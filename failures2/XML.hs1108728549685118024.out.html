<a href="Types.hs340756291478446501.out.html">prev</a></br><a href="failures.html">home</a></br><a href="XSLT.hs21187978011060806853.out.html">next</a></br></br><pre>9d8
<  output (File path block) = ({-# LINE 8 "XML.hs.neat" #-}
10d8
<   "<?xml version=\"1.0\"?>\n<File path=" ++ ({-# LINE 9 "XML.hs.neat" #-}
11d8
<   output (quote $ path)) ++ {-# LINE 9 "XML.hs.neat" #-}
12d8
<   ">" ++ ({-# LINE 10 "XML.hs.neat" #-}
13d8
<   output (block)) ++ {-# LINE 10 "XML.hs.neat" #-}
14c9
<   "\n</File>"){-# LINE 12 "XML.hs.neat" #-}
---
>  output (File path block) = ( ++ (
14a10
>   output (quote $ path)) ++ ++ (
14a11
>   output (block)) ++)
16a14
> 
18d15
<  output (Block chunks) = ({-# LINE 15 "XML.hs.neat" #-}
19c16
<   "\n  <Block>" ++ ({-# LINE 17 "XML.hs.neat" #-}
---
>  output (Block chunks) = ( ++ (
19a17
> 
22d19
<       then _l >>= \{-# LINE 17 "XML.hs.neat" #-}
23d19
<   chunk -> ({-# LINE 17 "XML.hs.neat" #-}
24d19
<     "" ++ ({-# LINE 18 "XML.hs.neat" #-}
25d19
<     output (chunk)) ++ {-# LINE 18 "XML.hs.neat" #-}
26d19
<     "")
27d19
<       else []) ++ {-# LINE 19 "XML.hs.neat" #-}
28c20
<   "\n  </Block>"){-# LINE 21 "XML.hs.neat" #-}
---
>       then  _l >>= \ -> ( ++ (
28a21
>     output (chunk)))
28a22
>       else) ++)
30a25
> 
32d26
<  output (Chunk location element) = ({-# LINE 24 "XML.hs.neat" #-}
33d26
<   "\n  <Chunk " ++ ({-# LINE 25 "XML.hs.neat" #-}
34d26
<   output (location)) ++ {-# LINE 25 "XML.hs.neat" #-}
35d26
<   ">" ++ ({-# LINE 26 "XML.hs.neat" #-}
36d26
<   output (element)) ++ {-# LINE 26 "XML.hs.neat" #-}
37c27
<   "\n  </Chunk>"){-# LINE 28 "XML.hs.neat" #-}
---
>  output (Chunk location element) = ( ++ (
37a28
>   output (location)) ++ ++ (
37a29
>   output (element)) ++)
39a32
> 
41d33
<  output (Case pattern block) = ({-# LINE 31 "XML.hs.neat" #-}
42d33
<   "\n  <Case>" ++ ({-# LINE 33 "XML.hs.neat" #-}
43d33
<   output (pattern)) ++ {-# LINE 33 "XML.hs.neat" #-}
44d33
<   "" ++ ({-# LINE 34 "XML.hs.neat" #-}
45d33
<   output (block)) ++ {-# LINE 34 "XML.hs.neat" #-}
46c34
<   "\n  </Case>"){-# LINE 36 "XML.hs.neat" #-}
---
>  output (Case pattern block) = ( ++ (
47a36
>   output (pattern)) ++ ++ (
47a37
>   output (block)) ++)
49d38
< instance Output Location where
50d38
<  output (Location file line) = ({-# LINE 39 "XML.hs.neat" #-}
51d38
<   "file=" ++ ({-# LINE 39 "XML.hs.neat" #-}
52d38
<   output (quote $ file)) ++ {-# LINE 39 "XML.hs.neat" #-}
53d38
<   " line=\"" ++ ({-# LINE 39 "XML.hs.neat" #-}
54d38
<   output (line)) ++ {-# LINE 39 "XML.hs.neat" #-}
55d38
<   "\""){-# LINE 39 "XML.hs.neat" #-}
57a41
> instance Output Location where
57a42
>  output (Location file line) = ( ++ ( (quote $ file)) ++ ++ ( (line)) ++)
57a43
> 
59d44
<  output (Value location pipeline) = ({-# LINE 42 "XML.hs.neat" #-}
60d44
<   "\n  <Value " ++ ({-# LINE 43 "XML.hs.neat" #-}
61d44
<   output (location)) ++ {-# LINE 43 "XML.hs.neat" #-}
62c45
<   ">\n    <Pipeline>" ++ ({-# LINE 45 "XML.hs.neat" #-}
---
>  output (Value location pipeline) = ( ++ (
62a46
>   output (location)) ++ ++ (
62a47
> 
65d49
<       then _l >>= \{-# LINE 45 "XML.hs.neat" #-}
66d49
<   pipe -> ({-# LINE 45 "XML.hs.neat" #-}
67d49
<     "\n        <Pipe><![CDATA[" ++ ({-# LINE 46 "XML.hs.neat" #-}
68d49
<     output (pipe)) ++ {-# LINE 46 "XML.hs.neat" #-}
69d49
<     "]]></Pipe>")
70d49
<       else []) ++ {-# LINE 47 "XML.hs.neat" #-}
71c50
<   "\n    </Pipeline>\n  </Value>"){-# LINE 50 "XML.hs.neat" #-}
---
>       then _l >>= \ -> ( ++ (
71a51
>     output (pipe)) ++)
71a52
>       else) ++)
73a55
> 
73a56
> 
75d57
<  output (Pattern location pattern) = ({-# LINE 53 "XML.hs.neat" #-}
76d57
<   "\n  <Pattern " ++ ({-# LINE 54 "XML.hs.neat" #-}
77d57
<   output (location)) ++ {-# LINE 54 "XML.hs.neat" #-}
78d57
<   "><![CDATA[" ++ ({-# LINE 54 "XML.hs.neat" #-}
79d57
<   output (pattern)) ++ {-# LINE 54 "XML.hs.neat" #-}
80c58
<   "]]></Pattern>"){-# LINE 55 "XML.hs.neat" #-}
---
>  output (Pattern location pattern) = ( ++ (
80a59
>   output (location)) ++ ++ ( (pattern)) ++)
84d62
<  output (Output value) = ({-# LINE 58 "XML.hs.neat" #-}
85d62
<   "\n  <Output>" ++ ({-# LINE 59 "XML.hs.neat" #-}
86d62
<   output (value)) ++ {-# LINE 59 "XML.hs.neat" #-}
87c63
<   "</Output>"){-# LINE 60 "XML.hs.neat" #-}
---
>  output (Output value) = ( ++ (
87a64
>   output (value)) ++)
90d66
<  output (Comment comment) = ({-# LINE 62 "XML.hs.neat" #-}
91d66
<   "\n  <Comment><![CDATA[" ++ ({-# LINE 63 "XML.hs.neat" #-}
92d66
<   output (comment)) ++ {-# LINE 63 "XML.hs.neat" #-}
93c67
<   "]]></Output>"){-# LINE 64 "XML.hs.neat" #-}
---
>  output (Comment comment) = ( ++ (
93a68
>   output (comment)) ++)
96d70
<  output (Define (Function location name pattern) block) = ({-# LINE 66 "XML.hs.neat" #-}
97d70
<   "\n  <Define name=" ++ ({-# LINE 67 "XML.hs.neat" #-}
98d70
<   output (quote $ name)) ++ {-# LINE 67 "XML.hs.neat" #-}
99d70
<   " " ++ ({-# LINE 67 "XML.hs.neat" #-}
100d70
<   output (location)) ++ {-# LINE 67 "XML.hs.neat" #-}
101d70
<   ">" ++ ({-# LINE 68 "XML.hs.neat" #-}
102d70
<   output (pattern)) ++ {-# LINE 68 "XML.hs.neat" #-}
103d70
<   "" ++ ({-# LINE 69 "XML.hs.neat" #-}
104d70
<   output (block)) ++ {-# LINE 69 "XML.hs.neat" #-}
105c71
<   "\n  </Define>"){-# LINE 71 "XML.hs.neat" #-}
---
>  output (Define (Function location name pattern) block) = ( ++ (
105a72
>   output (quote $ name)) ++ ++ ( (location)) ++ (
105a73
>   output (pattern)) ++ ++ (
105a74
>   output (block)) ++)
108d76
<  output (Filter value block) = ({-# LINE 73 "XML.hs.neat" #-}
109d76
<   "\n  <Filter>" ++ ({-# LINE 75 "XML.hs.neat" #-}
110d76
<   output (value)) ++ {-# LINE 75 "XML.hs.neat" #-}
111d76
<   "" ++ ({-# LINE 76 "XML.hs.neat" #-}
112d76
<   output (block)) ++ {-# LINE 76 "XML.hs.neat" #-}
113d76
<   "\n  </Filter>"){-# LINE 78 "XML.hs.neat" #-}
114a78
>  output (Filter value block) = ( ++ (
116d79
<  output (For binding block else') = ({-# LINE 80 "XML.hs.neat" #-}
117d79
<   "\n  <For>" ++ ({-# LINE 82 "XML.hs.neat" #-}
118d79
<   output (binding)) ++ {-# LINE 82 "XML.hs.neat" #-}
119d79
<   "" ++ ({-# LINE 83 "XML.hs.neat" #-}
120d79
<   output (block)) ++ {-# LINE 83 "XML.hs.neat" #-}
121c80
<   "" ++ ({-# LINE 84 "XML.hs.neat" #-}
---
>   output (value)) ++ ++ (
121a81
>   output (block)) ++)
121a82
> 
121a83
> 
121a84
> 
121a85
>  output (For binding block else') = ( ++ (
121a86
> 
121a87
>   output (binding)) ++ ++ (
121a88
>   output (block)) ++ ++ (
123d89
<     then ({-# LINE 84 "XML.hs.neat" #-}
124d89
<     "<Else>" ++ ({-# LINE 84 "XML.hs.neat" #-}
125d89
<     output (else')) ++ {-# LINE 84 "XML.hs.neat" #-}
126d89
<     "</Else>")
127d89
<     else []) ++ {-# LINE 84 "XML.hs.neat" #-}
128c90
<   "\n  </For>"){-# LINE 86 "XML.hs.neat" #-}
---
>     then      ( ++ ( (else')) ++)
128a91
>     else []) ++)
131d93
<  output (If value block else') = ({-# LINE 88 "XML.hs.neat" #-}
132d93
<   "\n  <If>" ++ ({-# LINE 90 "XML.hs.neat" #-}
133d93
<   output (value)) ++ {-# LINE 90 "XML.hs.neat" #-}
134d93
<   "" ++ ({-# LINE 91 "XML.hs.neat" #-}
135d93
<   output (block)) ++ {-# LINE 91 "XML.hs.neat" #-}
136c94
<   "" ++ ({-# LINE 92 "XML.hs.neat" #-}
---
> 
136a95
>  output (If value block else') = ( ++ (
136a96
> 
136a97
>   output (value)) ++ ++ (
136a98
>   output (block)) ++ ++ (
138d99
<     then ({-# LINE 92 "XML.hs.neat" #-}
139d99
<     "<Else>" ++ ({-# LINE 92 "XML.hs.neat" #-}
140d99
<     output (else')) ++ {-# LINE 92 "XML.hs.neat" #-}
141d99
<     "</Else>")
142d99
<     else []) ++ {-# LINE 92 "XML.hs.neat" #-}
143c100
<   "\n  </If>"){-# LINE 94 "XML.hs.neat" #-}
---
>     then      ( ++ ( (else')) ++)
143a101
>     else []) ++)
146d103
<  output (Switch value cases default') = ({-# LINE 96 "XML.hs.neat" #-}
147d103
<   "\n  <Switch>" ++ ({-# LINE 98 "XML.hs.neat" #-}
148d103
<   output (value)) ++ {-# LINE 98 "XML.hs.neat" #-}
149c104
<   "" ++ ({-# LINE 99 "XML.hs.neat" #-}
---
> 
149a105
>  output (Switch value cases default') = ( ++ (
149a106
> 
149a107
>   output (value)) ++ ++ (
152d109
<       then _l >>= \{-# LINE 99 "XML.hs.neat" #-}
153d109
<   case' -> ({-# LINE 99 "XML.hs.neat" #-}
154d109
<     "" ++ ({-# LINE 100 "XML.hs.neat" #-}
155d109
<     output (case')) ++ {-# LINE 100 "XML.hs.neat" #-}
156d109
<     "")
157d109
<       else []) ++ {-# LINE 101 "XML.hs.neat" #-}
158c110
<   "" ++ ({-# LINE 102 "XML.hs.neat" #-}
---
>       then  _l >>= \ -> ( ++ (
158a111
>     output (case')))
158a112
>       else) ++ ++ (
160d113
<     then ({-# LINE 102 "XML.hs.neat" #-}
161d113
<     "<Default>" ++ ({-# LINE 102 "XML.hs.neat" #-}
162d113
<     output (default')) ++ {-# LINE 102 "XML.hs.neat" #-}
163d113
<     "</Default>")
164d113
<     else []) ++ {-# LINE 102 "XML.hs.neat" #-}
165c114
<   "\n  </Switch>"){-# LINE 104 "XML.hs.neat" #-}
---
>     then         ( ++ ( (default')) ++)
165a115
>     else []) ++)
168d117
<  output (With binding block) = ({-# LINE 106 "XML.hs.neat" #-}
169d117
<   "\n  <With>" ++ ({-# LINE 108 "XML.hs.neat" #-}
170d117
<   output (binding)) ++ {-# LINE 108 "XML.hs.neat" #-}
171d117
<   "" ++ ({-# LINE 109 "XML.hs.neat" #-}
172d117
<   output (block)) ++ {-# LINE 109 "XML.hs.neat" #-}
173d117
<   "\n  </With>"){-# LINE 111 "XML.hs.neat" #-}
174a119
>  output (With binding block) = ( ++ (
176d120
<  output (Text text) = ({-# LINE 113 "XML.hs.neat" #-}
177d120
<   "<Text><![CDATA[" ++ ({-# LINE 113 "XML.hs.neat" #-}
178d120
<   output (text)) ++ {-# LINE 113 "XML.hs.neat" #-}
179c121
<   "]]></Text>"){-# LINE 113 "XML.hs.neat" #-}
---
>   output (binding)) ++ ++ (
179a122
>   output (block)) ++)
182a126
>  output (Text text) = ( ++ ( (text)) ++)
182a127
> 
182a128
> 
184a131
> 
</pre></br><h2>original</h2></br><pre>{-# LINE 1 "XML.hs.neat" #-}
module Text.Neat.Output.XML (outputXML) where

import Text.Neat.Template
import Text.Neat.Output


instance Output File where
 output (File path block) = ({-# LINE 8 "XML.hs.neat" #-}
  "<?xml version=\"1.0\"?>\n<File path=" ++ ({-# LINE 9 "XML.hs.neat" #-}
  output (quote $ path)) ++ {-# LINE 9 "XML.hs.neat" #-}
  ">" ++ ({-# LINE 10 "XML.hs.neat" #-}
  output (block)) ++ {-# LINE 10 "XML.hs.neat" #-}
  "\n</File>"){-# LINE 12 "XML.hs.neat" #-}


instance Output Block where
 output (Block chunks) = ({-# LINE 15 "XML.hs.neat" #-}
  "\n  <Block>" ++ ({-# LINE 17 "XML.hs.neat" #-}
  let _l = list (chunks) in
    if (not . null) _l
      then _l >>= \{-# LINE 17 "XML.hs.neat" #-}
  chunk -> ({-# LINE 17 "XML.hs.neat" #-}
    "" ++ ({-# LINE 18 "XML.hs.neat" #-}
    output (chunk)) ++ {-# LINE 18 "XML.hs.neat" #-}
    "")
      else []) ++ {-# LINE 19 "XML.hs.neat" #-}
  "\n  </Block>"){-# LINE 21 "XML.hs.neat" #-}


instance Output Chunk where
 output (Chunk location element) = ({-# LINE 24 "XML.hs.neat" #-}
  "\n  <Chunk " ++ ({-# LINE 25 "XML.hs.neat" #-}
  output (location)) ++ {-# LINE 25 "XML.hs.neat" #-}
  ">" ++ ({-# LINE 26 "XML.hs.neat" #-}
  output (element)) ++ {-# LINE 26 "XML.hs.neat" #-}
  "\n  </Chunk>"){-# LINE 28 "XML.hs.neat" #-}


instance Output Case where
 output (Case pattern block) = ({-# LINE 31 "XML.hs.neat" #-}
  "\n  <Case>" ++ ({-# LINE 33 "XML.hs.neat" #-}
  output (pattern)) ++ {-# LINE 33 "XML.hs.neat" #-}
  "" ++ ({-# LINE 34 "XML.hs.neat" #-}
  output (block)) ++ {-# LINE 34 "XML.hs.neat" #-}
  "\n  </Case>"){-# LINE 36 "XML.hs.neat" #-}


instance Output Location where
 output (Location file line) = ({-# LINE 39 "XML.hs.neat" #-}
  "file=" ++ ({-# LINE 39 "XML.hs.neat" #-}
  output (quote $ file)) ++ {-# LINE 39 "XML.hs.neat" #-}
  " line=\"" ++ ({-# LINE 39 "XML.hs.neat" #-}
  output (line)) ++ {-# LINE 39 "XML.hs.neat" #-}
  "\""){-# LINE 39 "XML.hs.neat" #-}


instance Output Value where
 output (Value location pipeline) = ({-# LINE 42 "XML.hs.neat" #-}
  "\n  <Value " ++ ({-# LINE 43 "XML.hs.neat" #-}
  output (location)) ++ {-# LINE 43 "XML.hs.neat" #-}
  ">\n    <Pipeline>" ++ ({-# LINE 45 "XML.hs.neat" #-}
  let _l = list (pipeline) in
    if (not . null) _l
      then _l >>= \{-# LINE 45 "XML.hs.neat" #-}
  pipe -> ({-# LINE 45 "XML.hs.neat" #-}
    "\n        <Pipe><![CDATA[" ++ ({-# LINE 46 "XML.hs.neat" #-}
    output (pipe)) ++ {-# LINE 46 "XML.hs.neat" #-}
    "]]></Pipe>")
      else []) ++ {-# LINE 47 "XML.hs.neat" #-}
  "\n    </Pipeline>\n  </Value>"){-# LINE 50 "XML.hs.neat" #-}


instance Output Pattern where
 output (Pattern location pattern) = ({-# LINE 53 "XML.hs.neat" #-}
  "\n  <Pattern " ++ ({-# LINE 54 "XML.hs.neat" #-}
  output (location)) ++ {-# LINE 54 "XML.hs.neat" #-}
  "><![CDATA[" ++ ({-# LINE 54 "XML.hs.neat" #-}
  output (pattern)) ++ {-# LINE 54 "XML.hs.neat" #-}
  "]]></Pattern>"){-# LINE 55 "XML.hs.neat" #-}


instance Output Element where
 output (Output value) = ({-# LINE 58 "XML.hs.neat" #-}
  "\n  <Output>" ++ ({-# LINE 59 "XML.hs.neat" #-}
  output (value)) ++ {-# LINE 59 "XML.hs.neat" #-}
  "</Output>"){-# LINE 60 "XML.hs.neat" #-}


 output (Comment comment) = ({-# LINE 62 "XML.hs.neat" #-}
  "\n  <Comment><![CDATA[" ++ ({-# LINE 63 "XML.hs.neat" #-}
  output (comment)) ++ {-# LINE 63 "XML.hs.neat" #-}
  "]]></Output>"){-# LINE 64 "XML.hs.neat" #-}


 output (Define (Function location name pattern) block) = ({-# LINE 66 "XML.hs.neat" #-}
  "\n  <Define name=" ++ ({-# LINE 67 "XML.hs.neat" #-}
  output (quote $ name)) ++ {-# LINE 67 "XML.hs.neat" #-}
  " " ++ ({-# LINE 67 "XML.hs.neat" #-}
  output (location)) ++ {-# LINE 67 "XML.hs.neat" #-}
  ">" ++ ({-# LINE 68 "XML.hs.neat" #-}
  output (pattern)) ++ {-# LINE 68 "XML.hs.neat" #-}
  "" ++ ({-# LINE 69 "XML.hs.neat" #-}
  output (block)) ++ {-# LINE 69 "XML.hs.neat" #-}
  "\n  </Define>"){-# LINE 71 "XML.hs.neat" #-}


 output (Filter value block) = ({-# LINE 73 "XML.hs.neat" #-}
  "\n  <Filter>" ++ ({-# LINE 75 "XML.hs.neat" #-}
  output (value)) ++ {-# LINE 75 "XML.hs.neat" #-}
  "" ++ ({-# LINE 76 "XML.hs.neat" #-}
  output (block)) ++ {-# LINE 76 "XML.hs.neat" #-}
  "\n  </Filter>"){-# LINE 78 "XML.hs.neat" #-}


 output (For binding block else') = ({-# LINE 80 "XML.hs.neat" #-}
  "\n  <For>" ++ ({-# LINE 82 "XML.hs.neat" #-}
  output (binding)) ++ {-# LINE 82 "XML.hs.neat" #-}
  "" ++ ({-# LINE 83 "XML.hs.neat" #-}
  output (block)) ++ {-# LINE 83 "XML.hs.neat" #-}
  "" ++ ({-# LINE 84 "XML.hs.neat" #-}
  if (not . zero) (else')
    then ({-# LINE 84 "XML.hs.neat" #-}
    "<Else>" ++ ({-# LINE 84 "XML.hs.neat" #-}
    output (else')) ++ {-# LINE 84 "XML.hs.neat" #-}
    "</Else>")
    else []) ++ {-# LINE 84 "XML.hs.neat" #-}
  "\n  </For>"){-# LINE 86 "XML.hs.neat" #-}


 output (If value block else') = ({-# LINE 88 "XML.hs.neat" #-}
  "\n  <If>" ++ ({-# LINE 90 "XML.hs.neat" #-}
  output (value)) ++ {-# LINE 90 "XML.hs.neat" #-}
  "" ++ ({-# LINE 91 "XML.hs.neat" #-}
  output (block)) ++ {-# LINE 91 "XML.hs.neat" #-}
  "" ++ ({-# LINE 92 "XML.hs.neat" #-}
  if (not . zero) (else')
    then ({-# LINE 92 "XML.hs.neat" #-}
    "<Else>" ++ ({-# LINE 92 "XML.hs.neat" #-}
    output (else')) ++ {-# LINE 92 "XML.hs.neat" #-}
    "</Else>")
    else []) ++ {-# LINE 92 "XML.hs.neat" #-}
  "\n  </If>"){-# LINE 94 "XML.hs.neat" #-}


 output (Switch value cases default') = ({-# LINE 96 "XML.hs.neat" #-}
  "\n  <Switch>" ++ ({-# LINE 98 "XML.hs.neat" #-}
  output (value)) ++ {-# LINE 98 "XML.hs.neat" #-}
  "" ++ ({-# LINE 99 "XML.hs.neat" #-}
  let _l = list (cases) in
    if (not . null) _l
      then _l >>= \{-# LINE 99 "XML.hs.neat" #-}
  case' -> ({-# LINE 99 "XML.hs.neat" #-}
    "" ++ ({-# LINE 100 "XML.hs.neat" #-}
    output (case')) ++ {-# LINE 100 "XML.hs.neat" #-}
    "")
      else []) ++ {-# LINE 101 "XML.hs.neat" #-}
  "" ++ ({-# LINE 102 "XML.hs.neat" #-}
  if (not . zero) (default')
    then ({-# LINE 102 "XML.hs.neat" #-}
    "<Default>" ++ ({-# LINE 102 "XML.hs.neat" #-}
    output (default')) ++ {-# LINE 102 "XML.hs.neat" #-}
    "</Default>")
    else []) ++ {-# LINE 102 "XML.hs.neat" #-}
  "\n  </Switch>"){-# LINE 104 "XML.hs.neat" #-}


 output (With binding block) = ({-# LINE 106 "XML.hs.neat" #-}
  "\n  <With>" ++ ({-# LINE 108 "XML.hs.neat" #-}
  output (binding)) ++ {-# LINE 108 "XML.hs.neat" #-}
  "" ++ ({-# LINE 109 "XML.hs.neat" #-}
  output (block)) ++ {-# LINE 109 "XML.hs.neat" #-}
  "\n  </With>"){-# LINE 111 "XML.hs.neat" #-}


 output (Text text) = ({-# LINE 113 "XML.hs.neat" #-}
  "<Text><![CDATA[" ++ ({-# LINE 113 "XML.hs.neat" #-}
  output (text)) ++ {-# LINE 113 "XML.hs.neat" #-}
  "]]></Text>"){-# LINE 113 "XML.hs.neat" #-}



outputXML :: File -> String
outputXML = output
</pre></br><h2>printed</h2></br><pre>{-# LINE 1 "XML.hs.neat" #-}
module Text.Neat.Output.XML (outputXML) where

import Text.Neat.Template
import Text.Neat.Output


instance Output File where
 output (File path block) = ( ++ (
  output (quote $ path)) ++ ++ (
  output (block)) ++)



instance Output Block where
 output (Block chunks) = ( ++ (

  let _l = list (chunks) in
    if (not . null) _l
      then  _l >>= \ -> ( ++ (
    output (chunk)))
      else) ++)



instance Output Chunk where
 output (Chunk location element) = ( ++ (
  output (location)) ++ ++ (
  output (element)) ++)



instance Output Case where
 output (Case pattern block) = ( ++ (

  output (pattern)) ++ ++ (
  output (block)) ++)



instance Output Location where
 output (Location file line) = ( ++ ( (quote $ file)) ++ ++ ( (line)) ++)

instance Output Value where
 output (Value location pipeline) = ( ++ (
  output (location)) ++ ++ (

  let _l = list (pipeline) in
    if (not . null) _l
      then _l >>= \ -> ( ++ (
    output (pipe)) ++)
      else) ++)




instance Output Pattern where
 output (Pattern location pattern) = ( ++ (
  output (location)) ++ ++ ( (pattern)) ++)


instance Output Element where
 output (Output value) = ( ++ (
  output (value)) ++)


 output (Comment comment) = ( ++ (
  output (comment)) ++)


 output (Define (Function location name pattern) block) = ( ++ (
  output (quote $ name)) ++ ++ ( (location)) ++ (
  output (pattern)) ++ ++ (
  output (block)) ++)



 output (Filter value block) = ( ++ (

  output (value)) ++ ++ (
  output (block)) ++)



 output (For binding block else') = ( ++ (

  output (binding)) ++ ++ (
  output (block)) ++ ++ (
  if (not . zero) (else')
    then      ( ++ ( (else')) ++)
    else []) ++)



 output (If value block else') = ( ++ (

  output (value)) ++ ++ (
  output (block)) ++ ++ (
  if (not . zero) (else')
    then      ( ++ ( (else')) ++)
    else []) ++)



 output (Switch value cases default') = ( ++ (

  output (value)) ++ ++ (
  let _l = list (cases) in
    if (not . null) _l
      then  _l >>= \ -> ( ++ (
    output (case')))
      else) ++ ++ (
  if (not . zero) (default')
    then         ( ++ ( (default')) ++)
    else []) ++)



 output (With binding block) = ( ++ (

  output (binding)) ++ ++ (
  output (block)) ++)



 output (Text text) = ( ++ ( (text)) ++)


outputXML :: File -> String
outputXML = output

</pre>