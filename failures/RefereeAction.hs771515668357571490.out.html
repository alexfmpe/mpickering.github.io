<a href="Referee.hs510616708590357944.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Reference.hs14946643051706755176.out.html">next</a></br></br><pre>34c34
< isReprimandPlayer ∷ RefereeAction → Bool
---
> isReprimandPlayer :: RefereeAction -> Bool
38c38
< isHands ∷ RefereeAction → Bool
---
> isHands :: RefereeAction -> Bool
42c42
< isTackleDetected ∷ RefereeAction → Bool
---
> isTackleDetected :: RefereeAction -> Bool
46c46
< isSchwalbeDetected ∷ RefereeAction → Bool
---
> isSchwalbeDetected :: RefereeAction -> Bool
50c50
< isTheaterDetected ∷ RefereeAction → Bool
---
> isTheaterDetected :: RefereeAction -> Bool
54c54
< isDangerousPlay ∷ RefereeAction → Bool
---
> isDangerousPlay :: RefereeAction -> Bool
58c58
< isGameOver ∷ RefereeAction → Bool
---
> isGameOver :: RefereeAction -> Bool
62c62
< isPauseGame ∷ RefereeAction → Bool
---
> isPauseGame :: RefereeAction -> Bool
66c66
< isAddTime ∷ RefereeAction → Bool
---
> isAddTime :: RefereeAction -> Bool
70c70
< isEndHalf ∷ RefereeAction → Bool
---
> isEndHalf :: RefereeAction -> Bool
74c74
< isGoal ∷ RefereeAction → Bool
---
> isGoal :: RefereeAction -> Bool
78c78
< isOffside ∷ RefereeAction → Bool
---
> isOffside :: RefereeAction -> Bool
82c82
< isDirectFreeKick ∷ RefereeAction → Bool
---
> isDirectFreeKick :: RefereeAction -> Bool
86c86
< isGoalKick ∷ RefereeAction → Bool
---
> isGoalKick :: RefereeAction -> Bool
90c90
< isCorner ∷ RefereeAction → Bool
---
> isCorner :: RefereeAction -> Bool
94c94
< isThrowIn ∷ RefereeAction → Bool
---
> isThrowIn :: RefereeAction -> Bool
98c98
< isPenalty ∷ RefereeAction → Bool
---
> isPenalty :: RefereeAction -> Bool
102c102
< isCenterKick ∷ RefereeAction → Bool
---
> isCenterKick :: RefereeAction -> Bool
106c106
< isAdvantage ∷ RefereeAction → Bool
---
> isAdvantage :: RefereeAction -> Bool
110c110
< isOwnBallIllegally ∷ RefereeAction → Bool
---
> isOwnBallIllegally :: RefereeAction -> Bool
114c114
< isDisplacePlayers ∷ RefereeAction → Bool
---
> isDisplacePlayers :: RefereeAction -> Bool
118c118
< isContinueGame ∷ RefereeAction → Bool
---
> isContinueGame :: RefereeAction -> Bool
122c122
< isTellMessage ∷ RefereeAction → Bool
---
> isTellMessage :: RefereeAction -> Bool
127c127
< isGoal4ATeam ∷ ATeam → RefereeAction → Bool
---
> isGoal4ATeam :: ATeam -> RefereeAction -> Bool
132c132
< getKickPos ∷ Field → Half → RefereeAction → Maybe Position
---
> getKickPos :: Field -> Half -> RefereeAction -> Maybe Position
156a157
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE UnicodeSyntax #-}
module SoccerFun.RefereeAction where

import SoccerFun.Types
import SoccerFun.Geometry
import SoccerFun.Field

data RefereeAction
    = ReprimandPlayer PlayerID Reprimand -- ^ player with given name receives reprimand
    | Hands PlayerID                     -- ^ person is seen for doing hands
    | TackleDetected PlayerID            -- ^ person is seen for doing tackle
    | SchwalbeDetected PlayerID          -- ^ person is seen for doing schwalbe
    | TheaterDetected PlayerID
    | DangerousPlay PlayerID             -- ^ person is seen for doing dangerous actions
    | GameOver                           -- ^ end of game
    | PauseGame                          -- ^ game is paused
    | AddTime ExtraTime                  -- ^ extra time is added to the game
    | EndHalf                            -- ^ first half is over, teams go for a second half
    | Goal ATeam                         -- ^ team playing at home has scored
    | Offside PlayerID                   -- ^ player is offside at Home
    | DirectFreeKick ATeam Position      -- ^ a direct free kick is granted for team home at given position
    | GoalKick ATeam                     -- ^ a goal kick is granted for team home
    | Corner ATeam Edge                  -- ^ a corner kick is granted for team home
    | ThrowIn ATeam Position             -- ^ a throw in ball is granted for team home at given position
    | Penalty ATeam                      -- ^ penalty at homeside
    | CenterKick ATeam                   -- ^ team playing at home may start from the center
    | Advantage ATeam                    -- ^ referee gives advantages to home-team
    | OwnBallIllegally PlayerID          -- ^ ball was for the other team
    | DisplacePlayers Displacements      -- ^ displaces all players at the provided position (used with free kicks)
    | ContinueGame
    | TellMessage String                 -- ^ no effect on match, message is displayed by referee
    deriving (Show, Eq)

isReprimandPlayer ∷ RefereeAction → Bool
isReprimandPlayer (ReprimandPlayer _ _) = True
isReprimandPlayer _ = False

isHands ∷ RefereeAction → Bool
isHands (Hands _) = True
isHands _ = False

isTackleDetected ∷ RefereeAction → Bool
isTackleDetected (TackleDetected _) = True
isTackleDetected _ = False

isSchwalbeDetected ∷ RefereeAction → Bool
isSchwalbeDetected (SchwalbeDetected _) = True
isSchwalbeDetected _ = False

isTheaterDetected ∷ RefereeAction → Bool
isTheaterDetected (TheaterDetected _) = True
isTheaterDetected _ = False

isDangerousPlay ∷ RefereeAction → Bool
isDangerousPlay (DangerousPlay _) = True
isDangerousPlay _ = False

isGameOver ∷ RefereeAction → Bool
isGameOver GameOver = True
isGameOver _ = False

isPauseGame ∷ RefereeAction → Bool
isPauseGame PauseGame = True
isPauseGame _ = False

isAddTime ∷ RefereeAction → Bool
isAddTime (AddTime _) = True
isAddTime _ = False

isEndHalf ∷ RefereeAction → Bool
isEndHalf EndHalf = True
isEndHalf _ = False

isGoal ∷ RefereeAction → Bool
isGoal (Goal _) = True
isGoal _ = False

isOffside ∷ RefereeAction → Bool
isOffside (Offside _) = True
isOffside _ = False

isDirectFreeKick ∷ RefereeAction → Bool
isDirectFreeKick (DirectFreeKick _ _ ) = True
isDirectFreeKick _ = False

isGoalKick ∷ RefereeAction → Bool
isGoalKick (GoalKick _) = True
isGoalKick _ = False

isCorner ∷ RefereeAction → Bool
isCorner (Corner _ _) = True
isCorner _ = False

isThrowIn ∷ RefereeAction → Bool
isThrowIn (ThrowIn _ _) = True
isThrowIn _ = False

isPenalty ∷ RefereeAction → Bool
isPenalty (Penalty _) = True
isPenalty _ = False

isCenterKick ∷ RefereeAction → Bool
isCenterKick (CenterKick _) = True
isCenterKick _ = False

isAdvantage ∷ RefereeAction → Bool
isAdvantage (Advantage _) = True
isAdvantage _ = False

isOwnBallIllegally ∷ RefereeAction → Bool
isOwnBallIllegally (OwnBallIllegally _) = True
isOwnBallIllegally _ = False

isDisplacePlayers ∷ RefereeAction → Bool
isDisplacePlayers (DisplacePlayers _) = True
isDisplacePlayers _ = False

isContinueGame ∷ RefereeAction → Bool
isContinueGame ContinueGame = True
isContinueGame _ = False

isTellMessage ∷ RefereeAction → Bool
isTellMessage (TellMessage _) = True
isTellMessage _ = False


isGoal4ATeam ∷ ATeam → RefereeAction → Bool
isGoal4ATeam t (Goal t') = t == t'
isGoal4ATeam _ _ = False

-- | Position of a referee-granted action like a throw-in, a corner kick, etc.
getKickPos ∷ Field → Half → RefereeAction → Maybe Position
getKickPos field half (GoalKick team) = Just $ Position { py = (fwidth field)/2.0
                                                   , px = if (team == Team1 && half == FirstHalf || team == Team2 && half == SecondHalf)
                                                             then 5
                                                             else (flength field) - 5 }
getKickPos field half (Corner team edge) = Just $ Position { px = if (team == Team1 && half == SecondHalf || team == Team2 && half == FirstHalf)
                                                             then halfRadiusCornerKickArea
                                                             else ((flength field) - halfRadiusCornerKickArea)
                                                   , py = if (edge == North)
                                                             then halfRadiusCornerKickArea
                                                             else ((fwidth field) - halfRadiusCornerKickArea)
                                                   }
    where
    halfRadiusCornerKickArea = radiusCornerKickArea / 2.0
getKickPos field half (Penalty team) = Just $ Position { py = (fwidth field)/2.0
                                                   , px = if (team == Team1 && half == SecondHalf || team == Team2 && half == FirstHalf)
                                                             then penaltySpotDepth
                                                             else ((flength field) - penaltySpotDepth)
                                                   }
getKickPos field _ (CenterKick _) = Just $ Position { px = (flength field)/2.0
                                                   , py = (fwidth field) /2.0
                                                   }
getKickPos _ _ (DirectFreeKick _ pos) = Just pos
getKickPos _ _ (ThrowIn _ pos) = Just pos
getKickPos _ _ _ = Nothing
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE UnicodeSyntax #-}
module SoccerFun.RefereeAction where

import SoccerFun.Types
import SoccerFun.Geometry
import SoccerFun.Field

data RefereeAction
    = ReprimandPlayer PlayerID Reprimand -- ^ player with given name receives reprimand
    | Hands PlayerID                     -- ^ person is seen for doing hands
    | TackleDetected PlayerID            -- ^ person is seen for doing tackle
    | SchwalbeDetected PlayerID          -- ^ person is seen for doing schwalbe
    | TheaterDetected PlayerID
    | DangerousPlay PlayerID             -- ^ person is seen for doing dangerous actions
    | GameOver                           -- ^ end of game
    | PauseGame                          -- ^ game is paused
    | AddTime ExtraTime                  -- ^ extra time is added to the game
    | EndHalf                            -- ^ first half is over, teams go for a second half
    | Goal ATeam                         -- ^ team playing at home has scored
    | Offside PlayerID                   -- ^ player is offside at Home
    | DirectFreeKick ATeam Position      -- ^ a direct free kick is granted for team home at given position
    | GoalKick ATeam                     -- ^ a goal kick is granted for team home
    | Corner ATeam Edge                  -- ^ a corner kick is granted for team home
    | ThrowIn ATeam Position             -- ^ a throw in ball is granted for team home at given position
    | Penalty ATeam                      -- ^ penalty at homeside
    | CenterKick ATeam                   -- ^ team playing at home may start from the center
    | Advantage ATeam                    -- ^ referee gives advantages to home-team
    | OwnBallIllegally PlayerID          -- ^ ball was for the other team
    | DisplacePlayers Displacements      -- ^ displaces all players at the provided position (used with free kicks)
    | ContinueGame
    | TellMessage String                 -- ^ no effect on match, message is displayed by referee
    deriving (Show, Eq)

isReprimandPlayer :: RefereeAction -> Bool
isReprimandPlayer (ReprimandPlayer _ _) = True
isReprimandPlayer _ = False

isHands :: RefereeAction -> Bool
isHands (Hands _) = True
isHands _ = False

isTackleDetected :: RefereeAction -> Bool
isTackleDetected (TackleDetected _) = True
isTackleDetected _ = False

isSchwalbeDetected :: RefereeAction -> Bool
isSchwalbeDetected (SchwalbeDetected _) = True
isSchwalbeDetected _ = False

isTheaterDetected :: RefereeAction -> Bool
isTheaterDetected (TheaterDetected _) = True
isTheaterDetected _ = False

isDangerousPlay :: RefereeAction -> Bool
isDangerousPlay (DangerousPlay _) = True
isDangerousPlay _ = False

isGameOver :: RefereeAction -> Bool
isGameOver GameOver = True
isGameOver _ = False

isPauseGame :: RefereeAction -> Bool
isPauseGame PauseGame = True
isPauseGame _ = False

isAddTime :: RefereeAction -> Bool
isAddTime (AddTime _) = True
isAddTime _ = False

isEndHalf :: RefereeAction -> Bool
isEndHalf EndHalf = True
isEndHalf _ = False

isGoal :: RefereeAction -> Bool
isGoal (Goal _) = True
isGoal _ = False

isOffside :: RefereeAction -> Bool
isOffside (Offside _) = True
isOffside _ = False

isDirectFreeKick :: RefereeAction -> Bool
isDirectFreeKick (DirectFreeKick _ _ ) = True
isDirectFreeKick _ = False

isGoalKick :: RefereeAction -> Bool
isGoalKick (GoalKick _) = True
isGoalKick _ = False

isCorner :: RefereeAction -> Bool
isCorner (Corner _ _) = True
isCorner _ = False

isThrowIn :: RefereeAction -> Bool
isThrowIn (ThrowIn _ _) = True
isThrowIn _ = False

isPenalty :: RefereeAction -> Bool
isPenalty (Penalty _) = True
isPenalty _ = False

isCenterKick :: RefereeAction -> Bool
isCenterKick (CenterKick _) = True
isCenterKick _ = False

isAdvantage :: RefereeAction -> Bool
isAdvantage (Advantage _) = True
isAdvantage _ = False

isOwnBallIllegally :: RefereeAction -> Bool
isOwnBallIllegally (OwnBallIllegally _) = True
isOwnBallIllegally _ = False

isDisplacePlayers :: RefereeAction -> Bool
isDisplacePlayers (DisplacePlayers _) = True
isDisplacePlayers _ = False

isContinueGame :: RefereeAction -> Bool
isContinueGame ContinueGame = True
isContinueGame _ = False

isTellMessage :: RefereeAction -> Bool
isTellMessage (TellMessage _) = True
isTellMessage _ = False


isGoal4ATeam :: ATeam -> RefereeAction -> Bool
isGoal4ATeam t (Goal t') = t == t'
isGoal4ATeam _ _ = False

-- | Position of a referee-granted action like a throw-in, a corner kick, etc.
getKickPos :: Field -> Half -> RefereeAction -> Maybe Position
getKickPos field half (GoalKick team) = Just $ Position { py = (fwidth field)/2.0
                                                   , px = if (team == Team1 && half == FirstHalf || team == Team2 && half == SecondHalf)
                                                             then 5
                                                             else (flength field) - 5 }
getKickPos field half (Corner team edge) = Just $ Position { px = if (team == Team1 && half == SecondHalf || team == Team2 && half == FirstHalf)
                                                             then halfRadiusCornerKickArea
                                                             else ((flength field) - halfRadiusCornerKickArea)
                                                   , py = if (edge == North)
                                                             then halfRadiusCornerKickArea
                                                             else ((fwidth field) - halfRadiusCornerKickArea)
                                                   }
    where
    halfRadiusCornerKickArea = radiusCornerKickArea / 2.0
getKickPos field half (Penalty team) = Just $ Position { py = (fwidth field)/2.0
                                                   , px = if (team == Team1 && half == SecondHalf || team == Team2 && half == FirstHalf)
                                                             then penaltySpotDepth
                                                             else ((flength field) - penaltySpotDepth)
                                                   }
getKickPos field _ (CenterKick _) = Just $ Position { px = (flength field)/2.0
                                                   , py = (fwidth field) /2.0
                                                   }
getKickPos _ _ (DirectFreeKick _ pos) = Just pos
getKickPos _ _ (ThrowIn _ pos) = Just pos
getKickPos _ _ _ = Nothing

</pre>