<a href="State.hs1075260298824938981.out.html">prev</a></br><a href="failures.html">home</a></br><a href="State.hs1580723810704877633.out.html">next</a></br></br><pre>28c28
<     , shift mods == Down
---
>       shift mods == Down
42a43
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE PatternGuards #-}

module State where
import World
import Graphics.Gloss.Interface.Pure.Game

-- | The game state.
data State
    = State
    { stateWorld        :: World
    , stateLineStart    :: Point
    , stateLineEnd      :: Point }


-- | Initial game state.
initState world
    = State
    { stateWorld        = world
    , stateLineStart    = (10, 10)
    , stateLineEnd      = (10, 10) }


-- | Handle an input event.
handleInput :: World -> Event -> State -> State
handleInput world (EventKey key keyState mods pos) state
    | MouseButton LeftButton    <- key
    , Down              <- keyState
    , shift mods == Down
    = state { stateLineEnd = worldPosOfWindowPos world pos }

    | MouseButton LeftButton    <- key
    , Down              <- keyState
    = state { stateLineStart    = worldPosOfWindowPos world pos
        , stateLineEnd      = worldPosOfWindowPos world pos }

    | MouseButton RightButton   <- key
    , Down              <- keyState
    = state { stateLineEnd      = worldPosOfWindowPos world pos }

handleInput _ _ state
    = state

</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE PatternGuards #-}

module State where
import World
import Graphics.Gloss.Interface.Pure.Game

-- | The game state.
data State
    = State
    { stateWorld        :: World
    , stateLineStart    :: Point
    , stateLineEnd      :: Point }


-- | Initial game state.
initState world
    = State
    { stateWorld        = world
    , stateLineStart    = (10, 10)
    , stateLineEnd      = (10, 10) }


-- | Handle an input event.
handleInput :: World -> Event -> State -> State
handleInput world (EventKey key keyState mods pos) state
    | MouseButton LeftButton    <- key
    , Down              <- keyState
      shift mods == Down
    = state { stateLineEnd = worldPosOfWindowPos world pos }

    | MouseButton LeftButton    <- key
    , Down              <- keyState
    = state { stateLineStart    = worldPosOfWindowPos world pos
        , stateLineEnd      = worldPosOfWindowPos world pos }

    | MouseButton RightButton   <- key
    , Down              <- keyState
    = state { stateLineEnd      = worldPosOfWindowPos world pos }

handleInput _ _ state
    = state


</pre>