<a href="Integral.hs8395944102095688080.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Integration.hs1075260298824938981.out.html">next</a></br></br><pre>104c104
< digitIn ∷ (PositionalSystem s, Num α, CharParsing μ) ⇒ s → μ α
---
> digitIn :: (PositionalSystem s, Num α, CharParsing μ) => s -> μ α
110c110
< nzDigitIn ∷ (PositionalSystem s, Num α, CharParsing μ) ⇒ s → μ α
---
> nzDigitIn :: (PositionalSystem s, Num α, CharParsing μ) => s -> μ α
116c116
< binDigit ∷ (Num α, CharParsing μ) ⇒ μ α
---
> binDigit :: (Num α, CharParsing μ) => μ α
121c121
< nzBinDigit ∷ (Num α, CharParsing μ) ⇒ μ α
---
> nzBinDigit :: (Num α, CharParsing μ) => μ α
126c126
< decDigit ∷ (Num α, CharParsing μ) ⇒ μ α
---
> decDigit :: (Num α, CharParsing μ) => μ α
131c131
< nzDecDigit ∷ (Num α, CharParsing μ) ⇒ μ α
---
> nzDecDigit :: (Num α, CharParsing μ) => μ α
136c136
< octDigit ∷ (Num α, CharParsing μ) ⇒ μ α
---
> octDigit :: (Num α, CharParsing μ) => μ α
141c141
< nzOctDigit ∷ (Num α, CharParsing μ) ⇒ μ α
---
> nzOctDigit :: (Num α, CharParsing μ) => μ α
146c146
< hexDigit ∷ (Num α, CharParsing μ) ⇒ μ α
---
> hexDigit :: (Num α, CharParsing μ) => μ α
151c151
< nzHexDigit ∷ (Num α, CharParsing μ) ⇒ μ α
---
> nzHexDigit :: (Num α, CharParsing μ) => μ α
156c156
< lowHexDigit ∷ (Num α, CharParsing μ) ⇒ μ α
---
> lowHexDigit :: (Num α, CharParsing μ) => μ α
161c161
< nzLowHexDigit ∷ (Num α, CharParsing μ) ⇒ μ α
---
> nzLowHexDigit :: (Num α, CharParsing μ) => μ α
166c166
< upHexDigit ∷ (Num α, CharParsing μ) ⇒ μ α
---
> upHexDigit :: (Num α, CharParsing μ) => μ α
171c171
< nzUpHexDigit ∷ (Num α, CharParsing μ) ⇒ μ α
---
> nzUpHexDigit :: (Num α, CharParsing μ) => μ α
177c177
< nonNegative ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → μ α
---
> nonNegative :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> μ α
179d178
<   where go !r = optional digit >>= \case
180d178
<                   Just d  → go (r * radix + d)
181c179
<                   Nothing → return r
---
>   where go !r = optional digit >>= 
181a180
>                   Just d  -> go (r * radix + d)
181a181
>                   Nothing -> return r
184d183
< {-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int #-}
185d183
< {-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int8 #-}
186d183
< {-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int16 #-}
187d183
< {-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int32 #-}
188d183
< {-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int64 #-}
189d183
< {-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word #-}
190d183
< {-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word8 #-}
191d183
< {-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word16 #-}
192d183
< {-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word32 #-}
193d183
< {-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word64 #-}
194d183
< {-# SPECIALIZE nonNegative ∷ (Num α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
195d183
< {-# SPECIALIZE nonNegative ∷ (Num α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
196d183
< {-# SPECIALIZE nonNegative ∷ (Num α, Monad μ, CharParsing μ) ⇒ Decimal → μ α #-}
197d183
< {-# SPECIALIZE nonNegative ∷ (Num α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
198d183
< {-# SPECIALIZE nonNegative ∷ (Num α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
199c184
< {-# SPECIALIZE nonNegative ∷ (Num α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}
---
> {-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Int #-}
199a185
> {-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Int8 #-}
199a186
> {-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Int16 #-}
199a187
> {-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Int32 #-}
199a188
> {-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Int64 #-}
199a189
> {-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Word #-}
199a190
> {-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Word8 #-}
199a191
> {-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Word16 #-}
199a192
> {-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Word32 #-}
199a193
> {-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Word64 #-}
199a194
> {-# SPECIALIZE nonNegative :: (Num α, Monad μ, CharParsing μ) => Binary -> μ α #-}
199a195
> {-# SPECIALIZE nonNegative :: (Num α, Monad μ, CharParsing μ) => Octal -> μ α #-}
199a196
> {-# SPECIALIZE nonNegative :: (Num α, Monad μ, CharParsing μ) => Decimal -> μ α #-}
199a197
> {-# SPECIALIZE nonNegative :: (Num α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
199a198
> {-# SPECIALIZE nonNegative :: (Num α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
199a199
> {-# SPECIALIZE nonNegative :: (Num α, Monad μ, CharParsing μ) => UpHex -> μ α #-}
203d202
< nnCompact ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → μ α
204d202
< nnCompact s = (<?> systemName s ++ " digits") $ digitIn s >>= \case
205d202
<                 0 → optional (PC.satisfy $ isDigitIn s) >>= \case
206d202
<                       Just _  → PC.unexpected "leading zero"
207d202
<                       Nothing → return 0
208d202
<                 r → go $ fromIntegral (r ∷ Word)
209d202
<   where go !r = optional digit >>= \case
210d202
<                   Just d  → go (r * radix + d)
211c203
<                   Nothing → return r
---
> nnCompact :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> μ α
211a204
> nnCompact s = (<?> systemName s ++ " digits") $ digitIn s >>= 
211a205
>                 0 -> optional (PC.satisfy $ isDigitIn s) >>= 
211a206
>                       Just _  -> PC.unexpected "leading zero"
211a207
>                       Nothing -> return 0
211a208
>                 r -> go $ fromIntegral (r :: Word)
211a209
>   where go !r = optional digit >>= 
211a210
>                   Just d  -> go (r * radix + d)
211a211
>                   Nothing -> return r
214d213
< {-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int #-}
215d213
< {-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int8 #-}
216d213
< {-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int16 #-}
217d213
< {-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int32 #-}
218d213
< {-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int64 #-}
219d213
< {-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word #-}
220d213
< {-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word8 #-}
221d213
< {-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word16 #-}
222d213
< {-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word32 #-}
223d213
< {-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word64 #-}
224d213
< {-# SPECIALIZE nnCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
225d213
< {-# SPECIALIZE nnCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
226d213
< {-# SPECIALIZE nnCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ Decimal → μ α #-}
227d213
< {-# SPECIALIZE nnCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
228d213
< {-# SPECIALIZE nnCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
229c214
< {-# SPECIALIZE nnCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}
---
> {-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int #-}
229a215
> {-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int8 #-}
229a216
> {-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int16 #-}
229a217
> {-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int32 #-}
229a218
> {-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int64 #-}
229a219
> {-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word #-}
229a220
> {-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word8 #-}
229a221
> {-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word16 #-}
229a222
> {-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word32 #-}
229a223
> {-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word64 #-}
229a224
> {-# SPECIALIZE nnCompact :: (Num α, Monad μ, CharParsing μ) => Binary -> μ α #-}
229a225
> {-# SPECIALIZE nnCompact :: (Num α, Monad μ, CharParsing μ) => Octal -> μ α #-}
229a226
> {-# SPECIALIZE nnCompact :: (Num α, Monad μ, CharParsing μ) => Decimal -> μ α #-}
229a227
> {-# SPECIALIZE nnCompact :: (Num α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
229a228
> {-# SPECIALIZE nnCompact :: (Num α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
229a229
> {-# SPECIALIZE nnCompact :: (Num α, Monad μ, CharParsing μ) => UpHex -> μ α #-}
231c231
< moreThan ∷ CharParsing μ ⇒ Int → μ α
---
> moreThan :: CharParsing μ => Int -> μ α
235d234
<                1 → " digit"
236c235
<                _ → " digits"
---
>                1 -> " digit"
236a236
>                _ -> " digits"
241c241
< nnUpTo ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → Int → μ α
---
> nnUpTo :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> Int -> μ α
244d243
<   where go 0 !r = optional (PC.satisfy $ isDigitIn s) >>= \case
245d243
<                     Just _  → moreThan n
246d243
<                     Nothing → return r
247d243
<         go l !r = optional digit >>= \case
248d243
<                     Just d  → go (l - 1) (r * radix + d)
249c244
<                     Nothing → return r
---
>   where go 0 !r = optional (PC.satisfy $ isDigitIn s) >>= 
249a245
>                     Just _  -> moreThan n
249a246
>                     Nothing -> return r
249a247
>         go l !r = optional digit >>= 
249a248
>                     Just d  -> go (l - 1) (r * radix + d)
249a249
>                     Nothing -> return r
252d251
< {-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int #-}
253d251
< {-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int8 #-}
254d251
< {-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int16 #-}
255d251
< {-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int32 #-}
256d251
< {-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int64 #-}
257d251
< {-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word #-}
258d251
< {-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word8 #-}
259d251
< {-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word16 #-}
260d251
< {-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word32 #-}
261d251
< {-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word64 #-}
262d251
< {-# SPECIALIZE nnUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Binary → Int → μ α #-}
263d251
< {-# SPECIALIZE nnUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Octal → Int → μ α #-}
264d251
< {-# SPECIALIZE nnUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Decimal → Int → μ α #-}
265d251
< {-# SPECIALIZE nnUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ α #-}
266d251
< {-# SPECIALIZE nnUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ LowHex → Int → μ α #-}
267c252
< {-# SPECIALIZE nnUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ UpHex → Int → μ α #-}
---
> {-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int #-}
267a253
> {-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int8 #-}
267a254
> {-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int16 #-}
267a255
> {-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int32 #-}
267a256
> {-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int64 #-}
267a257
> {-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word #-}
267a258
> {-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word8 #-}
267a259
> {-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word16 #-}
267a260
> {-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word32 #-}
267a261
> {-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word64 #-}
267a262
> {-# SPECIALIZE nnUpTo :: (Num α, Monad μ, CharParsing μ) => Binary -> Int -> μ α #-}
267a263
> {-# SPECIALIZE nnUpTo :: (Num α, Monad μ, CharParsing μ) => Octal -> Int -> μ α #-}
267a264
> {-# SPECIALIZE nnUpTo :: (Num α, Monad μ, CharParsing μ) => Decimal -> Int -> μ α #-}
267a265
> {-# SPECIALIZE nnUpTo :: (Num α, Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ α #-}
267a266
> {-# SPECIALIZE nnUpTo :: (Num α, Monad μ, CharParsing μ) => LowHex -> Int -> μ α #-}
267a267
> {-# SPECIALIZE nnUpTo :: (Num α, Monad μ, CharParsing μ) => UpHex -> Int -> μ α #-}
271c271
< nncUpTo ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → Int → μ α
---
> nncUpTo :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> Int -> μ α
273d272
< nncUpTo s n = (<?> systemName s ++ " digits") $ digitIn s >>= \case
274d272
<                 0 → optional (PC.satisfy $ isDigitIn s) >>= \case
275d272
<                       Just _  → PC.unexpected "leading zero"
276d272
<                       Nothing → return 0
277d272
<                 r → go (n - 1) $ fromIntegral (r ∷ Word)
278d272
<   where go 0 !r = optional (PC.satisfy $ isDigitIn s) >>= \case
279d272
<                     Just _  → moreThan n
280d272
<                     Nothing → return r
281d272
<         go l !r = optional digit >>= \case
282d272
<                     Just d  → go (l - 1) (r * radix + d)
283c273
<                     Nothing → return r
---
> nncUpTo s n = (<?> systemName s ++ " digits") $ digitIn s >>= 
283a274
>                 0 -> optional (PC.satisfy $ isDigitIn s) >>= 
283a275
>                       Just _  -> PC.unexpected "leading zero"
283a276
>                       Nothing -> return 0
283a277
>                 r -> go (n - 1) $ fromIntegral (r :: Word)
283a278
>   where go 0 !r = optional (PC.satisfy $ isDigitIn s) >>= 
283a279
>                     Just _  -> moreThan n
283a280
>                     Nothing -> return r
283a281
>         go l !r = optional digit >>= 
283a282
>                     Just d  -> go (l - 1) (r * radix + d)
283a283
>                     Nothing -> return r
286d285
< {-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int #-}
287d285
< {-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int8 #-}
288d285
< {-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int16 #-}
289d285
< {-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int32 #-}
290d285
< {-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int64 #-}
291d285
< {-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word #-}
292d285
< {-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word8 #-}
293d285
< {-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word16 #-}
294d285
< {-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word32 #-}
295d285
< {-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word64 #-}
296d285
< {-# SPECIALIZE nncUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Binary → Int → μ α #-}
297d285
< {-# SPECIALIZE nncUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Octal → Int → μ α #-}
298d285
< {-# SPECIALIZE nncUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Decimal → Int → μ α #-}
299d285
< {-# SPECIALIZE nncUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ α #-}
300d285
< {-# SPECIALIZE nncUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ LowHex → Int → μ α #-}
301c286
< {-# SPECIALIZE nncUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ UpHex → Int → μ α #-}
---
> {-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int #-}
301a287
> {-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int8 #-}
301a288
> {-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int16 #-}
301a289
> {-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int32 #-}
301a290
> {-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int64 #-}
301a291
> {-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word #-}
301a292
> {-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word8 #-}
301a293
> {-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word16 #-}
301a294
> {-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word32 #-}
301a295
> {-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word64 #-}
301a296
> {-# SPECIALIZE nncUpTo :: (Num α, Monad μ, CharParsing μ) => Binary -> Int -> μ α #-}
301a297
> {-# SPECIALIZE nncUpTo :: (Num α, Monad μ, CharParsing μ) => Octal -> Int -> μ α #-}
301a298
> {-# SPECIALIZE nncUpTo :: (Num α, Monad μ, CharParsing μ) => Decimal -> Int -> μ α #-}
301a299
> {-# SPECIALIZE nncUpTo :: (Num α, Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ α #-}
301a300
> {-# SPECIALIZE nncUpTo :: (Num α, Monad μ, CharParsing μ) => LowHex -> Int -> μ α #-}
301a301
> {-# SPECIALIZE nncUpTo :: (Num α, Monad μ, CharParsing μ) => UpHex -> Int -> μ α #-}
305d304
< nnBounded ∷ (PositionalSystem s, Ord α, Bounded α, Integral α,
306c305
<              Monad μ, CharParsing μ) ⇒ s → μ α
---
> nnBounded :: (PositionalSystem s, Ord α, Bounded α, Integral α,
306a306
>              Monad μ, CharParsing μ) => s -> μ α
309d308
<         go !n  = optional digit >>= \case
310c309
<                    Just n1 → if n < q || (n == q && n1 <= r)
---
>         go !n  = optional digit >>= 
310a310
>                    Just n1 -> if n < q || (n == q && n1 <= r)
313c313
<                    Nothing → return n
---
>                    Nothing -> return n
316d315
< {-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int #-}
317d315
< {-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int8 #-}
318d315
< {-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int16 #-}
319d315
< {-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int32 #-}
320d315
< {-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int64 #-}
321d315
< {-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word #-}
322d315
< {-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word8 #-}
323d315
< {-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word16 #-}
324d315
< {-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word32 #-}
325d315
< {-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word64 #-}
326d315
< {-# SPECIALIZE nnBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
327d315
< {-# SPECIALIZE nnBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
328d315
< {-# SPECIALIZE nnBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Decimal → μ α #-}
329d315
< {-# SPECIALIZE nnBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
330d315
< {-# SPECIALIZE nnBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
331c316
< {-# SPECIALIZE nnBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}
---
> {-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int #-}
331a317
> {-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int8 #-}
331a318
> {-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int16 #-}
331a319
> {-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int32 #-}
331a320
> {-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int64 #-}
331a321
> {-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word #-}
331a322
> {-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word8 #-}
331a323
> {-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word16 #-}
331a324
> {-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word32 #-}
331a325
> {-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word64 #-}
331a326
> {-# SPECIALIZE nnBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Binary -> μ α #-}
331a327
> {-# SPECIALIZE nnBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Octal -> μ α #-}
331a328
> {-# SPECIALIZE nnBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Decimal -> μ α #-}
331a329
> {-# SPECIALIZE nnBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
331a330
> {-# SPECIALIZE nnBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
331a331
> {-# SPECIALIZE nnBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => UpHex -> μ α #-}
335d334
< nncBounded ∷ (PositionalSystem s, Ord α, Bounded α, Integral α,
336d334
<               Monad μ, CharParsing μ) ⇒ s → μ α
337d334
< nncBounded s = (<?> systemName s ++ " digits") $ digit >>= \case
338d334
<                  0 → optional (PC.satisfy $ isDigitIn s) >>= \case
339d334
<                        Just _  → PC.unexpected "leading zero"
340d334
<                        Nothing → return 0
341c335
<                  n → go n
---
> nncBounded :: (PositionalSystem s, Ord α, Bounded α, Integral α,
341a336
>               Monad μ, CharParsing μ) => s -> μ α
341a337
> nncBounded s = (<?> systemName s ++ " digits") $ digit >>= 
341a338
>                  0 -> optional (PC.satisfy $ isDigitIn s) >>= 
341a339
>                        Just _  -> PC.unexpected "leading zero"
341a340
>                        Nothing -> return 0
341a341
>                  n -> go n
343d342
<         go !n  = optional digit >>= \case
344c343
<                    Just d  → if n < q || (n == q && d <= r)
---
>         go !n  = optional digit >>= 
344a344
>                    Just d  -> if n < q || (n == q && d <= r)
347c347
<                    Nothing → return n
---
>                    Nothing -> return n
350d349
< {-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int #-}
351d349
< {-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int8 #-}
352d349
< {-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int16 #-}
353d349
< {-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int32 #-}
354d349
< {-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int64 #-}
355d349
< {-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word #-}
356d349
< {-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word8 #-}
357d349
< {-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word16 #-}
358d349
< {-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word32 #-}
359d349
< {-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word64 #-}
360d349
< {-# SPECIALIZE nncBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
361d349
< {-# SPECIALIZE nncBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
362d349
< {-# SPECIALIZE nncBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Decimal → μ α #-}
363d349
< {-# SPECIALIZE nncBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
364d349
< {-# SPECIALIZE nncBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
365c350
< {-# SPECIALIZE nncBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}
---
> {-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int #-}
365a351
> {-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int8 #-}
365a352
> {-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int16 #-}
365a353
> {-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int32 #-}
365a354
> {-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int64 #-}
365a355
> {-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word #-}
365a356
> {-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word8 #-}
365a357
> {-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word16 #-}
365a358
> {-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word32 #-}
365a359
> {-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word64 #-}
365a360
> {-# SPECIALIZE nncBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Binary -> μ α #-}
365a361
> {-# SPECIALIZE nncBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Octal -> μ α #-}
365a362
> {-# SPECIALIZE nncBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Decimal -> μ α #-}
365a363
> {-# SPECIALIZE nncBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
365a364
> {-# SPECIALIZE nncBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
365a365
> {-# SPECIALIZE nncBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => UpHex -> μ α #-}
369c369
< nnBits ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) ⇒ s → μ α
---
> nnBits :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) => s -> μ α
371d370
<   where go !r     = optional digit >>= \case
372d370
<                       Just d  → go ((r `shiftL` digitBits) .|. d)
373c371
<                       Nothing → return r
---
>   where go !r     = optional digit >>= 
373a372
>                       Just d  -> go ((r `shiftL` digitBits) .|. d)
373a373
>                       Nothing -> return r
376d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int #-}
377d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int8 #-}
378d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int16 #-}
379d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int32 #-}
380d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int64 #-}
381d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word #-}
382d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word8 #-}
383d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word16 #-}
384d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word32 #-}
385d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word64 #-}
386d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int #-}
387d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int8 #-}
388d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int16 #-}
389d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int32 #-}
390d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int64 #-}
391d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word #-}
392d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word8 #-}
393d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word16 #-}
394d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word32 #-}
395d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word64 #-}
396d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int #-}
397d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int8 #-}
398d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int16 #-}
399d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int32 #-}
400d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int64 #-}
401d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word #-}
402d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word8 #-}
403d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word16 #-}
404d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word32 #-}
405d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word64 #-}
406d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int #-}
407d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int8 #-}
408d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int16 #-}
409d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int32 #-}
410d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int64 #-}
411d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word #-}
412d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word8 #-}
413d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word16 #-}
414d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word32 #-}
415d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word64 #-}
416d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int #-}
417d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int8 #-}
418d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int16 #-}
419d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int32 #-}
420d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int64 #-}
421d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word #-}
422d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word8 #-}
423d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word16 #-}
424d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word32 #-}
425d375
< {-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word64 #-}
426d375
< {-# SPECIALIZE nnBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
427d375
< {-# SPECIALIZE nnBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
428d375
< {-# SPECIALIZE nnBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
429d375
< {-# SPECIALIZE nnBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
430c376
< {-# SPECIALIZE nnBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}
---
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Int #-}
430a377
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Int8 #-}
430a378
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Int16 #-}
430a379
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Int32 #-}
430a380
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Int64 #-}
430a381
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Word #-}
430a382
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Word8 #-}
430a383
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Word16 #-}
430a384
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Word32 #-}
430a385
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Word64 #-}
430a386
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Int #-}
430a387
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Int8 #-}
430a388
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Int16 #-}
430a389
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Int32 #-}
430a390
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Int64 #-}
430a391
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Word #-}
430a392
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Word8 #-}
430a393
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Word16 #-}
430a394
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Word32 #-}
430a395
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Word64 #-}
430a396
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int #-}
430a397
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int8 #-}
430a398
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int16 #-}
430a399
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int32 #-}
430a400
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int64 #-}
430a401
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word #-}
430a402
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word8 #-}
430a403
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word16 #-}
430a404
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word32 #-}
430a405
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word64 #-}
430a406
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int #-}
430a407
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int8 #-}
430a408
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int16 #-}
430a409
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int32 #-}
430a410
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int64 #-}
430a411
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word #-}
430a412
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word8 #-}
430a413
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word16 #-}
430a414
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word32 #-}
430a415
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word64 #-}
430a416
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int #-}
430a417
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int8 #-}
430a418
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int16 #-}
430a419
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int32 #-}
430a420
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int64 #-}
430a421
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word #-}
430a422
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word8 #-}
430a423
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word16 #-}
430a424
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word32 #-}
430a425
> {-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word64 #-}
430a426
> {-# SPECIALIZE nnBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Binary -> μ α #-}
430a427
> {-# SPECIALIZE nnBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Octal -> μ α #-}
430a428
> {-# SPECIALIZE nnBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
430a429
> {-# SPECIALIZE nnBits :: (Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
430a430
> {-# SPECIALIZE nnBits :: (Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> μ α #-}
434d433
< nncBits ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) ⇒ s → μ α
435d433
< nncBits s = (<?> systemName s ++ " digits") $ digit >>= \case
436d433
<               0 → optional (PC.satisfy $ isDigitIn s) >>= \case
437d433
<                     Just _  → PC.unexpected "leading zero"
438d433
<                     Nothing → return 0
439d433
<               r → go r
440d433
<   where go !r     = optional digit >>= \case
441d433
<                       Just d  → go ((r `shiftL` digitBits) .|. d)
442c434
<                       Nothing → return r
---
> nncBits :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) => s -> μ α
442a435
> nncBits s = (<?> systemName s ++ " digits") $ digit >>= 
442a436
>               0 -> optional (PC.satisfy $ isDigitIn s) >>= 
442a437
>                     Just _  -> PC.unexpected "leading zero"
442a438
>                     Nothing -> return 0
442a439
>               r -> go r
442a440
>   where go !r     = optional digit >>= 
442a441
>                       Just d  -> go ((r `shiftL` digitBits) .|. d)
442a442
>                       Nothing -> return r
445d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int #-}
446d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int8 #-}
447d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int16 #-}
448d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int32 #-}
449d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int64 #-}
450d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word #-}
451d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word8 #-}
452d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word16 #-}
453d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word32 #-}
454d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word64 #-}
455d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int #-}
456d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int8 #-}
457d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int16 #-}
458d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int32 #-}
459d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int64 #-}
460d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word #-}
461d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word8 #-}
462d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word16 #-}
463d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word32 #-}
464d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word64 #-}
465d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int #-}
466d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int8 #-}
467d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int16 #-}
468d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int32 #-}
469d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int64 #-}
470d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word #-}
471d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word8 #-}
472d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word16 #-}
473d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word32 #-}
474d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word64 #-}
475d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int #-}
476d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int8 #-}
477d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int16 #-}
478d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int32 #-}
479d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int64 #-}
480d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word #-}
481d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word8 #-}
482d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word16 #-}
483d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word32 #-}
484d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word64 #-}
485d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int #-}
486d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int8 #-}
487d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int16 #-}
488d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int32 #-}
489d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int64 #-}
490d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word #-}
491d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word8 #-}
492d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word16 #-}
493d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word32 #-}
494d444
< {-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word64 #-}
495d444
< {-# SPECIALIZE nncBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
496d444
< {-# SPECIALIZE nncBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
497d444
< {-# SPECIALIZE nncBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
498d444
< {-# SPECIALIZE nncBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
499c445
< {-# SPECIALIZE nncBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}
---
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Int #-}
499a446
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Int8 #-}
499a447
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Int16 #-}
499a448
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Int32 #-}
499a449
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Int64 #-}
499a450
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Word #-}
499a451
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Word8 #-}
499a452
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Word16 #-}
499a453
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Word32 #-}
499a454
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Word64 #-}
499a455
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Int #-}
499a456
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Int8 #-}
499a457
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Int16 #-}
499a458
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Int32 #-}
499a459
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Int64 #-}
499a460
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Word #-}
499a461
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Word8 #-}
499a462
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Word16 #-}
499a463
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Word32 #-}
499a464
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Word64 #-}
499a465
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int #-}
499a466
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int8 #-}
499a467
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int16 #-}
499a468
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int32 #-}
499a469
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int64 #-}
499a470
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word #-}
499a471
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word8 #-}
499a472
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word16 #-}
499a473
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word32 #-}
499a474
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word64 #-}
499a475
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int #-}
499a476
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int8 #-}
499a477
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int16 #-}
499a478
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int32 #-}
499a479
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int64 #-}
499a480
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word #-}
499a481
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word8 #-}
499a482
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word16 #-}
499a483
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word32 #-}
499a484
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word64 #-}
499a485
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int #-}
499a486
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int8 #-}
499a487
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int16 #-}
499a488
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int32 #-}
499a489
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int64 #-}
499a490
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word #-}
499a491
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word8 #-}
499a492
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word16 #-}
499a493
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word32 #-}
499a494
> {-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word64 #-}
499a495
> {-# SPECIALIZE nncBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Binary -> μ α #-}
499a496
> {-# SPECIALIZE nncBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Octal -> μ α #-}
499a497
> {-# SPECIALIZE nncBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
499a498
> {-# SPECIALIZE nncBits :: (Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
499a499
> {-# SPECIALIZE nncBits :: (Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> μ α #-}
503d502
< nnBitsUpTo ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
504c503
<            ⇒ s → Int → μ α
---
> nnBitsUpTo :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
504a504
>            => s -> Int -> μ α
507d506
<   where go 0 !r   = optional (PC.satisfy $ isDigitIn s) >>= \case
508d506
<                       Just _  → moreThan n
509d506
<                       Nothing → return r
510d506
<         go l !r   = optional digit >>= \case
511d506
<                       Just d  → go (l - 1) ((r `shiftL` digitBits) .|. d)
512c507
<                       Nothing → return r
---
>   where go 0 !r   = optional (PC.satisfy $ isDigitIn s) >>= 
512a508
>                       Just _  -> moreThan n
512a509
>                       Nothing -> return r
512a510
>         go l !r   = optional digit >>= 
512a511
>                       Just d  -> go (l - 1) ((r `shiftL` digitBits) .|. d)
512a512
>                       Nothing -> return r
515d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int #-}
516d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int8 #-}
517d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int16 #-}
518d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int32 #-}
519d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int64 #-}
520d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word #-}
521d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word8 #-}
522d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word16 #-}
523d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word32 #-}
524d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word64 #-}
525d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int #-}
526d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int8 #-}
527d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int16 #-}
528d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int32 #-}
529d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int64 #-}
530d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word #-}
531d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word8 #-}
532d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word16 #-}
533d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word32 #-}
534d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word64 #-}
535d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int #-}
536d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int8 #-}
537d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int16 #-}
538d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int32 #-}
539d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int64 #-}
540d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word #-}
541d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word8 #-}
542d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word16 #-}
543d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word32 #-}
544d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word64 #-}
545d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int #-}
546d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int8 #-}
547d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int16 #-}
548d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int32 #-}
549d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int64 #-}
550d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word #-}
551d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word8 #-}
552d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word16 #-}
553d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word32 #-}
554d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word64 #-}
555d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int #-}
556d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int8 #-}
557d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int16 #-}
558d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int32 #-}
559d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int64 #-}
560d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word #-}
561d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word8 #-}
562d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word16 #-}
563d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word32 #-}
564d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word64 #-}
565d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → Int → μ α #-}
566d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → Int → μ α #-}
567d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ α #-}
568d514
< {-# SPECIALIZE nnBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → Int → μ α #-}
569c515
< {-# SPECIALIZE nnBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → Int → μ α #-}
---
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int #-}
569a516
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int8 #-}
569a517
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int16 #-}
569a518
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int32 #-}
569a519
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int64 #-}
569a520
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word #-}
569a521
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word8 #-}
569a522
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word16 #-}
569a523
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word32 #-}
569a524
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word64 #-}
569a525
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int #-}
569a526
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int8 #-}
569a527
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int16 #-}
569a528
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int32 #-}
569a529
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int64 #-}
569a530
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word #-}
569a531
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word8 #-}
569a532
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word16 #-}
569a533
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word32 #-}
569a534
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word64 #-}
569a535
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int #-}
569a536
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int8 #-}
569a537
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int16 #-}
569a538
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int32 #-}
569a539
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int64 #-}
569a540
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word #-}
569a541
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word8 #-}
569a542
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word16 #-}
569a543
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word32 #-}
569a544
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word64 #-}
569a545
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int #-}
569a546
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int8 #-}
569a547
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int16 #-}
569a548
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int32 #-}
569a549
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int64 #-}
569a550
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word #-}
569a551
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word8 #-}
569a552
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word16 #-}
569a553
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word32 #-}
569a554
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word64 #-}
569a555
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int #-}
569a556
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int8 #-}
569a557
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int16 #-}
569a558
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int32 #-}
569a559
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int64 #-}
569a560
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word #-}
569a561
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word8 #-}
569a562
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word16 #-}
569a563
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word32 #-}
569a564
> {-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word64 #-}
569a565
> {-# SPECIALIZE nnBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Binary -> Int -> μ α #-}
569a566
> {-# SPECIALIZE nnBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Octal -> Int -> μ α #-}
569a567
> {-# SPECIALIZE nnBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ α #-}
569a568
> {-# SPECIALIZE nnBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> Int -> μ α #-}
569a569
> {-# SPECIALIZE nnBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> Int -> μ α #-}
574d573
< nncBitsUpTo ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
575c574
<             ⇒ s → Int → μ α
---
> nncBitsUpTo :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
575a575
>             => s -> Int -> μ α
577d576
< nncBitsUpTo s n = (<?> systemName s ++ " digits") $ digitIn s >>= \case
578d576
<                     0 → optional (PC.satisfy $ isDigitIn s) >>= \case
579d576
<                           Just _  → PC.unexpected "leading zero"
580d576
<                           Nothing → return 0
581d576
<                     r → go (n - 1) $ fromIntegral (r ∷ Word)
582d576
<   where go 0 !r   = optional (PC.satisfy $ isDigitIn s) >>= \case
583d576
<                       Just _  → moreThan n
584d576
<                       Nothing → return r
585d576
<         go l !r   = optional digit >>= \case
586d576
<                       Just d  → go (l - 1) ((r `shiftL` digitBits) .|. d)
587c577
<                       Nothing → return r
---
> nncBitsUpTo s n = (<?> systemName s ++ " digits") $ digitIn s >>= 
587a578
>                     0 -> optional (PC.satisfy $ isDigitIn s) >>= 
587a579
>                           Just _  -> PC.unexpected "leading zero"
587a580
>                           Nothing -> return 0
587a581
>                     r -> go (n - 1) $ fromIntegral (r :: Word)
587a582
>   where go 0 !r   = optional (PC.satisfy $ isDigitIn s) >>= 
587a583
>                       Just _  -> moreThan n
587a584
>                       Nothing -> return r
587a585
>         go l !r   = optional digit >>= 
587a586
>                       Just d  -> go (l - 1) ((r `shiftL` digitBits) .|. d)
587a587
>                       Nothing -> return r
590d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int #-}
591d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int8 #-}
592d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int16 #-}
593d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int32 #-}
594d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int64 #-}
595d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word #-}
596d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word8 #-}
597d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word16 #-}
598d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word32 #-}
599d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word64 #-}
600d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int #-}
601d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int8 #-}
602d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int16 #-}
603d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int32 #-}
604d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int64 #-}
605d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word #-}
606d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word8 #-}
607d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word16 #-}
608d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word32 #-}
609d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word64 #-}
610d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int #-}
611d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int8 #-}
612d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int16 #-}
613d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int32 #-}
614d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int64 #-}
615d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word #-}
616d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word8 #-}
617d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word16 #-}
618d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word32 #-}
619d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word64 #-}
620d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int #-}
621d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int8 #-}
622d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int16 #-}
623d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int32 #-}
624d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int64 #-}
625d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word #-}
626d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word8 #-}
627d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word16 #-}
628d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word32 #-}
629d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word64 #-}
630d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int #-}
631d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int8 #-}
632d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int16 #-}
633d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int32 #-}
634d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int64 #-}
635d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word #-}
636d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word8 #-}
637d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word16 #-}
638d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word32 #-}
639d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word64 #-}
640d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → Int → μ α #-}
641d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → Int → μ α #-}
642d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ α #-}
643d589
< {-# SPECIALIZE nncBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → Int → μ α #-}
644c590
< {-# SPECIALIZE nncBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → Int → μ α #-}
---
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int #-}
644a591
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int8 #-}
644a592
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int16 #-}
644a593
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int32 #-}
644a594
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int64 #-}
644a595
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word #-}
644a596
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word8 #-}
644a597
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word16 #-}
644a598
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word32 #-}
644a599
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word64 #-}
644a600
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int #-}
644a601
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int8 #-}
644a602
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int16 #-}
644a603
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int32 #-}
644a604
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int64 #-}
644a605
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word #-}
644a606
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word8 #-}
644a607
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word16 #-}
644a608
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word32 #-}
644a609
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word64 #-}
644a610
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int #-}
644a611
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int8 #-}
644a612
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int16 #-}
644a613
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int32 #-}
644a614
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int64 #-}
644a615
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word #-}
644a616
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word8 #-}
644a617
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word16 #-}
644a618
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word32 #-}
644a619
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word64 #-}
644a620
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int #-}
644a621
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int8 #-}
644a622
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int16 #-}
644a623
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int32 #-}
644a624
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int64 #-}
644a625
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word #-}
644a626
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word8 #-}
644a627
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word16 #-}
644a628
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word32 #-}
644a629
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word64 #-}
644a630
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int #-}
644a631
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int8 #-}
644a632
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int16 #-}
644a633
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int32 #-}
644a634
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int64 #-}
644a635
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word #-}
644a636
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word8 #-}
644a637
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word16 #-}
644a638
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word32 #-}
644a639
> {-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word64 #-}
644a640
> {-# SPECIALIZE nncBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Binary -> Int -> μ α #-}
644a641
> {-# SPECIALIZE nncBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Octal -> Int -> μ α #-}
644a642
> {-# SPECIALIZE nncBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ α #-}
644a643
> {-# SPECIALIZE nncBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> Int -> μ α #-}
644a644
> {-# SPECIALIZE nncBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> Int -> μ α #-}
648c648
< nnbBits ∷ (BitSystem s, Ord α, Bounded α, Num α, Bits α,
---
> nnbBits :: (BitSystem s, Ord α, Bounded α, Num α, Bits α,
650c650
<         ⇒ s → μ α
---
>         => s -> μ α
654d653
<         go !n = optional digit >>= \case
655c654
<                   Just d  → if n < q || (n == q && d <= r)
---
>         go !n = optional digit >>= 
655a655
>                   Just d  -> if n < q || (n == q && d <= r)
658c658
<                   Nothing → return n
---
>                   Nothing -> return n
661d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int #-}
662d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int8 #-}
663d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int16 #-}
664d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int32 #-}
665d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int64 #-}
666d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word #-}
667d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word8 #-}
668d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word16 #-}
669d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word32 #-}
670d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word64 #-}
671d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int #-}
672d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int8 #-}
673d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int16 #-}
674d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int32 #-}
675d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int64 #-}
676d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word #-}
677d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word8 #-}
678d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word16 #-}
679d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word32 #-}
680d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word64 #-}
681d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int #-}
682d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int8 #-}
683d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int16 #-}
684d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int32 #-}
685d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int64 #-}
686d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word #-}
687d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word8 #-}
688d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word16 #-}
689d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word32 #-}
690d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word64 #-}
691d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int #-}
692d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int8 #-}
693d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int16 #-}
694d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int32 #-}
695d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int64 #-}
696d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word #-}
697d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word8 #-}
698d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word16 #-}
699d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word32 #-}
700d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word64 #-}
701d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int #-}
702d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int8 #-}
703d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int16 #-}
704d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int32 #-}
705d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int64 #-}
706d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word #-}
707d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word8 #-}
708d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word16 #-}
709d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word32 #-}
710d660
< {-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word64 #-}
711d660
< {-# SPECIALIZE nnbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
712d660
< {-# SPECIALIZE nnbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
713d660
< {-# SPECIALIZE nnbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
714d660
< {-# SPECIALIZE nnbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
715c661
< {-# SPECIALIZE nnbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}
---
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int #-}
715a662
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int8 #-}
715a663
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int16 #-}
715a664
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int32 #-}
715a665
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int64 #-}
715a666
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word #-}
715a667
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word8 #-}
715a668
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word16 #-}
715a669
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word32 #-}
715a670
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word64 #-}
715a671
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int #-}
715a672
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int8 #-}
715a673
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int16 #-}
715a674
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int32 #-}
715a675
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int64 #-}
715a676
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word #-}
715a677
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word8 #-}
715a678
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word16 #-}
715a679
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word32 #-}
715a680
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word64 #-}
715a681
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int #-}
715a682
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int8 #-}
715a683
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int16 #-}
715a684
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int32 #-}
715a685
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int64 #-}
715a686
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word #-}
715a687
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word8 #-}
715a688
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word16 #-}
715a689
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word32 #-}
715a690
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word64 #-}
715a691
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int #-}
715a692
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int8 #-}
715a693
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int16 #-}
715a694
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int32 #-}
715a695
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int64 #-}
715a696
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word #-}
715a697
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word8 #-}
715a698
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word16 #-}
715a699
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word32 #-}
715a700
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word64 #-}
715a701
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int #-}
715a702
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int8 #-}
715a703
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int16 #-}
715a704
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int32 #-}
715a705
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int64 #-}
715a706
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word #-}
715a707
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word8 #-}
715a708
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word16 #-}
715a709
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word32 #-}
715a710
> {-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word64 #-}
715a711
> {-# SPECIALIZE nnbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Binary -> μ α #-}
715a712
> {-# SPECIALIZE nnbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Octal -> μ α #-}
715a713
> {-# SPECIALIZE nnbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
715a714
> {-# SPECIALIZE nnbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
715a715
> {-# SPECIALIZE nnbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> μ α #-}
720c720
< nncbBits ∷ (BitSystem s, Ord α, Bounded α, Num α, Bits α,
---
> nncbBits :: (BitSystem s, Ord α, Bounded α, Num α, Bits α,
722d721
<          ⇒ s → μ α
723d721
< nncbBits s = (<?> systemName s ++ " digits") $ digitIn s >>= \case
724d721
<                0 → optional (PC.satisfy $ isDigitIn s) >>= \case
725d721
<                      Just _  → PC.unexpected "leading zero"
726d721
<                      Nothing → return 0
727c722
<                n → go $ fromIntegral (n ∷ Word)
---
>          => s -> μ α
727a723
> nncbBits s = (<?> systemName s ++ " digits") $ digitIn s >>= 
727a724
>                0 -> optional (PC.satisfy $ isDigitIn s) >>= 
727a725
>                      Just _  -> PC.unexpected "leading zero"
727a726
>                      Nothing -> return 0
727a727
>                n -> go $ fromIntegral (n :: Word)
730d729
<         go !n = optional digit >>= \case
731c730
<                   Just d  → if n < q || (n == q && d <= r)
---
>         go !n = optional digit >>= 
731a731
>                   Just d  -> if n < q || (n == q && d <= r)
734c734
<                   Nothing → return n
---
>                   Nothing -> return n
737d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int #-}
738d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int8 #-}
739d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int16 #-}
740d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int32 #-}
741d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int64 #-}
742d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word #-}
743d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word8 #-}
744d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word16 #-}
745d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word32 #-}
746d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word64 #-}
747d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int #-}
748d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int8 #-}
749d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int16 #-}
750d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int32 #-}
751d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int64 #-}
752d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word #-}
753d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word8 #-}
754d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word16 #-}
755d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word32 #-}
756d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word64 #-}
757d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int #-}
758d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int8 #-}
759d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int16 #-}
760d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int32 #-}
761d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int64 #-}
762d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word #-}
763d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word8 #-}
764d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word16 #-}
765d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word32 #-}
766d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word64 #-}
767d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int #-}
768d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int8 #-}
769d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int16 #-}
770d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int32 #-}
771d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int64 #-}
772d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word #-}
773d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word8 #-}
774d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word16 #-}
775d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word32 #-}
776d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word64 #-}
777d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int #-}
778d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int8 #-}
779d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int16 #-}
780d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int32 #-}
781d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int64 #-}
782d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word #-}
783d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word8 #-}
784d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word16 #-}
785d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word32 #-}
786d736
< {-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word64 #-}
787d736
< {-# SPECIALIZE nncbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
788d736
< {-# SPECIALIZE nncbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
789d736
< {-# SPECIALIZE nncbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
790d736
< {-# SPECIALIZE nncbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
791c737
< {-# SPECIALIZE nncbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}
---
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int #-}
791a738
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int8 #-}
791a739
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int16 #-}
791a740
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int32 #-}
791a741
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int64 #-}
791a742
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word #-}
791a743
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word8 #-}
791a744
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word16 #-}
791a745
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word32 #-}
791a746
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word64 #-}
791a747
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int #-}
791a748
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int8 #-}
791a749
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int16 #-}
791a750
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int32 #-}
791a751
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int64 #-}
791a752
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word #-}
791a753
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word8 #-}
791a754
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word16 #-}
791a755
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word32 #-}
791a756
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word64 #-}
791a757
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int #-}
791a758
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int8 #-}
791a759
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int16 #-}
791a760
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int32 #-}
791a761
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int64 #-}
791a762
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word #-}
791a763
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word8 #-}
791a764
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word16 #-}
791a765
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word32 #-}
791a766
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word64 #-}
791a767
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int #-}
791a768
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int8 #-}
791a769
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int16 #-}
791a770
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int32 #-}
791a771
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int64 #-}
791a772
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word #-}
791a773
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word8 #-}
791a774
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word16 #-}
791a775
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word32 #-}
791a776
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word64 #-}
791a777
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int #-}
791a778
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int8 #-}
791a779
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int16 #-}
791a780
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int32 #-}
791a781
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int64 #-}
791a782
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word #-}
791a783
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word8 #-}
791a784
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word16 #-}
791a785
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word32 #-}
791a786
> {-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word64 #-}
791a787
> {-# SPECIALIZE nncbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Binary -> μ α #-}
791a788
> {-# SPECIALIZE nncbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Octal -> μ α #-}
791a789
> {-# SPECIALIZE nncbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
791a790
> {-# SPECIALIZE nncbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
791a791
> {-# SPECIALIZE nncbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> μ α #-}
796c796
< nonPositive ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → μ α
---
> nonPositive :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> μ α
798d797
<                   r ← digitIn s
799d797
<                   go $ fromIntegral $ negate (r ∷ Int)
800d797
<   where go !r = optional digit >>= \case
801d797
<                   Just d  → go (r * radix - d)
802c798
<                   Nothing → return r
---
>                   r <- digitIn s
802a799
>                   go $ fromIntegral $ negate (r :: Int)
802a800
>   where go !r = optional digit >>= 
802a801
>                   Just d  -> go (r * radix - d)
802a802
>                   Nothing -> return r
805d804
< {-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int #-}
806d804
< {-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int8 #-}
807d804
< {-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int16 #-}
808d804
< {-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int32 #-}
809d804
< {-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int64 #-}
810d804
< {-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word #-}
811d804
< {-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word8 #-}
812d804
< {-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word16 #-}
813d804
< {-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word32 #-}
814d804
< {-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word64 #-}
815d804
< {-# SPECIALIZE nonPositive ∷ (Num α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
816d804
< {-# SPECIALIZE nonPositive ∷ (Num α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
817d804
< {-# SPECIALIZE nonPositive ∷ (Num α, Monad μ, CharParsing μ) ⇒ Decimal → μ α #-}
818d804
< {-# SPECIALIZE nonPositive ∷ (Num α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
819d804
< {-# SPECIALIZE nonPositive ∷ (Num α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
820c805
< {-# SPECIALIZE nonPositive ∷ (Num α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}
---
> {-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Int #-}
820a806
> {-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Int8 #-}
820a807
> {-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Int16 #-}
820a808
> {-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Int32 #-}
820a809
> {-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Int64 #-}
820a810
> {-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Word #-}
820a811
> {-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Word8 #-}
820a812
> {-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Word16 #-}
820a813
> {-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Word32 #-}
820a814
> {-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Word64 #-}
820a815
> {-# SPECIALIZE nonPositive :: (Num α, Monad μ, CharParsing μ) => Binary -> μ α #-}
820a816
> {-# SPECIALIZE nonPositive :: (Num α, Monad μ, CharParsing μ) => Octal -> μ α #-}
820a817
> {-# SPECIALIZE nonPositive :: (Num α, Monad μ, CharParsing μ) => Decimal -> μ α #-}
820a818
> {-# SPECIALIZE nonPositive :: (Num α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
820a819
> {-# SPECIALIZE nonPositive :: (Num α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
820a820
> {-# SPECIALIZE nonPositive :: (Num α, Monad μ, CharParsing μ) => UpHex -> μ α #-}
824d823
< npCompact ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → μ α
825d823
< npCompact s = (<?> systemName s ++ " digits") $ digitIn s >>= \case
826d823
<                 0 → optional (PC.satisfy $ isDigitIn s) >>= \case
827d823
<                       Just _  → PC.unexpected "leading zero"
828d823
<                       Nothing → return 0
829d823
<                 r → go $ fromIntegral $ negate (r ∷ Int)
830d823
<   where go !r = optional digit >>= \case
831d823
<                   Just d  → go (r * radix - d)
832c824
<                   Nothing → return r
---
> npCompact :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> μ α
832a825
> npCompact s = (<?> systemName s ++ " digits") $ digitIn s >>= 
832a826
>                 0 -> optional (PC.satisfy $ isDigitIn s) >>= 
832a827
>                       Just _  -> PC.unexpected "leading zero"
832a828
>                       Nothing -> return 0
832a829
>                 r -> go $ fromIntegral $ negate (r :: Int)
832a830
>   where go !r = optional digit >>= 
832a831
>                   Just d  -> go (r * radix - d)
832a832
>                   Nothing -> return r
835d834
< {-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int #-}
836d834
< {-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int8 #-}
837d834
< {-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int16 #-}
838d834
< {-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int32 #-}
839d834
< {-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int64 #-}
840d834
< {-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word #-}
841d834
< {-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word8 #-}
842d834
< {-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word16 #-}
843d834
< {-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word32 #-}
844d834
< {-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word64 #-}
845d834
< {-# SPECIALIZE npCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
846d834
< {-# SPECIALIZE npCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
847d834
< {-# SPECIALIZE npCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ Decimal → μ α #-}
848d834
< {-# SPECIALIZE npCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
849d834
< {-# SPECIALIZE npCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
850c835
< {-# SPECIALIZE npCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}
---
> {-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int #-}
850a836
> {-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int8 #-}
850a837
> {-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int16 #-}
850a838
> {-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int32 #-}
850a839
> {-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int64 #-}
850a840
> {-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word #-}
850a841
> {-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word8 #-}
850a842
> {-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word16 #-}
850a843
> {-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word32 #-}
850a844
> {-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word64 #-}
850a845
> {-# SPECIALIZE npCompact :: (Num α, Monad μ, CharParsing μ) => Binary -> μ α #-}
850a846
> {-# SPECIALIZE npCompact :: (Num α, Monad μ, CharParsing μ) => Octal -> μ α #-}
850a847
> {-# SPECIALIZE npCompact :: (Num α, Monad μ, CharParsing μ) => Decimal -> μ α #-}
850a848
> {-# SPECIALIZE npCompact :: (Num α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
850a849
> {-# SPECIALIZE npCompact :: (Num α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
850a850
> {-# SPECIALIZE npCompact :: (Num α, Monad μ, CharParsing μ) => UpHex -> μ α #-}
854c854
< npUpTo ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → Int → μ α
---
> npUpTo :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> Int -> μ α
857d856
<                r ← digitIn s
858d856
<                go (n - 1) $ fromIntegral $ negate (r ∷ Int)
859d856
<   where go 0 !r = optional (PC.satisfy $ isDigitIn s) >>= \case
860d856
<                     Just _  → moreThan n
861d856
<                     Nothing → return r
862d856
<         go l !r = optional digit >>= \case
863d856
<                     Just d  → go (l - 1) (r * radix - d)
864c857
<                     Nothing → return r
---
>                r <- digitIn s
864a858
>                go (n - 1) $ fromIntegral $ negate (r :: Int)
864a859
>   where go 0 !r = optional (PC.satisfy $ isDigitIn s) >>= 
864a860
>                     Just _  -> moreThan n
864a861
>                     Nothing -> return r
864a862
>         go l !r = optional digit >>= 
864a863
>                     Just d  -> go (l - 1) (r * radix - d)
864a864
>                     Nothing -> return r
867d866
< {-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int #-}
868d866
< {-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int8 #-}
869d866
< {-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int16 #-}
870d866
< {-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int32 #-}
871d866
< {-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int64 #-}
872d866
< {-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word #-}
873d866
< {-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word8 #-}
874d866
< {-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word16 #-}
875d866
< {-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word32 #-}
876d866
< {-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word64 #-}
877d866
< {-# SPECIALIZE npUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Binary → Int → μ α #-}
878d866
< {-# SPECIALIZE npUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Octal → Int → μ α #-}
879d866
< {-# SPECIALIZE npUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Decimal → Int → μ α #-}
880d866
< {-# SPECIALIZE npUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ α #-}
881d866
< {-# SPECIALIZE npUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ LowHex → Int → μ α #-}
882c867
< {-# SPECIALIZE npUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ UpHex → Int → μ α #-}
---
> {-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int #-}
882a868
> {-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int8 #-}
882a869
> {-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int16 #-}
882a870
> {-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int32 #-}
882a871
> {-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int64 #-}
882a872
> {-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word #-}
882a873
> {-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word8 #-}
882a874
> {-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word16 #-}
882a875
> {-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word32 #-}
882a876
> {-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word64 #-}
882a877
> {-# SPECIALIZE npUpTo :: (Num α, Monad μ, CharParsing μ) => Binary -> Int -> μ α #-}
882a878
> {-# SPECIALIZE npUpTo :: (Num α, Monad μ, CharParsing μ) => Octal -> Int -> μ α #-}
882a879
> {-# SPECIALIZE npUpTo :: (Num α, Monad μ, CharParsing μ) => Decimal -> Int -> μ α #-}
882a880
> {-# SPECIALIZE npUpTo :: (Num α, Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ α #-}
882a881
> {-# SPECIALIZE npUpTo :: (Num α, Monad μ, CharParsing μ) => LowHex -> Int -> μ α #-}
882a882
> {-# SPECIALIZE npUpTo :: (Num α, Monad μ, CharParsing μ) => UpHex -> Int -> μ α #-}
886c886
< npcUpTo ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → Int → μ α
---
> npcUpTo :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> Int -> μ α
888d887
< npcUpTo s n = (<?> systemName s ++ " digits") $ digitIn s >>= \case
889d887
<                 0 → optional (PC.satisfy $ isDigitIn s) >>= \case
890d887
<                       Just _  → PC.unexpected "leading zero"
891d887
<                       Nothing → return 0
892d887
<                 r → go (n - 1) $ fromIntegral $ negate (r ∷ Int)
893d887
<   where go 0 !r = optional (PC.satisfy $ isDigitIn s) >>= \case
894d887
<                     Just _  → moreThan n
895d887
<                     Nothing → return r
896d887
<         go l !r = optional digit >>= \case
897d887
<                     Just d  → go (l - 1) (r * radix - d)
898c888
<                     Nothing → return r
---
> npcUpTo s n = (<?> systemName s ++ " digits") $ digitIn s >>= 
898a889
>                 0 -> optional (PC.satisfy $ isDigitIn s) >>= 
898a890
>                       Just _  -> PC.unexpected "leading zero"
898a891
>                       Nothing -> return 0
898a892
>                 r -> go (n - 1) $ fromIntegral $ negate (r :: Int)
898a893
>   where go 0 !r = optional (PC.satisfy $ isDigitIn s) >>= 
898a894
>                     Just _  -> moreThan n
898a895
>                     Nothing -> return r
898a896
>         go l !r = optional digit >>= 
898a897
>                     Just d  -> go (l - 1) (r * radix - d)
898a898
>                     Nothing -> return r
901d900
< {-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int #-}
902d900
< {-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int8 #-}
903d900
< {-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int16 #-}
904d900
< {-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int32 #-}
905d900
< {-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int64 #-}
906d900
< {-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word #-}
907d900
< {-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word8 #-}
908d900
< {-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word16 #-}
909d900
< {-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word32 #-}
910d900
< {-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word64 #-}
911d900
< {-# SPECIALIZE npcUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Binary → Int → μ α #-}
912d900
< {-# SPECIALIZE npcUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Octal → Int → μ α #-}
913d900
< {-# SPECIALIZE npcUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Decimal → Int → μ α #-}
914d900
< {-# SPECIALIZE npcUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ α #-}
915d900
< {-# SPECIALIZE npcUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ LowHex → Int → μ α #-}
916c901
< {-# SPECIALIZE npcUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ UpHex → Int → μ α #-}
---
> {-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int #-}
916a902
> {-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int8 #-}
916a903
> {-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int16 #-}
916a904
> {-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int32 #-}
916a905
> {-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int64 #-}
916a906
> {-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word #-}
916a907
> {-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word8 #-}
916a908
> {-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word16 #-}
916a909
> {-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word32 #-}
916a910
> {-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word64 #-}
916a911
> {-# SPECIALIZE npcUpTo :: (Num α, Monad μ, CharParsing μ) => Binary -> Int -> μ α #-}
916a912
> {-# SPECIALIZE npcUpTo :: (Num α, Monad μ, CharParsing μ) => Octal -> Int -> μ α #-}
916a913
> {-# SPECIALIZE npcUpTo :: (Num α, Monad μ, CharParsing μ) => Decimal -> Int -> μ α #-}
916a914
> {-# SPECIALIZE npcUpTo :: (Num α, Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ α #-}
916a915
> {-# SPECIALIZE npcUpTo :: (Num α, Monad μ, CharParsing μ) => LowHex -> Int -> μ α #-}
916a916
> {-# SPECIALIZE npcUpTo :: (Num α, Monad μ, CharParsing μ) => UpHex -> Int -> μ α #-}
920c920
< npBounded ∷ (PositionalSystem s, Ord α, Bounded α, Integral α,
---
> npBounded :: (PositionalSystem s, Ord α, Bounded α, Integral α,
922c922
<           ⇒ s → μ α
---
>           => s -> μ α
924d923
<                 n ← digitIn s
925c924
<                 go $ fromIntegral $ negate (n ∷ Int)
---
>                 n <- digitIn s
925a925
>                 go $ fromIntegral $ negate (n :: Int)
928d927
<         go !n   = optional digit >>= \case
929c928
<                     Just d  → if n > q || (n == q && d <= r)
---
>         go !n   = optional digit >>= 
929a929
>                     Just d  -> if n > q || (n == q && d <= r)
932c932
<                     Nothing → return n
---
>                     Nothing -> return n
935d934
< {-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int #-}
936d934
< {-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int8 #-}
937d934
< {-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int16 #-}
938d934
< {-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int32 #-}
939d934
< {-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int64 #-}
940d934
< {-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word #-}
941d934
< {-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word8 #-}
942d934
< {-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word16 #-}
943d934
< {-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word32 #-}
944d934
< {-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word64 #-}
945d934
< {-# SPECIALIZE npBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
946d934
< {-# SPECIALIZE npBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
947d934
< {-# SPECIALIZE npBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Decimal → μ α #-}
948d934
< {-# SPECIALIZE npBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
949d934
< {-# SPECIALIZE npBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
950c935
< {-# SPECIALIZE npBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}
---
> {-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int #-}
950a936
> {-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int8 #-}
950a937
> {-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int16 #-}
950a938
> {-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int32 #-}
950a939
> {-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int64 #-}
950a940
> {-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word #-}
950a941
> {-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word8 #-}
950a942
> {-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word16 #-}
950a943
> {-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word32 #-}
950a944
> {-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word64 #-}
950a945
> {-# SPECIALIZE npBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Binary -> μ α #-}
950a946
> {-# SPECIALIZE npBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Octal -> μ α #-}
950a947
> {-# SPECIALIZE npBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Decimal -> μ α #-}
950a948
> {-# SPECIALIZE npBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
950a949
> {-# SPECIALIZE npBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
950a950
> {-# SPECIALIZE npBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => UpHex -> μ α #-}
954c954
< npcBounded ∷ (PositionalSystem s, Ord α, Bounded α, Integral α,
---
> npcBounded :: (PositionalSystem s, Ord α, Bounded α, Integral α,
956d955
<            ⇒ s → μ α
957d955
< npcBounded s = (<?> systemName s ++ " digits") $ digitIn s >>= \case
958d955
<                  0 → optional (PC.satisfy $ isDigitIn s) >>= \case
959d955
<                        Just _  → PC.unexpected "leading zero"
960d955
<                        Nothing → return 0
961c956
<                  n → go $ fromIntegral $ negate (n ∷ Int)
---
>            => s -> μ α
961a957
> npcBounded s = (<?> systemName s ++ " digits") $ digitIn s >>= 
961a958
>                  0 -> optional (PC.satisfy $ isDigitIn s) >>= 
961a959
>                        Just _  -> PC.unexpected "leading zero"
961a960
>                        Nothing -> return 0
961a961
>                  n -> go $ fromIntegral $ negate (n :: Int)
964d963
<         go !n   = optional digit >>= \case
965c964
<                     Just d  → if n > q || (n == q && d <= r)
---
>         go !n   = optional digit >>= 
965a965
>                     Just d  -> if n > q || (n == q && d <= r)
968c968
<                     Nothing → return n
---
>                     Nothing -> return n
971d970
< {-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int #-}
972d970
< {-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int8 #-}
973d970
< {-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int16 #-}
974d970
< {-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int32 #-}
975d970
< {-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int64 #-}
976d970
< {-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word #-}
977d970
< {-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word8 #-}
978d970
< {-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word16 #-}
979d970
< {-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word32 #-}
980d970
< {-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word64 #-}
981d970
< {-# SPECIALIZE npcBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
982d970
< {-# SPECIALIZE npcBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
983d970
< {-# SPECIALIZE npcBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Decimal → μ α #-}
984d970
< {-# SPECIALIZE npcBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
985d970
< {-# SPECIALIZE npcBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
986c971
< {-# SPECIALIZE npcBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}
---
> {-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int #-}
986a972
> {-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int8 #-}
986a973
> {-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int16 #-}
986a974
> {-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int32 #-}
986a975
> {-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int64 #-}
986a976
> {-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word #-}
986a977
> {-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word8 #-}
986a978
> {-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word16 #-}
986a979
> {-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word32 #-}
986a980
> {-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word64 #-}
986a981
> {-# SPECIALIZE npcBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Binary -> μ α #-}
986a982
> {-# SPECIALIZE npcBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Octal -> μ α #-}
986a983
> {-# SPECIALIZE npcBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Decimal -> μ α #-}
986a984
> {-# SPECIALIZE npcBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
986a985
> {-# SPECIALIZE npcBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
986a986
> {-# SPECIALIZE npcBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => UpHex -> μ α #-}
990c990
< npBits ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) ⇒ s → μ α
---
> npBits :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) => s -> μ α
992d991
<              r ← digit
993d991
<              go $ fromIntegral $ negate (r ∷ Int)
994d991
<   where go !r     = optional digit >>= \case
995c992
<                       Just d1 → go ((r `shiftL` digitBits) + d)
---
>              r <- digit
995a993
>              go $ fromIntegral $ negate (r :: Int)
995a994
>   where go !r     = optional digit >>= 
995a995
>                       Just d1 -> go ((r `shiftL` digitBits) + d)
997c997
<                       Nothing → return r
---
>                       Nothing -> return r
1000d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int #-}
1001d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int8 #-}
1002d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int16 #-}
1003d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int32 #-}
1004d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int64 #-}
1005d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word #-}
1006d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word8 #-}
1007d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word16 #-}
1008d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word32 #-}
1009d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word64 #-}
1010d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int #-}
1011d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int8 #-}
1012d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int16 #-}
1013d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int32 #-}
1014d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int64 #-}
1015d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word #-}
1016d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word8 #-}
1017d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word16 #-}
1018d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word32 #-}
1019d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word64 #-}
1020d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int #-}
1021d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int8 #-}
1022d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int16 #-}
1023d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int32 #-}
1024d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int64 #-}
1025d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word #-}
1026d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word8 #-}
1027d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word16 #-}
1028d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word32 #-}
1029d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word64 #-}
1030d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int #-}
1031d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int8 #-}
1032d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int16 #-}
1033d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int32 #-}
1034d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int64 #-}
1035d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word #-}
1036d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word8 #-}
1037d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word16 #-}
1038d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word32 #-}
1039d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word64 #-}
1040d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int #-}
1041d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int8 #-}
1042d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int16 #-}
1043d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int32 #-}
1044d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int64 #-}
1045d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word #-}
1046d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word8 #-}
1047d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word16 #-}
1048d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word32 #-}
1049d999
< {-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word64 #-}
1050d999
< {-# SPECIALIZE npBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
1051d999
< {-# SPECIALIZE npBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
1052d999
< {-# SPECIALIZE npBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
1053d999
< {-# SPECIALIZE npBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
1054c1000
< {-# SPECIALIZE npBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}
---
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Int #-}
1054a1001
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Int8 #-}
1054a1002
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Int16 #-}
1054a1003
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Int32 #-}
1054a1004
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Int64 #-}
1054a1005
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Word #-}
1054a1006
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Word8 #-}
1054a1007
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Word16 #-}
1054a1008
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Word32 #-}
1054a1009
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Word64 #-}
1054a1010
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Int #-}
1054a1011
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Int8 #-}
1054a1012
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Int16 #-}
1054a1013
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Int32 #-}
1054a1014
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Int64 #-}
1054a1015
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Word #-}
1054a1016
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Word8 #-}
1054a1017
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Word16 #-}
1054a1018
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Word32 #-}
1054a1019
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Word64 #-}
1054a1020
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int #-}
1054a1021
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int8 #-}
1054a1022
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int16 #-}
1054a1023
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int32 #-}
1054a1024
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int64 #-}
1054a1025
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word #-}
1054a1026
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word8 #-}
1054a1027
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word16 #-}
1054a1028
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word32 #-}
1054a1029
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word64 #-}
1054a1030
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int #-}
1054a1031
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int8 #-}
1054a1032
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int16 #-}
1054a1033
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int32 #-}
1054a1034
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int64 #-}
1054a1035
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word #-}
1054a1036
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word8 #-}
1054a1037
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word16 #-}
1054a1038
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word32 #-}
1054a1039
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word64 #-}
1054a1040
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int #-}
1054a1041
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int8 #-}
1054a1042
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int16 #-}
1054a1043
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int32 #-}
1054a1044
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int64 #-}
1054a1045
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word #-}
1054a1046
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word8 #-}
1054a1047
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word16 #-}
1054a1048
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word32 #-}
1054a1049
> {-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word64 #-}
1054a1050
> {-# SPECIALIZE npBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Binary -> μ α #-}
1054a1051
> {-# SPECIALIZE npBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Octal -> μ α #-}
1054a1052
> {-# SPECIALIZE npBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
1054a1053
> {-# SPECIALIZE npBits :: (Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
1054a1054
> {-# SPECIALIZE npBits :: (Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> μ α #-}
1058d1057
< npBitsUpTo ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
1059c1058
<            ⇒ s → Int → μ α
---
> npBitsUpTo :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
1059a1059
>            => s -> Int -> μ α
1062d1061
<                    r ← digit
1063d1061
<                    go (n - 1) $ fromIntegral $ negate (r ∷ Int)
1064d1061
<   where go 0 !r   = optional (PC.satisfy $ isDigitIn s) >>= \case
1065d1061
<                       Just _  → moreThan n
1066d1061
<                       Nothing → return r
1067d1061
<         go l !r   = optional digit >>= \case
1068c1062
<                       Just d1 → go (l - 1) ((r `shiftL` digitBits) + d)
---
>                    r <- digit
1068a1063
>                    go (n - 1) $ fromIntegral $ negate (r :: Int)
1068a1064
>   where go 0 !r   = optional (PC.satisfy $ isDigitIn s) >>= 
1068a1065
>                       Just _  -> moreThan n
1068a1066
>                       Nothing -> return r
1068a1067
>         go l !r   = optional digit >>= 
1068a1068
>                       Just d1 -> go (l - 1) ((r `shiftL` digitBits) + d)
1070c1070
<                       Nothing → return r
---
>                       Nothing -> return r
1073d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int #-}
1074d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int8 #-}
1075d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int16 #-}
1076d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int32 #-}
1077d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int64 #-}
1078d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word #-}
1079d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word8 #-}
1080d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word16 #-}
1081d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word32 #-}
1082d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word64 #-}
1083d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int #-}
1084d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int8 #-}
1085d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int16 #-}
1086d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int32 #-}
1087d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int64 #-}
1088d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word #-}
1089d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word8 #-}
1090d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word16 #-}
1091d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word32 #-}
1092d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word64 #-}
1093d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int #-}
1094d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int8 #-}
1095d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int16 #-}
1096d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int32 #-}
1097d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int64 #-}
1098d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word #-}
1099d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word8 #-}
1100d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word16 #-}
1101d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word32 #-}
1102d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word64 #-}
1103d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int #-}
1104d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int8 #-}
1105d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int16 #-}
1106d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int32 #-}
1107d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int64 #-}
1108d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word #-}
1109d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word8 #-}
1110d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word16 #-}
1111d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word32 #-}
1112d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word64 #-}
1113d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int #-}
1114d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int8 #-}
1115d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int16 #-}
1116d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int32 #-}
1117d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int64 #-}
1118d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word #-}
1119d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word8 #-}
1120d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word16 #-}
1121d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word32 #-}
1122d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word64 #-}
1123d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → Int → μ α #-}
1124d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → Int → μ α #-}
1125d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ α #-}
1126d1072
< {-# SPECIALIZE npBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → Int → μ α #-}
1127c1073
< {-# SPECIALIZE npBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → Int → μ α #-}
---
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int #-}
1127a1074
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int8 #-}
1127a1075
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int16 #-}
1127a1076
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int32 #-}
1127a1077
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int64 #-}
1127a1078
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word #-}
1127a1079
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word8 #-}
1127a1080
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word16 #-}
1127a1081
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word32 #-}
1127a1082
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word64 #-}
1127a1083
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int #-}
1127a1084
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int8 #-}
1127a1085
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int16 #-}
1127a1086
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int32 #-}
1127a1087
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int64 #-}
1127a1088
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word #-}
1127a1089
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word8 #-}
1127a1090
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word16 #-}
1127a1091
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word32 #-}
1127a1092
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word64 #-}
1127a1093
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int #-}
1127a1094
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int8 #-}
1127a1095
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int16 #-}
1127a1096
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int32 #-}
1127a1097
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int64 #-}
1127a1098
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word #-}
1127a1099
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word8 #-}
1127a1100
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word16 #-}
1127a1101
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word32 #-}
1127a1102
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word64 #-}
1127a1103
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int #-}
1127a1104
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int8 #-}
1127a1105
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int16 #-}
1127a1106
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int32 #-}
1127a1107
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int64 #-}
1127a1108
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word #-}
1127a1109
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word8 #-}
1127a1110
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word16 #-}
1127a1111
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word32 #-}
1127a1112
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word64 #-}
1127a1113
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int #-}
1127a1114
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int8 #-}
1127a1115
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int16 #-}
1127a1116
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int32 #-}
1127a1117
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int64 #-}
1127a1118
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word #-}
1127a1119
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word8 #-}
1127a1120
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word16 #-}
1127a1121
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word32 #-}
1127a1122
> {-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word64 #-}
1127a1123
> {-# SPECIALIZE npBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Binary -> Int -> μ α #-}
1127a1124
> {-# SPECIALIZE npBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Octal -> Int -> μ α #-}
1127a1125
> {-# SPECIALIZE npBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ α #-}
1127a1126
> {-# SPECIALIZE npBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> Int -> μ α #-}
1127a1127
> {-# SPECIALIZE npBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> Int -> μ α #-}
1131d1130
< npcBits ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) ⇒ s → μ α
1132d1130
< npcBits s = (<?> systemName s ++ " digits") $ digit >>= \case
1133d1130
<               0 → optional (PC.satisfy $ isDigitIn s) >>= \case
1134d1130
<                     Just _  → PC.unexpected "leading zero"
1135d1130
<                     Nothing → return 0
1136d1130
<               r → go $ fromIntegral $ negate (r ∷ Int)
1137d1130
<   where go !r     = optional digit >>= \case
1138c1131
<                       Just d1 → go ((r `shiftL` digitBits) + d)
---
> npcBits :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) => s -> μ α
1138a1132
> npcBits s = (<?> systemName s ++ " digits") $ digit >>= 
1138a1133
>               0 -> optional (PC.satisfy $ isDigitIn s) >>= 
1138a1134
>                     Just _  -> PC.unexpected "leading zero"
1138a1135
>                     Nothing -> return 0
1138a1136
>               r -> go $ fromIntegral $ negate (r :: Int)
1138a1137
>   where go !r     = optional digit >>= 
1138a1138
>                       Just d1 -> go ((r `shiftL` digitBits) + d)
1140c1140
<                       Nothing → return r
---
>                       Nothing -> return r
1143d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int #-}
1144d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int8 #-}
1145d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int16 #-}
1146d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int32 #-}
1147d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int64 #-}
1148d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word #-}
1149d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word8 #-}
1150d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word16 #-}
1151d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word32 #-}
1152d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word64 #-}
1153d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int #-}
1154d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int8 #-}
1155d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int16 #-}
1156d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int32 #-}
1157d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int64 #-}
1158d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word #-}
1159d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word8 #-}
1160d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word16 #-}
1161d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word32 #-}
1162d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word64 #-}
1163d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int #-}
1164d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int8 #-}
1165d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int16 #-}
1166d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int32 #-}
1167d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int64 #-}
1168d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word #-}
1169d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word8 #-}
1170d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word16 #-}
1171d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word32 #-}
1172d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word64 #-}
1173d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int #-}
1174d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int8 #-}
1175d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int16 #-}
1176d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int32 #-}
1177d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int64 #-}
1178d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word #-}
1179d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word8 #-}
1180d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word16 #-}
1181d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word32 #-}
1182d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word64 #-}
1183d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int #-}
1184d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int8 #-}
1185d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int16 #-}
1186d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int32 #-}
1187d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int64 #-}
1188d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word #-}
1189d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word8 #-}
1190d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word16 #-}
1191d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word32 #-}
1192d1142
< {-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word64 #-}
1193d1142
< {-# SPECIALIZE npcBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
1194d1142
< {-# SPECIALIZE npcBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
1195d1142
< {-# SPECIALIZE npcBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
1196d1142
< {-# SPECIALIZE npcBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
1197c1143
< {-# SPECIALIZE npcBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}
---
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Int #-}
1197a1144
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Int8 #-}
1197a1145
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Int16 #-}
1197a1146
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Int32 #-}
1197a1147
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Int64 #-}
1197a1148
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Word #-}
1197a1149
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Word8 #-}
1197a1150
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Word16 #-}
1197a1151
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Word32 #-}
1197a1152
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Word64 #-}
1197a1153
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Int #-}
1197a1154
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Int8 #-}
1197a1155
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Int16 #-}
1197a1156
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Int32 #-}
1197a1157
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Int64 #-}
1197a1158
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Word #-}
1197a1159
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Word8 #-}
1197a1160
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Word16 #-}
1197a1161
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Word32 #-}
1197a1162
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Word64 #-}
1197a1163
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int #-}
1197a1164
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int8 #-}
1197a1165
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int16 #-}
1197a1166
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int32 #-}
1197a1167
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int64 #-}
1197a1168
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word #-}
1197a1169
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word8 #-}
1197a1170
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word16 #-}
1197a1171
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word32 #-}
1197a1172
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word64 #-}
1197a1173
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int #-}
1197a1174
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int8 #-}
1197a1175
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int16 #-}
1197a1176
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int32 #-}
1197a1177
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int64 #-}
1197a1178
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word #-}
1197a1179
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word8 #-}
1197a1180
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word16 #-}
1197a1181
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word32 #-}
1197a1182
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word64 #-}
1197a1183
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int #-}
1197a1184
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int8 #-}
1197a1185
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int16 #-}
1197a1186
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int32 #-}
1197a1187
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int64 #-}
1197a1188
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word #-}
1197a1189
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word8 #-}
1197a1190
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word16 #-}
1197a1191
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word32 #-}
1197a1192
> {-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word64 #-}
1197a1193
> {-# SPECIALIZE npcBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Binary -> μ α #-}
1197a1194
> {-# SPECIALIZE npcBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Octal -> μ α #-}
1197a1195
> {-# SPECIALIZE npcBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
1197a1196
> {-# SPECIALIZE npcBits :: (Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
1197a1197
> {-# SPECIALIZE npcBits :: (Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> μ α #-}
1202d1201
< npcBitsUpTo ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
1203c1202
<             ⇒ s → Int → μ α
---
> npcBitsUpTo :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
1203a1203
>             => s -> Int -> μ α
1205d1204
< npcBitsUpTo s n = (<?> systemName s ++ " digits") $ digit >>= \case
1206d1204
<                     0 → optional (PC.satisfy $ isDigitIn s) >>= \case
1207d1204
<                           Just _  → PC.unexpected "leading zero"
1208d1204
<                           Nothing → return 0
1209d1204
<                     r → go (n - 1) $ fromIntegral $ negate (r ∷ Int)
1210d1204
<   where go 0 !r   = optional (PC.satisfy $ isDigitIn s) >>= \case
1211d1204
<                       Just _  → moreThan n
1212d1204
<                       Nothing → return r
1213d1204
<         go l !r   = optional digit >>= \case
1214c1205
<                       Just d1 → go (l - 1) ((r `shiftL` digitBits) + d)
---
> npcBitsUpTo s n = (<?> systemName s ++ " digits") $ digit >>= 
1214a1206
>                     0 -> optional (PC.satisfy $ isDigitIn s) >>= 
1214a1207
>                           Just _  -> PC.unexpected "leading zero"
1214a1208
>                           Nothing -> return 0
1214a1209
>                     r -> go (n - 1) $ fromIntegral $ negate (r :: Int)
1214a1210
>   where go 0 !r   = optional (PC.satisfy $ isDigitIn s) >>= 
1214a1211
>                       Just _  -> moreThan n
1214a1212
>                       Nothing -> return r
1214a1213
>         go l !r   = optional digit >>= 
1214a1214
>                       Just d1 -> go (l - 1) ((r `shiftL` digitBits) + d)
1216c1216
<                       Nothing → return r
---
>                       Nothing -> return r
1219d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int #-}
1220d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int8 #-}
1221d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int16 #-}
1222d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int32 #-}
1223d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int64 #-}
1224d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word #-}
1225d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word8 #-}
1226d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word16 #-}
1227d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word32 #-}
1228d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word64 #-}
1229d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int #-}
1230d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int8 #-}
1231d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int16 #-}
1232d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int32 #-}
1233d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int64 #-}
1234d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word #-}
1235d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word8 #-}
1236d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word16 #-}
1237d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word32 #-}
1238d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word64 #-}
1239d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int #-}
1240d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int8 #-}
1241d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int16 #-}
1242d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int32 #-}
1243d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int64 #-}
1244d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word #-}
1245d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word8 #-}
1246d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word16 #-}
1247d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word32 #-}
1248d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word64 #-}
1249d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int #-}
1250d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int8 #-}
1251d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int16 #-}
1252d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int32 #-}
1253d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int64 #-}
1254d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word #-}
1255d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word8 #-}
1256d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word16 #-}
1257d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word32 #-}
1258d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word64 #-}
1259d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int #-}
1260d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int8 #-}
1261d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int16 #-}
1262d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int32 #-}
1263d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int64 #-}
1264d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word #-}
1265d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word8 #-}
1266d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word16 #-}
1267d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word32 #-}
1268d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word64 #-}
1269d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → Int → μ α #-}
1270d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → Int → μ α #-}
1271d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ α #-}
1272d1218
< {-# SPECIALIZE npcBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → Int → μ α #-}
1273c1219
< {-# SPECIALIZE npcBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → Int → μ α #-}
---
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int #-}
1273a1220
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int8 #-}
1273a1221
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int16 #-}
1273a1222
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int32 #-}
1273a1223
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int64 #-}
1273a1224
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word #-}
1273a1225
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word8 #-}
1273a1226
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word16 #-}
1273a1227
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word32 #-}
1273a1228
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word64 #-}
1273a1229
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int #-}
1273a1230
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int8 #-}
1273a1231
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int16 #-}
1273a1232
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int32 #-}
1273a1233
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int64 #-}
1273a1234
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word #-}
1273a1235
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word8 #-}
1273a1236
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word16 #-}
1273a1237
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word32 #-}
1273a1238
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word64 #-}
1273a1239
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int #-}
1273a1240
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int8 #-}
1273a1241
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int16 #-}
1273a1242
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int32 #-}
1273a1243
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int64 #-}
1273a1244
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word #-}
1273a1245
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word8 #-}
1273a1246
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word16 #-}
1273a1247
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word32 #-}
1273a1248
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word64 #-}
1273a1249
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int #-}
1273a1250
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int8 #-}
1273a1251
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int16 #-}
1273a1252
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int32 #-}
1273a1253
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int64 #-}
1273a1254
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word #-}
1273a1255
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word8 #-}
1273a1256
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word16 #-}
1273a1257
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word32 #-}
1273a1258
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word64 #-}
1273a1259
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int #-}
1273a1260
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int8 #-}
1273a1261
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int16 #-}
1273a1262
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int32 #-}
1273a1263
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int64 #-}
1273a1264
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word #-}
1273a1265
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word8 #-}
1273a1266
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word16 #-}
1273a1267
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word32 #-}
1273a1268
> {-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word64 #-}
1273a1269
> {-# SPECIALIZE npcBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Binary -> Int -> μ α #-}
1273a1270
> {-# SPECIALIZE npcBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Octal -> Int -> μ α #-}
1273a1271
> {-# SPECIALIZE npcBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ α #-}
1273a1272
> {-# SPECIALIZE npcBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> Int -> μ α #-}
1273a1273
> {-# SPECIALIZE npcBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> Int -> μ α #-}
1277c1277
< npbBits ∷ ∀ s μ α
---
> npbBits :: forall s μ α
1280c1280
<         ⇒ s → μ α
---
>         => s -> μ α
1282d1281
<               n ← digit
1283c1282
<               go $ fromIntegral $ negate (n ∷ Int)
---
>               n <- digit
1283a1283
>               go $ fromIntegral $ negate (n :: Int)
1285c1285
<         r  = negate (lastDigitIn s (minBound ∷ α)) .&. digitMaskIn s
---
>         r  = negate (lastDigitIn s (minBound :: α)) .&. digitMaskIn s
1287d1286
<         go !n     = optional digit >>= \case
1288c1287
<                       Just d1 → if n > q || (n == q && d1 <= r)
---
>         go !n     = optional digit >>= 
1288a1288
>                       Just d1 -> if n > q || (n == q && d1 <= r)
1292c1292
<                       Nothing → return n
---
>                       Nothing -> return n
1295d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int #-}
1296d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int8 #-}
1297d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int16 #-}
1298d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int32 #-}
1299d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int64 #-}
1300d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word #-}
1301d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word8 #-}
1302d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word16 #-}
1303d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word32 #-}
1304d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word64 #-}
1305d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int #-}
1306d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int8 #-}
1307d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int16 #-}
1308d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int32 #-}
1309d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int64 #-}
1310d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word #-}
1311d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word8 #-}
1312d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word16 #-}
1313d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word32 #-}
1314d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word64 #-}
1315d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int #-}
1316d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int8 #-}
1317d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int16 #-}
1318d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int32 #-}
1319d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int64 #-}
1320d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word #-}
1321d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word8 #-}
1322d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word16 #-}
1323d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word32 #-}
1324d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word64 #-}
1325d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int #-}
1326d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int8 #-}
1327d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int16 #-}
1328d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int32 #-}
1329d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int64 #-}
1330d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word #-}
1331d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word8 #-}
1332d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word16 #-}
1333d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word32 #-}
1334d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word64 #-}
1335d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int #-}
1336d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int8 #-}
1337d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int16 #-}
1338d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int32 #-}
1339d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int64 #-}
1340d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word #-}
1341d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word8 #-}
1342d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word16 #-}
1343d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word32 #-}
1344d1294
< {-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word64 #-}
1345d1294
< {-# SPECIALIZE npbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
1346d1294
< {-# SPECIALIZE npbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
1347d1294
< {-# SPECIALIZE npbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
1348d1294
< {-# SPECIALIZE npbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
1349c1295
< {-# SPECIALIZE npbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}
---
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int #-}
1349a1296
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int8 #-}
1349a1297
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int16 #-}
1349a1298
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int32 #-}
1349a1299
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int64 #-}
1349a1300
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word #-}
1349a1301
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word8 #-}
1349a1302
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word16 #-}
1349a1303
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word32 #-}
1349a1304
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word64 #-}
1349a1305
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int #-}
1349a1306
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int8 #-}
1349a1307
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int16 #-}
1349a1308
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int32 #-}
1349a1309
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int64 #-}
1349a1310
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word #-}
1349a1311
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word8 #-}
1349a1312
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word16 #-}
1349a1313
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word32 #-}
1349a1314
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word64 #-}
1349a1315
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int #-}
1349a1316
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int8 #-}
1349a1317
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int16 #-}
1349a1318
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int32 #-}
1349a1319
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int64 #-}
1349a1320
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word #-}
1349a1321
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word8 #-}
1349a1322
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word16 #-}
1349a1323
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word32 #-}
1349a1324
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word64 #-}
1349a1325
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int #-}
1349a1326
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int8 #-}
1349a1327
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int16 #-}
1349a1328
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int32 #-}
1349a1329
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int64 #-}
1349a1330
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word #-}
1349a1331
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word8 #-}
1349a1332
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word16 #-}
1349a1333
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word32 #-}
1349a1334
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word64 #-}
1349a1335
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int #-}
1349a1336
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int8 #-}
1349a1337
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int16 #-}
1349a1338
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int32 #-}
1349a1339
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int64 #-}
1349a1340
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word #-}
1349a1341
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word8 #-}
1349a1342
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word16 #-}
1349a1343
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word32 #-}
1349a1344
> {-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word64 #-}
1349a1345
> {-# SPECIALIZE npbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Binary -> μ α #-}
1349a1346
> {-# SPECIALIZE npbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Octal -> μ α #-}
1349a1347
> {-# SPECIALIZE npbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
1349a1348
> {-# SPECIALIZE npbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
1349a1349
> {-# SPECIALIZE npbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> μ α #-}
1354c1354
< npcbBits ∷ ∀ s μ α
---
> npcbBits :: forall s μ α
1357d1356
<         ⇒ s → μ α
1358d1356
< npcbBits s = (<?> systemName s ++ " digits") $ digit >>= \case
1359d1356
<                0 → optional (PC.satisfy $ isDigitIn s) >>= \case
1360d1356
<                      Just _  → PC.unexpected "leading zero"
1361d1356
<                      Nothing → return 0
1362c1357
<                n → go $ fromIntegral $ negate (n ∷ Int)
---
>         => s -> μ α
1362a1358
> npcbBits s = (<?> systemName s ++ " digits") $ digit >>= 
1362a1359
>                0 -> optional (PC.satisfy $ isDigitIn s) >>= 
1362a1360
>                      Just _  -> PC.unexpected "leading zero"
1362a1361
>                      Nothing -> return 0
1362a1362
>                n -> go $ fromIntegral $ negate (n :: Int)
1364c1364
<         r  = negate (lastDigitIn s (minBound ∷ α)) .&. digitMaskIn s
---
>         r  = negate (lastDigitIn s (minBound :: α)) .&. digitMaskIn s
1366d1365
<         go !n     = optional digit >>= \case
1367c1366
<                       Just d1 → if n > q || (n == q && d1 <= r)
---
>         go !n     = optional digit >>= 
1367a1367
>                       Just d1 -> if n > q || (n == q && d1 <= r)
1371c1371
<                       Nothing → return n
---
>                       Nothing -> return n
1374d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int #-}
1375d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int8 #-}
1376d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int16 #-}
1377d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int32 #-}
1378d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int64 #-}
1379d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word #-}
1380d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word8 #-}
1381d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word16 #-}
1382d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word32 #-}
1383d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word64 #-}
1384d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int #-}
1385d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int8 #-}
1386d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int16 #-}
1387d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int32 #-}
1388d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int64 #-}
1389d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word #-}
1390d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word8 #-}
1391d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word16 #-}
1392d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word32 #-}
1393d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word64 #-}
1394d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int #-}
1395d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int8 #-}
1396d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int16 #-}
1397d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int32 #-}
1398d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int64 #-}
1399d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word #-}
1400d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word8 #-}
1401d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word16 #-}
1402d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word32 #-}
1403d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word64 #-}
1404d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int #-}
1405d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int8 #-}
1406d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int16 #-}
1407d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int32 #-}
1408d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int64 #-}
1409d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word #-}
1410d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word8 #-}
1411d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word16 #-}
1412d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word32 #-}
1413d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word64 #-}
1414d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int #-}
1415d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int8 #-}
1416d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int16 #-}
1417d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int32 #-}
1418d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int64 #-}
1419d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word #-}
1420d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word8 #-}
1421d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word16 #-}
1422d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word32 #-}
1423d1373
< {-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word64 #-}
1424d1373
< {-# SPECIALIZE npcbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
1425d1373
< {-# SPECIALIZE npcbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
1426d1373
< {-# SPECIALIZE npcbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
1427d1373
< {-# SPECIALIZE npcbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
1428c1374
< {-# SPECIALIZE npcbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}
---
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int #-}
1428a1375
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int8 #-}
1428a1376
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int16 #-}
1428a1377
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int32 #-}
1428a1378
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int64 #-}
1428a1379
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word #-}
1428a1380
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word8 #-}
1428a1381
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word16 #-}
1428a1382
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word32 #-}
1428a1383
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word64 #-}
1428a1384
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int #-}
1428a1385
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int8 #-}
1428a1386
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int16 #-}
1428a1387
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int32 #-}
1428a1388
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int64 #-}
1428a1389
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word #-}
1428a1390
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word8 #-}
1428a1391
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word16 #-}
1428a1392
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word32 #-}
1428a1393
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word64 #-}
1428a1394
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int #-}
1428a1395
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int8 #-}
1428a1396
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int16 #-}
1428a1397
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int32 #-}
1428a1398
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int64 #-}
1428a1399
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word #-}
1428a1400
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word8 #-}
1428a1401
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word16 #-}
1428a1402
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word32 #-}
1428a1403
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word64 #-}
1428a1404
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int #-}
1428a1405
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int8 #-}
1428a1406
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int16 #-}
1428a1407
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int32 #-}
1428a1408
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int64 #-}
1428a1409
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word #-}
1428a1410
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word8 #-}
1428a1411
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word16 #-}
1428a1412
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word32 #-}
1428a1413
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word64 #-}
1428a1414
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int #-}
1428a1415
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int8 #-}
1428a1416
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int16 #-}
1428a1417
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int32 #-}
1428a1418
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int64 #-}
1428a1419
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word #-}
1428a1420
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word8 #-}
1428a1421
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word16 #-}
1428a1422
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word32 #-}
1428a1423
> {-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word64 #-}
1428a1424
> {-# SPECIALIZE npcbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Binary -> μ α #-}
1428a1425
> {-# SPECIALIZE npcbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Octal -> μ α #-}
1428a1426
> {-# SPECIALIZE npcbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
1428a1427
> {-# SPECIALIZE npcbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
1428a1428
> {-# SPECIALIZE npcbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> μ α #-}
1436c1436
< applySign ∷ Num α ⇒ Sign → α → α
---
> applySign :: Num α => Sign -> α -> α
1441c1441
< optMinus ∷ CharParsing μ ⇒ μ Sign
---
> optMinus :: CharParsing μ => μ Sign
1447c1447
< optSign ∷ CharParsing μ ⇒ μ Sign
---
> optSign :: CharParsing μ => μ Sign
1456d1455
< number' ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ)
1457d1455
<         ⇒ μ Sign → s → μ α
1458d1455
< number' neg s = (<?> systemName s) $ neg >>= \case
1459d1455
<   NonNegative → nonNegative s
1460c1456
<   NonPositive → nonPositive s
---
> number' :: (PositionalSystem s, Num α, Monad μ, CharParsing μ)
1460a1457
>         => μ Sign -> s -> μ α
1460a1458
> number' neg s = (<?> systemName s) $ neg >>= 
1460a1459
>   NonNegative -> nonNegative s
1460a1460
>   NonPositive -> nonPositive s
1464c1464
< number ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → μ α
---
> number :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> μ α
1471d1470
< compact' ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ)
1472d1470
<          ⇒ μ Sign → s → μ α
1473d1470
< compact' neg s = (<?> systemName s) $ neg >>= \case
1474d1470
<   NonNegative → nnCompact s
1475c1471
<   NonPositive → npCompact s
---
> compact' :: (PositionalSystem s, Num α, Monad μ, CharParsing μ)
1475a1472
>          => μ Sign -> s -> μ α
1475a1473
> compact' neg s = (<?> systemName s) $ neg >>= 
1475a1474
>   NonNegative -> nnCompact s
1475a1475
>   NonPositive -> npCompact s
1479c1479
< compact ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → μ α
---
> compact :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> μ α
1486d1485
< numberUpTo' ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ)
1487d1485
<             ⇒ μ Sign → s → Int → μ α
1488d1485
< numberUpTo' neg s n = (<?> systemName s) $ neg >>= \case
1489d1485
<   NonNegative → nnUpTo s n
1490c1486
<   NonPositive → npUpTo s n
---
> numberUpTo' :: (PositionalSystem s, Num α, Monad μ, CharParsing μ)
1490a1487
>             => μ Sign -> s -> Int -> μ α
1490a1488
> numberUpTo' neg s n = (<?> systemName s) $ neg >>= 
1490a1489
>   NonNegative -> nnUpTo s n
1490a1490
>   NonPositive -> npUpTo s n
1494d1493
< numberUpTo ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ)
1495c1494
<            ⇒ s → Int → μ α
---
> numberUpTo :: (PositionalSystem s, Num α, Monad μ, CharParsing μ)
1495a1495
>            => s -> Int -> μ α
1502d1501
< compactUpTo' ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ)
1503d1501
<              ⇒ μ Sign → s → Int → μ α
1504d1501
< compactUpTo' neg s n = (<?> systemName s) $ neg >>= \case
1505d1501
<   NonNegative → nncUpTo s n
1506c1502
<   NonPositive → npcUpTo s n
---
> compactUpTo' :: (PositionalSystem s, Num α, Monad μ, CharParsing μ)
1506a1503
>              => μ Sign -> s -> Int -> μ α
1506a1504
> compactUpTo' neg s n = (<?> systemName s) $ neg >>= 
1506a1505
>   NonNegative -> nncUpTo s n
1506a1506
>   NonPositive -> npcUpTo s n
1510d1509
< compactUpTo ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ)
1511c1510
<            ⇒ s → Int → μ α
---
> compactUpTo :: (PositionalSystem s, Num α, Monad μ, CharParsing μ)
1511a1511
>            => s -> Int -> μ α
1518c1518
< bounded' ∷ (PositionalSystem s, Ord α, Bounded α, Integral α,
---
> bounded' :: (PositionalSystem s, Ord α, Bounded α, Integral α,
1520d1519
<          ⇒ μ Sign → s → μ α
1521d1519
< bounded' neg s = (<?> systemName s) $ neg >>= \case
1522d1519
<   NonNegative → nnBounded s
1523c1520
<   NonPositive → npBounded s
---
>          => μ Sign -> s -> μ α
1523a1521
> bounded' neg s = (<?> systemName s) $ neg >>= 
1523a1522
>   NonNegative -> nnBounded s
1523a1523
>   NonPositive -> npBounded s
1527d1526
< bounded ∷ (PositionalSystem s, Ord α, Bounded α, Integral α,
1528c1527
<            Monad μ, CharParsing μ) ⇒ s → μ α
---
> bounded :: (PositionalSystem s, Ord α, Bounded α, Integral α,
1528a1528
>            Monad μ, CharParsing μ) => s -> μ α
1535c1535
< cBounded' ∷ (PositionalSystem s, Ord α, Bounded α, Integral α,
---
> cBounded' :: (PositionalSystem s, Ord α, Bounded α, Integral α,
1537d1536
<           ⇒ μ Sign → s → μ α
1538d1536
< cBounded' neg s = (<?> systemName s) $ neg >>= \case
1539d1536
<   NonNegative → nncBounded s
1540c1537
<   NonPositive → npcBounded s
---
>           => μ Sign -> s -> μ α
1540a1538
> cBounded' neg s = (<?> systemName s) $ neg >>= 
1540a1539
>   NonNegative -> nncBounded s
1540a1540
>   NonPositive -> npcBounded s
1544d1543
< cBounded ∷ (PositionalSystem s, Ord α, Bounded α, Integral α,
1545c1544
<             Monad μ, CharParsing μ) ⇒ s → μ α
---
> cBounded :: (PositionalSystem s, Ord α, Bounded α, Integral α,
1545a1545
>             Monad μ, CharParsing μ) => s -> μ α
1552d1551
< bits' ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
1553d1551
<       ⇒ μ Sign → s → μ α
1554d1551
< bits' neg s = (<?> systemName s) $ neg >>= \case
1555d1551
<   NonNegative → nnBits s
1556c1552
<   NonPositive → npBits s
---
> bits' :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
1556a1553
>       => μ Sign -> s -> μ α
1556a1554
> bits' neg s = (<?> systemName s) $ neg >>= 
1556a1555
>   NonNegative -> nnBits s
1556a1556
>   NonPositive -> npBits s
1560c1560
< bits ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) ⇒ s → μ α
---
> bits :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) => s -> μ α
1567d1566
< cBits' ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
1568d1566
<        ⇒ μ Sign → s → μ α
1569d1566
< cBits' neg s = (<?> systemName s) $ neg >>= \case
1570d1566
<   NonNegative → nncBits s
1571c1567
<   NonPositive → npcBits s
---
> cBits' :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
1571a1568
>        => μ Sign -> s -> μ α
1571a1569
> cBits' neg s = (<?> systemName s) $ neg >>= 
1571a1570
>   NonNegative -> nncBits s
1571a1571
>   NonPositive -> npcBits s
1575c1575
< cBits ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) ⇒ s → μ α
---
> cBits :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) => s -> μ α
1582d1581
< bitsUpTo' ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
1583d1581
<           ⇒ μ Sign → s → Int → μ α
1584d1581
< bitsUpTo' neg s n = (<?> systemName s) $ neg >>= \case
1585d1581
<   NonNegative → nnBitsUpTo s n
1586c1582
<   NonPositive → npBitsUpTo s n
---
> bitsUpTo' :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
1586a1583
>           => μ Sign -> s -> Int -> μ α
1586a1584
> bitsUpTo' neg s n = (<?> systemName s) $ neg >>= 
1586a1585
>   NonNegative -> nnBitsUpTo s n
1586a1586
>   NonPositive -> npBitsUpTo s n
1590d1589
< bitsUpTo ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
1591c1590
<          ⇒ s → Int → μ α
---
> bitsUpTo :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
1591a1591
>          => s -> Int -> μ α
1599d1598
< cBitsUpTo' ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
1600d1598
<            ⇒ μ Sign → s → Int → μ α
1601d1598
< cBitsUpTo' neg s n = (<?> systemName s) $ neg >>= \case
1602d1598
<   NonNegative → nncBitsUpTo s n
1603c1599
<   NonPositive → npcBitsUpTo s n
---
> cBitsUpTo' :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
1603a1600
>            => μ Sign -> s -> Int -> μ α
1603a1601
> cBitsUpTo' neg s n = (<?> systemName s) $ neg >>= 
1603a1602
>   NonNegative -> nncBitsUpTo s n
1603a1603
>   NonPositive -> npcBitsUpTo s n
1607d1606
< cBitsUpTo ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
1608c1607
<           ⇒ s → Int → μ α
---
> cBitsUpTo :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
1608a1608
>           => s -> Int -> μ α
1615c1615
< bBits' ∷ (BitSystem s, Ord α, Bounded α, Num α, Bits α,
---
> bBits' :: (BitSystem s, Ord α, Bounded α, Num α, Bits α,
1617d1616
<        ⇒ μ Sign → s → μ α
1618d1616
< bBits' neg s = (<?> systemName s) $ neg >>= \case
1619d1616
<   NonNegative → nnbBits s
1620c1617
<   NonPositive → npbBits s
---
>        => μ Sign -> s -> μ α
1620a1618
> bBits' neg s = (<?> systemName s) $ neg >>= 
1620a1619
>   NonNegative -> nnbBits s
1620a1620
>   NonPositive -> npbBits s
1624c1624
< bBits ∷ (BitSystem s, Ord α, Bounded α, Num α, Bits α,
---
> bBits :: (BitSystem s, Ord α, Bounded α, Num α, Bits α,
1626c1626
<       ⇒ s → μ α
---
>       => s -> μ α
1634c1634
< cbBits' ∷ (BitSystem s, Ord α, Bounded α, Num α, Bits α,
---
> cbBits' :: (BitSystem s, Ord α, Bounded α, Num α, Bits α,
1636d1635
<         ⇒ μ Sign → s → μ α
1637d1635
< cbBits' neg s = (<?> systemName s) $ neg >>= \case
1638d1635
<   NonNegative → nncbBits s
1639c1636
<   NonPositive → npcbBits s
---
>         => μ Sign -> s -> μ α
1639a1637
> cbBits' neg s = (<?> systemName s) $ neg >>= 
1639a1638
>   NonNegative -> nncbBits s
1639a1639
>   NonPositive -> npcbBits s
1643c1643
< cbBits ∷ (BitSystem s, Ord α, Bounded α, Num α, Bits α,
---
> cbBits :: (BitSystem s, Ord α, Bounded α, Num α, Bits α,
1645c1645
<        ⇒ s → μ α
---
>        => s -> μ α
1648a1649
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE UnicodeSyntax #-}
{-# LANGUAGE DeriveDataTypeable #-}
{-# LANGUAGE BangPatterns #-}
{-# LANGUAGE LambdaCase #-}
{-# LANGUAGE ScopedTypeVariables #-}

-- | Parsers for integral numbers written in positional numeral systems.
module Data.Textual.Integral
  (
  -- * Positional numeral systems
    PositionalSystem(..)
  , BitSystem(..)
  , Binary(..)
  , Octal(..)
  , Decimal(..)
  , Hexadecimal(..)
  , LowHex(..)
  , UpHex(..)
  -- * Single digits
  , digitIn
  , nzDigitIn
  , binDigit
  , nzBinDigit
  , octDigit
  , nzOctDigit
  , decDigit
  , nzDecDigit
  , hexDigit
  , nzHexDigit
  , lowHexDigit
  , nzLowHexDigit
  , upHexDigit
  , nzUpHexDigit
  -- * Numbers
  , nonNegative
  , nnCompact
  , nnUpTo
  , nncUpTo
  , nnBounded
  , nncBounded
  , nnBits
  , nncBits
  , nnBitsUpTo
  , nncBitsUpTo
  , nnbBits
  , nncbBits
  , nonPositive
  , npCompact
  , npUpTo
  , npcUpTo
  , npBounded
  , npcBounded
  , npBits
  , npcBits
  , npBitsUpTo
  , npcBitsUpTo
  , npbBits
  , npcbBits
  , Sign(..)
  , applySign
  , optMinus
  , optSign
  , number'
  , number
  , compact'
  , compact
  , numberUpTo'
  , numberUpTo
  , compactUpTo'
  , compactUpTo
  , bounded'
  , bounded
  , cBounded'
  , cBounded
  , bits'
  , bits
  , cBits'
  , cBits
  , bitsUpTo'
  , bitsUpTo
  , cBitsUpTo'
  , cBitsUpTo
  , bBits'
  , bBits
  , cbBits'
  , cbBits
  ) where

import Data.Typeable (Typeable)
import Data.Int
import Data.Word
import Data.Bits (Bits(..))
import Control.Applicative
import Text.Printer.Integral (
         PositionalSystem(..), BitSystem(..),
         Binary(..), Octal(..), Decimal(..), Hexadecimal(..),
         LowHex(..), UpHex(..))
import Text.Parser.Combinators ((<?>))
import qualified Text.Parser.Combinators as PC
import Text.Parser.Char (CharParsing)
import qualified Text.Parser.Char as PC

-- | Parse a digit of the specified positional numeral system.
digitIn ∷ (PositionalSystem s, Num α, CharParsing μ) ⇒ s → μ α
digitIn s  =  unsafeFromDigitIn s <$> PC.satisfy (isDigitIn s)
          <?> systemName s ++ " digit"
{-# INLINE digitIn #-}

-- | Parse a non-zero digit of the specified positional numeral system.
nzDigitIn ∷ (PositionalSystem s, Num α, CharParsing μ) ⇒ s → μ α
nzDigitIn s  =  unsafeFromDigitIn s <$> PC.satisfy (isNzDigitIn s)
            <?> "non-zero " ++ systemName s ++ " digit"
{-# INLINE nzDigitIn #-}

-- | Parse a binary digit.
binDigit ∷ (Num α, CharParsing μ) ⇒ μ α
binDigit = digitIn Binary
{-# INLINE binDigit #-}

-- | Parse a non-zero binary digit (/'1'/).
nzBinDigit ∷ (Num α, CharParsing μ) ⇒ μ α
nzBinDigit = nzDigitIn Binary
{-# INLINE nzBinDigit #-}

-- | Parse a decimal digit.
decDigit ∷ (Num α, CharParsing μ) ⇒ μ α
decDigit = digitIn Decimal
{-# INLINE decDigit #-}

-- | Parse a non-zero decimal digit.
nzDecDigit ∷ (Num α, CharParsing μ) ⇒ μ α
nzDecDigit = nzDigitIn Decimal
{-# INLINE nzDecDigit #-}

-- | Parse an octal digit.
octDigit ∷ (Num α, CharParsing μ) ⇒ μ α
octDigit = digitIn Octal
{-# INLINE octDigit #-}

-- | Parse a non-zero octal digit.
nzOctDigit ∷ (Num α, CharParsing μ) ⇒ μ α
nzOctDigit = nzDigitIn Octal
{-# INLINE nzOctDigit #-}

-- | Parse a hexadecimal digit.
hexDigit ∷ (Num α, CharParsing μ) ⇒ μ α
hexDigit = digitIn Hexadecimal
{-# INLINE hexDigit #-}

-- | Parse a non-zero hexadecimal digit.
nzHexDigit ∷ (Num α, CharParsing μ) ⇒ μ α
nzHexDigit = nzDigitIn Hexadecimal
{-# INLINE nzHexDigit #-}

-- | Parse a lower case hexadecimal digit.
lowHexDigit ∷ (Num α, CharParsing μ) ⇒ μ α
lowHexDigit = digitIn LowHex
{-# INLINE lowHexDigit #-}

-- | Parse a non-zero lower case hexadecimal digit.
nzLowHexDigit ∷ (Num α, CharParsing μ) ⇒ μ α
nzLowHexDigit = nzDigitIn LowHex
{-# INLINE nzLowHexDigit #-}

-- | Parse an upper case hexadecimal digit.
upHexDigit ∷ (Num α, CharParsing μ) ⇒ μ α
upHexDigit = digitIn UpHex
{-# INLINE upHexDigit #-}

-- | Parse a non-zero upper case hexadecimal digit.
nzUpHexDigit ∷ (Num α, CharParsing μ) ⇒ μ α
nzUpHexDigit = nzDigitIn UpHex
{-# INLINE nzUpHexDigit #-}

-- | Parse a non-negative number written in the specified positional
--   numeral system.
nonNegative ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → μ α
nonNegative s = digit >>= go <?> systemName s ++ " digits"
  where go !r = optional digit >>= \case
                  Just d  → go (r * radix + d)
                  Nothing → return r
        radix = radixIn s
        digit = digitIn s
{-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int #-}
{-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int8 #-}
{-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int16 #-}
{-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int32 #-}
{-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int64 #-}
{-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word #-}
{-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word8 #-}
{-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word16 #-}
{-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word32 #-}
{-# SPECIALIZE nonNegative ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word64 #-}
{-# SPECIALIZE nonNegative ∷ (Num α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
{-# SPECIALIZE nonNegative ∷ (Num α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
{-# SPECIALIZE nonNegative ∷ (Num α, Monad μ, CharParsing μ) ⇒ Decimal → μ α #-}
{-# SPECIALIZE nonNegative ∷ (Num α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
{-# SPECIALIZE nonNegative ∷ (Num α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
{-# SPECIALIZE nonNegative ∷ (Num α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}

-- | Parse a non-negative number written in the specified positional
--   numeral system. Leading zeroes are not allowed.
nnCompact ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → μ α
nnCompact s = (<?> systemName s ++ " digits") $ digitIn s >>= \case
                0 → optional (PC.satisfy $ isDigitIn s) >>= \case
                      Just _  → PC.unexpected "leading zero"
                      Nothing → return 0
                r → go $ fromIntegral (r ∷ Word)
  where go !r = optional digit >>= \case
                  Just d  → go (r * radix + d)
                  Nothing → return r
        radix = radixIn s
        digit = digitIn s
{-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int #-}
{-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int8 #-}
{-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int16 #-}
{-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int32 #-}
{-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int64 #-}
{-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word #-}
{-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word8 #-}
{-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word16 #-}
{-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word32 #-}
{-# SPECIALIZE nnCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word64 #-}
{-# SPECIALIZE nnCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
{-# SPECIALIZE nnCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
{-# SPECIALIZE nnCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ Decimal → μ α #-}
{-# SPECIALIZE nnCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
{-# SPECIALIZE nnCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
{-# SPECIALIZE nnCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}

moreThan ∷ CharParsing μ ⇒ Int → μ α
moreThan n = PC.unexpected
           $ "more than " ++ show n ++
             case n of
               1 → " digit"
               _ → " digits"
{-# INLINE moreThan #-}

-- | Parse a non-negative number written in the specified positional
--   numeral system (up to /n/ digits).
nnUpTo ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → Int → μ α
nnUpTo _ n | n <= 0 = empty
nnUpTo s n = digit >>= go (n - 1) <?> systemName s ++ " digits"
  where go 0 !r = optional (PC.satisfy $ isDigitIn s) >>= \case
                    Just _  → moreThan n
                    Nothing → return r
        go l !r = optional digit >>= \case
                    Just d  → go (l - 1) (r * radix + d)
                    Nothing → return r
        radix   = radixIn s
        digit   = digitIn s
{-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int #-}
{-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int8 #-}
{-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int16 #-}
{-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int32 #-}
{-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int64 #-}
{-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word #-}
{-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word8 #-}
{-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word16 #-}
{-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word32 #-}
{-# SPECIALIZE nnUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word64 #-}
{-# SPECIALIZE nnUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Binary → Int → μ α #-}
{-# SPECIALIZE nnUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Octal → Int → μ α #-}
{-# SPECIALIZE nnUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Decimal → Int → μ α #-}
{-# SPECIALIZE nnUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ α #-}
{-# SPECIALIZE nnUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ LowHex → Int → μ α #-}
{-# SPECIALIZE nnUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ UpHex → Int → μ α #-}

-- | Parse a non-negative number written in the specified positional
--   numeral system (up to /n/ digits). Leading zeroes are not allowed.
nncUpTo ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → Int → μ α
nncUpTo _ n | n <= 0 = empty
nncUpTo s n = (<?> systemName s ++ " digits") $ digitIn s >>= \case
                0 → optional (PC.satisfy $ isDigitIn s) >>= \case
                      Just _  → PC.unexpected "leading zero"
                      Nothing → return 0
                r → go (n - 1) $ fromIntegral (r ∷ Word)
  where go 0 !r = optional (PC.satisfy $ isDigitIn s) >>= \case
                    Just _  → moreThan n
                    Nothing → return r
        go l !r = optional digit >>= \case
                    Just d  → go (l - 1) (r * radix + d)
                    Nothing → return r
        radix   = radixIn s
        digit   = digitIn s
{-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int #-}
{-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int8 #-}
{-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int16 #-}
{-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int32 #-}
{-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int64 #-}
{-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word #-}
{-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word8 #-}
{-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word16 #-}
{-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word32 #-}
{-# SPECIALIZE nncUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word64 #-}
{-# SPECIALIZE nncUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Binary → Int → μ α #-}
{-# SPECIALIZE nncUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Octal → Int → μ α #-}
{-# SPECIALIZE nncUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Decimal → Int → μ α #-}
{-# SPECIALIZE nncUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ α #-}
{-# SPECIALIZE nncUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ LowHex → Int → μ α #-}
{-# SPECIALIZE nncUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ UpHex → Int → μ α #-}

-- | Parse a non-negative number written in the specified positional
--   numeral system, failing on overflow.
nnBounded ∷ (PositionalSystem s, Ord α, Bounded α, Integral α,
             Monad μ, CharParsing μ) ⇒ s → μ α
nnBounded s = digit >>= go <?> systemName s ++ " digits"
  where (q, r) = quotRem maxBound radix
        go !n  = optional digit >>= \case
                   Just n1 → if n < q || (n == q && n1 <= r)
                             then go (n * radix + n1)
                             else fail "out of bounds"
                   Nothing → return n
        radix  = radixIn s
        digit  = digitIn s
{-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int #-}
{-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int8 #-}
{-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int16 #-}
{-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int32 #-}
{-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int64 #-}
{-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word #-}
{-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word8 #-}
{-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word16 #-}
{-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word32 #-}
{-# SPECIALIZE nnBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word64 #-}
{-# SPECIALIZE nnBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
{-# SPECIALIZE nnBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
{-# SPECIALIZE nnBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Decimal → μ α #-}
{-# SPECIALIZE nnBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
{-# SPECIALIZE nnBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
{-# SPECIALIZE nnBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}

-- | Parse a non-negative number written in the specified positional
--   numeral system, failing on overflow. Leading zeroes are not allowed.
nncBounded ∷ (PositionalSystem s, Ord α, Bounded α, Integral α,
              Monad μ, CharParsing μ) ⇒ s → μ α
nncBounded s = (<?> systemName s ++ " digits") $ digit >>= \case
                 0 → optional (PC.satisfy $ isDigitIn s) >>= \case
                       Just _  → PC.unexpected "leading zero"
                       Nothing → return 0
                 n → go n
  where (q, r) = quotRem maxBound radix
        go !n  = optional digit >>= \case
                   Just d  → if n < q || (n == q && d <= r)
                             then go (n * radix + d)
                             else fail "out of bounds"
                   Nothing → return n
        radix  = radixIn s
        digit  = digitIn s
{-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int #-}
{-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int8 #-}
{-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int16 #-}
{-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int32 #-}
{-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int64 #-}
{-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word #-}
{-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word8 #-}
{-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word16 #-}
{-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word32 #-}
{-# SPECIALIZE nncBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word64 #-}
{-# SPECIALIZE nncBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
{-# SPECIALIZE nncBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
{-# SPECIALIZE nncBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Decimal → μ α #-}
{-# SPECIALIZE nncBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
{-# SPECIALIZE nncBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
{-# SPECIALIZE nncBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}

-- | Parse a non-negative binary number written in the specified
--   positional numeral system.
nnBits ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) ⇒ s → μ α
nnBits s = digit >>= go <?> systemName s ++ " digits"
  where go !r     = optional digit >>= \case
                      Just d  → go ((r `shiftL` digitBits) .|. d)
                      Nothing → return r
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int8 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int16 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int32 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int64 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word8 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word16 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word32 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word64 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int8 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int16 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int32 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int64 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word8 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word16 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word32 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word64 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int8 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int16 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int32 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int64 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word8 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word16 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word32 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word64 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int8 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int16 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int32 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int64 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word8 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word16 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word32 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word64 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int8 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int16 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int32 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int64 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word8 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word16 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word32 #-}
{-# SPECIALIZE nnBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word64 #-}
{-# SPECIALIZE nnBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
{-# SPECIALIZE nnBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
{-# SPECIALIZE nnBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
{-# SPECIALIZE nnBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
{-# SPECIALIZE nnBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}

-- | Parse a non-negative binary number written in the specified
--   positional numeral system. Leading zeroes are not allowed.
nncBits ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) ⇒ s → μ α
nncBits s = (<?> systemName s ++ " digits") $ digit >>= \case
              0 → optional (PC.satisfy $ isDigitIn s) >>= \case
                    Just _  → PC.unexpected "leading zero"
                    Nothing → return 0
              r → go r
  where go !r     = optional digit >>= \case
                      Just d  → go ((r `shiftL` digitBits) .|. d)
                      Nothing → return r
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int8 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int16 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int32 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int64 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word8 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word16 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word32 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word64 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int8 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int16 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int32 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int64 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word8 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word16 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word32 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word64 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int8 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int16 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int32 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int64 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word8 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word16 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word32 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word64 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int8 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int16 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int32 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int64 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word8 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word16 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word32 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word64 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int8 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int16 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int32 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int64 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word8 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word16 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word32 #-}
{-# SPECIALIZE nncBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word64 #-}
{-# SPECIALIZE nncBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
{-# SPECIALIZE nncBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
{-# SPECIALIZE nncBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
{-# SPECIALIZE nncBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
{-# SPECIALIZE nncBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}

-- | Parse a non-negative binary number written in the specified
--   positional numeral system (up to /n/ digits).
nnBitsUpTo ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
           ⇒ s → Int → μ α
nnBitsUpTo _ n | n <= 0 = empty
nnBitsUpTo s n = digit >>= go (n - 1) <?> systemName s ++ " digits"
  where go 0 !r   = optional (PC.satisfy $ isDigitIn s) >>= \case
                      Just _  → moreThan n
                      Nothing → return r
        go l !r   = optional digit >>= \case
                      Just d  → go (l - 1) ((r `shiftL` digitBits) .|. d)
                      Nothing → return r
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int8 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int16 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int32 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int64 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word8 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word16 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word32 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word64 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int8 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int16 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int32 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int64 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word8 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word16 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word32 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word64 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int8 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int16 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int32 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int64 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word8 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word16 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word32 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word64 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int8 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int16 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int32 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int64 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word8 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word16 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word32 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word64 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int8 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int16 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int32 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int64 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word8 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word16 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word32 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word64 #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → Int → μ α #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → Int → μ α #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ α #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → Int → μ α #-}
{-# SPECIALIZE nnBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → Int → μ α #-}

-- | Parse a non-negative binary number written in the specified
--   positional numeral system (up to /n/ digits). Leading zeroes are not
--   allowed.
nncBitsUpTo ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
            ⇒ s → Int → μ α
nncBitsUpTo _ n | n <= 0 = empty
nncBitsUpTo s n = (<?> systemName s ++ " digits") $ digitIn s >>= \case
                    0 → optional (PC.satisfy $ isDigitIn s) >>= \case
                          Just _  → PC.unexpected "leading zero"
                          Nothing → return 0
                    r → go (n - 1) $ fromIntegral (r ∷ Word)
  where go 0 !r   = optional (PC.satisfy $ isDigitIn s) >>= \case
                      Just _  → moreThan n
                      Nothing → return r
        go l !r   = optional digit >>= \case
                      Just d  → go (l - 1) ((r `shiftL` digitBits) .|. d)
                      Nothing → return r
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int8 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int16 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int32 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int64 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word8 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word16 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word32 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word64 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int8 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int16 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int32 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int64 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word8 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word16 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word32 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word64 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int8 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int16 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int32 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int64 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word8 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word16 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word32 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word64 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int8 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int16 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int32 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int64 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word8 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word16 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word32 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word64 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int8 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int16 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int32 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int64 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word8 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word16 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word32 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word64 #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → Int → μ α #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → Int → μ α #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ α #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → Int → μ α #-}
{-# SPECIALIZE nncBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → Int → μ α #-}

-- | Parse a non-negative binary number written in the specified
--   positional numeral system, failing on overflow.
nnbBits ∷ (BitSystem s, Ord α, Bounded α, Num α, Bits α,
           Monad μ, CharParsing μ)
        ⇒ s → μ α
nnbBits s = digit >>= go <?> systemName s ++ " digits"
  where q = maxBound `shiftR` digitBits
        r = maxBound .&. digitMaskIn s
        go !n = optional digit >>= \case
                  Just d  → if n < q || (n == q && d <= r)
                            then go ((n `shiftL` digitBits) .|. d)
                            else fail "out of bounds"
                  Nothing → return n
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int8 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int16 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int32 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int64 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word8 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word16 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word32 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word64 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int8 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int16 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int32 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int64 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word8 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word16 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word32 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word64 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int8 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int16 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int32 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int64 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word8 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word16 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word32 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word64 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int8 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int16 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int32 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int64 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word8 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word16 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word32 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word64 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int8 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int16 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int32 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int64 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word8 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word16 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word32 #-}
{-# SPECIALIZE nnbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word64 #-}
{-# SPECIALIZE nnbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
{-# SPECIALIZE nnbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
{-# SPECIALIZE nnbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
{-# SPECIALIZE nnbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
{-# SPECIALIZE nnbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}

-- | Parse a non-negative binary number written in the specified
--   positional numeral system, failing on overflow. Leading zeroes are not
--   allowed.
nncbBits ∷ (BitSystem s, Ord α, Bounded α, Num α, Bits α,
            Monad μ, CharParsing μ)
         ⇒ s → μ α
nncbBits s = (<?> systemName s ++ " digits") $ digitIn s >>= \case
               0 → optional (PC.satisfy $ isDigitIn s) >>= \case
                     Just _  → PC.unexpected "leading zero"
                     Nothing → return 0
               n → go $ fromIntegral (n ∷ Word)
  where q = maxBound `shiftR` digitBits
        r = maxBound .&. digitMaskIn s
        go !n = optional digit >>= \case
                  Just d  → if n < q || (n == q && d <= r)
                            then go ((n `shiftL` digitBits) .|. d)
                            else fail "out of bounds"
                  Nothing → return n
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int8 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int16 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int32 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int64 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word8 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word16 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word32 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word64 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int8 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int16 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int32 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int64 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word8 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word16 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word32 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word64 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int8 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int16 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int32 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int64 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word8 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word16 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word32 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word64 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int8 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int16 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int32 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int64 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word8 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word16 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word32 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word64 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int8 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int16 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int32 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int64 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word8 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word16 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word32 #-}
{-# SPECIALIZE nncbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word64 #-}
{-# SPECIALIZE nncbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
{-# SPECIALIZE nncbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
{-# SPECIALIZE nncbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
{-# SPECIALIZE nncbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
{-# SPECIALIZE nncbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}

-- | Parse a non-positive number written in the specified positional
--   numeral system. For example, parsing \"123\" as a decimal would produce
--   /-123/, not /123/.
nonPositive ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → μ α
nonPositive s = (<?> systemName s ++ " digits") $ do
                  r ← digitIn s
                  go $ fromIntegral $ negate (r ∷ Int)
  where go !r = optional digit >>= \case
                  Just d  → go (r * radix - d)
                  Nothing → return r
        radix = radixIn s
        digit = digitIn s
{-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int #-}
{-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int8 #-}
{-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int16 #-}
{-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int32 #-}
{-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int64 #-}
{-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word #-}
{-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word8 #-}
{-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word16 #-}
{-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word32 #-}
{-# SPECIALIZE nonPositive ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word64 #-}
{-# SPECIALIZE nonPositive ∷ (Num α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
{-# SPECIALIZE nonPositive ∷ (Num α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
{-# SPECIALIZE nonPositive ∷ (Num α, Monad μ, CharParsing μ) ⇒ Decimal → μ α #-}
{-# SPECIALIZE nonPositive ∷ (Num α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
{-# SPECIALIZE nonPositive ∷ (Num α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
{-# SPECIALIZE nonPositive ∷ (Num α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}

-- | Parse a non-positive number written in the specified positional
--   numeral system. Leading zeroes are not allowed.
npCompact ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → μ α
npCompact s = (<?> systemName s ++ " digits") $ digitIn s >>= \case
                0 → optional (PC.satisfy $ isDigitIn s) >>= \case
                      Just _  → PC.unexpected "leading zero"
                      Nothing → return 0
                r → go $ fromIntegral $ negate (r ∷ Int)
  where go !r = optional digit >>= \case
                  Just d  → go (r * radix - d)
                  Nothing → return r
        radix = radixIn s
        digit = digitIn s
{-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int #-}
{-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int8 #-}
{-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int16 #-}
{-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int32 #-}
{-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int64 #-}
{-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word #-}
{-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word8 #-}
{-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word16 #-}
{-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word32 #-}
{-# SPECIALIZE npCompact ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word64 #-}
{-# SPECIALIZE npCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
{-# SPECIALIZE npCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
{-# SPECIALIZE npCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ Decimal → μ α #-}
{-# SPECIALIZE npCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
{-# SPECIALIZE npCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
{-# SPECIALIZE npCompact ∷ (Num α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}

-- | Parse a non-positive number written in the specified positional
--   numeral system (up to /n/ digits).
npUpTo ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → Int → μ α
npUpTo _ n | n <= 0 = empty
npUpTo s n = (<?> systemName s ++ " digits") $ do
               r ← digitIn s
               go (n - 1) $ fromIntegral $ negate (r ∷ Int)
  where go 0 !r = optional (PC.satisfy $ isDigitIn s) >>= \case
                    Just _  → moreThan n
                    Nothing → return r
        go l !r = optional digit >>= \case
                    Just d  → go (l - 1) (r * radix - d)
                    Nothing → return r
        radix   = radixIn s
        digit   = digitIn s
{-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int #-}
{-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int8 #-}
{-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int16 #-}
{-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int32 #-}
{-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int64 #-}
{-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word #-}
{-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word8 #-}
{-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word16 #-}
{-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word32 #-}
{-# SPECIALIZE npUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word64 #-}
{-# SPECIALIZE npUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Binary → Int → μ α #-}
{-# SPECIALIZE npUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Octal → Int → μ α #-}
{-# SPECIALIZE npUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Decimal → Int → μ α #-}
{-# SPECIALIZE npUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ α #-}
{-# SPECIALIZE npUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ LowHex → Int → μ α #-}
{-# SPECIALIZE npUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ UpHex → Int → μ α #-}

-- | Parse a non-positive number written in the specified positional
--   numeral system (up to /n/ digits). Leading zeroes are not allowed.
npcUpTo ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → Int → μ α
npcUpTo _ n | n <= 0 = empty
npcUpTo s n = (<?> systemName s ++ " digits") $ digitIn s >>= \case
                0 → optional (PC.satisfy $ isDigitIn s) >>= \case
                      Just _  → PC.unexpected "leading zero"
                      Nothing → return 0
                r → go (n - 1) $ fromIntegral $ negate (r ∷ Int)
  where go 0 !r = optional (PC.satisfy $ isDigitIn s) >>= \case
                    Just _  → moreThan n
                    Nothing → return r
        go l !r = optional digit >>= \case
                    Just d  → go (l - 1) (r * radix - d)
                    Nothing → return r
        radix   = radixIn s
        digit   = digitIn s
{-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int #-}
{-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int8 #-}
{-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int16 #-}
{-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int32 #-}
{-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Int64 #-}
{-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word #-}
{-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word8 #-}
{-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word16 #-}
{-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word32 #-}
{-# SPECIALIZE npcUpTo ∷ (Monad μ, CharParsing μ) ⇒ Decimal → Int → μ Word64 #-}
{-# SPECIALIZE npcUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Binary → Int → μ α #-}
{-# SPECIALIZE npcUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Octal → Int → μ α #-}
{-# SPECIALIZE npcUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Decimal → Int → μ α #-}
{-# SPECIALIZE npcUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ α #-}
{-# SPECIALIZE npcUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ LowHex → Int → μ α #-}
{-# SPECIALIZE npcUpTo ∷ (Num α, Monad μ, CharParsing μ) ⇒ UpHex → Int → μ α #-}

-- | Parse a non-positive number written in the specified positional
--   numeral system, failing on overflow.
npBounded ∷ (PositionalSystem s, Ord α, Bounded α, Integral α,
             Monad μ, CharParsing μ)
          ⇒ s → μ α
npBounded s = (<?> systemName s ++ " digits") $ do
                n ← digitIn s
                go $ fromIntegral $ negate (n ∷ Int)
  where (q, r1) = quotRem minBound radix
        !r      = negate r1
        go !n   = optional digit >>= \case
                    Just d  → if n > q || (n == q && d <= r)
                              then go (n * radix - d)
                              else fail "out of bounds"
                    Nothing → return n
        radix   = radixIn s
        digit   = digitIn s
{-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int #-}
{-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int8 #-}
{-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int16 #-}
{-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int32 #-}
{-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int64 #-}
{-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word #-}
{-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word8 #-}
{-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word16 #-}
{-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word32 #-}
{-# SPECIALIZE npBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word64 #-}
{-# SPECIALIZE npBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
{-# SPECIALIZE npBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
{-# SPECIALIZE npBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Decimal → μ α #-}
{-# SPECIALIZE npBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
{-# SPECIALIZE npBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
{-# SPECIALIZE npBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}

-- | Parse a non-positive number written in the specified positional
--   numeral system, failing on overflow. Leading zeroes are not allowed.
npcBounded ∷ (PositionalSystem s, Ord α, Bounded α, Integral α,
              Monad μ, CharParsing μ)
           ⇒ s → μ α
npcBounded s = (<?> systemName s ++ " digits") $ digitIn s >>= \case
                 0 → optional (PC.satisfy $ isDigitIn s) >>= \case
                       Just _  → PC.unexpected "leading zero"
                       Nothing → return 0
                 n → go $ fromIntegral $ negate (n ∷ Int)
  where (q, r1) = quotRem minBound radix
        !r      = negate r1
        go !n   = optional digit >>= \case
                    Just d  → if n > q || (n == q && d <= r)
                              then go (n * radix - d)
                              else fail "out of bounds"
                    Nothing → return n
        radix   = radixIn s
        digit   = digitIn s
{-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int #-}
{-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int8 #-}
{-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int16 #-}
{-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int32 #-}
{-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Int64 #-}
{-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word #-}
{-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word8 #-}
{-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word16 #-}
{-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word32 #-}
{-# SPECIALIZE npcBounded ∷ (Monad μ, CharParsing μ) ⇒ Decimal → μ Word64 #-}
{-# SPECIALIZE npcBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
{-# SPECIALIZE npcBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
{-# SPECIALIZE npcBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Decimal → μ α #-}
{-# SPECIALIZE npcBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
{-# SPECIALIZE npcBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
{-# SPECIALIZE npcBounded ∷ (Bounded α, Integral α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}

-- | Parse a non-positive two\'s complement binary number written in
--   the specified positional numeral system.
npBits ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) ⇒ s → μ α
npBits s = (<?> systemName s ++ " digits") $ do
             r ← digit
             go $ fromIntegral $ negate (r ∷ Int)
  where go !r     = optional digit >>= \case
                      Just d1 → go ((r `shiftL` digitBits) + d)
                        where !d = fromIntegral $ negate d1
                      Nothing → return r
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int8 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int16 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int32 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int64 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word8 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word16 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word32 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word64 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int8 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int16 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int32 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int64 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word8 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word16 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word32 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word64 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int8 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int16 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int32 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int64 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word8 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word16 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word32 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word64 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int8 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int16 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int32 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int64 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word8 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word16 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word32 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word64 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int8 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int16 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int32 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int64 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word8 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word16 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word32 #-}
{-# SPECIALIZE npBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word64 #-}
{-# SPECIALIZE npBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
{-# SPECIALIZE npBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
{-# SPECIALIZE npBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
{-# SPECIALIZE npBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
{-# SPECIALIZE npBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}

-- | Parse a non-positive two\'s complement binary number written in
--   the specified positional numeral system (up to /n/ digits).
npBitsUpTo ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
           ⇒ s → Int → μ α
npBitsUpTo _ n | n <= 0 = empty
npBitsUpTo s n = (<?> systemName s ++ " digits") $ do
                   r ← digit
                   go (n - 1) $ fromIntegral $ negate (r ∷ Int)
  where go 0 !r   = optional (PC.satisfy $ isDigitIn s) >>= \case
                      Just _  → moreThan n
                      Nothing → return r
        go l !r   = optional digit >>= \case
                      Just d1 → go (l - 1) ((r `shiftL` digitBits) + d)
                        where !d = fromIntegral $ negate d1
                      Nothing → return r
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int8 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int16 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int32 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int64 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word8 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word16 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word32 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word64 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int8 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int16 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int32 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int64 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word8 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word16 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word32 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word64 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int8 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int16 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int32 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int64 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word8 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word16 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word32 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word64 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int8 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int16 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int32 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int64 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word8 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word16 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word32 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word64 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int8 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int16 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int32 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int64 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word8 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word16 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word32 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word64 #-}
{-# SPECIALIZE npBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → Int → μ α #-}
{-# SPECIALIZE npBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → Int → μ α #-}
{-# SPECIALIZE npBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ α #-}
{-# SPECIALIZE npBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → Int → μ α #-}
{-# SPECIALIZE npBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → Int → μ α #-}

-- | Parse a non-positive two\'s complement binary number written in
--   the specified positional numeral system. Leading zeroes are not allowed.
npcBits ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) ⇒ s → μ α
npcBits s = (<?> systemName s ++ " digits") $ digit >>= \case
              0 → optional (PC.satisfy $ isDigitIn s) >>= \case
                    Just _  → PC.unexpected "leading zero"
                    Nothing → return 0
              r → go $ fromIntegral $ negate (r ∷ Int)
  where go !r     = optional digit >>= \case
                      Just d1 → go ((r `shiftL` digitBits) + d)
                        where !d = fromIntegral $ negate d1
                      Nothing → return r
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int8 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int16 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int32 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int64 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word8 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word16 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word32 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word64 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int8 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int16 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int32 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int64 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word8 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word16 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word32 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word64 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int8 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int16 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int32 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int64 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word8 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word16 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word32 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word64 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int8 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int16 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int32 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int64 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word8 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word16 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word32 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word64 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int8 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int16 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int32 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int64 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word8 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word16 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word32 #-}
{-# SPECIALIZE npcBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word64 #-}
{-# SPECIALIZE npcBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
{-# SPECIALIZE npcBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
{-# SPECIALIZE npcBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
{-# SPECIALIZE npcBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
{-# SPECIALIZE npcBits ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}

-- | Parse a non-positive two\'s complement binary number written in
--   the specified positional numeral system (up to /n/ digits).
--   Leading zeroes are not allowed.
npcBitsUpTo ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
            ⇒ s → Int → μ α
npcBitsUpTo _ n | n <= 0 = empty
npcBitsUpTo s n = (<?> systemName s ++ " digits") $ digit >>= \case
                    0 → optional (PC.satisfy $ isDigitIn s) >>= \case
                          Just _  → PC.unexpected "leading zero"
                          Nothing → return 0
                    r → go (n - 1) $ fromIntegral $ negate (r ∷ Int)
  where go 0 !r   = optional (PC.satisfy $ isDigitIn s) >>= \case
                      Just _  → moreThan n
                      Nothing → return r
        go l !r   = optional digit >>= \case
                      Just d1 → go (l - 1) ((r `shiftL` digitBits) + d)
                        where !d = fromIntegral $ negate d1
                      Nothing → return r
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int8 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int16 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int32 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Int64 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word8 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word16 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word32 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Binary → Int → μ Word64 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int8 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int16 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int32 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Int64 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word8 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word16 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word32 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Octal → Int → μ Word64 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int8 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int16 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int32 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Int64 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word8 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word16 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word32 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ Word64 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int8 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int16 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int32 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Int64 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word8 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word16 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word32 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ LowHex → Int → μ Word64 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int8 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int16 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int32 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Int64 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word8 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word16 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word32 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Monad μ, CharParsing μ) ⇒ UpHex → Int → μ Word64 #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → Int → μ α #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → Int → μ α #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → Int → μ α #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → Int → μ α #-}
{-# SPECIALIZE npcBitsUpTo ∷ (Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → Int → μ α #-}

-- | Parse a non-positive two\'s complement binary number written in
--   the specified positional numeral system, failing on overflow.
npbBits ∷ ∀ s μ α
        . (BitSystem s, Ord α, Bounded α, Num α, Bits α,
           Monad μ, CharParsing μ)
        ⇒ s → μ α
npbBits s = (<?> systemName s ++ " digits") $ do
              n ← digit
              go $ fromIntegral $ negate (n ∷ Int)
  where q1 = minBound `shiftR` digitBits
        r  = negate (lastDigitIn s (minBound ∷ α)) .&. digitMaskIn s
        q  = if r == 0 then q1 else q1 + 1
        go !n     = optional digit >>= \case
                      Just d1 → if n > q || (n == q && d1 <= r)
                                then go ((n `shiftL` digitBits) + d)
                                else fail "out of bounds"
                        where !d = fromIntegral $ negate d1
                      Nothing → return n
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int8 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int16 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int32 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int64 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word8 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word16 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word32 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word64 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int8 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int16 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int32 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int64 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word8 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word16 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word32 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word64 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int8 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int16 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int32 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int64 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word8 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word16 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word32 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word64 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int8 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int16 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int32 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int64 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word8 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word16 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word32 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word64 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int8 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int16 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int32 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int64 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word8 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word16 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word32 #-}
{-# SPECIALIZE npbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word64 #-}
{-# SPECIALIZE npbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
{-# SPECIALIZE npbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
{-# SPECIALIZE npbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
{-# SPECIALIZE npbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
{-# SPECIALIZE npbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}

-- | Parse a non-positive two\'s complement binary number written in
--   the specified positional numeral system, failing on overflow.
--   Leading zeroes are not allowed.
npcbBits ∷ ∀ s μ α
         . (BitSystem s, Ord α, Bounded α, Num α, Bits α,
            Monad μ, CharParsing μ)
        ⇒ s → μ α
npcbBits s = (<?> systemName s ++ " digits") $ digit >>= \case
               0 → optional (PC.satisfy $ isDigitIn s) >>= \case
                     Just _  → PC.unexpected "leading zero"
                     Nothing → return 0
               n → go $ fromIntegral $ negate (n ∷ Int)
  where q1 = minBound `shiftR` digitBits
        r  = negate (lastDigitIn s (minBound ∷ α)) .&. digitMaskIn s
        q  = if r == 0 then q1 else q1 + 1
        go !n     = optional digit >>= \case
                      Just d1 → if n > q || (n == q && d1 <= r)
                                then go ((n `shiftL` digitBits) + d)
                                else fail "out of bounds"
                        where !d = fromIntegral $ negate d1
                      Nothing → return n
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int8 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int16 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int32 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Int64 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word8 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word16 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word32 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Binary → μ Word64 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int8 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int16 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int32 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Int64 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word8 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word16 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word32 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Octal → μ Word64 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int8 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int16 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int32 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Int64 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word8 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word16 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word32 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ Hexadecimal → μ Word64 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int8 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int16 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int32 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Int64 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word8 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word16 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word32 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ LowHex → μ Word64 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int8 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int16 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int32 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Int64 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word8 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word16 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word32 #-}
{-# SPECIALIZE npcbBits ∷ (Monad μ, CharParsing μ) ⇒ UpHex → μ Word64 #-}
{-# SPECIALIZE npcbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Binary → μ α #-}
{-# SPECIALIZE npcbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Octal → μ α #-}
{-# SPECIALIZE npcbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ Hexadecimal → μ α #-}
{-# SPECIALIZE npcbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ LowHex → μ α #-}
{-# SPECIALIZE npcbBits ∷ (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) ⇒ UpHex → μ α #-}

-- | Sign of a number.
data Sign = NonNegative | NonPositive
            deriving (Typeable, Eq, Show, Read)

-- | Negate the supplied value if the sign is 'NonPositive' and return it
--   as it is otherwise.
applySign ∷ Num α ⇒ Sign → α → α
applySign NonNegative a = a
applySign NonPositive a = negate a

-- | Optional minus sign.
optMinus ∷ CharParsing μ ⇒ μ Sign
optMinus  =  (pure NonPositive <* PC.char '-') <|> pure NonNegative
         <?> "optional minus sign"
{-# INLINE optMinus #-}

-- | Optional minus or plus sign.
optSign ∷ CharParsing μ ⇒ μ Sign
optSign  =  (pure NonPositive <* PC.char '-')
        <|> (pure NonNegative <* PC.char '+')
        <|> pure NonNegative
        <?> "optional sign"
{-# INLINABLE optSign #-}

-- | Parse a number written in the specified positional numeral system.
--   The supplied parser is used to determine the sign of the number.
number' ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ)
        ⇒ μ Sign → s → μ α
number' neg s = (<?> systemName s) $ neg >>= \case
  NonNegative → nonNegative s
  NonPositive → nonPositive s
{-# INLINE number' #-}

-- | A shorthand for 'number'' 'optMinus'.
number ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → μ α
number = number' optMinus
{-# INLINE number #-}

-- | Parse a number written in the specified positional numeral system.
--   The supplied parser is used to determine the sign of the number.
--   Leading zeroes are not allowed.
compact' ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ)
         ⇒ μ Sign → s → μ α
compact' neg s = (<?> systemName s) $ neg >>= \case
  NonNegative → nnCompact s
  NonPositive → npCompact s
{-# INLINE compact' #-}

-- | A shorthand for 'compact'' 'optMinus'.
compact ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ) ⇒ s → μ α
compact = compact' optMinus
{-# INLINE compact #-}

-- | Parse a number written in the specified positional numeral system
--   (up to /n/ digits). The supplied parser is used to determine the sign of
--   the number.
numberUpTo' ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ)
            ⇒ μ Sign → s → Int → μ α
numberUpTo' neg s n = (<?> systemName s) $ neg >>= \case
  NonNegative → nnUpTo s n
  NonPositive → npUpTo s n
{-# INLINE numberUpTo' #-}

-- | A shorthand for 'numberUpTo'' 'optMinus'.
numberUpTo ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ)
           ⇒ s → Int → μ α
numberUpTo = numberUpTo' optMinus
{-# INLINE numberUpTo #-}

-- | Parse a number written in the specified positional numeral system
--   (up to /n/ digits). The supplied parser is used to determine the sign of
--   the number. Leading zeroes are not allowed.
compactUpTo' ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ)
             ⇒ μ Sign → s → Int → μ α
compactUpTo' neg s n = (<?> systemName s) $ neg >>= \case
  NonNegative → nncUpTo s n
  NonPositive → npcUpTo s n
{-# INLINE compactUpTo' #-}

-- | A shorthand for 'compactUpTo'' 'optMinus'.
compactUpTo ∷ (PositionalSystem s, Num α, Monad μ, CharParsing μ)
           ⇒ s → Int → μ α
compactUpTo = compactUpTo' optMinus
{-# INLINE compactUpTo #-}

-- | Parse a number written in the specified positional numeral system,
--   failing on overflow. The supplied parser is used to determine the sign
--   of the number.
bounded' ∷ (PositionalSystem s, Ord α, Bounded α, Integral α,
            Monad μ, CharParsing μ)
         ⇒ μ Sign → s → μ α
bounded' neg s = (<?> systemName s) $ neg >>= \case
  NonNegative → nnBounded s
  NonPositive → npBounded s
{-# INLINE bounded' #-}

-- | A shorthand for 'bounded'' 'optMinus'.
bounded ∷ (PositionalSystem s, Ord α, Bounded α, Integral α,
           Monad μ, CharParsing μ) ⇒ s → μ α
bounded = bounded' optMinus
{-# INLINE bounded #-}

-- | Parse a number written in the specified positional numeral system,
--   failing on overflow. The supplied parser is used to determine the sign
--   of the number. Leading zeroes are not allowed.
cBounded' ∷ (PositionalSystem s, Ord α, Bounded α, Integral α,
             Monad μ, CharParsing μ)
          ⇒ μ Sign → s → μ α
cBounded' neg s = (<?> systemName s) $ neg >>= \case
  NonNegative → nncBounded s
  NonPositive → npcBounded s
{-# INLINE cBounded' #-}

-- | A shorthand for 'cBounded'' 'optMinus'.
cBounded ∷ (PositionalSystem s, Ord α, Bounded α, Integral α,
            Monad μ, CharParsing μ) ⇒ s → μ α
cBounded = cBounded' optMinus
{-# INLINE cBounded #-}

-- | Parse a (two\'s complement) binary number written in the specified
--   positional numeral system. The supplied parser is used to determine
--   the sign of the number.
bits' ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
      ⇒ μ Sign → s → μ α
bits' neg s = (<?> systemName s) $ neg >>= \case
  NonNegative → nnBits s
  NonPositive → npBits s
{-# INLINE bits' #-}

-- | A shorthand for 'bits'' 'optMinus'.
bits ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) ⇒ s → μ α
bits = bits' optMinus
{-# INLINE bits #-}

-- | Parse a (two\'s complement) binary number written in the specified
--   positional numeral system. The supplied parser is used to determine
--   the sign of the number. Leading zeroes are not allowed.
cBits' ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
       ⇒ μ Sign → s → μ α
cBits' neg s = (<?> systemName s) $ neg >>= \case
  NonNegative → nncBits s
  NonPositive → npcBits s
{-# INLINE cBits' #-}

-- | A shorthand for 'cBits'' 'optMinus'.
cBits ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) ⇒ s → μ α
cBits = cBits' optMinus
{-# INLINE cBits #-}

-- | Parse a (two\'s complement) binary number written in the specified
--   positional numeral system (up to /n/ digits). The supplied parser is
--   used to determine the sign of the number.
bitsUpTo' ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
          ⇒ μ Sign → s → Int → μ α
bitsUpTo' neg s n = (<?> systemName s) $ neg >>= \case
  NonNegative → nnBitsUpTo s n
  NonPositive → npBitsUpTo s n
{-# INLINE bitsUpTo' #-}

-- | A shorthand for 'bitsUpTo'' 'optMinus'.
bitsUpTo ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
         ⇒ s → Int → μ α
bitsUpTo = bitsUpTo' optMinus
{-# INLINE bitsUpTo #-}

-- | Parse a (two\'s complement) binary number written in the specified
--   positional numeral system (up to /n/ digits). The supplied parser is
--   used to determine the sign of the number. Leading zeroes are not
--   allowed.
cBitsUpTo' ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
           ⇒ μ Sign → s → Int → μ α
cBitsUpTo' neg s n = (<?> systemName s) $ neg >>= \case
  NonNegative → nncBitsUpTo s n
  NonPositive → npcBitsUpTo s n
{-# INLINE cBitsUpTo' #-}

-- | A shorthand for 'cBitsUpTo'' 'optMinus'.
cBitsUpTo ∷ (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
          ⇒ s → Int → μ α
cBitsUpTo = cBitsUpTo' optMinus
{-# INLINE cBitsUpTo #-}

-- | Parse a (two\'s complement) binary number written in the specified
--   positional numeral system, failing on overflow. The supplied parser is
--   used to determine the sign of the number.
bBits' ∷ (BitSystem s, Ord α, Bounded α, Num α, Bits α,
          Monad μ, CharParsing μ)
       ⇒ μ Sign → s → μ α
bBits' neg s = (<?> systemName s) $ neg >>= \case
  NonNegative → nnbBits s
  NonPositive → npbBits s
{-# INLINE bBits' #-}

-- | A shorthand for 'bBits'' 'optMinus'.
bBits ∷ (BitSystem s, Ord α, Bounded α, Num α, Bits α,
         Monad μ, CharParsing μ)
      ⇒ s → μ α
bBits = bBits' optMinus
{-# INLINE bBits #-}

-- | Parse a (two\'s complement) binary number written in the specified
--   positional numeral system, failing on overflow. The supplied parser is
--   used to determine the sign of the number. Leading zeroes are not
--   allowed.
cbBits' ∷ (BitSystem s, Ord α, Bounded α, Num α, Bits α,
           Monad μ, CharParsing μ)
        ⇒ μ Sign → s → μ α
cbBits' neg s = (<?> systemName s) $ neg >>= \case
  NonNegative → nncbBits s
  NonPositive → npcbBits s
{-# INLINE cbBits' #-}

-- | A shorthand for 'cbBits'' 'optMinus'.
cbBits ∷ (BitSystem s, Ord α, Bounded α, Num α, Bits α,
          Monad μ, CharParsing μ)
       ⇒ s → μ α
cbBits = cbBits' optMinus
{-# INLINE cbBits #-}

</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE UnicodeSyntax #-}
{-# LANGUAGE DeriveDataTypeable #-}
{-# LANGUAGE BangPatterns #-}
{-# LANGUAGE LambdaCase #-}
{-# LANGUAGE ScopedTypeVariables #-}

-- | Parsers for integral numbers written in positional numeral systems.
module Data.Textual.Integral
  (
  -- * Positional numeral systems
    PositionalSystem(..)
  , BitSystem(..)
  , Binary(..)
  , Octal(..)
  , Decimal(..)
  , Hexadecimal(..)
  , LowHex(..)
  , UpHex(..)
  -- * Single digits
  , digitIn
  , nzDigitIn
  , binDigit
  , nzBinDigit
  , octDigit
  , nzOctDigit
  , decDigit
  , nzDecDigit
  , hexDigit
  , nzHexDigit
  , lowHexDigit
  , nzLowHexDigit
  , upHexDigit
  , nzUpHexDigit
  -- * Numbers
  , nonNegative
  , nnCompact
  , nnUpTo
  , nncUpTo
  , nnBounded
  , nncBounded
  , nnBits
  , nncBits
  , nnBitsUpTo
  , nncBitsUpTo
  , nnbBits
  , nncbBits
  , nonPositive
  , npCompact
  , npUpTo
  , npcUpTo
  , npBounded
  , npcBounded
  , npBits
  , npcBits
  , npBitsUpTo
  , npcBitsUpTo
  , npbBits
  , npcbBits
  , Sign(..)
  , applySign
  , optMinus
  , optSign
  , number'
  , number
  , compact'
  , compact
  , numberUpTo'
  , numberUpTo
  , compactUpTo'
  , compactUpTo
  , bounded'
  , bounded
  , cBounded'
  , cBounded
  , bits'
  , bits
  , cBits'
  , cBits
  , bitsUpTo'
  , bitsUpTo
  , cBitsUpTo'
  , cBitsUpTo
  , bBits'
  , bBits
  , cbBits'
  , cbBits
  ) where

import Data.Typeable (Typeable)
import Data.Int
import Data.Word
import Data.Bits (Bits(..))
import Control.Applicative
import Text.Printer.Integral (
         PositionalSystem(..), BitSystem(..),
         Binary(..), Octal(..), Decimal(..), Hexadecimal(..),
         LowHex(..), UpHex(..))
import Text.Parser.Combinators ((<?>))
import qualified Text.Parser.Combinators as PC
import Text.Parser.Char (CharParsing)
import qualified Text.Parser.Char as PC

-- | Parse a digit of the specified positional numeral system.
digitIn :: (PositionalSystem s, Num α, CharParsing μ) => s -> μ α
digitIn s  =  unsafeFromDigitIn s <$> PC.satisfy (isDigitIn s)
          <?> systemName s ++ " digit"
{-# INLINE digitIn #-}

-- | Parse a non-zero digit of the specified positional numeral system.
nzDigitIn :: (PositionalSystem s, Num α, CharParsing μ) => s -> μ α
nzDigitIn s  =  unsafeFromDigitIn s <$> PC.satisfy (isNzDigitIn s)
            <?> "non-zero " ++ systemName s ++ " digit"
{-# INLINE nzDigitIn #-}

-- | Parse a binary digit.
binDigit :: (Num α, CharParsing μ) => μ α
binDigit = digitIn Binary
{-# INLINE binDigit #-}

-- | Parse a non-zero binary digit (/'1'/).
nzBinDigit :: (Num α, CharParsing μ) => μ α
nzBinDigit = nzDigitIn Binary
{-# INLINE nzBinDigit #-}

-- | Parse a decimal digit.
decDigit :: (Num α, CharParsing μ) => μ α
decDigit = digitIn Decimal
{-# INLINE decDigit #-}

-- | Parse a non-zero decimal digit.
nzDecDigit :: (Num α, CharParsing μ) => μ α
nzDecDigit = nzDigitIn Decimal
{-# INLINE nzDecDigit #-}

-- | Parse an octal digit.
octDigit :: (Num α, CharParsing μ) => μ α
octDigit = digitIn Octal
{-# INLINE octDigit #-}

-- | Parse a non-zero octal digit.
nzOctDigit :: (Num α, CharParsing μ) => μ α
nzOctDigit = nzDigitIn Octal
{-# INLINE nzOctDigit #-}

-- | Parse a hexadecimal digit.
hexDigit :: (Num α, CharParsing μ) => μ α
hexDigit = digitIn Hexadecimal
{-# INLINE hexDigit #-}

-- | Parse a non-zero hexadecimal digit.
nzHexDigit :: (Num α, CharParsing μ) => μ α
nzHexDigit = nzDigitIn Hexadecimal
{-# INLINE nzHexDigit #-}

-- | Parse a lower case hexadecimal digit.
lowHexDigit :: (Num α, CharParsing μ) => μ α
lowHexDigit = digitIn LowHex
{-# INLINE lowHexDigit #-}

-- | Parse a non-zero lower case hexadecimal digit.
nzLowHexDigit :: (Num α, CharParsing μ) => μ α
nzLowHexDigit = nzDigitIn LowHex
{-# INLINE nzLowHexDigit #-}

-- | Parse an upper case hexadecimal digit.
upHexDigit :: (Num α, CharParsing μ) => μ α
upHexDigit = digitIn UpHex
{-# INLINE upHexDigit #-}

-- | Parse a non-zero upper case hexadecimal digit.
nzUpHexDigit :: (Num α, CharParsing μ) => μ α
nzUpHexDigit = nzDigitIn UpHex
{-# INLINE nzUpHexDigit #-}

-- | Parse a non-negative number written in the specified positional
--   numeral system.
nonNegative :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> μ α
nonNegative s = digit >>= go <?> systemName s ++ " digits"
  where go !r = optional digit >>= 
                  Just d  -> go (r * radix + d)
                  Nothing -> return r
        radix = radixIn s
        digit = digitIn s
{-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Int #-}
{-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Int8 #-}
{-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Int16 #-}
{-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Int32 #-}
{-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Int64 #-}
{-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Word #-}
{-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Word8 #-}
{-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Word16 #-}
{-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Word32 #-}
{-# SPECIALIZE nonNegative :: (Monad μ, CharParsing μ) => Decimal -> μ Word64 #-}
{-# SPECIALIZE nonNegative :: (Num α, Monad μ, CharParsing μ) => Binary -> μ α #-}
{-# SPECIALIZE nonNegative :: (Num α, Monad μ, CharParsing μ) => Octal -> μ α #-}
{-# SPECIALIZE nonNegative :: (Num α, Monad μ, CharParsing μ) => Decimal -> μ α #-}
{-# SPECIALIZE nonNegative :: (Num α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
{-# SPECIALIZE nonNegative :: (Num α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
{-# SPECIALIZE nonNegative :: (Num α, Monad μ, CharParsing μ) => UpHex -> μ α #-}

-- | Parse a non-negative number written in the specified positional
--   numeral system. Leading zeroes are not allowed.
nnCompact :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> μ α
nnCompact s = (<?> systemName s ++ " digits") $ digitIn s >>= 
                0 -> optional (PC.satisfy $ isDigitIn s) >>= 
                      Just _  -> PC.unexpected "leading zero"
                      Nothing -> return 0
                r -> go $ fromIntegral (r :: Word)
  where go !r = optional digit >>= 
                  Just d  -> go (r * radix + d)
                  Nothing -> return r
        radix = radixIn s
        digit = digitIn s
{-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int #-}
{-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int8 #-}
{-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int16 #-}
{-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int32 #-}
{-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int64 #-}
{-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word #-}
{-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word8 #-}
{-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word16 #-}
{-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word32 #-}
{-# SPECIALIZE nnCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word64 #-}
{-# SPECIALIZE nnCompact :: (Num α, Monad μ, CharParsing μ) => Binary -> μ α #-}
{-# SPECIALIZE nnCompact :: (Num α, Monad μ, CharParsing μ) => Octal -> μ α #-}
{-# SPECIALIZE nnCompact :: (Num α, Monad μ, CharParsing μ) => Decimal -> μ α #-}
{-# SPECIALIZE nnCompact :: (Num α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
{-# SPECIALIZE nnCompact :: (Num α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
{-# SPECIALIZE nnCompact :: (Num α, Monad μ, CharParsing μ) => UpHex -> μ α #-}

moreThan :: CharParsing μ => Int -> μ α
moreThan n = PC.unexpected
           $ "more than " ++ show n ++
             case n of
               1 -> " digit"
               _ -> " digits"
{-# INLINE moreThan #-}

-- | Parse a non-negative number written in the specified positional
--   numeral system (up to /n/ digits).
nnUpTo :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> Int -> μ α
nnUpTo _ n | n <= 0 = empty
nnUpTo s n = digit >>= go (n - 1) <?> systemName s ++ " digits"
  where go 0 !r = optional (PC.satisfy $ isDigitIn s) >>= 
                    Just _  -> moreThan n
                    Nothing -> return r
        go l !r = optional digit >>= 
                    Just d  -> go (l - 1) (r * radix + d)
                    Nothing -> return r
        radix   = radixIn s
        digit   = digitIn s
{-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int #-}
{-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int8 #-}
{-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int16 #-}
{-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int32 #-}
{-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int64 #-}
{-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word #-}
{-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word8 #-}
{-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word16 #-}
{-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word32 #-}
{-# SPECIALIZE nnUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word64 #-}
{-# SPECIALIZE nnUpTo :: (Num α, Monad μ, CharParsing μ) => Binary -> Int -> μ α #-}
{-# SPECIALIZE nnUpTo :: (Num α, Monad μ, CharParsing μ) => Octal -> Int -> μ α #-}
{-# SPECIALIZE nnUpTo :: (Num α, Monad μ, CharParsing μ) => Decimal -> Int -> μ α #-}
{-# SPECIALIZE nnUpTo :: (Num α, Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ α #-}
{-# SPECIALIZE nnUpTo :: (Num α, Monad μ, CharParsing μ) => LowHex -> Int -> μ α #-}
{-# SPECIALIZE nnUpTo :: (Num α, Monad μ, CharParsing μ) => UpHex -> Int -> μ α #-}

-- | Parse a non-negative number written in the specified positional
--   numeral system (up to /n/ digits). Leading zeroes are not allowed.
nncUpTo :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> Int -> μ α
nncUpTo _ n | n <= 0 = empty
nncUpTo s n = (<?> systemName s ++ " digits") $ digitIn s >>= 
                0 -> optional (PC.satisfy $ isDigitIn s) >>= 
                      Just _  -> PC.unexpected "leading zero"
                      Nothing -> return 0
                r -> go (n - 1) $ fromIntegral (r :: Word)
  where go 0 !r = optional (PC.satisfy $ isDigitIn s) >>= 
                    Just _  -> moreThan n
                    Nothing -> return r
        go l !r = optional digit >>= 
                    Just d  -> go (l - 1) (r * radix + d)
                    Nothing -> return r
        radix   = radixIn s
        digit   = digitIn s
{-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int #-}
{-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int8 #-}
{-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int16 #-}
{-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int32 #-}
{-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int64 #-}
{-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word #-}
{-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word8 #-}
{-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word16 #-}
{-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word32 #-}
{-# SPECIALIZE nncUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word64 #-}
{-# SPECIALIZE nncUpTo :: (Num α, Monad μ, CharParsing μ) => Binary -> Int -> μ α #-}
{-# SPECIALIZE nncUpTo :: (Num α, Monad μ, CharParsing μ) => Octal -> Int -> μ α #-}
{-# SPECIALIZE nncUpTo :: (Num α, Monad μ, CharParsing μ) => Decimal -> Int -> μ α #-}
{-# SPECIALIZE nncUpTo :: (Num α, Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ α #-}
{-# SPECIALIZE nncUpTo :: (Num α, Monad μ, CharParsing μ) => LowHex -> Int -> μ α #-}
{-# SPECIALIZE nncUpTo :: (Num α, Monad μ, CharParsing μ) => UpHex -> Int -> μ α #-}

-- | Parse a non-negative number written in the specified positional
--   numeral system, failing on overflow.
nnBounded :: (PositionalSystem s, Ord α, Bounded α, Integral α,
             Monad μ, CharParsing μ) => s -> μ α
nnBounded s = digit >>= go <?> systemName s ++ " digits"
  where (q, r) = quotRem maxBound radix
        go !n  = optional digit >>= 
                   Just n1 -> if n < q || (n == q && n1 <= r)
                             then go (n * radix + n1)
                             else fail "out of bounds"
                   Nothing -> return n
        radix  = radixIn s
        digit  = digitIn s
{-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int #-}
{-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int8 #-}
{-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int16 #-}
{-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int32 #-}
{-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int64 #-}
{-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word #-}
{-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word8 #-}
{-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word16 #-}
{-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word32 #-}
{-# SPECIALIZE nnBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word64 #-}
{-# SPECIALIZE nnBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Binary -> μ α #-}
{-# SPECIALIZE nnBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Octal -> μ α #-}
{-# SPECIALIZE nnBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Decimal -> μ α #-}
{-# SPECIALIZE nnBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
{-# SPECIALIZE nnBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
{-# SPECIALIZE nnBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => UpHex -> μ α #-}

-- | Parse a non-negative number written in the specified positional
--   numeral system, failing on overflow. Leading zeroes are not allowed.
nncBounded :: (PositionalSystem s, Ord α, Bounded α, Integral α,
              Monad μ, CharParsing μ) => s -> μ α
nncBounded s = (<?> systemName s ++ " digits") $ digit >>= 
                 0 -> optional (PC.satisfy $ isDigitIn s) >>= 
                       Just _  -> PC.unexpected "leading zero"
                       Nothing -> return 0
                 n -> go n
  where (q, r) = quotRem maxBound radix
        go !n  = optional digit >>= 
                   Just d  -> if n < q || (n == q && d <= r)
                             then go (n * radix + d)
                             else fail "out of bounds"
                   Nothing -> return n
        radix  = radixIn s
        digit  = digitIn s
{-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int #-}
{-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int8 #-}
{-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int16 #-}
{-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int32 #-}
{-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int64 #-}
{-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word #-}
{-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word8 #-}
{-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word16 #-}
{-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word32 #-}
{-# SPECIALIZE nncBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word64 #-}
{-# SPECIALIZE nncBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Binary -> μ α #-}
{-# SPECIALIZE nncBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Octal -> μ α #-}
{-# SPECIALIZE nncBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Decimal -> μ α #-}
{-# SPECIALIZE nncBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
{-# SPECIALIZE nncBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
{-# SPECIALIZE nncBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => UpHex -> μ α #-}

-- | Parse a non-negative binary number written in the specified
--   positional numeral system.
nnBits :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) => s -> μ α
nnBits s = digit >>= go <?> systemName s ++ " digits"
  where go !r     = optional digit >>= 
                      Just d  -> go ((r `shiftL` digitBits) .|. d)
                      Nothing -> return r
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Int #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Int8 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Int16 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Int32 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Int64 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Word #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Word8 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Word16 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Word32 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Binary -> μ Word64 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Int #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Int8 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Int16 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Int32 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Int64 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Word #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Word8 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Word16 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Word32 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Octal -> μ Word64 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int8 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int16 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int32 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int64 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word8 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word16 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word32 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word64 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int8 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int16 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int32 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int64 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word8 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word16 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word32 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word64 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int8 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int16 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int32 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int64 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word8 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word16 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word32 #-}
{-# SPECIALIZE nnBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word64 #-}
{-# SPECIALIZE nnBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Binary -> μ α #-}
{-# SPECIALIZE nnBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Octal -> μ α #-}
{-# SPECIALIZE nnBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
{-# SPECIALIZE nnBits :: (Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
{-# SPECIALIZE nnBits :: (Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> μ α #-}

-- | Parse a non-negative binary number written in the specified
--   positional numeral system. Leading zeroes are not allowed.
nncBits :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) => s -> μ α
nncBits s = (<?> systemName s ++ " digits") $ digit >>= 
              0 -> optional (PC.satisfy $ isDigitIn s) >>= 
                    Just _  -> PC.unexpected "leading zero"
                    Nothing -> return 0
              r -> go r
  where go !r     = optional digit >>= 
                      Just d  -> go ((r `shiftL` digitBits) .|. d)
                      Nothing -> return r
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Int #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Int8 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Int16 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Int32 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Int64 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Word #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Word8 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Word16 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Word32 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Binary -> μ Word64 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Int #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Int8 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Int16 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Int32 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Int64 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Word #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Word8 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Word16 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Word32 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Octal -> μ Word64 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int8 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int16 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int32 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int64 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word8 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word16 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word32 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word64 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int8 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int16 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int32 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int64 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word8 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word16 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word32 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word64 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int8 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int16 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int32 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int64 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word8 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word16 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word32 #-}
{-# SPECIALIZE nncBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word64 #-}
{-# SPECIALIZE nncBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Binary -> μ α #-}
{-# SPECIALIZE nncBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Octal -> μ α #-}
{-# SPECIALIZE nncBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
{-# SPECIALIZE nncBits :: (Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
{-# SPECIALIZE nncBits :: (Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> μ α #-}

-- | Parse a non-negative binary number written in the specified
--   positional numeral system (up to /n/ digits).
nnBitsUpTo :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
           => s -> Int -> μ α
nnBitsUpTo _ n | n <= 0 = empty
nnBitsUpTo s n = digit >>= go (n - 1) <?> systemName s ++ " digits"
  where go 0 !r   = optional (PC.satisfy $ isDigitIn s) >>= 
                      Just _  -> moreThan n
                      Nothing -> return r
        go l !r   = optional digit >>= 
                      Just d  -> go (l - 1) ((r `shiftL` digitBits) .|. d)
                      Nothing -> return r
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int8 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int16 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int32 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int64 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word8 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word16 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word32 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word64 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int8 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int16 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int32 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int64 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word8 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word16 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word32 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word64 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int8 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int16 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int32 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int64 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word8 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word16 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word32 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word64 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int8 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int16 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int32 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int64 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word8 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word16 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word32 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word64 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int8 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int16 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int32 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int64 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word8 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word16 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word32 #-}
{-# SPECIALIZE nnBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word64 #-}
{-# SPECIALIZE nnBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Binary -> Int -> μ α #-}
{-# SPECIALIZE nnBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Octal -> Int -> μ α #-}
{-# SPECIALIZE nnBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ α #-}
{-# SPECIALIZE nnBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> Int -> μ α #-}
{-# SPECIALIZE nnBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> Int -> μ α #-}

-- | Parse a non-negative binary number written in the specified
--   positional numeral system (up to /n/ digits). Leading zeroes are not
--   allowed.
nncBitsUpTo :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
            => s -> Int -> μ α
nncBitsUpTo _ n | n <= 0 = empty
nncBitsUpTo s n = (<?> systemName s ++ " digits") $ digitIn s >>= 
                    0 -> optional (PC.satisfy $ isDigitIn s) >>= 
                          Just _  -> PC.unexpected "leading zero"
                          Nothing -> return 0
                    r -> go (n - 1) $ fromIntegral (r :: Word)
  where go 0 !r   = optional (PC.satisfy $ isDigitIn s) >>= 
                      Just _  -> moreThan n
                      Nothing -> return r
        go l !r   = optional digit >>= 
                      Just d  -> go (l - 1) ((r `shiftL` digitBits) .|. d)
                      Nothing -> return r
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int8 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int16 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int32 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int64 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word8 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word16 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word32 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word64 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int8 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int16 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int32 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int64 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word8 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word16 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word32 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word64 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int8 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int16 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int32 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int64 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word8 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word16 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word32 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word64 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int8 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int16 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int32 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int64 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word8 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word16 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word32 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word64 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int8 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int16 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int32 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int64 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word8 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word16 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word32 #-}
{-# SPECIALIZE nncBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word64 #-}
{-# SPECIALIZE nncBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Binary -> Int -> μ α #-}
{-# SPECIALIZE nncBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Octal -> Int -> μ α #-}
{-# SPECIALIZE nncBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ α #-}
{-# SPECIALIZE nncBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> Int -> μ α #-}
{-# SPECIALIZE nncBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> Int -> μ α #-}

-- | Parse a non-negative binary number written in the specified
--   positional numeral system, failing on overflow.
nnbBits :: (BitSystem s, Ord α, Bounded α, Num α, Bits α,
           Monad μ, CharParsing μ)
        => s -> μ α
nnbBits s = digit >>= go <?> systemName s ++ " digits"
  where q = maxBound `shiftR` digitBits
        r = maxBound .&. digitMaskIn s
        go !n = optional digit >>= 
                  Just d  -> if n < q || (n == q && d <= r)
                            then go ((n `shiftL` digitBits) .|. d)
                            else fail "out of bounds"
                  Nothing -> return n
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int8 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int16 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int32 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int64 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word8 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word16 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word32 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word64 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int8 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int16 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int32 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int64 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word8 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word16 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word32 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word64 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int8 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int16 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int32 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int64 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word8 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word16 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word32 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word64 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int8 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int16 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int32 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int64 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word8 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word16 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word32 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word64 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int8 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int16 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int32 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int64 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word8 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word16 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word32 #-}
{-# SPECIALIZE nnbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word64 #-}
{-# SPECIALIZE nnbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Binary -> μ α #-}
{-# SPECIALIZE nnbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Octal -> μ α #-}
{-# SPECIALIZE nnbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
{-# SPECIALIZE nnbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
{-# SPECIALIZE nnbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> μ α #-}

-- | Parse a non-negative binary number written in the specified
--   positional numeral system, failing on overflow. Leading zeroes are not
--   allowed.
nncbBits :: (BitSystem s, Ord α, Bounded α, Num α, Bits α,
            Monad μ, CharParsing μ)
         => s -> μ α
nncbBits s = (<?> systemName s ++ " digits") $ digitIn s >>= 
               0 -> optional (PC.satisfy $ isDigitIn s) >>= 
                     Just _  -> PC.unexpected "leading zero"
                     Nothing -> return 0
               n -> go $ fromIntegral (n :: Word)
  where q = maxBound `shiftR` digitBits
        r = maxBound .&. digitMaskIn s
        go !n = optional digit >>= 
                  Just d  -> if n < q || (n == q && d <= r)
                            then go ((n `shiftL` digitBits) .|. d)
                            else fail "out of bounds"
                  Nothing -> return n
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int8 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int16 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int32 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int64 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word8 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word16 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word32 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word64 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int8 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int16 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int32 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int64 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word8 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word16 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word32 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word64 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int8 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int16 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int32 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int64 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word8 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word16 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word32 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word64 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int8 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int16 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int32 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int64 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word8 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word16 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word32 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word64 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int8 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int16 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int32 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int64 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word8 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word16 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word32 #-}
{-# SPECIALIZE nncbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word64 #-}
{-# SPECIALIZE nncbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Binary -> μ α #-}
{-# SPECIALIZE nncbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Octal -> μ α #-}
{-# SPECIALIZE nncbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
{-# SPECIALIZE nncbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
{-# SPECIALIZE nncbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> μ α #-}

-- | Parse a non-positive number written in the specified positional
--   numeral system. For example, parsing \"123\" as a decimal would produce
--   /-123/, not /123/.
nonPositive :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> μ α
nonPositive s = (<?> systemName s ++ " digits") $ do
                  r <- digitIn s
                  go $ fromIntegral $ negate (r :: Int)
  where go !r = optional digit >>= 
                  Just d  -> go (r * radix - d)
                  Nothing -> return r
        radix = radixIn s
        digit = digitIn s
{-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Int #-}
{-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Int8 #-}
{-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Int16 #-}
{-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Int32 #-}
{-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Int64 #-}
{-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Word #-}
{-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Word8 #-}
{-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Word16 #-}
{-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Word32 #-}
{-# SPECIALIZE nonPositive :: (Monad μ, CharParsing μ) => Decimal -> μ Word64 #-}
{-# SPECIALIZE nonPositive :: (Num α, Monad μ, CharParsing μ) => Binary -> μ α #-}
{-# SPECIALIZE nonPositive :: (Num α, Monad μ, CharParsing μ) => Octal -> μ α #-}
{-# SPECIALIZE nonPositive :: (Num α, Monad μ, CharParsing μ) => Decimal -> μ α #-}
{-# SPECIALIZE nonPositive :: (Num α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
{-# SPECIALIZE nonPositive :: (Num α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
{-# SPECIALIZE nonPositive :: (Num α, Monad μ, CharParsing μ) => UpHex -> μ α #-}

-- | Parse a non-positive number written in the specified positional
--   numeral system. Leading zeroes are not allowed.
npCompact :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> μ α
npCompact s = (<?> systemName s ++ " digits") $ digitIn s >>= 
                0 -> optional (PC.satisfy $ isDigitIn s) >>= 
                      Just _  -> PC.unexpected "leading zero"
                      Nothing -> return 0
                r -> go $ fromIntegral $ negate (r :: Int)
  where go !r = optional digit >>= 
                  Just d  -> go (r * radix - d)
                  Nothing -> return r
        radix = radixIn s
        digit = digitIn s
{-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int #-}
{-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int8 #-}
{-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int16 #-}
{-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int32 #-}
{-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Int64 #-}
{-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word #-}
{-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word8 #-}
{-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word16 #-}
{-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word32 #-}
{-# SPECIALIZE npCompact :: (Monad μ, CharParsing μ) => Decimal -> μ Word64 #-}
{-# SPECIALIZE npCompact :: (Num α, Monad μ, CharParsing μ) => Binary -> μ α #-}
{-# SPECIALIZE npCompact :: (Num α, Monad μ, CharParsing μ) => Octal -> μ α #-}
{-# SPECIALIZE npCompact :: (Num α, Monad μ, CharParsing μ) => Decimal -> μ α #-}
{-# SPECIALIZE npCompact :: (Num α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
{-# SPECIALIZE npCompact :: (Num α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
{-# SPECIALIZE npCompact :: (Num α, Monad μ, CharParsing μ) => UpHex -> μ α #-}

-- | Parse a non-positive number written in the specified positional
--   numeral system (up to /n/ digits).
npUpTo :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> Int -> μ α
npUpTo _ n | n <= 0 = empty
npUpTo s n = (<?> systemName s ++ " digits") $ do
               r <- digitIn s
               go (n - 1) $ fromIntegral $ negate (r :: Int)
  where go 0 !r = optional (PC.satisfy $ isDigitIn s) >>= 
                    Just _  -> moreThan n
                    Nothing -> return r
        go l !r = optional digit >>= 
                    Just d  -> go (l - 1) (r * radix - d)
                    Nothing -> return r
        radix   = radixIn s
        digit   = digitIn s
{-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int #-}
{-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int8 #-}
{-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int16 #-}
{-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int32 #-}
{-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int64 #-}
{-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word #-}
{-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word8 #-}
{-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word16 #-}
{-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word32 #-}
{-# SPECIALIZE npUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word64 #-}
{-# SPECIALIZE npUpTo :: (Num α, Monad μ, CharParsing μ) => Binary -> Int -> μ α #-}
{-# SPECIALIZE npUpTo :: (Num α, Monad μ, CharParsing μ) => Octal -> Int -> μ α #-}
{-# SPECIALIZE npUpTo :: (Num α, Monad μ, CharParsing μ) => Decimal -> Int -> μ α #-}
{-# SPECIALIZE npUpTo :: (Num α, Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ α #-}
{-# SPECIALIZE npUpTo :: (Num α, Monad μ, CharParsing μ) => LowHex -> Int -> μ α #-}
{-# SPECIALIZE npUpTo :: (Num α, Monad μ, CharParsing μ) => UpHex -> Int -> μ α #-}

-- | Parse a non-positive number written in the specified positional
--   numeral system (up to /n/ digits). Leading zeroes are not allowed.
npcUpTo :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> Int -> μ α
npcUpTo _ n | n <= 0 = empty
npcUpTo s n = (<?> systemName s ++ " digits") $ digitIn s >>= 
                0 -> optional (PC.satisfy $ isDigitIn s) >>= 
                      Just _  -> PC.unexpected "leading zero"
                      Nothing -> return 0
                r -> go (n - 1) $ fromIntegral $ negate (r :: Int)
  where go 0 !r = optional (PC.satisfy $ isDigitIn s) >>= 
                    Just _  -> moreThan n
                    Nothing -> return r
        go l !r = optional digit >>= 
                    Just d  -> go (l - 1) (r * radix - d)
                    Nothing -> return r
        radix   = radixIn s
        digit   = digitIn s
{-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int #-}
{-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int8 #-}
{-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int16 #-}
{-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int32 #-}
{-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Int64 #-}
{-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word #-}
{-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word8 #-}
{-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word16 #-}
{-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word32 #-}
{-# SPECIALIZE npcUpTo :: (Monad μ, CharParsing μ) => Decimal -> Int -> μ Word64 #-}
{-# SPECIALIZE npcUpTo :: (Num α, Monad μ, CharParsing μ) => Binary -> Int -> μ α #-}
{-# SPECIALIZE npcUpTo :: (Num α, Monad μ, CharParsing μ) => Octal -> Int -> μ α #-}
{-# SPECIALIZE npcUpTo :: (Num α, Monad μ, CharParsing μ) => Decimal -> Int -> μ α #-}
{-# SPECIALIZE npcUpTo :: (Num α, Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ α #-}
{-# SPECIALIZE npcUpTo :: (Num α, Monad μ, CharParsing μ) => LowHex -> Int -> μ α #-}
{-# SPECIALIZE npcUpTo :: (Num α, Monad μ, CharParsing μ) => UpHex -> Int -> μ α #-}

-- | Parse a non-positive number written in the specified positional
--   numeral system, failing on overflow.
npBounded :: (PositionalSystem s, Ord α, Bounded α, Integral α,
             Monad μ, CharParsing μ)
          => s -> μ α
npBounded s = (<?> systemName s ++ " digits") $ do
                n <- digitIn s
                go $ fromIntegral $ negate (n :: Int)
  where (q, r1) = quotRem minBound radix
        !r      = negate r1
        go !n   = optional digit >>= 
                    Just d  -> if n > q || (n == q && d <= r)
                              then go (n * radix - d)
                              else fail "out of bounds"
                    Nothing -> return n
        radix   = radixIn s
        digit   = digitIn s
{-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int #-}
{-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int8 #-}
{-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int16 #-}
{-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int32 #-}
{-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int64 #-}
{-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word #-}
{-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word8 #-}
{-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word16 #-}
{-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word32 #-}
{-# SPECIALIZE npBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word64 #-}
{-# SPECIALIZE npBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Binary -> μ α #-}
{-# SPECIALIZE npBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Octal -> μ α #-}
{-# SPECIALIZE npBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Decimal -> μ α #-}
{-# SPECIALIZE npBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
{-# SPECIALIZE npBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
{-# SPECIALIZE npBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => UpHex -> μ α #-}

-- | Parse a non-positive number written in the specified positional
--   numeral system, failing on overflow. Leading zeroes are not allowed.
npcBounded :: (PositionalSystem s, Ord α, Bounded α, Integral α,
              Monad μ, CharParsing μ)
           => s -> μ α
npcBounded s = (<?> systemName s ++ " digits") $ digitIn s >>= 
                 0 -> optional (PC.satisfy $ isDigitIn s) >>= 
                       Just _  -> PC.unexpected "leading zero"
                       Nothing -> return 0
                 n -> go $ fromIntegral $ negate (n :: Int)
  where (q, r1) = quotRem minBound radix
        !r      = negate r1
        go !n   = optional digit >>= 
                    Just d  -> if n > q || (n == q && d <= r)
                              then go (n * radix - d)
                              else fail "out of bounds"
                    Nothing -> return n
        radix   = radixIn s
        digit   = digitIn s
{-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int #-}
{-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int8 #-}
{-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int16 #-}
{-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int32 #-}
{-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Int64 #-}
{-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word #-}
{-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word8 #-}
{-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word16 #-}
{-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word32 #-}
{-# SPECIALIZE npcBounded :: (Monad μ, CharParsing μ) => Decimal -> μ Word64 #-}
{-# SPECIALIZE npcBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Binary -> μ α #-}
{-# SPECIALIZE npcBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Octal -> μ α #-}
{-# SPECIALIZE npcBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Decimal -> μ α #-}
{-# SPECIALIZE npcBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
{-# SPECIALIZE npcBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
{-# SPECIALIZE npcBounded :: (Bounded α, Integral α, Monad μ, CharParsing μ) => UpHex -> μ α #-}

-- | Parse a non-positive two\'s complement binary number written in
--   the specified positional numeral system.
npBits :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) => s -> μ α
npBits s = (<?> systemName s ++ " digits") $ do
             r <- digit
             go $ fromIntegral $ negate (r :: Int)
  where go !r     = optional digit >>= 
                      Just d1 -> go ((r `shiftL` digitBits) + d)
                        where !d = fromIntegral $ negate d1
                      Nothing -> return r
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Int #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Int8 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Int16 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Int32 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Int64 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Word #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Word8 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Word16 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Word32 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Binary -> μ Word64 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Int #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Int8 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Int16 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Int32 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Int64 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Word #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Word8 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Word16 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Word32 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Octal -> μ Word64 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int8 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int16 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int32 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int64 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word8 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word16 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word32 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word64 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int8 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int16 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int32 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int64 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word8 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word16 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word32 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word64 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int8 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int16 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int32 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int64 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word8 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word16 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word32 #-}
{-# SPECIALIZE npBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word64 #-}
{-# SPECIALIZE npBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Binary -> μ α #-}
{-# SPECIALIZE npBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Octal -> μ α #-}
{-# SPECIALIZE npBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
{-# SPECIALIZE npBits :: (Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
{-# SPECIALIZE npBits :: (Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> μ α #-}

-- | Parse a non-positive two\'s complement binary number written in
--   the specified positional numeral system (up to /n/ digits).
npBitsUpTo :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
           => s -> Int -> μ α
npBitsUpTo _ n | n <= 0 = empty
npBitsUpTo s n = (<?> systemName s ++ " digits") $ do
                   r <- digit
                   go (n - 1) $ fromIntegral $ negate (r :: Int)
  where go 0 !r   = optional (PC.satisfy $ isDigitIn s) >>= 
                      Just _  -> moreThan n
                      Nothing -> return r
        go l !r   = optional digit >>= 
                      Just d1 -> go (l - 1) ((r `shiftL` digitBits) + d)
                        where !d = fromIntegral $ negate d1
                      Nothing -> return r
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int8 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int16 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int32 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int64 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word8 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word16 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word32 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word64 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int8 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int16 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int32 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int64 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word8 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word16 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word32 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word64 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int8 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int16 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int32 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int64 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word8 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word16 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word32 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word64 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int8 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int16 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int32 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int64 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word8 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word16 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word32 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word64 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int8 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int16 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int32 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int64 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word8 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word16 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word32 #-}
{-# SPECIALIZE npBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word64 #-}
{-# SPECIALIZE npBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Binary -> Int -> μ α #-}
{-# SPECIALIZE npBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Octal -> Int -> μ α #-}
{-# SPECIALIZE npBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ α #-}
{-# SPECIALIZE npBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> Int -> μ α #-}
{-# SPECIALIZE npBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> Int -> μ α #-}

-- | Parse a non-positive two\'s complement binary number written in
--   the specified positional numeral system. Leading zeroes are not allowed.
npcBits :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) => s -> μ α
npcBits s = (<?> systemName s ++ " digits") $ digit >>= 
              0 -> optional (PC.satisfy $ isDigitIn s) >>= 
                    Just _  -> PC.unexpected "leading zero"
                    Nothing -> return 0
              r -> go $ fromIntegral $ negate (r :: Int)
  where go !r     = optional digit >>= 
                      Just d1 -> go ((r `shiftL` digitBits) + d)
                        where !d = fromIntegral $ negate d1
                      Nothing -> return r
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Int #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Int8 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Int16 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Int32 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Int64 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Word #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Word8 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Word16 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Word32 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Binary -> μ Word64 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Int #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Int8 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Int16 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Int32 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Int64 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Word #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Word8 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Word16 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Word32 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Octal -> μ Word64 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int8 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int16 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int32 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int64 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word8 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word16 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word32 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word64 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int8 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int16 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int32 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int64 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word8 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word16 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word32 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word64 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int8 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int16 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int32 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int64 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word8 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word16 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word32 #-}
{-# SPECIALIZE npcBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word64 #-}
{-# SPECIALIZE npcBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Binary -> μ α #-}
{-# SPECIALIZE npcBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Octal -> μ α #-}
{-# SPECIALIZE npcBits :: (Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
{-# SPECIALIZE npcBits :: (Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
{-# SPECIALIZE npcBits :: (Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> μ α #-}

-- | Parse a non-positive two\'s complement binary number written in
--   the specified positional numeral system (up to /n/ digits).
--   Leading zeroes are not allowed.
npcBitsUpTo :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
            => s -> Int -> μ α
npcBitsUpTo _ n | n <= 0 = empty
npcBitsUpTo s n = (<?> systemName s ++ " digits") $ digit >>= 
                    0 -> optional (PC.satisfy $ isDigitIn s) >>= 
                          Just _  -> PC.unexpected "leading zero"
                          Nothing -> return 0
                    r -> go (n - 1) $ fromIntegral $ negate (r :: Int)
  where go 0 !r   = optional (PC.satisfy $ isDigitIn s) >>= 
                      Just _  -> moreThan n
                      Nothing -> return r
        go l !r   = optional digit >>= 
                      Just d1 -> go (l - 1) ((r `shiftL` digitBits) + d)
                        where !d = fromIntegral $ negate d1
                      Nothing -> return r
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int8 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int16 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int32 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Int64 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word8 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word16 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word32 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Binary -> Int -> μ Word64 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int8 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int16 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int32 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Int64 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word8 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word16 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word32 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Octal -> Int -> μ Word64 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int8 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int16 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int32 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Int64 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word8 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word16 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word32 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ Word64 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int8 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int16 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int32 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Int64 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word8 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word16 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word32 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => LowHex -> Int -> μ Word64 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int8 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int16 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int32 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Int64 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word8 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word16 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word32 #-}
{-# SPECIALIZE npcBitsUpTo :: (Monad μ, CharParsing μ) => UpHex -> Int -> μ Word64 #-}
{-# SPECIALIZE npcBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Binary -> Int -> μ α #-}
{-# SPECIALIZE npcBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Octal -> Int -> μ α #-}
{-# SPECIALIZE npcBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> Int -> μ α #-}
{-# SPECIALIZE npcBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> Int -> μ α #-}
{-# SPECIALIZE npcBitsUpTo :: (Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> Int -> μ α #-}

-- | Parse a non-positive two\'s complement binary number written in
--   the specified positional numeral system, failing on overflow.
npbBits :: forall s μ α
        . (BitSystem s, Ord α, Bounded α, Num α, Bits α,
           Monad μ, CharParsing μ)
        => s -> μ α
npbBits s = (<?> systemName s ++ " digits") $ do
              n <- digit
              go $ fromIntegral $ negate (n :: Int)
  where q1 = minBound `shiftR` digitBits
        r  = negate (lastDigitIn s (minBound :: α)) .&. digitMaskIn s
        q  = if r == 0 then q1 else q1 + 1
        go !n     = optional digit >>= 
                      Just d1 -> if n > q || (n == q && d1 <= r)
                                then go ((n `shiftL` digitBits) + d)
                                else fail "out of bounds"
                        where !d = fromIntegral $ negate d1
                      Nothing -> return n
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int8 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int16 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int32 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int64 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word8 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word16 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word32 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word64 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int8 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int16 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int32 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int64 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word8 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word16 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word32 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word64 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int8 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int16 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int32 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int64 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word8 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word16 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word32 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word64 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int8 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int16 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int32 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int64 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word8 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word16 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word32 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word64 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int8 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int16 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int32 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int64 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word8 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word16 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word32 #-}
{-# SPECIALIZE npbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word64 #-}
{-# SPECIALIZE npbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Binary -> μ α #-}
{-# SPECIALIZE npbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Octal -> μ α #-}
{-# SPECIALIZE npbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
{-# SPECIALIZE npbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
{-# SPECIALIZE npbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> μ α #-}

-- | Parse a non-positive two\'s complement binary number written in
--   the specified positional numeral system, failing on overflow.
--   Leading zeroes are not allowed.
npcbBits :: forall s μ α
         . (BitSystem s, Ord α, Bounded α, Num α, Bits α,
            Monad μ, CharParsing μ)
        => s -> μ α
npcbBits s = (<?> systemName s ++ " digits") $ digit >>= 
               0 -> optional (PC.satisfy $ isDigitIn s) >>= 
                     Just _  -> PC.unexpected "leading zero"
                     Nothing -> return 0
               n -> go $ fromIntegral $ negate (n :: Int)
  where q1 = minBound `shiftR` digitBits
        r  = negate (lastDigitIn s (minBound :: α)) .&. digitMaskIn s
        q  = if r == 0 then q1 else q1 + 1
        go !n     = optional digit >>= 
                      Just d1 -> if n > q || (n == q && d1 <= r)
                                then go ((n `shiftL` digitBits) + d)
                                else fail "out of bounds"
                        where !d = fromIntegral $ negate d1
                      Nothing -> return n
        digitBits = digitBitsIn s
        digit     = digitIn s
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int8 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int16 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int32 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Int64 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word8 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word16 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word32 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Binary -> μ Word64 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int8 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int16 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int32 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Int64 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word8 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word16 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word32 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Octal -> μ Word64 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int8 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int16 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int32 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Int64 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word8 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word16 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word32 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => Hexadecimal -> μ Word64 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int8 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int16 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int32 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Int64 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word8 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word16 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word32 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => LowHex -> μ Word64 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int8 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int16 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int32 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Int64 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word8 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word16 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word32 #-}
{-# SPECIALIZE npcbBits :: (Monad μ, CharParsing μ) => UpHex -> μ Word64 #-}
{-# SPECIALIZE npcbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Binary -> μ α #-}
{-# SPECIALIZE npcbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Octal -> μ α #-}
{-# SPECIALIZE npcbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => Hexadecimal -> μ α #-}
{-# SPECIALIZE npcbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => LowHex -> μ α #-}
{-# SPECIALIZE npcbBits :: (Ord α, Bounded α, Num α, Bits α, Monad μ, CharParsing μ) => UpHex -> μ α #-}

-- | Sign of a number.
data Sign = NonNegative | NonPositive
            deriving (Typeable, Eq, Show, Read)

-- | Negate the supplied value if the sign is 'NonPositive' and return it
--   as it is otherwise.
applySign :: Num α => Sign -> α -> α
applySign NonNegative a = a
applySign NonPositive a = negate a

-- | Optional minus sign.
optMinus :: CharParsing μ => μ Sign
optMinus  =  (pure NonPositive <* PC.char '-') <|> pure NonNegative
         <?> "optional minus sign"
{-# INLINE optMinus #-}

-- | Optional minus or plus sign.
optSign :: CharParsing μ => μ Sign
optSign  =  (pure NonPositive <* PC.char '-')
        <|> (pure NonNegative <* PC.char '+')
        <|> pure NonNegative
        <?> "optional sign"
{-# INLINABLE optSign #-}

-- | Parse a number written in the specified positional numeral system.
--   The supplied parser is used to determine the sign of the number.
number' :: (PositionalSystem s, Num α, Monad μ, CharParsing μ)
        => μ Sign -> s -> μ α
number' neg s = (<?> systemName s) $ neg >>= 
  NonNegative -> nonNegative s
  NonPositive -> nonPositive s
{-# INLINE number' #-}

-- | A shorthand for 'number'' 'optMinus'.
number :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> μ α
number = number' optMinus
{-# INLINE number #-}

-- | Parse a number written in the specified positional numeral system.
--   The supplied parser is used to determine the sign of the number.
--   Leading zeroes are not allowed.
compact' :: (PositionalSystem s, Num α, Monad μ, CharParsing μ)
         => μ Sign -> s -> μ α
compact' neg s = (<?> systemName s) $ neg >>= 
  NonNegative -> nnCompact s
  NonPositive -> npCompact s
{-# INLINE compact' #-}

-- | A shorthand for 'compact'' 'optMinus'.
compact :: (PositionalSystem s, Num α, Monad μ, CharParsing μ) => s -> μ α
compact = compact' optMinus
{-# INLINE compact #-}

-- | Parse a number written in the specified positional numeral system
--   (up to /n/ digits). The supplied parser is used to determine the sign of
--   the number.
numberUpTo' :: (PositionalSystem s, Num α, Monad μ, CharParsing μ)
            => μ Sign -> s -> Int -> μ α
numberUpTo' neg s n = (<?> systemName s) $ neg >>= 
  NonNegative -> nnUpTo s n
  NonPositive -> npUpTo s n
{-# INLINE numberUpTo' #-}

-- | A shorthand for 'numberUpTo'' 'optMinus'.
numberUpTo :: (PositionalSystem s, Num α, Monad μ, CharParsing μ)
           => s -> Int -> μ α
numberUpTo = numberUpTo' optMinus
{-# INLINE numberUpTo #-}

-- | Parse a number written in the specified positional numeral system
--   (up to /n/ digits). The supplied parser is used to determine the sign of
--   the number. Leading zeroes are not allowed.
compactUpTo' :: (PositionalSystem s, Num α, Monad μ, CharParsing μ)
             => μ Sign -> s -> Int -> μ α
compactUpTo' neg s n = (<?> systemName s) $ neg >>= 
  NonNegative -> nncUpTo s n
  NonPositive -> npcUpTo s n
{-# INLINE compactUpTo' #-}

-- | A shorthand for 'compactUpTo'' 'optMinus'.
compactUpTo :: (PositionalSystem s, Num α, Monad μ, CharParsing μ)
           => s -> Int -> μ α
compactUpTo = compactUpTo' optMinus
{-# INLINE compactUpTo #-}

-- | Parse a number written in the specified positional numeral system,
--   failing on overflow. The supplied parser is used to determine the sign
--   of the number.
bounded' :: (PositionalSystem s, Ord α, Bounded α, Integral α,
            Monad μ, CharParsing μ)
         => μ Sign -> s -> μ α
bounded' neg s = (<?> systemName s) $ neg >>= 
  NonNegative -> nnBounded s
  NonPositive -> npBounded s
{-# INLINE bounded' #-}

-- | A shorthand for 'bounded'' 'optMinus'.
bounded :: (PositionalSystem s, Ord α, Bounded α, Integral α,
           Monad μ, CharParsing μ) => s -> μ α
bounded = bounded' optMinus
{-# INLINE bounded #-}

-- | Parse a number written in the specified positional numeral system,
--   failing on overflow. The supplied parser is used to determine the sign
--   of the number. Leading zeroes are not allowed.
cBounded' :: (PositionalSystem s, Ord α, Bounded α, Integral α,
             Monad μ, CharParsing μ)
          => μ Sign -> s -> μ α
cBounded' neg s = (<?> systemName s) $ neg >>= 
  NonNegative -> nncBounded s
  NonPositive -> npcBounded s
{-# INLINE cBounded' #-}

-- | A shorthand for 'cBounded'' 'optMinus'.
cBounded :: (PositionalSystem s, Ord α, Bounded α, Integral α,
            Monad μ, CharParsing μ) => s -> μ α
cBounded = cBounded' optMinus
{-# INLINE cBounded #-}

-- | Parse a (two\'s complement) binary number written in the specified
--   positional numeral system. The supplied parser is used to determine
--   the sign of the number.
bits' :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
      => μ Sign -> s -> μ α
bits' neg s = (<?> systemName s) $ neg >>= 
  NonNegative -> nnBits s
  NonPositive -> npBits s
{-# INLINE bits' #-}

-- | A shorthand for 'bits'' 'optMinus'.
bits :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) => s -> μ α
bits = bits' optMinus
{-# INLINE bits #-}

-- | Parse a (two\'s complement) binary number written in the specified
--   positional numeral system. The supplied parser is used to determine
--   the sign of the number. Leading zeroes are not allowed.
cBits' :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
       => μ Sign -> s -> μ α
cBits' neg s = (<?> systemName s) $ neg >>= 
  NonNegative -> nncBits s
  NonPositive -> npcBits s
{-# INLINE cBits' #-}

-- | A shorthand for 'cBits'' 'optMinus'.
cBits :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ) => s -> μ α
cBits = cBits' optMinus
{-# INLINE cBits #-}

-- | Parse a (two\'s complement) binary number written in the specified
--   positional numeral system (up to /n/ digits). The supplied parser is
--   used to determine the sign of the number.
bitsUpTo' :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
          => μ Sign -> s -> Int -> μ α
bitsUpTo' neg s n = (<?> systemName s) $ neg >>= 
  NonNegative -> nnBitsUpTo s n
  NonPositive -> npBitsUpTo s n
{-# INLINE bitsUpTo' #-}

-- | A shorthand for 'bitsUpTo'' 'optMinus'.
bitsUpTo :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
         => s -> Int -> μ α
bitsUpTo = bitsUpTo' optMinus
{-# INLINE bitsUpTo #-}

-- | Parse a (two\'s complement) binary number written in the specified
--   positional numeral system (up to /n/ digits). The supplied parser is
--   used to determine the sign of the number. Leading zeroes are not
--   allowed.
cBitsUpTo' :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
           => μ Sign -> s -> Int -> μ α
cBitsUpTo' neg s n = (<?> systemName s) $ neg >>= 
  NonNegative -> nncBitsUpTo s n
  NonPositive -> npcBitsUpTo s n
{-# INLINE cBitsUpTo' #-}

-- | A shorthand for 'cBitsUpTo'' 'optMinus'.
cBitsUpTo :: (BitSystem s, Num α, Bits α, Monad μ, CharParsing μ)
          => s -> Int -> μ α
cBitsUpTo = cBitsUpTo' optMinus
{-# INLINE cBitsUpTo #-}

-- | Parse a (two\'s complement) binary number written in the specified
--   positional numeral system, failing on overflow. The supplied parser is
--   used to determine the sign of the number.
bBits' :: (BitSystem s, Ord α, Bounded α, Num α, Bits α,
          Monad μ, CharParsing μ)
       => μ Sign -> s -> μ α
bBits' neg s = (<?> systemName s) $ neg >>= 
  NonNegative -> nnbBits s
  NonPositive -> npbBits s
{-# INLINE bBits' #-}

-- | A shorthand for 'bBits'' 'optMinus'.
bBits :: (BitSystem s, Ord α, Bounded α, Num α, Bits α,
         Monad μ, CharParsing μ)
      => s -> μ α
bBits = bBits' optMinus
{-# INLINE bBits #-}

-- | Parse a (two\'s complement) binary number written in the specified
--   positional numeral system, failing on overflow. The supplied parser is
--   used to determine the sign of the number. Leading zeroes are not
--   allowed.
cbBits' :: (BitSystem s, Ord α, Bounded α, Num α, Bits α,
           Monad μ, CharParsing μ)
        => μ Sign -> s -> μ α
cbBits' neg s = (<?> systemName s) $ neg >>= 
  NonNegative -> nncbBits s
  NonPositive -> npcbBits s
{-# INLINE cbBits' #-}

-- | A shorthand for 'cbBits'' 'optMinus'.
cbBits :: (BitSystem s, Ord α, Bounded α, Num α, Bits α,
          Monad μ, CharParsing μ)
       => s -> μ α
cbBits = cbBits' optMinus
{-# INLINE cbBits #-}


</pre>