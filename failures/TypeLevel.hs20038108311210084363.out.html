<a href="TypeLens.hs7889743901728536152.out.html">prev</a></br><a href="failures.html">home</a></br><a href="TypeList.hs10551512406933754.out.html">next</a></br></br><pre>22d21
<   RIndex r (r ': rs) = Z
23c22
<   RIndex r (s ': rs) = S (RIndex r rs)
---
>   RIndex r (r  : rs) = Z
23a23
>   RIndex r (s  : rs) = S (RIndex r rs)
28c28
<   RImage (r ': rs) ss = RIndex r ss ': RImage rs ss
---
>   RImage (r  : rs) ss = RIndex r ss  : RImage rs ss
33c33
<   RecAll f (r ': rs) c = (c (f r), RecAll f rs c)
---
>   RecAll f (r  : rs) c = (c (f r), RecAll f rs c)
36d35
< type family (as :: [k]) ++ (bs :: [k]) :: [k] where
37d35
<   '[] ++ bs = bs
38c36
<   (a ': as) ++ bs = a ': (as ++ bs)
---
> type family             ++as :: [k])    (bs :: [k]) :: [k] where
38a37
>       ++[]    bs = bs
38a38
>             ++a  : as)    bs = a  : (as ++ bs)
39a40
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE ConstraintKinds       #-}
{-# LANGUAGE DataKinds             #-}
{-# LANGUAGE FlexibleContexts      #-}
{-# LANGUAGE FlexibleInstances     #-}
{-# LANGUAGE GADTs                 #-}
{-# LANGUAGE MultiParamTypeClasses #-}
{-# LANGUAGE PolyKinds             #-}
{-# LANGUAGE ScopedTypeVariables   #-}
{-# LANGUAGE TypeFamilies          #-}
{-# LANGUAGE TypeOperators         #-}

module Data.Vinyl.TypeLevel where

import GHC.Exts

-- | A mere approximation of the natural numbers. And their image as lifted by
-- @-XDataKinds@ corresponds to the actual natural numbers.
data Nat = Z | S !Nat

-- | A partial relation that gives the index of a value in a list.
type family RIndex (r :: k) (rs :: [k]) :: Nat where
  RIndex r (r ': rs) = Z
  RIndex r (s ': rs) = S (RIndex r rs)

-- | A partial relation that gives the indices of a sublist in a larger list.
type family RImage (rs :: [k]) (ss :: [k]) :: [Nat] where
  RImage '[] ss = '[]
  RImage (r ': rs) ss = RIndex r ss ': RImage rs ss

-- | A constraint-former which applies to every field in a record.
type family RecAll (f :: u -> *) (rs :: [u]) (c :: * -> Constraint) :: Constraint where
  RecAll f '[] c = ()
  RecAll f (r ': rs) c = (c (f r), RecAll f rs c)

-- | Append for type-level lists.
type family (as :: [k]) ++ (bs :: [k]) :: [k] where
  '[] ++ bs = bs
  (a ': as) ++ bs = a ': (as ++ bs)

</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE ConstraintKinds       #-}
{-# LANGUAGE DataKinds             #-}
{-# LANGUAGE FlexibleContexts      #-}
{-# LANGUAGE FlexibleInstances     #-}
{-# LANGUAGE GADTs                 #-}
{-# LANGUAGE MultiParamTypeClasses #-}
{-# LANGUAGE PolyKinds             #-}
{-# LANGUAGE ScopedTypeVariables   #-}
{-# LANGUAGE TypeFamilies          #-}
{-# LANGUAGE TypeOperators         #-}

module Data.Vinyl.TypeLevel where

import GHC.Exts

-- | A mere approximation of the natural numbers. And their image as lifted by
-- @-XDataKinds@ corresponds to the actual natural numbers.
data Nat = Z | S !Nat

-- | A partial relation that gives the index of a value in a list.
type family RIndex (r :: k) (rs :: [k]) :: Nat where
  RIndex r (r  : rs) = Z
  RIndex r (s  : rs) = S (RIndex r rs)

-- | A partial relation that gives the indices of a sublist in a larger list.
type family RImage (rs :: [k]) (ss :: [k]) :: [Nat] where
  RImage '[] ss = '[]
  RImage (r  : rs) ss = RIndex r ss  : RImage rs ss

-- | A constraint-former which applies to every field in a record.
type family RecAll (f :: u -> *) (rs :: [u]) (c :: * -> Constraint) :: Constraint where
  RecAll f '[] c = ()
  RecAll f (r  : rs) c = (c (f r), RecAll f rs c)

-- | Append for type-level lists.
type family             ++as :: [k])    (bs :: [k]) :: [k] where
      ++[]    bs = bs
            ++a  : as)    bs = a  : (as ++ bs)


</pre>