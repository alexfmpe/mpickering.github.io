<a href="Common.hs19027373351127401868.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Compare.hs17223219341132666825.out.html">next</a></br></br><pre>51c51
< deriveFromText "Hypervisor" ["ovm", "xen"]
---
> $ "Hypervisor" ["ovm", "xen"]
110d109
< deriveFromText "Architecture" ["i386", "x86_64"]
111d109
< deriveFromText "ProductCodeType" ["devpay", "marketplace"]
112d109
< deriveFromText "RootDeviceType" ["ebs", "instance-store"]
113d109
< deriveFromText "ShutdownBehavior" ["stop", "terminate"]
114c110
< deriveFromText "VirtualizationType" ["paravirtual", "hvm"]
---
> $ "Architecture" ["i386", "x86_64"]
114a111
> $ "ProductCodeType" ["devpay", "marketplace"]
114a112
> $ "RootDeviceType" ["ebs", "instance-store"]
114a113
> $ "ShutdownBehavior" ["stop", "terminate"]
114a114
> $ "VirtualizationType" ["paravirtual", "hvm"]
114a115
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE TemplateHaskell #-}

module AWS.EC2.Types.Common
    ( Architecture(..)
    , Filter
    , EC2Return(..)
    , Group(..)
    , Hypervisor(..)
    , Placement(..)
    , Platform(..)
    , ProductCode(..)
    , ProductCodeType(..)
    , ResourceTag(..)
    , RootDeviceType(..)
    , ShutdownBehavior(..)
    , StateReason(..)
    , VirtualizationType(..)
    ) where

import AWS.Lib.FromText

data Architecture
    = I386
    | X86_64
  deriving (Show, Read, Eq)

data EC2Return
    = EC2Success
    | EC2Error Text
  deriving (Show, Read, Eq)

instance FromText EC2Return
  where
    fromTextMay t
        | t == "true" = Just EC2Success
        | otherwise   = Just $ EC2Error t

type Filter = (Text, [Text])

data Group = Group
    { groupId :: Text
    , groupName :: Text
    }
  deriving (Show, Read, Eq)

data Hypervisor
    = HypervisorOVM
    | HypervisorXen
  deriving (Show, Read, Eq)

deriveFromText "Hypervisor" ["ovm", "xen"]

data Placement = Placement
    { placementAvailabilityZone :: Text
    , placementGroupName :: Maybe Text
    , placementTenancy :: Text
    }
  deriving (Show, Read, Eq)

data Platform
    = PlatformWindows
    | PlatformOther
  deriving (Show, Read, Eq)

instance FromText Platform
  where
    fromMaybeText _name Nothing  = return PlatformOther
    fromMaybeText _name (Just t)
        | t == "windows" = return PlatformWindows
        | otherwise      = return PlatformOther

data ProductCode = ProductCode
    { productCodeCode :: Text
    , productCodeType :: ProductCodeType
    }
  deriving (Show, Read, Eq)

data ProductCodeType
    = ProductCodeDevpay
    | ProductCodeMarketplace
  deriving (Show, Read, Eq)

data ResourceTag = ResourceTag
    { resourceTagKey :: Text
    , resourceTagValue :: Maybe Text
    }
  deriving (Show, Read, Eq)

data RootDeviceType
    = RootDeviceTypeEBS
    | RootDeviceTypeInstanceStore
  deriving (Show, Read, Eq)

data ShutdownBehavior
    = ShutdownBehaviorStop
    | ShutdownBehaviorTerminate
  deriving (Show, Read, Eq)

data StateReason = StateReason
    { stateReasonCode :: Text
    , stateReasonMessage :: Text
    }
  deriving (Show, Read, Eq)

data VirtualizationType
    = VirtualizationTypeParavirtual
    | VirtualizationTypeHVM
  deriving (Show, Read, Eq)

deriveFromText "Architecture" ["i386", "x86_64"]
deriveFromText "ProductCodeType" ["devpay", "marketplace"]
deriveFromText "RootDeviceType" ["ebs", "instance-store"]
deriveFromText "ShutdownBehavior" ["stop", "terminate"]
deriveFromText "VirtualizationType" ["paravirtual", "hvm"]
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE TemplateHaskell #-}

module AWS.EC2.Types.Common
    ( Architecture(..)
    , Filter
    , EC2Return(..)
    , Group(..)
    , Hypervisor(..)
    , Placement(..)
    , Platform(..)
    , ProductCode(..)
    , ProductCodeType(..)
    , ResourceTag(..)
    , RootDeviceType(..)
    , ShutdownBehavior(..)
    , StateReason(..)
    , VirtualizationType(..)
    ) where

import AWS.Lib.FromText

data Architecture
    = I386
    | X86_64
  deriving (Show, Read, Eq)

data EC2Return
    = EC2Success
    | EC2Error Text
  deriving (Show, Read, Eq)

instance FromText EC2Return
  where
    fromTextMay t
        | t == "true" = Just EC2Success
        | otherwise   = Just $ EC2Error t

type Filter = (Text, [Text])

data Group = Group
    { groupId :: Text
    , groupName :: Text
    }
  deriving (Show, Read, Eq)

data Hypervisor
    = HypervisorOVM
    | HypervisorXen
  deriving (Show, Read, Eq)

$ "Hypervisor" ["ovm", "xen"]

data Placement = Placement
    { placementAvailabilityZone :: Text
    , placementGroupName :: Maybe Text
    , placementTenancy :: Text
    }
  deriving (Show, Read, Eq)

data Platform
    = PlatformWindows
    | PlatformOther
  deriving (Show, Read, Eq)

instance FromText Platform
  where
    fromMaybeText _name Nothing  = return PlatformOther
    fromMaybeText _name (Just t)
        | t == "windows" = return PlatformWindows
        | otherwise      = return PlatformOther

data ProductCode = ProductCode
    { productCodeCode :: Text
    , productCodeType :: ProductCodeType
    }
  deriving (Show, Read, Eq)

data ProductCodeType
    = ProductCodeDevpay
    | ProductCodeMarketplace
  deriving (Show, Read, Eq)

data ResourceTag = ResourceTag
    { resourceTagKey :: Text
    , resourceTagValue :: Maybe Text
    }
  deriving (Show, Read, Eq)

data RootDeviceType
    = RootDeviceTypeEBS
    | RootDeviceTypeInstanceStore
  deriving (Show, Read, Eq)

data ShutdownBehavior
    = ShutdownBehaviorStop
    | ShutdownBehaviorTerminate
  deriving (Show, Read, Eq)

data StateReason = StateReason
    { stateReasonCode :: Text
    , stateReasonMessage :: Text
    }
  deriving (Show, Read, Eq)

data VirtualizationType
    = VirtualizationTypeParavirtual
    | VirtualizationTypeHVM
  deriving (Show, Read, Eq)

$ "Architecture" ["i386", "x86_64"]
$ "ProductCodeType" ["devpay", "marketplace"]
$ "RootDeviceType" ["ebs", "instance-store"]
$ "ShutdownBehavior" ["stop", "terminate"]
$ "VirtualizationType" ["paravirtual", "hvm"]

</pre>