<a href="Exception.hs2035308228158374933.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Execute.hs1010275441457850878.out.html">next</a></br></br><pre>23d22
< defExceptionP(isKeyNotFound                   , 0x01)
24d22
< defExceptionP(isKeyExists                     , 0x02)
25d22
< defExceptionP(isValueTooLarge                 , 0x03)
26d22
< defExceptionP(isInvalidArguments              , 0x04)
27d22
< defExceptionP(isItemNotStored                 , 0x05)
28d22
< defExceptionP(isIncrDecrOnNonNumeric          , 0x06)
29d22
< defExceptionP(isVBucketBelongsToAnotherServer , 0x07)
30d22
< defExceptionP(isAuthenticationError           , 0x08)
31d22
< defExceptionP(isAuthenticationContinue        , 0x09)
32d22
< defExceptionP(isUnknownCommand                , 0x81)
33d22
< defExceptionP(isOutOfMemory                   , 0x82)
34d22
< defExceptionP(isNotSupported                  , 0x83)
35d22
< defExceptionP(isInternalError                 , 0x84)
36d22
< defExceptionP(isBusy                          , 0x85)
37c23
< defExceptionP(isTemporaryFailure              , 0x86)
---
> isKeyNotFound(isKeyNotFound      :: MemcachedException, 0x01)  -> Bool;isKeyNotFound                    (MemcachedException i _) = i ==  0x01;isKeyNotFound                    _ = False
37a24
> isKeyExistsdefExceptionP(isKeyExists        :: MemcachedException, 0x02)  -> Bool;isKeyExists                      (MemcachedException i _) = i ==  0x02;isKeyExists                      _ = False
37a25
> isValueTooLargedefExceptionP(isValueTooLarge    :: MemcachedException, 0x03)  -> Bool;isValueTooLarge                  (MemcachedException i _) = i ==  0x03;isValueTooLarge                  _ = False
37a26
> isInvalidArgumentsdefExceptionP(isInvalidArguments :: MemcachedException, 0x04)  -> Bool;isInvalidArguments               (MemcachedException i _) = i ==  0x04;isInvalidArguments               _ = False
37a27
> isItemNotStoreddefExceptionP(isItemNotStored    :: MemcachedException, 0x05)  -> Bool;isItemNotStored                  (MemcachedException i _) = i ==  0x05;isItemNotStored                  _ = False
37a28
> isIncrDecrOnNonNumericdefExceptionP(isIncrDecrOnNonNumeric:: MemcachedException, 0x06)  -> Bool;isIncrDecrOnNonNumeric           (MemcachedException i _) = i ==  0x06;isIncrDecrOnNonNumeric           _ = False
37a29
> isVBucketBelongsToAnotherServerdefExceptionP(isVBucketBelongsToAnotherServer:: MemcachedException, 0x07)  -> Bool;isVBucketBelongsToAnotherServer  (MemcachedException i _) = i ==  0x07;isVBucketBelongsToAnotherServer  _ = False
37a30
> isAuthenticationErrordefExceptionP(isAuthenticationError:: MemcachedException, 0x08)  -> Bool;isAuthenticationError            (MemcachedException i _) = i ==  0x08;isAuthenticationError            _ = False
37a31
> isAuthenticationContinuedefExceptionP(isAuthenticationContinue:: MemcachedException, 0x09)  -> Bool;isAuthenticationContinue         (MemcachedException i _) = i ==  0x09;isAuthenticationContinue         _ = False
37a32
> isUnknownCommanddefExceptionP(isUnknownCommand   :: MemcachedException, 0x81)  -> Bool;isUnknownCommand                 (MemcachedException i _) = i ==  0x81;isUnknownCommand                 _ = False
37a33
> isOutOfMemory(isOutOfMemory      :: MemcachedException, 0x82)  -> Bool;isOutOfMemory                    (MemcachedException i _) = i ==  0x82;isOutOfMemory                    _ = False
37a34
> isNotSupporteddefExceptionP(isNotSupported     :: MemcachedException, 0x83)  -> Bool;isNotSupported                   (MemcachedException i _) = i ==  0x83;isNotSupported                   _ = False
37a35
> isInternalErrordefExceptionP(isInternalError    :: MemcachedException, 0x84)  -> Bool;isInternalError                  (MemcachedException i _) = i ==  0x84;isInternalError                  _ = False
37a36
> isBusydefExceptionP(isBusy             :: MemcachedException, 0x85)  -> Bool;isBusy                           (MemcachedException i _) = i ==  0x85;isBusy                           _ = False
37a37
> isTemporaryFailuredefExceptionP(isTemporaryFailure :: MemcachedException, 0x86)  -> Bool;isTemporaryFailure               (MemcachedException i _) = i ==  0x86;isTemporaryFailure               _ = False
39a40
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE DeriveDataTypeable #-}
{-# LANGUAGE CPP #-}

module Database.Memcached.Binary.Types.Exception where

import Control.Exception
import Data.Word
import Data.Typeable
import qualified Data.ByteString as S

data MemcachedException
    = MemcachedException {-# UNPACK #-} !Word16 {-# UNPACK #-} !S.ByteString
    | DataReadFailed
    | VersionParseFailed
    deriving (Show, Typeable)

instance Exception MemcachedException

#define defExceptionP(n,w) n :: MemcachedException -> Bool;\
n (MemcachedException i _) = i == w;\
n _ = False

defExceptionP(isKeyNotFound                   , 0x01)
defExceptionP(isKeyExists                     , 0x02)
defExceptionP(isValueTooLarge                 , 0x03)
defExceptionP(isInvalidArguments              , 0x04)
defExceptionP(isItemNotStored                 , 0x05)
defExceptionP(isIncrDecrOnNonNumeric          , 0x06)
defExceptionP(isVBucketBelongsToAnotherServer , 0x07)
defExceptionP(isAuthenticationError           , 0x08)
defExceptionP(isAuthenticationContinue        , 0x09)
defExceptionP(isUnknownCommand                , 0x81)
defExceptionP(isOutOfMemory                   , 0x82)
defExceptionP(isNotSupported                  , 0x83)
defExceptionP(isInternalError                 , 0x84)
defExceptionP(isBusy                          , 0x85)
defExceptionP(isTemporaryFailure              , 0x86)

#undef defExceptionP
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE DeriveDataTypeable #-}
{-# LANGUAGE CPP #-}

module Database.Memcached.Binary.Types.Exception where

import Control.Exception
import Data.Word
import Data.Typeable
import qualified Data.ByteString as S

data MemcachedException
    = MemcachedException {-# UNPACK #-} !Word16 {-# UNPACK #-} !S.ByteString
    | DataReadFailed
    | VersionParseFailed
    deriving (Show, Typeable)

instance Exception MemcachedException

#define defExceptionP(n,w) n :: MemcachedException -> Bool;\
n (MemcachedException i _) = i == w;\
n _ = False

isKeyNotFound(isKeyNotFound      :: MemcachedException, 0x01)  -> Bool;isKeyNotFound                    (MemcachedException i _) = i ==  0x01;isKeyNotFound                    _ = False
isKeyExistsdefExceptionP(isKeyExists        :: MemcachedException, 0x02)  -> Bool;isKeyExists                      (MemcachedException i _) = i ==  0x02;isKeyExists                      _ = False
isValueTooLargedefExceptionP(isValueTooLarge    :: MemcachedException, 0x03)  -> Bool;isValueTooLarge                  (MemcachedException i _) = i ==  0x03;isValueTooLarge                  _ = False
isInvalidArgumentsdefExceptionP(isInvalidArguments :: MemcachedException, 0x04)  -> Bool;isInvalidArguments               (MemcachedException i _) = i ==  0x04;isInvalidArguments               _ = False
isItemNotStoreddefExceptionP(isItemNotStored    :: MemcachedException, 0x05)  -> Bool;isItemNotStored                  (MemcachedException i _) = i ==  0x05;isItemNotStored                  _ = False
isIncrDecrOnNonNumericdefExceptionP(isIncrDecrOnNonNumeric:: MemcachedException, 0x06)  -> Bool;isIncrDecrOnNonNumeric           (MemcachedException i _) = i ==  0x06;isIncrDecrOnNonNumeric           _ = False
isVBucketBelongsToAnotherServerdefExceptionP(isVBucketBelongsToAnotherServer:: MemcachedException, 0x07)  -> Bool;isVBucketBelongsToAnotherServer  (MemcachedException i _) = i ==  0x07;isVBucketBelongsToAnotherServer  _ = False
isAuthenticationErrordefExceptionP(isAuthenticationError:: MemcachedException, 0x08)  -> Bool;isAuthenticationError            (MemcachedException i _) = i ==  0x08;isAuthenticationError            _ = False
isAuthenticationContinuedefExceptionP(isAuthenticationContinue:: MemcachedException, 0x09)  -> Bool;isAuthenticationContinue         (MemcachedException i _) = i ==  0x09;isAuthenticationContinue         _ = False
isUnknownCommanddefExceptionP(isUnknownCommand   :: MemcachedException, 0x81)  -> Bool;isUnknownCommand                 (MemcachedException i _) = i ==  0x81;isUnknownCommand                 _ = False
isOutOfMemory(isOutOfMemory      :: MemcachedException, 0x82)  -> Bool;isOutOfMemory                    (MemcachedException i _) = i ==  0x82;isOutOfMemory                    _ = False
isNotSupporteddefExceptionP(isNotSupported     :: MemcachedException, 0x83)  -> Bool;isNotSupported                   (MemcachedException i _) = i ==  0x83;isNotSupported                   _ = False
isInternalErrordefExceptionP(isInternalError    :: MemcachedException, 0x84)  -> Bool;isInternalError                  (MemcachedException i _) = i ==  0x84;isInternalError                  _ = False
isBusydefExceptionP(isBusy             :: MemcachedException, 0x85)  -> Bool;isBusy                           (MemcachedException i _) = i ==  0x85;isBusy                           _ = False
isTemporaryFailuredefExceptionP(isTemporaryFailure :: MemcachedException, 0x86)  -> Bool;isTemporaryFailure               (MemcachedException i _) = i ==  0x86;isTemporaryFailure               _ = False

#undef defExceptionP

</pre>