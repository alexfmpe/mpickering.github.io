<a href="Methods.hs6140565981790318751.out.html">prev</a></br><a href="failures.html">home</a></br><a href="MIDI.hs13349489051724586126.out.html">next</a></br></br><pre>54d53
<   { geoLatitude    ∷ [Double]
55d53
<   , geoLongitude   ∷ [Double]
56c54
<   , geoAltitude    ∷ [Double] }
---
>   { geoLatitude    :: [Double]
56a55
>   , geoLongitude   :: [Double]
56a56
>   , geoAltitude    :: [Double] }
67d66
<   { adrStreetAddress    ∷ [Text]
68d66
<   , adrExtendedAddress  ∷ [Text]
69d66
<   , adrPostOfficeBox    ∷ [Text]
70d66
<   , adrLocality         ∷ [Text]
71d66
<   , adrRegion           ∷ [Text]
72d66
<   , adrPostalCode       ∷ [Text]
73d66
<   , adrCountryName      ∷ [Text]
74d66
<   , adrLabel            ∷ [Text]
75c67
<   , adrGeo              ∷ [GeoReference] }
---
>   { adrStreetAddress    :: [Text]
75a68
>   , adrExtendedAddress  :: [Text]
75a69
>   , adrPostOfficeBox    :: [Text]
75a70
>   , adrLocality         :: [Text]
75a71
>   , adrRegion           :: [Text]
75a72
>   , adrPostalCode       :: [Text]
75a73
>   , adrCountryName      :: [Text]
75a74
>   , adrLabel            :: [Text]
75a75
>   , adrGeo              :: [GeoReference] }
92d91
<   { cardName              ∷ [Text]
93d91
<   , cardHonorificPrefix   ∷ [Text]
94d91
<   , cardGivenName         ∷ [Text]
95d91
<   , cardAdditionalName    ∷ [Text]
96d91
<   , cardFamilyName        ∷ [Text]
97d91
<   , cardSortString        ∷ [Text]
98d91
<   , cardHonorificSuffix   ∷ [Text]
99d91
<   , cardNickname          ∷ [Text]
100d91
<   , cardEmail             ∷ [Text]
101d91
<   , cardLogo              ∷ [Text]
102d91
<   , cardPhoto             ∷ [Text]
103d91
<   , cardUrl               ∷ [Text]
104d91
<   , cardUid               ∷ [Text]
105d91
<   , cardCategory          ∷ [Text]
106d91
<   , cardAdr               ∷ [AdrReference]
107d91
<   , cardTel               ∷ [Text]
108d91
<   , cardNote              ∷ [Text]
109d91
<   , cardBday              ∷ [UTCTime]
110d91
<   , cardKey               ∷ [Text]
111d91
<   , cardOrg               ∷ [CardReference]
112d91
<   , cardJobTitle          ∷ [Text]
113d91
<   , cardRole              ∷ [Text]
114d91
<   , cardImpp              ∷ [Text]
115d91
<   , cardSex               ∷ [Text]
116d91
<   , cardGenderIdentity    ∷ [Text]
117c92
<   , cardAnniversary       ∷ [UTCTime] }
---
>   { cardName              :: [Text]
117a93
>   , cardHonorificPrefix   :: [Text]
117a94
>   , cardGivenName         :: [Text]
117a95
>   , cardAdditionalName    :: [Text]
117a96
>   , cardFamilyName        :: [Text]
117a97
>   , cardSortString        :: [Text]
117a98
>   , cardHonorificSuffix   :: [Text]
117a99
>   , cardNickname          :: [Text]
117a100
>   , cardEmail             :: [Text]
117a101
>   , cardLogo              :: [Text]
117a102
>   , cardPhoto             :: [Text]
117a103
>   , cardUrl               :: [Text]
117a104
>   , cardUid               :: [Text]
117a105
>   , cardCategory          :: [Text]
117a106
>   , cardAdr               :: [AdrReference]
117a107
>   , cardTel               :: [Text]
117a108
>   , cardNote              :: [Text]
117a109
>   , cardBday              :: [UTCTime]
117a110
>   , cardKey               :: [Text]
117a111
>   , cardOrg               :: [CardReference]
117a112
>   , cardJobTitle          :: [Text]
117a113
>   , cardRole              :: [Text]
117a114
>   , cardImpp              :: [Text]
117a115
>   , cardSex               :: [Text]
117a116
>   , cardGenderIdentity    :: [Text]
117a117
>   , cardAnniversary       :: [UTCTime] }
151d150
<   { citeName        ∷ [Text]
152d150
<   , citePublished   ∷ [UTCTime]
153d150
<   , citeAuthor      ∷ [CardReference]
154d150
<   , citeUrl         ∷ [Text]
155d150
<   , citeUid         ∷ [Text]
156d150
<   , citePublication ∷ [Text]
157d150
<   , citeAccessed    ∷ [UTCTime]
158c151
<   , citeContent     ∷ [ContentReference] }
---
>   { citeName        :: [Text]
158a152
>   , citePublished   :: [UTCTime]
158a153
>   , citeAuthor      :: [CardReference]
158a154
>   , citeUrl         :: [Text]
158a155
>   , citeUid         :: [Text]
158a156
>   , citePublication :: [Text]
158a157
>   , citeAccessed    :: [UTCTime]
158a158
>   , citeContent     :: [ContentReference] }
174d173
<   { entryName           ∷ [Text]
175d173
<   , entrySummary        ∷ [Text]
176d173
<   , entryContent        ∷ [ContentReference]
177d173
<   , entryPublished      ∷ [UTCTime]
178d173
<   , entryUpdated        ∷ [UTCTime]
179d173
<   , entryAuthor         ∷ [CardReference]
180d173
<   , entryCategory       ∷ [Text]
181d173
<   , entryUrl            ∷ [Text]
182d173
<   , entryUid            ∷ [Text]
183d173
<   , entryLocation       ∷ [LocationReference]
184d173
<   , entryComments       ∷ [EntryReference]
185d173
<   , entrySyndication    ∷ [Text]
186d173
<   , entryInReplyTo      ∷ [EntryReference]
187d173
<   , entryLikeOf         ∷ [EntryReference]
188c174
<   , entryRepostOf       ∷ [EntryReference] }
---
>   { entryName           :: [Text]
188a175
>   , entrySummary        :: [Text]
188a176
>   , entryContent        :: [ContentReference]
188a177
>   , entryPublished      :: [UTCTime]
188a178
>   , entryUpdated        :: [UTCTime]
188a179
>   , entryAuthor         :: [CardReference]
188a180
>   , entryCategory       :: [Text]
188a181
>   , entryUrl            :: [Text]
188a182
>   , entryUid            :: [Text]
188a183
>   , entryLocation       :: [LocationReference]
188a184
>   , entryComments       :: [EntryReference]
188a185
>   , entrySyndication    :: [Text]
188a186
>   , entryInReplyTo      :: [EntryReference]
188a187
>   , entryLikeOf         :: [EntryReference]
188a188
>   , entryRepostOf       :: [EntryReference] }
207a208
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE DeriveDataTypeable, UnicodeSyntax, Trustworthy #-}

-- | Microformats 2 types for Haskell.
--
-- Notes:
--
-- 1. We don't duplicate sub-properties in parent types.
--    E.g. h-adr has both p-geo and p-latitude, p-longitude, p-altitude.
--    Adr only has a Geo.
--
-- 2. Lazy Text is used for storing texts, because it's the format used in Scotty, Hastache and other popular web libraries.
--
-- 3. Lists are used everywhere, because all properties might be multivalued, even though it doesn't always make sense.
--    Use 'headMay' from the safe package!
--
-- 4. SomethingReference sum types are used for, well, references.
--    The spec always makes embedded microformats optional, so these types include Text options.
--
module Data.Microformats2 where

import safe      Data.Typeable (Typeable)
import safe      Data.Text.Lazy (Text)
import safe      Data.Data (Data)
import           Data.Default.Class
import           Data.Time (UTCTime)
import           Text.Pandoc.Definition (Pandoc)

-- | A Geo reference.
data GeoReference = TextGeo Text | UrlGeo Text | GeoGeo Geo -- LOL
  deriving (Eq, Show, Data, Typeable)

-- | An Adr reference.
data AdrReference = TextAdr Text | AdrAdr Adr
  deriving (Eq, Show, Data, Typeable)

-- | A location (Card/Adr/Geo) reference.
data LocationReference = TextLoc Text | CardLoc Card | AdrLoc Adr | GeoLoc Geo
  deriving (Eq, Show, Data, Typeable)

-- | A Card reference.
data CardReference = TextCard Text | CardCard Card
  deriving (Eq, Show, Data, Typeable)

-- | An Entry/Cite reference.
data EntryReference = TextEntry Text | UrlEntry Text | CiteEntry Cite | EntryEntry Entry
  deriving (Eq, Show, Data, Typeable)

-- | A content reference.
data ContentReference = TextContent Text | PandocContent Pandoc
  deriving (Eq, Show, Data, Typeable)

-- | A Geo type, based on h-geo <http://microformats.org/wiki/h-geo>
data Geo = Geo
  { geoLatitude    ∷ [Double]
  , geoLongitude   ∷ [Double]
  , geoAltitude    ∷ [Double] }
  deriving (Eq, Show, Data, Typeable)

instance Default Geo where
  def = Geo
    { geoLatitude    = []
    , geoLongitude   = []
    , geoAltitude    = [] }

-- | An Adr type, based on h-adr <http://microformats.org/wiki/h-adr>
data Adr = Adr
  { adrStreetAddress    ∷ [Text]
  , adrExtendedAddress  ∷ [Text]
  , adrPostOfficeBox    ∷ [Text]
  , adrLocality         ∷ [Text]
  , adrRegion           ∷ [Text]
  , adrPostalCode       ∷ [Text]
  , adrCountryName      ∷ [Text]
  , adrLabel            ∷ [Text]
  , adrGeo              ∷ [GeoReference] }
  deriving (Eq, Show, Data, Typeable)

instance Default Adr where
  def = Adr
    { adrStreetAddress    = []
    , adrExtendedAddress  = []
    , adrPostOfficeBox    = []
    , adrLocality         = []
    , adrRegion           = []
    , adrPostalCode       = []
    , adrCountryName      = []
    , adrLabel            = []
    , adrGeo              = [] }

-- | A Card type, based on h-card <http://microformats.org/wiki/h-card>
data Card = Card
  { cardName              ∷ [Text]
  , cardHonorificPrefix   ∷ [Text]
  , cardGivenName         ∷ [Text]
  , cardAdditionalName    ∷ [Text]
  , cardFamilyName        ∷ [Text]
  , cardSortString        ∷ [Text]
  , cardHonorificSuffix   ∷ [Text]
  , cardNickname          ∷ [Text]
  , cardEmail             ∷ [Text]
  , cardLogo              ∷ [Text]
  , cardPhoto             ∷ [Text]
  , cardUrl               ∷ [Text]
  , cardUid               ∷ [Text]
  , cardCategory          ∷ [Text]
  , cardAdr               ∷ [AdrReference]
  , cardTel               ∷ [Text]
  , cardNote              ∷ [Text]
  , cardBday              ∷ [UTCTime]
  , cardKey               ∷ [Text]
  , cardOrg               ∷ [CardReference]
  , cardJobTitle          ∷ [Text]
  , cardRole              ∷ [Text]
  , cardImpp              ∷ [Text]
  , cardSex               ∷ [Text]
  , cardGenderIdentity    ∷ [Text]
  , cardAnniversary       ∷ [UTCTime] }
  deriving (Eq, Show, Data, Typeable)

instance Default Card where
  def = Card
    { cardName              = []
    , cardHonorificPrefix   = []
    , cardGivenName         = []
    , cardAdditionalName    = []
    , cardFamilyName        = []
    , cardSortString        = []
    , cardHonorificSuffix   = []
    , cardNickname          = []
    , cardEmail             = []
    , cardLogo              = []
    , cardPhoto             = []
    , cardUrl               = []
    , cardUid               = []
    , cardCategory          = []
    , cardAdr               = []
    , cardTel               = []
    , cardNote              = []
    , cardBday              = []
    , cardKey               = []
    , cardOrg               = []
    , cardJobTitle          = []
    , cardRole              = []
    , cardImpp              = []
    , cardSex               = []
    , cardGenderIdentity    = []
    , cardAnniversary       = [] }

-- | A Cite type, based on h-cite <http://microformats.org/wiki/h-cite>
data Cite = Cite
  { citeName        ∷ [Text]
  , citePublished   ∷ [UTCTime]
  , citeAuthor      ∷ [CardReference]
  , citeUrl         ∷ [Text]
  , citeUid         ∷ [Text]
  , citePublication ∷ [Text]
  , citeAccessed    ∷ [UTCTime]
  , citeContent     ∷ [ContentReference] }
  deriving (Eq, Show, Data, Typeable)

instance Default Cite where
  def = Cite
    { citeName        = []
    , citePublished   = []
    , citeAuthor      = []
    , citeUrl         = []
    , citeUid         = []
    , citePublication = []
    , citeAccessed    = []
    , citeContent     = [] }

-- | An Entry type, based on h-entry <http://microformats.org/wiki/h-entry> with popular extensions.
data Entry = Entry
  { entryName           ∷ [Text]
  , entrySummary        ∷ [Text]
  , entryContent        ∷ [ContentReference]
  , entryPublished      ∷ [UTCTime]
  , entryUpdated        ∷ [UTCTime]
  , entryAuthor         ∷ [CardReference]
  , entryCategory       ∷ [Text]
  , entryUrl            ∷ [Text]
  , entryUid            ∷ [Text]
  , entryLocation       ∷ [LocationReference]
  , entryComments       ∷ [EntryReference]
  , entrySyndication    ∷ [Text]
  , entryInReplyTo      ∷ [EntryReference]
  , entryLikeOf         ∷ [EntryReference]
  , entryRepostOf       ∷ [EntryReference] }
  deriving (Eq, Show, Data, Typeable)

instance Default Entry where
  def = Entry
    { entryName           = []
    , entrySummary        = []
    , entryContent        = []
    , entryPublished      = []
    , entryUpdated        = []
    , entryAuthor         = []
    , entryCategory       = []
    , entryUrl            = []
    , entryUid            = []
    , entryLocation       = []
    , entryComments       = []
    , entrySyndication    = []
    , entryInReplyTo      = []
    , entryLikeOf         = []
    , entryRepostOf       = [] }
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE DeriveDataTypeable, UnicodeSyntax, Trustworthy #-}

-- | Microformats 2 types for Haskell.
--
-- Notes:
--
-- 1. We don't duplicate sub-properties in parent types.
--    E.g. h-adr has both p-geo and p-latitude, p-longitude, p-altitude.
--    Adr only has a Geo.
--
-- 2. Lazy Text is used for storing texts, because it's the format used in Scotty, Hastache and other popular web libraries.
--
-- 3. Lists are used everywhere, because all properties might be multivalued, even though it doesn't always make sense.
--    Use 'headMay' from the safe package!
--
-- 4. SomethingReference sum types are used for, well, references.
--    The spec always makes embedded microformats optional, so these types include Text options.
--
module Data.Microformats2 where

import safe      Data.Typeable (Typeable)
import safe      Data.Text.Lazy (Text)
import safe      Data.Data (Data)
import           Data.Default.Class
import           Data.Time (UTCTime)
import           Text.Pandoc.Definition (Pandoc)

-- | A Geo reference.
data GeoReference = TextGeo Text | UrlGeo Text | GeoGeo Geo -- LOL
  deriving (Eq, Show, Data, Typeable)

-- | An Adr reference.
data AdrReference = TextAdr Text | AdrAdr Adr
  deriving (Eq, Show, Data, Typeable)

-- | A location (Card/Adr/Geo) reference.
data LocationReference = TextLoc Text | CardLoc Card | AdrLoc Adr | GeoLoc Geo
  deriving (Eq, Show, Data, Typeable)

-- | A Card reference.
data CardReference = TextCard Text | CardCard Card
  deriving (Eq, Show, Data, Typeable)

-- | An Entry/Cite reference.
data EntryReference = TextEntry Text | UrlEntry Text | CiteEntry Cite | EntryEntry Entry
  deriving (Eq, Show, Data, Typeable)

-- | A content reference.
data ContentReference = TextContent Text | PandocContent Pandoc
  deriving (Eq, Show, Data, Typeable)

-- | A Geo type, based on h-geo <http://microformats.org/wiki/h-geo>
data Geo = Geo
  { geoLatitude    :: [Double]
  , geoLongitude   :: [Double]
  , geoAltitude    :: [Double] }
  deriving (Eq, Show, Data, Typeable)

instance Default Geo where
  def = Geo
    { geoLatitude    = []
    , geoLongitude   = []
    , geoAltitude    = [] }

-- | An Adr type, based on h-adr <http://microformats.org/wiki/h-adr>
data Adr = Adr
  { adrStreetAddress    :: [Text]
  , adrExtendedAddress  :: [Text]
  , adrPostOfficeBox    :: [Text]
  , adrLocality         :: [Text]
  , adrRegion           :: [Text]
  , adrPostalCode       :: [Text]
  , adrCountryName      :: [Text]
  , adrLabel            :: [Text]
  , adrGeo              :: [GeoReference] }
  deriving (Eq, Show, Data, Typeable)

instance Default Adr where
  def = Adr
    { adrStreetAddress    = []
    , adrExtendedAddress  = []
    , adrPostOfficeBox    = []
    , adrLocality         = []
    , adrRegion           = []
    , adrPostalCode       = []
    , adrCountryName      = []
    , adrLabel            = []
    , adrGeo              = [] }

-- | A Card type, based on h-card <http://microformats.org/wiki/h-card>
data Card = Card
  { cardName              :: [Text]
  , cardHonorificPrefix   :: [Text]
  , cardGivenName         :: [Text]
  , cardAdditionalName    :: [Text]
  , cardFamilyName        :: [Text]
  , cardSortString        :: [Text]
  , cardHonorificSuffix   :: [Text]
  , cardNickname          :: [Text]
  , cardEmail             :: [Text]
  , cardLogo              :: [Text]
  , cardPhoto             :: [Text]
  , cardUrl               :: [Text]
  , cardUid               :: [Text]
  , cardCategory          :: [Text]
  , cardAdr               :: [AdrReference]
  , cardTel               :: [Text]
  , cardNote              :: [Text]
  , cardBday              :: [UTCTime]
  , cardKey               :: [Text]
  , cardOrg               :: [CardReference]
  , cardJobTitle          :: [Text]
  , cardRole              :: [Text]
  , cardImpp              :: [Text]
  , cardSex               :: [Text]
  , cardGenderIdentity    :: [Text]
  , cardAnniversary       :: [UTCTime] }
  deriving (Eq, Show, Data, Typeable)

instance Default Card where
  def = Card
    { cardName              = []
    , cardHonorificPrefix   = []
    , cardGivenName         = []
    , cardAdditionalName    = []
    , cardFamilyName        = []
    , cardSortString        = []
    , cardHonorificSuffix   = []
    , cardNickname          = []
    , cardEmail             = []
    , cardLogo              = []
    , cardPhoto             = []
    , cardUrl               = []
    , cardUid               = []
    , cardCategory          = []
    , cardAdr               = []
    , cardTel               = []
    , cardNote              = []
    , cardBday              = []
    , cardKey               = []
    , cardOrg               = []
    , cardJobTitle          = []
    , cardRole              = []
    , cardImpp              = []
    , cardSex               = []
    , cardGenderIdentity    = []
    , cardAnniversary       = [] }

-- | A Cite type, based on h-cite <http://microformats.org/wiki/h-cite>
data Cite = Cite
  { citeName        :: [Text]
  , citePublished   :: [UTCTime]
  , citeAuthor      :: [CardReference]
  , citeUrl         :: [Text]
  , citeUid         :: [Text]
  , citePublication :: [Text]
  , citeAccessed    :: [UTCTime]
  , citeContent     :: [ContentReference] }
  deriving (Eq, Show, Data, Typeable)

instance Default Cite where
  def = Cite
    { citeName        = []
    , citePublished   = []
    , citeAuthor      = []
    , citeUrl         = []
    , citeUid         = []
    , citePublication = []
    , citeAccessed    = []
    , citeContent     = [] }

-- | An Entry type, based on h-entry <http://microformats.org/wiki/h-entry> with popular extensions.
data Entry = Entry
  { entryName           :: [Text]
  , entrySummary        :: [Text]
  , entryContent        :: [ContentReference]
  , entryPublished      :: [UTCTime]
  , entryUpdated        :: [UTCTime]
  , entryAuthor         :: [CardReference]
  , entryCategory       :: [Text]
  , entryUrl            :: [Text]
  , entryUid            :: [Text]
  , entryLocation       :: [LocationReference]
  , entryComments       :: [EntryReference]
  , entrySyndication    :: [Text]
  , entryInReplyTo      :: [EntryReference]
  , entryLikeOf         :: [EntryReference]
  , entryRepostOf       :: [EntryReference] }
  deriving (Eq, Show, Data, Typeable)

instance Default Entry where
  def = Entry
    { entryName           = []
    , entrySummary        = []
    , entryContent        = []
    , entryPublished      = []
    , entryUpdated        = []
    , entryAuthor         = []
    , entryCategory       = []
    , entryUrl            = []
    , entryUid            = []
    , entryLocation       = []
    , entryComments       = []
    , entrySyndication    = []
    , entryInReplyTo      = []
    , entryLikeOf         = []
    , entryRepostOf       = [] }

</pre>