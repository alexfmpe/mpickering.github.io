<a href="Instrument.hs5322361231023129506.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Integral.hs20516216091606946231.out.html">next</a></br></br><pre>76c76
<   systemName ∷ s → String
---
>   systemName :: s -> String
78c78
<   radixIn ∷ Num α ⇒ s → α
---
>   radixIn :: Num α => s -> α
80c80
<   isDigitIn ∷ s → Char → Bool
---
>   isDigitIn :: s -> Char -> Bool
82c82
<   isNzDigitIn ∷ s → Char → Bool
---
>   isNzDigitIn :: s -> Char -> Bool
85c85
<   fromDigitIn ∷ Num α ⇒ s → Char → Maybe α
---
>   fromDigitIn :: Num α => s -> Char -> Maybe α
88c88
<   fromNzDigitIn ∷ Num α ⇒ s → Char → Maybe α
---
>   fromNzDigitIn :: Num α => s -> Char -> Maybe α
90c90
<   unsafeFromDigitIn ∷ Num α ⇒ s → Char → α
---
>   unsafeFromDigitIn :: Num α => s -> Char -> α
93c93
<   intToDigitIn ∷ s → Int → Char
---
>   intToDigitIn :: s -> Int -> Char
95c95
<   printDigitIn ∷ Printer p ⇒ s → Char → p
---
>   printDigitIn :: Printer p => s -> Char -> p
98c98
<   printZeroIn ∷ Printer p ⇒ s → p
---
>   printZeroIn :: Printer p => s -> p
103c103
< class PositionalSystem s ⇒ BitSystem s where
---
> class PositionalSystem s => BitSystem s where
105c105
<   digitBitsIn ∷ s → Int
---
>   digitBitsIn :: s -> Int
108c108
<   digitMaskIn ∷ Num α ⇒ s → α
---
>   digitMaskIn :: Num α => s -> α
110c110
<   lastDigitIn ∷ Bits α ⇒ s → α → Int
---
>   lastDigitIn :: Bits α => s -> α -> Int
305c305
< nonNegative ∷ (PositionalSystem s, Integral α, Printer p) ⇒ s → α → p
---
> nonNegative :: (PositionalSystem s, Integral α, Printer p) => s -> α -> p
313d312
< {-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Int → p #-}
314d312
< {-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Int8 → p #-}
315d312
< {-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Int16 → p #-}
316d312
< {-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Int32 → p #-}
317d312
< {-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Int64 → p #-}
318d312
< {-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Word → p #-}
319d312
< {-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Word8 → p #-}
320d312
< {-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Word16 → p #-}
321d312
< {-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Word32 → p #-}
322d312
< {-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Word64 → p #-}
323d312
< {-# SPECIALIZE nonNegative ∷ (Integral α, Printer p) ⇒ Binary → α → p #-}
324d312
< {-# SPECIALIZE nonNegative ∷ (Integral α, Printer p) ⇒ Octal → α → p #-}
325d312
< {-# SPECIALIZE nonNegative ∷ (Integral α, Printer p) ⇒ Decimal → α → p #-}
326d312
< {-# SPECIALIZE nonNegative ∷ (Integral α, Printer p) ⇒ LowHex → α → p #-}
327c313
< {-# SPECIALIZE nonNegative ∷ (Integral α, Printer p) ⇒ UpHex → α → p #-}
---
> {-# SPECIALIZE nonNegative :: Printer p => Decimal -> Int -> p #-}
327a314
> {-# SPECIALIZE nonNegative :: Printer p => Decimal -> Int8 -> p #-}
327a315
> {-# SPECIALIZE nonNegative :: Printer p => Decimal -> Int16 -> p #-}
327a316
> {-# SPECIALIZE nonNegative :: Printer p => Decimal -> Int32 -> p #-}
327a317
> {-# SPECIALIZE nonNegative :: Printer p => Decimal -> Int64 -> p #-}
327a318
> {-# SPECIALIZE nonNegative :: Printer p => Decimal -> Word -> p #-}
327a319
> {-# SPECIALIZE nonNegative :: Printer p => Decimal -> Word8 -> p #-}
327a320
> {-# SPECIALIZE nonNegative :: Printer p => Decimal -> Word16 -> p #-}
327a321
> {-# SPECIALIZE nonNegative :: Printer p => Decimal -> Word32 -> p #-}
327a322
> {-# SPECIALIZE nonNegative :: Printer p => Decimal -> Word64 -> p #-}
327a323
> {-# SPECIALIZE nonNegative :: (Integral α, Printer p) => Binary -> α -> p #-}
327a324
> {-# SPECIALIZE nonNegative :: (Integral α, Printer p) => Octal -> α -> p #-}
327a325
> {-# SPECIALIZE nonNegative :: (Integral α, Printer p) => Decimal -> α -> p #-}
327a326
> {-# SPECIALIZE nonNegative :: (Integral α, Printer p) => LowHex -> α -> p #-}
327a327
> {-# SPECIALIZE nonNegative :: (Integral α, Printer p) => UpHex -> α -> p #-}
330c330
< nnBinary ∷ (Integral α, Printer p) ⇒ α → p
---
> nnBinary :: (Integral α, Printer p) => α -> p
335c335
< nnOctal ∷ (Integral α, Printer p) ⇒ α → p
---
> nnOctal :: (Integral α, Printer p) => α -> p
340c340
< nnDecimal ∷ (Integral α, Printer p) ⇒ α → p
---
> nnDecimal :: (Integral α, Printer p) => α -> p
346c346
< nnLowHex ∷ (Integral α, Printer p) ⇒ α → p
---
> nnLowHex :: (Integral α, Printer p) => α -> p
352c352
< nnUpHex ∷ (Integral α, Printer p) ⇒ α → p
---
> nnUpHex :: (Integral α, Printer p) => α -> p
358c358
< nnBits ∷ (BitSystem s, Num α, Bits α, Printer p) ⇒ s → α → p
---
> nnBits :: (BitSystem s, Num α, Bits α, Printer p) => s -> α -> p
365d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Int → p #-}
366d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Int8 → p #-}
367d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Int16 → p #-}
368d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Int32 → p #-}
369d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Int64 → p #-}
370d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Word → p #-}
371d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Word8 → p #-}
372d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Word16 → p #-}
373d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Word32 → p #-}
374d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Word64 → p #-}
375d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Int → p #-}
376d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Int8 → p #-}
377d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Int16 → p #-}
378d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Int32 → p #-}
379d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Int64 → p #-}
380d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Word → p #-}
381d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Word8 → p #-}
382d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Word16 → p #-}
383d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Word32 → p #-}
384d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Word64 → p #-}
385d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Int → p #-}
386d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Int8 → p #-}
387d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Int16 → p #-}
388d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Int32 → p #-}
389d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Int64 → p #-}
390d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Word → p #-}
391d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Word8 → p #-}
392d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Word16 → p #-}
393d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Word32 → p #-}
394d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Word64 → p #-}
395d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Int → p #-}
396d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Int8 → p #-}
397d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Int16 → p #-}
398d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Int32 → p #-}
399d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Int64 → p #-}
400d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Word → p #-}
401d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Word8 → p #-}
402d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Word16 → p #-}
403d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Word32 → p #-}
404d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Word64 → p #-}
405d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Int → p #-}
406d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Int8 → p #-}
407d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Int16 → p #-}
408d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Int32 → p #-}
409d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Int64 → p #-}
410d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Word → p #-}
411d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Word8 → p #-}
412d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Word16 → p #-}
413d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Word32 → p #-}
414d364
< {-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Word64 → p #-}
415d364
< {-# SPECIALIZE nnBits ∷ (Num α, Bits α, Printer p) ⇒ Binary → α → p #-}
416d364
< {-# SPECIALIZE nnBits ∷ (Num α, Bits α, Printer p) ⇒ Octal → α → p #-}
417d364
< {-# SPECIALIZE nnBits ∷ (Num α, Bits α, Printer p) ⇒ Hexadecimal → α → p #-}
418d364
< {-# SPECIALIZE nnBits ∷ (Num α, Bits α, Printer p) ⇒ LowHex → α → p #-}
419c365
< {-# SPECIALIZE nnBits ∷ (Num α, Bits α, Printer p) ⇒ UpHex → α → p #-}
---
> {-# SPECIALIZE nnBits :: Printer p => Binary -> Int -> p #-}
419a366
> {-# SPECIALIZE nnBits :: Printer p => Binary -> Int8 -> p #-}
419a367
> {-# SPECIALIZE nnBits :: Printer p => Binary -> Int16 -> p #-}
419a368
> {-# SPECIALIZE nnBits :: Printer p => Binary -> Int32 -> p #-}
419a369
> {-# SPECIALIZE nnBits :: Printer p => Binary -> Int64 -> p #-}
419a370
> {-# SPECIALIZE nnBits :: Printer p => Binary -> Word -> p #-}
419a371
> {-# SPECIALIZE nnBits :: Printer p => Binary -> Word8 -> p #-}
419a372
> {-# SPECIALIZE nnBits :: Printer p => Binary -> Word16 -> p #-}
419a373
> {-# SPECIALIZE nnBits :: Printer p => Binary -> Word32 -> p #-}
419a374
> {-# SPECIALIZE nnBits :: Printer p => Binary -> Word64 -> p #-}
419a375
> {-# SPECIALIZE nnBits :: Printer p => Octal -> Int -> p #-}
419a376
> {-# SPECIALIZE nnBits :: Printer p => Octal -> Int8 -> p #-}
419a377
> {-# SPECIALIZE nnBits :: Printer p => Octal -> Int16 -> p #-}
419a378
> {-# SPECIALIZE nnBits :: Printer p => Octal -> Int32 -> p #-}
419a379
> {-# SPECIALIZE nnBits :: Printer p => Octal -> Int64 -> p #-}
419a380
> {-# SPECIALIZE nnBits :: Printer p => Octal -> Word -> p #-}
419a381
> {-# SPECIALIZE nnBits :: Printer p => Octal -> Word8 -> p #-}
419a382
> {-# SPECIALIZE nnBits :: Printer p => Octal -> Word16 -> p #-}
419a383
> {-# SPECIALIZE nnBits :: Printer p => Octal -> Word32 -> p #-}
419a384
> {-# SPECIALIZE nnBits :: Printer p => Octal -> Word64 -> p #-}
419a385
> {-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Int -> p #-}
419a386
> {-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Int8 -> p #-}
419a387
> {-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Int16 -> p #-}
419a388
> {-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Int32 -> p #-}
419a389
> {-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Int64 -> p #-}
419a390
> {-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Word -> p #-}
419a391
> {-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Word8 -> p #-}
419a392
> {-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Word16 -> p #-}
419a393
> {-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Word32 -> p #-}
419a394
> {-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Word64 -> p #-}
419a395
> {-# SPECIALIZE nnBits :: Printer p => LowHex -> Int -> p #-}
419a396
> {-# SPECIALIZE nnBits :: Printer p => LowHex -> Int8 -> p #-}
419a397
> {-# SPECIALIZE nnBits :: Printer p => LowHex -> Int16 -> p #-}
419a398
> {-# SPECIALIZE nnBits :: Printer p => LowHex -> Int32 -> p #-}
419a399
> {-# SPECIALIZE nnBits :: Printer p => LowHex -> Int64 -> p #-}
419a400
> {-# SPECIALIZE nnBits :: Printer p => LowHex -> Word -> p #-}
419a401
> {-# SPECIALIZE nnBits :: Printer p => LowHex -> Word8 -> p #-}
419a402
> {-# SPECIALIZE nnBits :: Printer p => LowHex -> Word16 -> p #-}
419a403
> {-# SPECIALIZE nnBits :: Printer p => LowHex -> Word32 -> p #-}
419a404
> {-# SPECIALIZE nnBits :: Printer p => LowHex -> Word64 -> p #-}
419a405
> {-# SPECIALIZE nnBits :: Printer p => UpHex -> Int -> p #-}
419a406
> {-# SPECIALIZE nnBits :: Printer p => UpHex -> Int8 -> p #-}
419a407
> {-# SPECIALIZE nnBits :: Printer p => UpHex -> Int16 -> p #-}
419a408
> {-# SPECIALIZE nnBits :: Printer p => UpHex -> Int32 -> p #-}
419a409
> {-# SPECIALIZE nnBits :: Printer p => UpHex -> Int64 -> p #-}
419a410
> {-# SPECIALIZE nnBits :: Printer p => UpHex -> Word -> p #-}
419a411
> {-# SPECIALIZE nnBits :: Printer p => UpHex -> Word8 -> p #-}
419a412
> {-# SPECIALIZE nnBits :: Printer p => UpHex -> Word16 -> p #-}
419a413
> {-# SPECIALIZE nnBits :: Printer p => UpHex -> Word32 -> p #-}
419a414
> {-# SPECIALIZE nnBits :: Printer p => UpHex -> Word64 -> p #-}
419a415
> {-# SPECIALIZE nnBits :: (Num α, Bits α, Printer p) => Binary -> α -> p #-}
419a416
> {-# SPECIALIZE nnBits :: (Num α, Bits α, Printer p) => Octal -> α -> p #-}
419a417
> {-# SPECIALIZE nnBits :: (Num α, Bits α, Printer p) => Hexadecimal -> α -> p #-}
419a418
> {-# SPECIALIZE nnBits :: (Num α, Bits α, Printer p) => LowHex -> α -> p #-}
419a419
> {-# SPECIALIZE nnBits :: (Num α, Bits α, Printer p) => UpHex -> α -> p #-}
422c422
< nnBinaryBits ∷ (Num α, Bits α, Printer p) ⇒ α → p
---
> nnBinaryBits :: (Num α, Bits α, Printer p) => α -> p
427c427
< nnOctalBits ∷ (Num α, Bits α, Printer p) ⇒ α → p
---
> nnOctalBits :: (Num α, Bits α, Printer p) => α -> p
433c433
< nnLowHexBits ∷ (Num α, Bits α, Printer p) ⇒ α → p
---
> nnLowHexBits :: (Num α, Bits α, Printer p) => α -> p
439c439
< nnUpHexBits ∷ (Num α, Bits α, Printer p) ⇒ α → p
---
> nnUpHexBits :: (Num α, Bits α, Printer p) => α -> p
445c445
< nonPositive ∷ (PositionalSystem s, Integral α, Printer p) ⇒ s → α → p
---
> nonPositive :: (PositionalSystem s, Integral α, Printer p) => s -> α -> p
453d452
< {-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Int → p #-}
454d452
< {-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Int8 → p #-}
455d452
< {-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Int16 → p #-}
456d452
< {-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Int32 → p #-}
457d452
< {-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Int64 → p #-}
458d452
< {-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Word → p #-}
459d452
< {-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Word8 → p #-}
460d452
< {-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Word16 → p #-}
461d452
< {-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Word32 → p #-}
462d452
< {-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Word64 → p #-}
463d452
< {-# SPECIALIZE nonPositive ∷ (Integral α, Printer p) ⇒ Binary → α → p #-}
464d452
< {-# SPECIALIZE nonPositive ∷ (Integral α, Printer p) ⇒ Octal → α → p #-}
465d452
< {-# SPECIALIZE nonPositive ∷ (Integral α, Printer p) ⇒ Decimal → α → p #-}
466d452
< {-# SPECIALIZE nonPositive ∷ (Integral α, Printer p) ⇒ LowHex → α → p #-}
467c453
< {-# SPECIALIZE nonPositive ∷ (Integral α, Printer p) ⇒ UpHex → α → p #-}
---
> {-# SPECIALIZE nonPositive :: Printer p => Decimal -> Int -> p #-}
467a454
> {-# SPECIALIZE nonPositive :: Printer p => Decimal -> Int8 -> p #-}
467a455
> {-# SPECIALIZE nonPositive :: Printer p => Decimal -> Int16 -> p #-}
467a456
> {-# SPECIALIZE nonPositive :: Printer p => Decimal -> Int32 -> p #-}
467a457
> {-# SPECIALIZE nonPositive :: Printer p => Decimal -> Int64 -> p #-}
467a458
> {-# SPECIALIZE nonPositive :: Printer p => Decimal -> Word -> p #-}
467a459
> {-# SPECIALIZE nonPositive :: Printer p => Decimal -> Word8 -> p #-}
467a460
> {-# SPECIALIZE nonPositive :: Printer p => Decimal -> Word16 -> p #-}
467a461
> {-# SPECIALIZE nonPositive :: Printer p => Decimal -> Word32 -> p #-}
467a462
> {-# SPECIALIZE nonPositive :: Printer p => Decimal -> Word64 -> p #-}
467a463
> {-# SPECIALIZE nonPositive :: (Integral α, Printer p) => Binary -> α -> p #-}
467a464
> {-# SPECIALIZE nonPositive :: (Integral α, Printer p) => Octal -> α -> p #-}
467a465
> {-# SPECIALIZE nonPositive :: (Integral α, Printer p) => Decimal -> α -> p #-}
467a466
> {-# SPECIALIZE nonPositive :: (Integral α, Printer p) => LowHex -> α -> p #-}
467a467
> {-# SPECIALIZE nonPositive :: (Integral α, Printer p) => UpHex -> α -> p #-}
470c470
< npBinary ∷ (Integral α, Printer p) ⇒ α → p
---
> npBinary :: (Integral α, Printer p) => α -> p
475c475
< npOctal ∷ (Integral α, Printer p) ⇒ α → p
---
> npOctal :: (Integral α, Printer p) => α -> p
480c480
< npDecimal ∷ (Integral α, Printer p) ⇒ α → p
---
> npDecimal :: (Integral α, Printer p) => α -> p
486c486
< npLowHex ∷ (Integral α, Printer p) ⇒ α → p
---
> npLowHex :: (Integral α, Printer p) => α -> p
492c492
< npUpHex ∷ (Integral α, Printer p) ⇒ α → p
---
> npUpHex :: (Integral α, Printer p) => α -> p
499c499
< npBits ∷ (BitSystem s, Ord α, Num α, Bits α, Printer p) ⇒ s → α → p
---
> npBits :: (BitSystem s, Ord α, Num α, Bits α, Printer p) => s -> α -> p
501c501
<     True → go mempty (shiftR (negate n) digitBits) <> printDigitIn s d
---
>     True -> go mempty (shiftR (negate n) digitBits) <> printDigitIn s d
503d502
<     False → case n > negRadix of
504d502
<         True → printDigitIn s d'
505c503
<         False → go mempty m <> printDigitIn s d'
---
>     False -> case n > negRadix of
505a504
>         True -> printDigitIn s d'
505a505
>         False -> go mempty m <> printDigitIn s d'
517d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Int → p #-}
518d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Int8 → p #-}
519d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Int16 → p #-}
520d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Int32 → p #-}
521d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Int64 → p #-}
522d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Word → p #-}
523d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Word8 → p #-}
524d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Word16 → p #-}
525d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Word32 → p #-}
526d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Word64 → p #-}
527d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Int → p #-}
528d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Int8 → p #-}
529d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Int16 → p #-}
530d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Int32 → p #-}
531d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Int64 → p #-}
532d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Word → p #-}
533d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Word8 → p #-}
534d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Word16 → p #-}
535d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Word32 → p #-}
536d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Word64 → p #-}
537d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Int → p #-}
538d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Int8 → p #-}
539d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Int16 → p #-}
540d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Int32 → p #-}
541d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Int64 → p #-}
542d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Word → p #-}
543d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Word8 → p #-}
544d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Word16 → p #-}
545d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Word32 → p #-}
546d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Word64 → p #-}
547d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Int → p #-}
548d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Int8 → p #-}
549d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Int16 → p #-}
550d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Int32 → p #-}
551d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Int64 → p #-}
552d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Word → p #-}
553d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Word8 → p #-}
554d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Word16 → p #-}
555d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Word32 → p #-}
556d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Word64 → p #-}
557d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Int → p #-}
558d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Int8 → p #-}
559d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Int16 → p #-}
560d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Int32 → p #-}
561d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Int64 → p #-}
562d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Word → p #-}
563d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Word8 → p #-}
564d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Word16 → p #-}
565d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Word32 → p #-}
566d516
< {-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Word64 → p #-}
567d516
< {-# SPECIALIZE npBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ Binary → α → p #-}
568d516
< {-# SPECIALIZE npBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ Octal → α → p #-}
569d516
< {-# SPECIALIZE npBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ Hexadecimal → α → p #-}
570d516
< {-# SPECIALIZE npBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ LowHex → α → p #-}
571c517
< {-# SPECIALIZE npBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ UpHex → α → p #-}
---
> {-# SPECIALIZE npBits :: Printer p => Binary -> Int -> p #-}
571a518
> {-# SPECIALIZE npBits :: Printer p => Binary -> Int8 -> p #-}
571a519
> {-# SPECIALIZE npBits :: Printer p => Binary -> Int16 -> p #-}
571a520
> {-# SPECIALIZE npBits :: Printer p => Binary -> Int32 -> p #-}
571a521
> {-# SPECIALIZE npBits :: Printer p => Binary -> Int64 -> p #-}
571a522
> {-# SPECIALIZE npBits :: Printer p => Binary -> Word -> p #-}
571a523
> {-# SPECIALIZE npBits :: Printer p => Binary -> Word8 -> p #-}
571a524
> {-# SPECIALIZE npBits :: Printer p => Binary -> Word16 -> p #-}
571a525
> {-# SPECIALIZE npBits :: Printer p => Binary -> Word32 -> p #-}
571a526
> {-# SPECIALIZE npBits :: Printer p => Binary -> Word64 -> p #-}
571a527
> {-# SPECIALIZE npBits :: Printer p => Octal -> Int -> p #-}
571a528
> {-# SPECIALIZE npBits :: Printer p => Octal -> Int8 -> p #-}
571a529
> {-# SPECIALIZE npBits :: Printer p => Octal -> Int16 -> p #-}
571a530
> {-# SPECIALIZE npBits :: Printer p => Octal -> Int32 -> p #-}
571a531
> {-# SPECIALIZE npBits :: Printer p => Octal -> Int64 -> p #-}
571a532
> {-# SPECIALIZE npBits :: Printer p => Octal -> Word -> p #-}
571a533
> {-# SPECIALIZE npBits :: Printer p => Octal -> Word8 -> p #-}
571a534
> {-# SPECIALIZE npBits :: Printer p => Octal -> Word16 -> p #-}
571a535
> {-# SPECIALIZE npBits :: Printer p => Octal -> Word32 -> p #-}
571a536
> {-# SPECIALIZE npBits :: Printer p => Octal -> Word64 -> p #-}
571a537
> {-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Int -> p #-}
571a538
> {-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Int8 -> p #-}
571a539
> {-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Int16 -> p #-}
571a540
> {-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Int32 -> p #-}
571a541
> {-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Int64 -> p #-}
571a542
> {-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Word -> p #-}
571a543
> {-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Word8 -> p #-}
571a544
> {-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Word16 -> p #-}
571a545
> {-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Word32 -> p #-}
571a546
> {-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Word64 -> p #-}
571a547
> {-# SPECIALIZE npBits :: Printer p => LowHex -> Int -> p #-}
571a548
> {-# SPECIALIZE npBits :: Printer p => LowHex -> Int8 -> p #-}
571a549
> {-# SPECIALIZE npBits :: Printer p => LowHex -> Int16 -> p #-}
571a550
> {-# SPECIALIZE npBits :: Printer p => LowHex -> Int32 -> p #-}
571a551
> {-# SPECIALIZE npBits :: Printer p => LowHex -> Int64 -> p #-}
571a552
> {-# SPECIALIZE npBits :: Printer p => LowHex -> Word -> p #-}
571a553
> {-# SPECIALIZE npBits :: Printer p => LowHex -> Word8 -> p #-}
571a554
> {-# SPECIALIZE npBits :: Printer p => LowHex -> Word16 -> p #-}
571a555
> {-# SPECIALIZE npBits :: Printer p => LowHex -> Word32 -> p #-}
571a556
> {-# SPECIALIZE npBits :: Printer p => LowHex -> Word64 -> p #-}
571a557
> {-# SPECIALIZE npBits :: Printer p => UpHex -> Int -> p #-}
571a558
> {-# SPECIALIZE npBits :: Printer p => UpHex -> Int8 -> p #-}
571a559
> {-# SPECIALIZE npBits :: Printer p => UpHex -> Int16 -> p #-}
571a560
> {-# SPECIALIZE npBits :: Printer p => UpHex -> Int32 -> p #-}
571a561
> {-# SPECIALIZE npBits :: Printer p => UpHex -> Int64 -> p #-}
571a562
> {-# SPECIALIZE npBits :: Printer p => UpHex -> Word -> p #-}
571a563
> {-# SPECIALIZE npBits :: Printer p => UpHex -> Word8 -> p #-}
571a564
> {-# SPECIALIZE npBits :: Printer p => UpHex -> Word16 -> p #-}
571a565
> {-# SPECIALIZE npBits :: Printer p => UpHex -> Word32 -> p #-}
571a566
> {-# SPECIALIZE npBits :: Printer p => UpHex -> Word64 -> p #-}
571a567
> {-# SPECIALIZE npBits :: (Ord α, Num α, Bits α, Printer p) => Binary -> α -> p #-}
571a568
> {-# SPECIALIZE npBits :: (Ord α, Num α, Bits α, Printer p) => Octal -> α -> p #-}
571a569
> {-# SPECIALIZE npBits :: (Ord α, Num α, Bits α, Printer p) => Hexadecimal -> α -> p #-}
571a570
> {-# SPECIALIZE npBits :: (Ord α, Num α, Bits α, Printer p) => LowHex -> α -> p #-}
571a571
> {-# SPECIALIZE npBits :: (Ord α, Num α, Bits α, Printer p) => UpHex -> α -> p #-}
574c574
< npBinaryBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ α → p
---
> npBinaryBits :: (Ord α, Num α, Bits α, Printer p) => α -> p
579c579
< npOctalBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ α → p
---
> npOctalBits :: (Ord α, Num α, Bits α, Printer p) => α -> p
585c585
< npLowHexBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ α → p
---
> npLowHexBits :: (Ord α, Num α, Bits α, Printer p) => α -> p
591c591
< npUpHexBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ α → p
---
> npUpHexBits :: (Ord α, Num α, Bits α, Printer p) => α -> p
596d595
< number' ∷ (PositionalSystem s, Ord α, Integral α, Printer p)
597d595
<         ⇒ s
598d595
<         → p -- ^ Prefix for negative values
599d595
<         → p -- ^ Zero printer
600d595
<         → p -- ^ Prefix for positive values
601c596
<         → α → p
---
> number' :: (PositionalSystem s, Ord α, Integral α, Printer p)
601a597
>         => s
601a598
>         -> p -- ^ Prefix for negative values
601a599
>         -> p -- ^ Zero printer
601a600
>         -> p -- ^ Prefix for positive values
601a601
>         -> α -> p
603c603
<     LT → go neg q <> printDigitIn s d
---
>     LT -> go neg q <> printDigitIn s d
606d605
<     EQ → z
607c606
<     GT → go pos q <> printDigitIn s d
---
>     EQ -> z
607a607
>     GT -> go pos q <> printDigitIn s d
615d614
< {-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Int → p #-}
616d614
< {-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Int8 → p #-}
617d614
< {-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Int16 → p #-}
618d614
< {-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Int32 → p #-}
619d614
< {-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Int64 → p #-}
620d614
< {-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Word → p #-}
621d614
< {-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Word8 → p #-}
622d614
< {-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Word16 → p #-}
623d614
< {-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Word32 → p #-}
624d614
< {-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Word64 → p #-}
625d614
< {-# SPECIALIZE number' ∷ (Ord α, Integral α, Printer p) ⇒ Binary → p → p → p → α → p #-}
626d614
< {-# SPECIALIZE number' ∷ (Ord α, Integral α, Printer p) ⇒ Decimal → p → p → p → α → p #-}
627d614
< {-# SPECIALIZE number' ∷ (Ord α, Integral α, Printer p) ⇒ Octal → p → p → p → α → p #-}
628d614
< {-# SPECIALIZE number' ∷ (Ord α, Integral α, Printer p) ⇒ Hexadecimal → p → p → p → α → p #-}
629d614
< {-# SPECIALIZE number' ∷ (Ord α, Integral α, Printer p) ⇒ LowHex → p → p → p → α → p #-}
630c615
< {-# SPECIALIZE number' ∷ (Ord α, Integral α, Printer p) ⇒ UpHex → p → p → p → α → p #-}
---
> {-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Int -> p #-}
630a616
> {-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Int8 -> p #-}
630a617
> {-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Int16 -> p #-}
630a618
> {-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Int32 -> p #-}
630a619
> {-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Int64 -> p #-}
630a620
> {-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Word -> p #-}
630a621
> {-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Word8 -> p #-}
630a622
> {-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Word16 -> p #-}
630a623
> {-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Word32 -> p #-}
630a624
> {-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Word64 -> p #-}
630a625
> {-# SPECIALIZE number' :: (Ord α, Integral α, Printer p) => Binary -> p -> p -> p -> α -> p #-}
630a626
> {-# SPECIALIZE number' :: (Ord α, Integral α, Printer p) => Decimal -> p -> p -> p -> α -> p #-}
630a627
> {-# SPECIALIZE number' :: (Ord α, Integral α, Printer p) => Octal -> p -> p -> p -> α -> p #-}
630a628
> {-# SPECIALIZE number' :: (Ord α, Integral α, Printer p) => Hexadecimal -> p -> p -> p -> α -> p #-}
630a629
> {-# SPECIALIZE number' :: (Ord α, Integral α, Printer p) => LowHex -> p -> p -> p -> α -> p #-}
630a630
> {-# SPECIALIZE number' :: (Ord α, Integral α, Printer p) => UpHex -> p -> p -> p -> α -> p #-}
634c634
< number ∷ (PositionalSystem s, Ord α, Integral α, Printer p) ⇒ s → α → p
---
> number :: (PositionalSystem s, Ord α, Integral α, Printer p) => s -> α -> p
639d638
< binary' ∷ (Ord α, Integral α, Printer p)
640d638
<         ⇒ p -- ^ Prefix for negative values
641d638
<         → p -- ^ Zero printer
642d638
<         → p -- ^ Prefix for positive values
643c639
<         → α → p
---
> binary' :: (Ord α, Integral α, Printer p)
643a640
>         => p -- ^ Prefix for negative values
643a641
>         -> p -- ^ Zero printer
643a642
>         -> p -- ^ Prefix for positive values
643a643
>         -> α -> p
649c649
< binary ∷ (Ord α, Integral α, Printer p) ⇒ α → p
---
> binary :: (Ord α, Integral α, Printer p) => α -> p
654d653
< octal' ∷ (Ord α, Integral α, Printer p)
655d653
<        ⇒ p -- ^ Prefix for negative values
656d653
<        → p -- ^ Zero printer
657d653
<        → p -- ^ Prefix for positive values
658c654
<        → α → p
---
> octal' :: (Ord α, Integral α, Printer p)
658a655
>        => p -- ^ Prefix for negative values
658a656
>        -> p -- ^ Zero printer
658a657
>        -> p -- ^ Prefix for positive values
658a658
>        -> α -> p
664c664
< octal ∷ (Ord α, Integral α, Printer p) ⇒ α → p
---
> octal :: (Ord α, Integral α, Printer p) => α -> p
669d668
< decimal' ∷ (Ord α, Integral α, Printer p)
670d668
<          ⇒ p -- ^ Prefix for negative values
671d668
<          → p -- ^ Zero printer
672d668
<          → p -- ^ Prefix for positive values
673c669
<          → α → p
---
> decimal' :: (Ord α, Integral α, Printer p)
673a670
>          => p -- ^ Prefix for negative values
673a671
>          -> p -- ^ Zero printer
673a672
>          -> p -- ^ Prefix for positive values
673a673
>          -> α -> p
679c679
< decimal ∷ (Ord α, Integral α, Printer p) ⇒ α → p
---
> decimal :: (Ord α, Integral α, Printer p) => α -> p
685d684
< lowHex' ∷ (Ord α, Integral α, Printer p)
686d684
<         ⇒ p -- ^ Prefix for negative values
687d684
<         → p -- ^ Zero printer
688d684
<         → p -- ^ Prefix for positive values
689c685
<         → α → p
---
> lowHex' :: (Ord α, Integral α, Printer p)
689a686
>         => p -- ^ Prefix for negative values
689a687
>         -> p -- ^ Zero printer
689a688
>         -> p -- ^ Prefix for positive values
689a689
>         -> α -> p
695c695
< lowHex ∷ (Ord α, Integral α, Printer p) ⇒ α → p
---
> lowHex :: (Ord α, Integral α, Printer p) => α -> p
701d700
< upHex' ∷ (Ord α, Integral α, Printer p)
702d700
<        ⇒ p -- ^ Prefix for negative values
703d700
<        → p -- ^ Zero printer
704d700
<        → p -- ^ Prefix for positive values
705c701
<        → α → p
---
> upHex' :: (Ord α, Integral α, Printer p)
705a702
>        => p -- ^ Prefix for negative values
705a703
>        -> p -- ^ Zero printer
705a704
>        -> p -- ^ Prefix for positive values
705a705
>        -> α -> p
711c711
< upHex ∷ (Ord α, Integral α, Printer p) ⇒ α → p
---
> upHex :: (Ord α, Integral α, Printer p) => α -> p
716d715
< bits' ∷ (BitSystem s, Ord α, Num α, Bits α, Printer p)
717d715
<       ⇒ s
718d715
<       → p -- ^ Prefix for negative values
719d715
<       → p -- ^ Zero printer
720d715
<       → p -- ^ Prefix for positive values
721c716
<       → α → p
---
> bits' :: (BitSystem s, Ord α, Num α, Bits α, Printer p)
721a717
>       => s
721a718
>       -> p -- ^ Prefix for negative values
721a719
>       -> p -- ^ Zero printer
721a720
>       -> p -- ^ Prefix for positive values
721a721
>       -> α -> p
723d722
<     LT → case testBit n 0 of
724c723
<            True → go neg (shiftR (negate n) digitBits) <> printDigitIn s d
---
>     LT -> case testBit n 0 of
724a724
>            True -> go neg (shiftR (negate n) digitBits) <> printDigitIn s d
726d725
<            False → case n > negRadix of
727d725
<                True → neg <> printDigitIn s d'
728c726
<                False → go neg m <> printDigitIn s d'
---
>            False -> case n > negRadix of
728a727
>                True -> neg <> printDigitIn s d'
728a728
>                False -> go neg m <> printDigitIn s d'
733d732
<     EQ → z
734c733
<     GT → go pos (shiftR n digitBits) <> printDigitIn s d
---
>     EQ -> z
734a734
>     GT -> go pos (shiftR n digitBits) <> printDigitIn s d
743d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Int → p #-}
744d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Int8 → p #-}
745d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Int16 → p #-}
746d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Int32 → p #-}
747d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Int64 → p #-}
748d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Word → p #-}
749d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Word8 → p #-}
750d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Word16 → p #-}
751d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Word32 → p #-}
752d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Word64 → p #-}
753d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Int → p #-}
754d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Int8 → p #-}
755d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Int16 → p #-}
756d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Int32 → p #-}
757d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Int64 → p #-}
758d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Word → p #-}
759d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Word8 → p #-}
760d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Word16 → p #-}
761d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Word32 → p #-}
762d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Word64 → p #-}
763d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Int → p #-}
764d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Int8 → p #-}
765d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Int16 → p #-}
766d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Int32 → p #-}
767d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Int64 → p #-}
768d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Word → p #-}
769d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Word8 → p #-}
770d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Word16 → p #-}
771d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Word32 → p #-}
772d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Word64 → p #-}
773d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Int → p #-}
774d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Int8 → p #-}
775d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Int16 → p #-}
776d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Int32 → p #-}
777d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Int64 → p #-}
778d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Word → p #-}
779d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Word8 → p #-}
780d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Word16 → p #-}
781d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Word32 → p #-}
782d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Word64 → p #-}
783d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Int → p #-}
784d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Int8 → p #-}
785d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Int16 → p #-}
786d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Int32 → p #-}
787d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Int64 → p #-}
788d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Word → p #-}
789d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Word8 → p #-}
790d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Word16 → p #-}
791d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Word32 → p #-}
792d742
< {-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Word64 → p #-}
793d742
< {-# SPECIALIZE bits' ∷ (Ord α, Num α, Bits α, Printer p) ⇒ Binary → p → p → p → α → p #-}
794d742
< {-# SPECIALIZE bits' ∷ (Ord α, Num α, Bits α, Printer p) ⇒ Octal → p → p → p → α → p #-}
795d742
< {-# SPECIALIZE bits' ∷ (Ord α, Num α, Bits α, Printer p) ⇒ Hexadecimal → p → p → p → α → p #-}
796d742
< {-# SPECIALIZE bits' ∷ (Ord α, Num α, Bits α, Printer p) ⇒ LowHex → p → p → p → α → p #-}
797c743
< {-# SPECIALIZE bits' ∷ (Ord α, Num α, Bits α, Printer p) ⇒ UpHex → p → p → p → α → p #-}
---
> {-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Int -> p #-}
797a744
> {-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Int8 -> p #-}
797a745
> {-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Int16 -> p #-}
797a746
> {-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Int32 -> p #-}
797a747
> {-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Int64 -> p #-}
797a748
> {-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Word -> p #-}
797a749
> {-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Word8 -> p #-}
797a750
> {-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Word16 -> p #-}
797a751
> {-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Word32 -> p #-}
797a752
> {-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Word64 -> p #-}
797a753
> {-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Int -> p #-}
797a754
> {-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Int8 -> p #-}
797a755
> {-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Int16 -> p #-}
797a756
> {-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Int32 -> p #-}
797a757
> {-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Int64 -> p #-}
797a758
> {-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Word -> p #-}
797a759
> {-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Word8 -> p #-}
797a760
> {-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Word16 -> p #-}
797a761
> {-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Word32 -> p #-}
797a762
> {-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Word64 -> p #-}
797a763
> {-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Int -> p #-}
797a764
> {-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Int8 -> p #-}
797a765
> {-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Int16 -> p #-}
797a766
> {-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Int32 -> p #-}
797a767
> {-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Int64 -> p #-}
797a768
> {-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Word -> p #-}
797a769
> {-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Word8 -> p #-}
797a770
> {-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Word16 -> p #-}
797a771
> {-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Word32 -> p #-}
797a772
> {-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Word64 -> p #-}
797a773
> {-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Int -> p #-}
797a774
> {-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Int8 -> p #-}
797a775
> {-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Int16 -> p #-}
797a776
> {-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Int32 -> p #-}
797a777
> {-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Int64 -> p #-}
797a778
> {-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Word -> p #-}
797a779
> {-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Word8 -> p #-}
797a780
> {-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Word16 -> p #-}
797a781
> {-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Word32 -> p #-}
797a782
> {-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Word64 -> p #-}
797a783
> {-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Int -> p #-}
797a784
> {-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Int8 -> p #-}
797a785
> {-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Int16 -> p #-}
797a786
> {-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Int32 -> p #-}
797a787
> {-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Int64 -> p #-}
797a788
> {-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Word -> p #-}
797a789
> {-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Word8 -> p #-}
797a790
> {-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Word16 -> p #-}
797a791
> {-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Word32 -> p #-}
797a792
> {-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Word64 -> p #-}
797a793
> {-# SPECIALIZE bits' :: (Ord α, Num α, Bits α, Printer p) => Binary -> p -> p -> p -> α -> p #-}
797a794
> {-# SPECIALIZE bits' :: (Ord α, Num α, Bits α, Printer p) => Octal -> p -> p -> p -> α -> p #-}
797a795
> {-# SPECIALIZE bits' :: (Ord α, Num α, Bits α, Printer p) => Hexadecimal -> p -> p -> p -> α -> p #-}
797a796
> {-# SPECIALIZE bits' :: (Ord α, Num α, Bits α, Printer p) => LowHex -> p -> p -> p -> α -> p #-}
797a797
> {-# SPECIALIZE bits' :: (Ord α, Num α, Bits α, Printer p) => UpHex -> p -> p -> p -> α -> p #-}
801c801
< bits ∷ (BitSystem s, Ord α, Num α, Bits α, Printer p) ⇒ s → α → p
---
> bits :: (BitSystem s, Ord α, Num α, Bits α, Printer p) => s -> α -> p
806d805
< binaryBits' ∷ (Ord α, Num α, Bits α, Printer p)
807d805
<             ⇒ p -- ^ Prefix for negative values
808d805
<             → p -- ^ Zero printer
809d805
<             → p -- ^ Prefix for positive values
810c806
<             → α → p
---
> binaryBits' :: (Ord α, Num α, Bits α, Printer p)
810a807
>             => p -- ^ Prefix for negative values
810a808
>             -> p -- ^ Zero printer
810a809
>             -> p -- ^ Prefix for positive values
810a810
>             -> α -> p
816c816
< binaryBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ α → p
---
> binaryBits :: (Ord α, Num α, Bits α, Printer p) => α -> p
821d820
< octalBits' ∷ (Ord α, Num α, Bits α, Printer p)
822d820
<            ⇒ p -- ^ Prefix for negative values
823d820
<            → p -- ^ Zero printer
824d820
<            → p -- ^ Prefix for positive values
825c821
<            → α → p
---
> octalBits' :: (Ord α, Num α, Bits α, Printer p)
825a822
>            => p -- ^ Prefix for negative values
825a823
>            -> p -- ^ Zero printer
825a824
>            -> p -- ^ Prefix for positive values
825a825
>            -> α -> p
831c831
< octalBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ α → p
---
> octalBits :: (Ord α, Num α, Bits α, Printer p) => α -> p
837d836
< lowHexBits' ∷ (Ord α, Num α, Bits α, Printer p)
838d836
<             ⇒ p -- ^ Prefix for negative values
839d836
<             → p -- ^ Zero printer
840d836
<             → p -- ^ Prefix for positive values
841c837
<             → α → p
---
> lowHexBits' :: (Ord α, Num α, Bits α, Printer p)
841a838
>             => p -- ^ Prefix for negative values
841a839
>             -> p -- ^ Zero printer
841a840
>             -> p -- ^ Prefix for positive values
841a841
>             -> α -> p
847c847
< lowHexBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ α → p
---
> lowHexBits :: (Ord α, Num α, Bits α, Printer p) => α -> p
853d852
< upHexBits' ∷ (Ord α, Num α, Bits α, Printer p)
854d852
<            ⇒ p -- ^ Prefix for negative values
855d852
<            → p -- ^ Zero printer
856d852
<            → p -- ^ Prefix for positive values
857c853
<            → α → p
---
> upHexBits' :: (Ord α, Num α, Bits α, Printer p)
857a854
>            => p -- ^ Prefix for negative values
857a855
>            -> p -- ^ Zero printer
857a856
>            -> p -- ^ Prefix for positive values
857a857
>            -> α -> p
863c863
< upHexBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ α → p
---
> upHexBits :: (Ord α, Num α, Bits α, Printer p) => α -> p
865a866
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE UnicodeSyntax #-}
{-# LANGUAGE DeriveDataTypeable #-}
{-# LANGUAGE BangPatterns #-}

-- | Print integral numbers in common positional numeral systems.
module Text.Printer.Integral
  (
  -- * Positional systems
    PositionalSystem(..)
  , BitSystem(..)
  , Binary(..)
  , Octal(..)
  , Decimal(..)
  , Hexadecimal(..)
  , LowHex(..)
  , UpHex(..)
  -- * Numeral printers
  , nonNegative
  , nnBinary
  , nnOctal
  , nnDecimal
  , nnLowHex
  , nnUpHex
  , nnBits
  , nnBinaryBits
  , nnOctalBits
  , nnLowHexBits
  , nnUpHexBits
  , nonPositive
  , npBinary
  , npOctal
  , npDecimal
  , npLowHex
  , npUpHex
  , npBits
  , npBinaryBits
  , npOctalBits
  , npLowHexBits
  , npUpHexBits
  , number'
  , number
  , binary'
  , binary
  , octal'
  , octal
  , decimal'
  , decimal
  , lowHex'
  , lowHex
  , upHex'
  , upHex
  , bits'
  , bits
  , binaryBits'
  , binaryBits
  , octalBits'
  , octalBits
  , lowHexBits'
  , lowHexBits
  , upHexBits'
  , upHexBits
  ) where

import Data.Typeable (Typeable)
import Data.Char (chr, ord)
import Data.Int
import Data.Word
import Data.Bits (Bits(..))
import Data.Monoid (mempty)
import qualified Text.Ascii as A
import Text.Printer

-- | Positional numeral system.
class PositionalSystem s where
  -- | The name of the system (e.g. \"binary\", \"decimal\").
  systemName ∷ s → String
  -- | The radix of the system.
  radixIn ∷ Num α ⇒ s → α
  -- | Test if a character is a digit.
  isDigitIn ∷ s → Char → Bool
  -- | Test if a character is a non-zero digit.
  isNzDigitIn ∷ s → Char → Bool
  -- | Map digits to the corresponding numbers. Return 'Nothing' on
  --   other inputs.
  fromDigitIn ∷ Num α ⇒ s → Char → Maybe α
  -- | Map non-zero digits to the corresponding numbers. Return 'Nothing' on
  --   other inputs.
  fromNzDigitIn ∷ Num α ⇒ s → Char → Maybe α
  -- | Map digits to the corresponding numbers. No checks are performed.
  unsafeFromDigitIn ∷ Num α ⇒ s → Char → α
  -- | Map 'Int' values to the corresponding digits. Inputs /must/ be
  --   non-negative and less than the radix.
  intToDigitIn ∷ s → Int → Char
  -- | Print a digit.
  printDigitIn ∷ Printer p ⇒ s → Char → p
  printDigitIn _ = char7
  {-# INLINE printDigitIn #-}
  printZeroIn ∷ Printer p ⇒ s → p
  printZeroIn s = printDigitIn s $! intToDigitIn s 0
  {-# INLINE printZeroIn #-}

-- | Positonal numeral system with a power of two radix.
class PositionalSystem s ⇒ BitSystem s where
  -- | Numer of bits occupied by a digit.
  digitBitsIn ∷ s → Int
  -- | The number that has 'digitBitsIn' least significant bits set to ones
  --   and all the other bits set to zeroes.
  digitMaskIn ∷ Num α ⇒ s → α
  -- | Map the last digit of a number to the corresponding 'Int' value.
  lastDigitIn ∷ Bits α ⇒ s → α → Int

-- | The binary numeral system.
data Binary = Binary deriving (Typeable, Eq, Ord, Show, Read)

instance PositionalSystem Binary where
  systemName _ = "binary"
  {-# INLINE systemName #-}
  radixIn _ = 2
  {-# INLINE radixIn #-}
  isDigitIn _ = A.isBinDigit
  {-# INLINE isDigitIn #-}
  isNzDigitIn _ = A.isNzBinDigit
  {-# INLINE isNzDigitIn #-}
  fromDigitIn _ = A.fromBinDigit
  {-# INLINE fromDigitIn #-}
  fromNzDigitIn _ = A.fromNzBinDigit
  {-# INLINE fromNzDigitIn #-}
  unsafeFromDigitIn _ = A.unsafeFromBinDigit
  {-# INLINE unsafeFromDigitIn #-}
  intToDigitIn _ i = chr $! ord '0' + i
  {-# INLINE intToDigitIn #-}
  printZeroIn _ = char7 '0'
  {-# INLINE printZeroIn #-}

instance BitSystem Binary where
  digitBitsIn _ = 1
  {-# INLINE digitBitsIn #-}
  digitMaskIn _ = 1
  {-# INLINE digitMaskIn #-}
  lastDigitIn _ n = if testBit n 0 then 1 else 0
  {-# INLINE lastDigitIn #-}

-- | The octal numeral system.
data Octal = Octal deriving (Typeable, Eq, Ord, Show, Read)

instance PositionalSystem Octal where
  systemName _ = "octal"
  {-# INLINE systemName #-}
  radixIn _ = 8
  {-# INLINE radixIn #-}
  isDigitIn _ = A.isOctDigit
  {-# INLINE isDigitIn #-}
  isNzDigitIn _ = A.isNzOctDigit
  {-# INLINE isNzDigitIn #-}
  fromDigitIn _ = A.fromOctDigit
  {-# INLINE fromDigitIn #-}
  fromNzDigitIn _ = A.fromNzOctDigit
  {-# INLINE fromNzDigitIn #-}
  unsafeFromDigitIn _ = A.unsafeFromOctDigit
  {-# INLINE unsafeFromDigitIn #-}
  intToDigitIn _ i = chr $! ord '0' + i
  {-# INLINE intToDigitIn #-}
  printZeroIn _ = char7 '0'
  {-# INLINE printZeroIn #-}

instance BitSystem Octal where
  digitBitsIn _ = 3
  {-# INLINE digitBitsIn #-}
  digitMaskIn _ = 7
  {-# INLINE digitMaskIn #-}
  lastDigitIn _ n = (if testBit n 0 then 1 else 0)
                  + (if testBit n 1 then 2 else 0)
                  + (if testBit n 2 then 4 else 0)
  {-# INLINE lastDigitIn #-}

-- | The decimal numeral system.
data Decimal = Decimal deriving (Typeable, Eq, Ord, Show, Read)

instance PositionalSystem Decimal where
  systemName _ = "decimal"
  {-# INLINE systemName #-}
  radixIn _ = 10
  {-# INLINE radixIn #-}
  isDigitIn _ = A.isDecDigit
  {-# INLINE isDigitIn #-}
  isNzDigitIn _ = A.isNzDecDigit
  {-# INLINE isNzDigitIn #-}
  fromDigitIn _ = A.fromDecDigit
  {-# INLINE fromDigitIn #-}
  fromNzDigitIn _ = A.fromNzDecDigit
  {-# INLINE fromNzDigitIn #-}
  unsafeFromDigitIn _ = A.unsafeFromDecDigit
  {-# INLINE unsafeFromDigitIn #-}
  intToDigitIn _ i = chr $! ord '0' + i
  {-# INLINE intToDigitIn #-}
  printZeroIn _ = char7 '0'
  {-# INLINE printZeroIn #-}

-- | The hexadecimal numeral system.
data Hexadecimal = Hexadecimal

instance PositionalSystem Hexadecimal where
  systemName _ = "hexadecimal"
  {-# INLINE systemName #-}
  radixIn _ = 16
  {-# INLINE radixIn #-}
  isDigitIn _ = A.isHexDigit
  {-# INLINE isDigitIn #-}
  isNzDigitIn _ = A.isNzHexDigit
  {-# INLINE isNzDigitIn #-}
  fromDigitIn _ = A.fromHexDigit
  {-# INLINE fromDigitIn #-}
  fromNzDigitIn _ = A.fromNzHexDigit
  {-# INLINE fromNzDigitIn #-}
  unsafeFromDigitIn _ = A.unsafeFromHexDigit
  {-# INLINE unsafeFromDigitIn #-}
  intToDigitIn _ i | i < 10    = chr $! ord '0' + i
                   | otherwise = chr $! ord 'A' + (i - 10)
  {-# INLINE intToDigitIn #-}
  printZeroIn _ = char7 '0'
  {-# INLINE printZeroIn #-}

instance BitSystem Hexadecimal where
  digitBitsIn _ = 4
  {-# INLINE digitBitsIn #-}
  digitMaskIn _ = 15
  {-# INLINE digitMaskIn #-}
  lastDigitIn _ n = (if testBit n 0 then 1 else 0)
                  + (if testBit n 1 then 2 else 0)
                  + (if testBit n 2 then 4 else 0)
                  + (if testBit n 3 then 8 else 0)
  {-# INLINABLE lastDigitIn #-}

-- | The hexadecimal numeral system, using lower case digits.
data LowHex = LowHex

instance PositionalSystem LowHex where
  systemName _ = "lower case hexadecimal"
  {-# INLINE systemName #-}
  radixIn _ = 16
  {-# INLINE radixIn #-}
  isDigitIn _ = A.isLowHexDigit
  {-# INLINE isDigitIn #-}
  isNzDigitIn _ = A.isNzLowHexDigit
  {-# INLINE isNzDigitIn #-}
  fromDigitIn _ = A.fromLowHexDigit
  {-# INLINE fromDigitIn #-}
  fromNzDigitIn _ = A.fromNzLowHexDigit
  {-# INLINE fromNzDigitIn #-}
  unsafeFromDigitIn _ = A.unsafeFromLowHexDigit
  {-# INLINE unsafeFromDigitIn #-}
  intToDigitIn _ i | i < 10    = chr $! ord '0' + i
                   | otherwise = chr $! ord 'a' + (i - 10)
  {-# INLINE intToDigitIn #-}
  printZeroIn _ = char7 '0'
  {-# INLINE printZeroIn #-}

instance BitSystem LowHex where
  digitBitsIn _ = 4
  {-# INLINE digitBitsIn #-}
  digitMaskIn _ = 15
  {-# INLINE digitMaskIn #-}
  lastDigitIn _ n = (if testBit n 0 then 1 else 0)
                  + (if testBit n 1 then 2 else 0)
                  + (if testBit n 2 then 4 else 0)
                  + (if testBit n 3 then 8 else 0)
  {-# INLINABLE lastDigitIn #-}

-- | The hexadecimal numeral system, using upper case digits.
data UpHex = UpHex

instance PositionalSystem UpHex where
  systemName _ = "upper case hexadecimal"
  {-# INLINE systemName #-}
  radixIn _ = 16
  {-# INLINE radixIn #-}
  isDigitIn _ = A.isUpHexDigit
  {-# INLINE isDigitIn #-}
  isNzDigitIn _ = A.isNzUpHexDigit
  {-# INLINE isNzDigitIn #-}
  fromDigitIn _ = A.fromUpHexDigit
  {-# INLINE fromDigitIn #-}
  fromNzDigitIn _ = A.fromNzUpHexDigit
  {-# INLINE fromNzDigitIn #-}
  unsafeFromDigitIn _ = A.unsafeFromUpHexDigit
  {-# INLINE unsafeFromDigitIn #-}
  intToDigitIn _ i | i < 10    = chr $! ord '0' + i
                   | otherwise = chr $! ord 'A' + (i - 10)
  {-# INLINE intToDigitIn #-}
  printZeroIn _ = char7 '0'
  {-# INLINE printZeroIn #-}

instance BitSystem UpHex where
  digitBitsIn _ = 4
  {-# INLINE digitBitsIn #-}
  digitMaskIn _ = 15
  {-# INLINE digitMaskIn #-}
  lastDigitIn _ n = (if testBit n 0 then 1 else 0)
                  + (if testBit n 1 then 2 else 0)
                  + (if testBit n 2 then 4 else 0)
                  + (if testBit n 3 then 8 else 0)
  {-# INLINABLE lastDigitIn #-}

-- | Print a non-negative number in the specified positional numeral system.
nonNegative ∷ (PositionalSystem s, Integral α, Printer p) ⇒ s → α → p
nonNegative s = go (printDigitIn s $! intToDigitIn s 0)
  where go p 0 = p
        go _ m = go mempty q <> printDigitIn s d
          where (q, r) = quotRem m radix
                !d     = intToDigitIn s $ fromIntegral r
        radix = radixIn s
{-# INLINABLE nonNegative #-}
{-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Int → p #-}
{-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Int8 → p #-}
{-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Int16 → p #-}
{-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Int32 → p #-}
{-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Int64 → p #-}
{-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Word → p #-}
{-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Word8 → p #-}
{-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Word16 → p #-}
{-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Word32 → p #-}
{-# SPECIALIZE nonNegative ∷ Printer p ⇒ Decimal → Word64 → p #-}
{-# SPECIALIZE nonNegative ∷ (Integral α, Printer p) ⇒ Binary → α → p #-}
{-# SPECIALIZE nonNegative ∷ (Integral α, Printer p) ⇒ Octal → α → p #-}
{-# SPECIALIZE nonNegative ∷ (Integral α, Printer p) ⇒ Decimal → α → p #-}
{-# SPECIALIZE nonNegative ∷ (Integral α, Printer p) ⇒ LowHex → α → p #-}
{-# SPECIALIZE nonNegative ∷ (Integral α, Printer p) ⇒ UpHex → α → p #-}

-- | Print a non-negative number in the binary numeral system.
nnBinary ∷ (Integral α, Printer p) ⇒ α → p
nnBinary = nonNegative Binary
{-# INLINE nnBinary #-}

-- | Print a non-negative number in the octal numeral system.
nnOctal ∷ (Integral α, Printer p) ⇒ α → p
nnOctal = nonNegative Octal
{-# INLINE nnOctal #-}

-- | Print a non-negative number in the decimal numeral system.
nnDecimal ∷ (Integral α, Printer p) ⇒ α → p
nnDecimal = nonNegative Decimal
{-# INLINE nnDecimal #-}

-- | Print a non-negative number in the hexadecimal numeral system
--   using lower case digits.
nnLowHex ∷ (Integral α, Printer p) ⇒ α → p
nnLowHex = nonNegative LowHex
{-# INLINE nnLowHex #-}

-- | Print a non-negative number in the hexadecimal numeral system
--   using upper case digits.
nnUpHex ∷ (Integral α, Printer p) ⇒ α → p
nnUpHex = nonNegative UpHex
{-# INLINE nnUpHex #-}

-- | Print a non-negative binary number in the specified positional numeral
--   system.
nnBits ∷ (BitSystem s, Num α, Bits α, Printer p) ⇒ s → α → p
nnBits s = go (printDigitIn s $! intToDigitIn s 0)
  where go p 0 = p
        go _ m = go mempty (shiftR m digitBits) <> printDigitIn s d
          where !d = intToDigitIn s $ lastDigitIn s m
        digitBits = digitBitsIn s
{-# INLINABLE nnBits #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Int → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Int8 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Int16 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Int32 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Int64 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Word → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Word8 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Word16 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Word32 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Binary → Word64 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Int → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Int8 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Int16 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Int32 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Int64 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Word → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Word8 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Word16 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Word32 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Octal → Word64 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Int → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Int8 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Int16 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Int32 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Int64 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Word → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Word8 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Word16 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Word32 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ Hexadecimal → Word64 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Int → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Int8 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Int16 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Int32 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Int64 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Word → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Word8 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Word16 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Word32 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ LowHex → Word64 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Int → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Int8 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Int16 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Int32 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Int64 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Word → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Word8 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Word16 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Word32 → p #-}
{-# SPECIALIZE nnBits ∷ Printer p ⇒ UpHex → Word64 → p #-}
{-# SPECIALIZE nnBits ∷ (Num α, Bits α, Printer p) ⇒ Binary → α → p #-}
{-# SPECIALIZE nnBits ∷ (Num α, Bits α, Printer p) ⇒ Octal → α → p #-}
{-# SPECIALIZE nnBits ∷ (Num α, Bits α, Printer p) ⇒ Hexadecimal → α → p #-}
{-# SPECIALIZE nnBits ∷ (Num α, Bits α, Printer p) ⇒ LowHex → α → p #-}
{-# SPECIALIZE nnBits ∷ (Num α, Bits α, Printer p) ⇒ UpHex → α → p #-}

-- | Print a non-negative binary number in the binary numeral system.
nnBinaryBits ∷ (Num α, Bits α, Printer p) ⇒ α → p
nnBinaryBits = nnBits Binary
{-# INLINE nnBinaryBits #-}

-- | Print a non-negative binary number in the octal numeral system.
nnOctalBits ∷ (Num α, Bits α, Printer p) ⇒ α → p
nnOctalBits = nnBits Octal
{-# INLINE nnOctalBits #-}

-- | Print a non-negative binary number in the hexadecimal numeral system
--   using lower case digits.
nnLowHexBits ∷ (Num α, Bits α, Printer p) ⇒ α → p
nnLowHexBits = nnBits LowHex
{-# INLINE nnLowHexBits #-}

-- | Print a non-negative binary number in the hexadecimal numeral system
--   using upper case digits.
nnUpHexBits ∷ (Num α, Bits α, Printer p) ⇒ α → p
nnUpHexBits = nnBits UpHex
{-# INLINE nnUpHexBits #-}

-- | Print a non-positive number in the specified positional numeral system.
--   For example, @'nonPositive' 'Decimal' (-/123/)@ would print \"123\".
nonPositive ∷ (PositionalSystem s, Integral α, Printer p) ⇒ s → α → p
nonPositive s = go (printDigitIn s $! intToDigitIn s 0)
  where go p 0 = p
        go _ m = go mempty q <> printDigitIn s d
          where (q, r) = quotRem m radix
                !d     = intToDigitIn s $ negate $ fromIntegral r
        radix = radixIn s
{-# INLINABLE nonPositive #-}
{-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Int → p #-}
{-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Int8 → p #-}
{-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Int16 → p #-}
{-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Int32 → p #-}
{-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Int64 → p #-}
{-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Word → p #-}
{-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Word8 → p #-}
{-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Word16 → p #-}
{-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Word32 → p #-}
{-# SPECIALIZE nonPositive ∷ Printer p ⇒ Decimal → Word64 → p #-}
{-# SPECIALIZE nonPositive ∷ (Integral α, Printer p) ⇒ Binary → α → p #-}
{-# SPECIALIZE nonPositive ∷ (Integral α, Printer p) ⇒ Octal → α → p #-}
{-# SPECIALIZE nonPositive ∷ (Integral α, Printer p) ⇒ Decimal → α → p #-}
{-# SPECIALIZE nonPositive ∷ (Integral α, Printer p) ⇒ LowHex → α → p #-}
{-# SPECIALIZE nonPositive ∷ (Integral α, Printer p) ⇒ UpHex → α → p #-}

-- | Print a non-positive number in the binary numeral system.
npBinary ∷ (Integral α, Printer p) ⇒ α → p
npBinary = nonPositive Binary
{-# INLINE npBinary #-}

-- | Print a non-positive number in the octal numeral system.
npOctal ∷ (Integral α, Printer p) ⇒ α → p
npOctal = nonPositive Octal
{-# INLINE npOctal #-}

-- | Print a non-positive number in the decimal numeral system.
npDecimal ∷ (Integral α, Printer p) ⇒ α → p
npDecimal = nonPositive Decimal
{-# INLINE npDecimal #-}

-- | Print a non-positive number in the hexadecimal numeral system
--   using lower case digits.
npLowHex ∷ (Integral α, Printer p) ⇒ α → p
npLowHex = nonPositive LowHex
{-# INLINE npLowHex #-}

-- | Print a non-positive number in the hexadecimal numeral system
--   using upper case digits.
npUpHex ∷ (Integral α, Printer p) ⇒ α → p
npUpHex = nonPositive UpHex
{-# INLINE npUpHex #-}

-- | Print a non-positive two-compliment binary number in the specified
--   positional numeral system. For example, @'npBits' 'UpHex' (-/0xABC/)@
--   would print \"ABC\".
npBits ∷ (BitSystem s, Ord α, Num α, Bits α, Printer p) ⇒ s → α → p
npBits s n = case testBit n 0 of
    True → go mempty (shiftR (negate n) digitBits) <> printDigitIn s d
      where !d = intToDigitIn s $ radix - lastDigitIn s n
    False → case n > negRadix of
        True → printDigitIn s d'
        False → go mempty m <> printDigitIn s d'
          where m | d == 0    = negate $ shiftR n digitBits
                  | otherwise = complement $ shiftR n digitBits
      where !d  = lastDigitIn s n
            !d' = intToDigitIn s $ (radix - d) .&. digitMask
  where go p 0 = p
        go p m = go p (shiftR m digitBits) <> printDigitIn s d
          where !d = intToDigitIn s $ lastDigitIn s m
        radix     = radixIn s
        digitMask = digitMaskIn s
        digitBits = digitBitsIn s
        negRadix  = complement $ digitMaskIn s
{-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Int → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Int8 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Int16 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Int32 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Int64 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Word → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Word8 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Word16 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Word32 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Binary → Word64 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Int → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Int8 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Int16 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Int32 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Int64 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Word → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Word8 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Word16 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Word32 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Octal → Word64 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Int → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Int8 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Int16 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Int32 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Int64 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Word → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Word8 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Word16 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Word32 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ Hexadecimal → Word64 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Int → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Int8 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Int16 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Int32 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Int64 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Word → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Word8 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Word16 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Word32 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ LowHex → Word64 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Int → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Int8 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Int16 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Int32 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Int64 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Word → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Word8 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Word16 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Word32 → p #-}
{-# SPECIALIZE npBits ∷ Printer p ⇒ UpHex → Word64 → p #-}
{-# SPECIALIZE npBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ Binary → α → p #-}
{-# SPECIALIZE npBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ Octal → α → p #-}
{-# SPECIALIZE npBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ Hexadecimal → α → p #-}
{-# SPECIALIZE npBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ LowHex → α → p #-}
{-# SPECIALIZE npBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ UpHex → α → p #-}

-- | Print a non-positive binary number in the binary numeral system.
npBinaryBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ α → p
npBinaryBits = npBits Binary
{-# INLINE npBinaryBits #-}

-- | Print a non-positive binary number in the octal numeral system.
npOctalBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ α → p
npOctalBits = npBits Octal
{-# INLINE npOctalBits #-}

-- | Print a non-positive binary number in the hexadecimal numeral system
--   using lower case digits.
npLowHexBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ α → p
npLowHexBits = npBits LowHex
{-# INLINE npLowHexBits #-}

-- | Print a non-positive binary number in the hexadecimal numeral system
--   using upper case digits.
npUpHexBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ α → p
npUpHexBits = npBits UpHex
{-# INLINE npUpHexBits #-}

-- | Print a number in the specified positional numeral system.
number' ∷ (PositionalSystem s, Ord α, Integral α, Printer p)
        ⇒ s
        → p -- ^ Prefix for negative values
        → p -- ^ Zero printer
        → p -- ^ Prefix for positive values
        → α → p
number' s neg z pos n = case compare n 0 of
    LT → go neg q <> printDigitIn s d
      where (q, r) = quotRem n (negate radix)
            !d     = intToDigitIn s $ negate $ fromIntegral r
    EQ → z
    GT → go pos q <> printDigitIn s d
      where (q, r) = quotRem n radix
            !d     = intToDigitIn s $ fromIntegral r
  where go p 0 = p
        go p m = go p q <> printDigitIn s d
          where (q, r) = quotRem m radix
                !d     = intToDigitIn s $ fromIntegral r
        radix = radixIn s
{-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Int → p #-}
{-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Int8 → p #-}
{-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Int16 → p #-}
{-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Int32 → p #-}
{-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Int64 → p #-}
{-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Word → p #-}
{-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Word8 → p #-}
{-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Word16 → p #-}
{-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Word32 → p #-}
{-# SPECIALIZE number' ∷ Printer p ⇒ Decimal → p → p → p → Word64 → p #-}
{-# SPECIALIZE number' ∷ (Ord α, Integral α, Printer p) ⇒ Binary → p → p → p → α → p #-}
{-# SPECIALIZE number' ∷ (Ord α, Integral α, Printer p) ⇒ Decimal → p → p → p → α → p #-}
{-# SPECIALIZE number' ∷ (Ord α, Integral α, Printer p) ⇒ Octal → p → p → p → α → p #-}
{-# SPECIALIZE number' ∷ (Ord α, Integral α, Printer p) ⇒ Hexadecimal → p → p → p → α → p #-}
{-# SPECIALIZE number' ∷ (Ord α, Integral α, Printer p) ⇒ LowHex → p → p → p → α → p #-}
{-# SPECIALIZE number' ∷ (Ord α, Integral α, Printer p) ⇒ UpHex → p → p → p → α → p #-}

-- | Print a number in the specified positional numeral system. Negative
--   values are prefixed with a minus sign.
number ∷ (PositionalSystem s, Ord α, Integral α, Printer p) ⇒ s → α → p
number s = number' s (char7 '-') (printZeroIn s) mempty
{-# INLINE number #-}

-- | Print a number in the binary numeral system.
binary' ∷ (Ord α, Integral α, Printer p)
        ⇒ p -- ^ Prefix for negative values
        → p -- ^ Zero printer
        → p -- ^ Prefix for positive values
        → α → p
binary' = number' Binary
{-# INLINE binary' #-}

-- | Print a number in the binary numeral system. Negative values
--   are prefixed with a minus sign.
binary ∷ (Ord α, Integral α, Printer p) ⇒ α → p
binary = number Binary
{-# INLINE binary #-}

-- | Print a number in the octal numeral system.
octal' ∷ (Ord α, Integral α, Printer p)
       ⇒ p -- ^ Prefix for negative values
       → p -- ^ Zero printer
       → p -- ^ Prefix for positive values
       → α → p
octal' = number' Octal
{-# INLINE octal' #-}

-- | Print a number in the octal numeral system. Negative values
--   are prefixed with a minus sign.
octal ∷ (Ord α, Integral α, Printer p) ⇒ α → p
octal = number Octal
{-# INLINE octal #-}

-- | Print a number in the decimal numeral system.
decimal' ∷ (Ord α, Integral α, Printer p)
         ⇒ p -- ^ Prefix for negative values
         → p -- ^ Zero printer
         → p -- ^ Prefix for positive values
         → α → p
decimal' = number' Decimal
{-# INLINE decimal' #-}

-- | Print a number in the decimal numeral system. Negative values
--   are prefixed with a minus sign.
decimal ∷ (Ord α, Integral α, Printer p) ⇒ α → p
decimal = number Decimal
{-# INLINE decimal #-}

-- | Print a number in the hexadecimal numeral system using lower case
--   digits.
lowHex' ∷ (Ord α, Integral α, Printer p)
        ⇒ p -- ^ Prefix for negative values
        → p -- ^ Zero printer
        → p -- ^ Prefix for positive values
        → α → p
lowHex' = number' LowHex
{-# INLINE lowHex' #-}

-- | Print a number in the hexadecimal numeral system using lower case
--   digits. Negative values are prefixed with a minus sign.
lowHex ∷ (Ord α, Integral α, Printer p) ⇒ α → p
lowHex = number LowHex
{-# INLINE lowHex #-}

-- | Print a number in the hexadecimal numeral system using upper case
--   digits.
upHex' ∷ (Ord α, Integral α, Printer p)
       ⇒ p -- ^ Prefix for negative values
       → p -- ^ Zero printer
       → p -- ^ Prefix for positive values
       → α → p
upHex' = number' UpHex
{-# INLINE upHex' #-}

-- | Print a number in the hexadecimal numeral system using upper case
--   digits. Negative values are prefixed with a minus sign.
upHex ∷ (Ord α, Integral α, Printer p) ⇒ α → p
upHex = number UpHex
{-# INLINE upHex #-}

-- | Print a binary number in the specified positional numeral system.
bits' ∷ (BitSystem s, Ord α, Num α, Bits α, Printer p)
      ⇒ s
      → p -- ^ Prefix for negative values
      → p -- ^ Zero printer
      → p -- ^ Prefix for positive values
      → α → p
bits' s neg z pos n = case compare n 0 of
    LT → case testBit n 0 of
           True → go neg (shiftR (negate n) digitBits) <> printDigitIn s d
             where !d = intToDigitIn s $ radix - lastDigitIn s n
           False → case n > negRadix of
               True → neg <> printDigitIn s d'
               False → go neg m <> printDigitIn s d'
                 where m | d == 0    = negate $ shiftR n digitBits
                         | otherwise = complement $ shiftR n digitBits
             where !d  = lastDigitIn s n
                   !d' = intToDigitIn s $ (radix - d) .&. digitMask
    EQ → z
    GT → go pos (shiftR n digitBits) <> printDigitIn s d
      where !d = intToDigitIn s $ lastDigitIn s n
  where go p 0 = p
        go p m = go p (shiftR m digitBits) <> printDigitIn s d
          where !d = intToDigitIn s $ lastDigitIn s m
        radix     = radixIn s
        digitMask = digitMaskIn s
        digitBits = digitBitsIn s
        negRadix  = complement $ digitMaskIn s
{-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Int → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Int8 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Int16 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Int32 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Int64 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Word → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Word8 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Word16 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Word32 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Binary → p → p → p → Word64 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Int → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Int8 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Int16 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Int32 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Int64 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Word → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Word8 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Word16 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Word32 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Octal → p → p → p → Word64 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Int → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Int8 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Int16 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Int32 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Int64 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Word → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Word8 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Word16 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Word32 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ Hexadecimal → p → p → p → Word64 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Int → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Int8 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Int16 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Int32 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Int64 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Word → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Word8 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Word16 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Word32 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ LowHex → p → p → p → Word64 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Int → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Int8 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Int16 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Int32 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Int64 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Word → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Word8 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Word16 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Word32 → p #-}
{-# SPECIALIZE bits' ∷ Printer p ⇒ UpHex → p → p → p → Word64 → p #-}
{-# SPECIALIZE bits' ∷ (Ord α, Num α, Bits α, Printer p) ⇒ Binary → p → p → p → α → p #-}
{-# SPECIALIZE bits' ∷ (Ord α, Num α, Bits α, Printer p) ⇒ Octal → p → p → p → α → p #-}
{-# SPECIALIZE bits' ∷ (Ord α, Num α, Bits α, Printer p) ⇒ Hexadecimal → p → p → p → α → p #-}
{-# SPECIALIZE bits' ∷ (Ord α, Num α, Bits α, Printer p) ⇒ LowHex → p → p → p → α → p #-}
{-# SPECIALIZE bits' ∷ (Ord α, Num α, Bits α, Printer p) ⇒ UpHex → p → p → p → α → p #-}

-- | Print a binary number in the specified positional numeral system.
--   Negative values are prefixed with a minus sign.
bits ∷ (BitSystem s, Ord α, Num α, Bits α, Printer p) ⇒ s → α → p
bits s = bits' s (char7 '-') (printZeroIn s) mempty
{-# INLINE bits #-}

-- | Print a binary number in the binary numeral system.
binaryBits' ∷ (Ord α, Num α, Bits α, Printer p)
            ⇒ p -- ^ Prefix for negative values
            → p -- ^ Zero printer
            → p -- ^ Prefix for positive values
            → α → p
binaryBits' = bits' Binary
{-# INLINE binaryBits' #-}

-- | Print a binary number in the binary numeral system. Negative values
--   are prefixed with a minus sign.
binaryBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ α → p
binaryBits = bits Binary
{-# INLINE binaryBits #-}

-- | Print a binary number in the octal numeral system.
octalBits' ∷ (Ord α, Num α, Bits α, Printer p)
           ⇒ p -- ^ Prefix for negative values
           → p -- ^ Zero printer
           → p -- ^ Prefix for positive values
           → α → p
octalBits' = bits' Octal
{-# INLINE octalBits' #-}

-- | Print a binary number in the octal numeral system. Negative values
--   are prefixed with a minus sign.
octalBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ α → p
octalBits = bits Octal
{-# INLINE octalBits #-}

-- | Print a binary number in the hexadecimal numeral system using lower
--   case digits.
lowHexBits' ∷ (Ord α, Num α, Bits α, Printer p)
            ⇒ p -- ^ Prefix for negative values
            → p -- ^ Zero printer
            → p -- ^ Prefix for positive values
            → α → p
lowHexBits' = bits' LowHex
{-# INLINE lowHexBits' #-}

-- | Print a binary number in the hexadecimal numeral system using lower
--   case digits. Negative values are prefixed with a minus sign.
lowHexBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ α → p
lowHexBits = bits LowHex
{-# INLINE lowHexBits #-}

-- | Print a binary number in the hexadecimal numeral system using upper
--   case digits.
upHexBits' ∷ (Ord α, Num α, Bits α, Printer p)
           ⇒ p -- ^ Prefix for negative values
           → p -- ^ Zero printer
           → p -- ^ Prefix for positive values
           → α → p
upHexBits' = bits' UpHex
{-# INLINE upHexBits' #-}

-- | Print a binary number in the hexadecimal numeral system using upper
--   case digits. Negative values are prefixed with a minus sign.
upHexBits ∷ (Ord α, Num α, Bits α, Printer p) ⇒ α → p
upHexBits = bits UpHex
{-# INLINE upHexBits #-}
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE UnicodeSyntax #-}
{-# LANGUAGE DeriveDataTypeable #-}
{-# LANGUAGE BangPatterns #-}

-- | Print integral numbers in common positional numeral systems.
module Text.Printer.Integral
  (
  -- * Positional systems
    PositionalSystem(..)
  , BitSystem(..)
  , Binary(..)
  , Octal(..)
  , Decimal(..)
  , Hexadecimal(..)
  , LowHex(..)
  , UpHex(..)
  -- * Numeral printers
  , nonNegative
  , nnBinary
  , nnOctal
  , nnDecimal
  , nnLowHex
  , nnUpHex
  , nnBits
  , nnBinaryBits
  , nnOctalBits
  , nnLowHexBits
  , nnUpHexBits
  , nonPositive
  , npBinary
  , npOctal
  , npDecimal
  , npLowHex
  , npUpHex
  , npBits
  , npBinaryBits
  , npOctalBits
  , npLowHexBits
  , npUpHexBits
  , number'
  , number
  , binary'
  , binary
  , octal'
  , octal
  , decimal'
  , decimal
  , lowHex'
  , lowHex
  , upHex'
  , upHex
  , bits'
  , bits
  , binaryBits'
  , binaryBits
  , octalBits'
  , octalBits
  , lowHexBits'
  , lowHexBits
  , upHexBits'
  , upHexBits
  ) where

import Data.Typeable (Typeable)
import Data.Char (chr, ord)
import Data.Int
import Data.Word
import Data.Bits (Bits(..))
import Data.Monoid (mempty)
import qualified Text.Ascii as A
import Text.Printer

-- | Positional numeral system.
class PositionalSystem s where
  -- | The name of the system (e.g. \"binary\", \"decimal\").
  systemName :: s -> String
  -- | The radix of the system.
  radixIn :: Num α => s -> α
  -- | Test if a character is a digit.
  isDigitIn :: s -> Char -> Bool
  -- | Test if a character is a non-zero digit.
  isNzDigitIn :: s -> Char -> Bool
  -- | Map digits to the corresponding numbers. Return 'Nothing' on
  --   other inputs.
  fromDigitIn :: Num α => s -> Char -> Maybe α
  -- | Map non-zero digits to the corresponding numbers. Return 'Nothing' on
  --   other inputs.
  fromNzDigitIn :: Num α => s -> Char -> Maybe α
  -- | Map digits to the corresponding numbers. No checks are performed.
  unsafeFromDigitIn :: Num α => s -> Char -> α
  -- | Map 'Int' values to the corresponding digits. Inputs /must/ be
  --   non-negative and less than the radix.
  intToDigitIn :: s -> Int -> Char
  -- | Print a digit.
  printDigitIn :: Printer p => s -> Char -> p
  printDigitIn _ = char7
  {-# INLINE printDigitIn #-}
  printZeroIn :: Printer p => s -> p
  printZeroIn s = printDigitIn s $! intToDigitIn s 0
  {-# INLINE printZeroIn #-}

-- | Positonal numeral system with a power of two radix.
class PositionalSystem s => BitSystem s where
  -- | Numer of bits occupied by a digit.
  digitBitsIn :: s -> Int
  -- | The number that has 'digitBitsIn' least significant bits set to ones
  --   and all the other bits set to zeroes.
  digitMaskIn :: Num α => s -> α
  -- | Map the last digit of a number to the corresponding 'Int' value.
  lastDigitIn :: Bits α => s -> α -> Int

-- | The binary numeral system.
data Binary = Binary deriving (Typeable, Eq, Ord, Show, Read)

instance PositionalSystem Binary where
  systemName _ = "binary"
  {-# INLINE systemName #-}
  radixIn _ = 2
  {-# INLINE radixIn #-}
  isDigitIn _ = A.isBinDigit
  {-# INLINE isDigitIn #-}
  isNzDigitIn _ = A.isNzBinDigit
  {-# INLINE isNzDigitIn #-}
  fromDigitIn _ = A.fromBinDigit
  {-# INLINE fromDigitIn #-}
  fromNzDigitIn _ = A.fromNzBinDigit
  {-# INLINE fromNzDigitIn #-}
  unsafeFromDigitIn _ = A.unsafeFromBinDigit
  {-# INLINE unsafeFromDigitIn #-}
  intToDigitIn _ i = chr $! ord '0' + i
  {-# INLINE intToDigitIn #-}
  printZeroIn _ = char7 '0'
  {-# INLINE printZeroIn #-}

instance BitSystem Binary where
  digitBitsIn _ = 1
  {-# INLINE digitBitsIn #-}
  digitMaskIn _ = 1
  {-# INLINE digitMaskIn #-}
  lastDigitIn _ n = if testBit n 0 then 1 else 0
  {-# INLINE lastDigitIn #-}

-- | The octal numeral system.
data Octal = Octal deriving (Typeable, Eq, Ord, Show, Read)

instance PositionalSystem Octal where
  systemName _ = "octal"
  {-# INLINE systemName #-}
  radixIn _ = 8
  {-# INLINE radixIn #-}
  isDigitIn _ = A.isOctDigit
  {-# INLINE isDigitIn #-}
  isNzDigitIn _ = A.isNzOctDigit
  {-# INLINE isNzDigitIn #-}
  fromDigitIn _ = A.fromOctDigit
  {-# INLINE fromDigitIn #-}
  fromNzDigitIn _ = A.fromNzOctDigit
  {-# INLINE fromNzDigitIn #-}
  unsafeFromDigitIn _ = A.unsafeFromOctDigit
  {-# INLINE unsafeFromDigitIn #-}
  intToDigitIn _ i = chr $! ord '0' + i
  {-# INLINE intToDigitIn #-}
  printZeroIn _ = char7 '0'
  {-# INLINE printZeroIn #-}

instance BitSystem Octal where
  digitBitsIn _ = 3
  {-# INLINE digitBitsIn #-}
  digitMaskIn _ = 7
  {-# INLINE digitMaskIn #-}
  lastDigitIn _ n = (if testBit n 0 then 1 else 0)
                  + (if testBit n 1 then 2 else 0)
                  + (if testBit n 2 then 4 else 0)
  {-# INLINE lastDigitIn #-}

-- | The decimal numeral system.
data Decimal = Decimal deriving (Typeable, Eq, Ord, Show, Read)

instance PositionalSystem Decimal where
  systemName _ = "decimal"
  {-# INLINE systemName #-}
  radixIn _ = 10
  {-# INLINE radixIn #-}
  isDigitIn _ = A.isDecDigit
  {-# INLINE isDigitIn #-}
  isNzDigitIn _ = A.isNzDecDigit
  {-# INLINE isNzDigitIn #-}
  fromDigitIn _ = A.fromDecDigit
  {-# INLINE fromDigitIn #-}
  fromNzDigitIn _ = A.fromNzDecDigit
  {-# INLINE fromNzDigitIn #-}
  unsafeFromDigitIn _ = A.unsafeFromDecDigit
  {-# INLINE unsafeFromDigitIn #-}
  intToDigitIn _ i = chr $! ord '0' + i
  {-# INLINE intToDigitIn #-}
  printZeroIn _ = char7 '0'
  {-# INLINE printZeroIn #-}

-- | The hexadecimal numeral system.
data Hexadecimal = Hexadecimal

instance PositionalSystem Hexadecimal where
  systemName _ = "hexadecimal"
  {-# INLINE systemName #-}
  radixIn _ = 16
  {-# INLINE radixIn #-}
  isDigitIn _ = A.isHexDigit
  {-# INLINE isDigitIn #-}
  isNzDigitIn _ = A.isNzHexDigit
  {-# INLINE isNzDigitIn #-}
  fromDigitIn _ = A.fromHexDigit
  {-# INLINE fromDigitIn #-}
  fromNzDigitIn _ = A.fromNzHexDigit
  {-# INLINE fromNzDigitIn #-}
  unsafeFromDigitIn _ = A.unsafeFromHexDigit
  {-# INLINE unsafeFromDigitIn #-}
  intToDigitIn _ i | i < 10    = chr $! ord '0' + i
                   | otherwise = chr $! ord 'A' + (i - 10)
  {-# INLINE intToDigitIn #-}
  printZeroIn _ = char7 '0'
  {-# INLINE printZeroIn #-}

instance BitSystem Hexadecimal where
  digitBitsIn _ = 4
  {-# INLINE digitBitsIn #-}
  digitMaskIn _ = 15
  {-# INLINE digitMaskIn #-}
  lastDigitIn _ n = (if testBit n 0 then 1 else 0)
                  + (if testBit n 1 then 2 else 0)
                  + (if testBit n 2 then 4 else 0)
                  + (if testBit n 3 then 8 else 0)
  {-# INLINABLE lastDigitIn #-}

-- | The hexadecimal numeral system, using lower case digits.
data LowHex = LowHex

instance PositionalSystem LowHex where
  systemName _ = "lower case hexadecimal"
  {-# INLINE systemName #-}
  radixIn _ = 16
  {-# INLINE radixIn #-}
  isDigitIn _ = A.isLowHexDigit
  {-# INLINE isDigitIn #-}
  isNzDigitIn _ = A.isNzLowHexDigit
  {-# INLINE isNzDigitIn #-}
  fromDigitIn _ = A.fromLowHexDigit
  {-# INLINE fromDigitIn #-}
  fromNzDigitIn _ = A.fromNzLowHexDigit
  {-# INLINE fromNzDigitIn #-}
  unsafeFromDigitIn _ = A.unsafeFromLowHexDigit
  {-# INLINE unsafeFromDigitIn #-}
  intToDigitIn _ i | i < 10    = chr $! ord '0' + i
                   | otherwise = chr $! ord 'a' + (i - 10)
  {-# INLINE intToDigitIn #-}
  printZeroIn _ = char7 '0'
  {-# INLINE printZeroIn #-}

instance BitSystem LowHex where
  digitBitsIn _ = 4
  {-# INLINE digitBitsIn #-}
  digitMaskIn _ = 15
  {-# INLINE digitMaskIn #-}
  lastDigitIn _ n = (if testBit n 0 then 1 else 0)
                  + (if testBit n 1 then 2 else 0)
                  + (if testBit n 2 then 4 else 0)
                  + (if testBit n 3 then 8 else 0)
  {-# INLINABLE lastDigitIn #-}

-- | The hexadecimal numeral system, using upper case digits.
data UpHex = UpHex

instance PositionalSystem UpHex where
  systemName _ = "upper case hexadecimal"
  {-# INLINE systemName #-}
  radixIn _ = 16
  {-# INLINE radixIn #-}
  isDigitIn _ = A.isUpHexDigit
  {-# INLINE isDigitIn #-}
  isNzDigitIn _ = A.isNzUpHexDigit
  {-# INLINE isNzDigitIn #-}
  fromDigitIn _ = A.fromUpHexDigit
  {-# INLINE fromDigitIn #-}
  fromNzDigitIn _ = A.fromNzUpHexDigit
  {-# INLINE fromNzDigitIn #-}
  unsafeFromDigitIn _ = A.unsafeFromUpHexDigit
  {-# INLINE unsafeFromDigitIn #-}
  intToDigitIn _ i | i < 10    = chr $! ord '0' + i
                   | otherwise = chr $! ord 'A' + (i - 10)
  {-# INLINE intToDigitIn #-}
  printZeroIn _ = char7 '0'
  {-# INLINE printZeroIn #-}

instance BitSystem UpHex where
  digitBitsIn _ = 4
  {-# INLINE digitBitsIn #-}
  digitMaskIn _ = 15
  {-# INLINE digitMaskIn #-}
  lastDigitIn _ n = (if testBit n 0 then 1 else 0)
                  + (if testBit n 1 then 2 else 0)
                  + (if testBit n 2 then 4 else 0)
                  + (if testBit n 3 then 8 else 0)
  {-# INLINABLE lastDigitIn #-}

-- | Print a non-negative number in the specified positional numeral system.
nonNegative :: (PositionalSystem s, Integral α, Printer p) => s -> α -> p
nonNegative s = go (printDigitIn s $! intToDigitIn s 0)
  where go p 0 = p
        go _ m = go mempty q <> printDigitIn s d
          where (q, r) = quotRem m radix
                !d     = intToDigitIn s $ fromIntegral r
        radix = radixIn s
{-# INLINABLE nonNegative #-}
{-# SPECIALIZE nonNegative :: Printer p => Decimal -> Int -> p #-}
{-# SPECIALIZE nonNegative :: Printer p => Decimal -> Int8 -> p #-}
{-# SPECIALIZE nonNegative :: Printer p => Decimal -> Int16 -> p #-}
{-# SPECIALIZE nonNegative :: Printer p => Decimal -> Int32 -> p #-}
{-# SPECIALIZE nonNegative :: Printer p => Decimal -> Int64 -> p #-}
{-# SPECIALIZE nonNegative :: Printer p => Decimal -> Word -> p #-}
{-# SPECIALIZE nonNegative :: Printer p => Decimal -> Word8 -> p #-}
{-# SPECIALIZE nonNegative :: Printer p => Decimal -> Word16 -> p #-}
{-# SPECIALIZE nonNegative :: Printer p => Decimal -> Word32 -> p #-}
{-# SPECIALIZE nonNegative :: Printer p => Decimal -> Word64 -> p #-}
{-# SPECIALIZE nonNegative :: (Integral α, Printer p) => Binary -> α -> p #-}
{-# SPECIALIZE nonNegative :: (Integral α, Printer p) => Octal -> α -> p #-}
{-# SPECIALIZE nonNegative :: (Integral α, Printer p) => Decimal -> α -> p #-}
{-# SPECIALIZE nonNegative :: (Integral α, Printer p) => LowHex -> α -> p #-}
{-# SPECIALIZE nonNegative :: (Integral α, Printer p) => UpHex -> α -> p #-}

-- | Print a non-negative number in the binary numeral system.
nnBinary :: (Integral α, Printer p) => α -> p
nnBinary = nonNegative Binary
{-# INLINE nnBinary #-}

-- | Print a non-negative number in the octal numeral system.
nnOctal :: (Integral α, Printer p) => α -> p
nnOctal = nonNegative Octal
{-# INLINE nnOctal #-}

-- | Print a non-negative number in the decimal numeral system.
nnDecimal :: (Integral α, Printer p) => α -> p
nnDecimal = nonNegative Decimal
{-# INLINE nnDecimal #-}

-- | Print a non-negative number in the hexadecimal numeral system
--   using lower case digits.
nnLowHex :: (Integral α, Printer p) => α -> p
nnLowHex = nonNegative LowHex
{-# INLINE nnLowHex #-}

-- | Print a non-negative number in the hexadecimal numeral system
--   using upper case digits.
nnUpHex :: (Integral α, Printer p) => α -> p
nnUpHex = nonNegative UpHex
{-# INLINE nnUpHex #-}

-- | Print a non-negative binary number in the specified positional numeral
--   system.
nnBits :: (BitSystem s, Num α, Bits α, Printer p) => s -> α -> p
nnBits s = go (printDigitIn s $! intToDigitIn s 0)
  where go p 0 = p
        go _ m = go mempty (shiftR m digitBits) <> printDigitIn s d
          where !d = intToDigitIn s $ lastDigitIn s m
        digitBits = digitBitsIn s
{-# INLINABLE nnBits #-}
{-# SPECIALIZE nnBits :: Printer p => Binary -> Int -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Binary -> Int8 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Binary -> Int16 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Binary -> Int32 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Binary -> Int64 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Binary -> Word -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Binary -> Word8 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Binary -> Word16 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Binary -> Word32 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Binary -> Word64 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Octal -> Int -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Octal -> Int8 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Octal -> Int16 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Octal -> Int32 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Octal -> Int64 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Octal -> Word -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Octal -> Word8 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Octal -> Word16 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Octal -> Word32 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Octal -> Word64 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Int -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Int8 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Int16 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Int32 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Int64 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Word -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Word8 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Word16 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Word32 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => Hexadecimal -> Word64 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => LowHex -> Int -> p #-}
{-# SPECIALIZE nnBits :: Printer p => LowHex -> Int8 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => LowHex -> Int16 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => LowHex -> Int32 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => LowHex -> Int64 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => LowHex -> Word -> p #-}
{-# SPECIALIZE nnBits :: Printer p => LowHex -> Word8 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => LowHex -> Word16 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => LowHex -> Word32 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => LowHex -> Word64 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => UpHex -> Int -> p #-}
{-# SPECIALIZE nnBits :: Printer p => UpHex -> Int8 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => UpHex -> Int16 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => UpHex -> Int32 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => UpHex -> Int64 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => UpHex -> Word -> p #-}
{-# SPECIALIZE nnBits :: Printer p => UpHex -> Word8 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => UpHex -> Word16 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => UpHex -> Word32 -> p #-}
{-# SPECIALIZE nnBits :: Printer p => UpHex -> Word64 -> p #-}
{-# SPECIALIZE nnBits :: (Num α, Bits α, Printer p) => Binary -> α -> p #-}
{-# SPECIALIZE nnBits :: (Num α, Bits α, Printer p) => Octal -> α -> p #-}
{-# SPECIALIZE nnBits :: (Num α, Bits α, Printer p) => Hexadecimal -> α -> p #-}
{-# SPECIALIZE nnBits :: (Num α, Bits α, Printer p) => LowHex -> α -> p #-}
{-# SPECIALIZE nnBits :: (Num α, Bits α, Printer p) => UpHex -> α -> p #-}

-- | Print a non-negative binary number in the binary numeral system.
nnBinaryBits :: (Num α, Bits α, Printer p) => α -> p
nnBinaryBits = nnBits Binary
{-# INLINE nnBinaryBits #-}

-- | Print a non-negative binary number in the octal numeral system.
nnOctalBits :: (Num α, Bits α, Printer p) => α -> p
nnOctalBits = nnBits Octal
{-# INLINE nnOctalBits #-}

-- | Print a non-negative binary number in the hexadecimal numeral system
--   using lower case digits.
nnLowHexBits :: (Num α, Bits α, Printer p) => α -> p
nnLowHexBits = nnBits LowHex
{-# INLINE nnLowHexBits #-}

-- | Print a non-negative binary number in the hexadecimal numeral system
--   using upper case digits.
nnUpHexBits :: (Num α, Bits α, Printer p) => α -> p
nnUpHexBits = nnBits UpHex
{-# INLINE nnUpHexBits #-}

-- | Print a non-positive number in the specified positional numeral system.
--   For example, @'nonPositive' 'Decimal' (-/123/)@ would print \"123\".
nonPositive :: (PositionalSystem s, Integral α, Printer p) => s -> α -> p
nonPositive s = go (printDigitIn s $! intToDigitIn s 0)
  where go p 0 = p
        go _ m = go mempty q <> printDigitIn s d
          where (q, r) = quotRem m radix
                !d     = intToDigitIn s $ negate $ fromIntegral r
        radix = radixIn s
{-# INLINABLE nonPositive #-}
{-# SPECIALIZE nonPositive :: Printer p => Decimal -> Int -> p #-}
{-# SPECIALIZE nonPositive :: Printer p => Decimal -> Int8 -> p #-}
{-# SPECIALIZE nonPositive :: Printer p => Decimal -> Int16 -> p #-}
{-# SPECIALIZE nonPositive :: Printer p => Decimal -> Int32 -> p #-}
{-# SPECIALIZE nonPositive :: Printer p => Decimal -> Int64 -> p #-}
{-# SPECIALIZE nonPositive :: Printer p => Decimal -> Word -> p #-}
{-# SPECIALIZE nonPositive :: Printer p => Decimal -> Word8 -> p #-}
{-# SPECIALIZE nonPositive :: Printer p => Decimal -> Word16 -> p #-}
{-# SPECIALIZE nonPositive :: Printer p => Decimal -> Word32 -> p #-}
{-# SPECIALIZE nonPositive :: Printer p => Decimal -> Word64 -> p #-}
{-# SPECIALIZE nonPositive :: (Integral α, Printer p) => Binary -> α -> p #-}
{-# SPECIALIZE nonPositive :: (Integral α, Printer p) => Octal -> α -> p #-}
{-# SPECIALIZE nonPositive :: (Integral α, Printer p) => Decimal -> α -> p #-}
{-# SPECIALIZE nonPositive :: (Integral α, Printer p) => LowHex -> α -> p #-}
{-# SPECIALIZE nonPositive :: (Integral α, Printer p) => UpHex -> α -> p #-}

-- | Print a non-positive number in the binary numeral system.
npBinary :: (Integral α, Printer p) => α -> p
npBinary = nonPositive Binary
{-# INLINE npBinary #-}

-- | Print a non-positive number in the octal numeral system.
npOctal :: (Integral α, Printer p) => α -> p
npOctal = nonPositive Octal
{-# INLINE npOctal #-}

-- | Print a non-positive number in the decimal numeral system.
npDecimal :: (Integral α, Printer p) => α -> p
npDecimal = nonPositive Decimal
{-# INLINE npDecimal #-}

-- | Print a non-positive number in the hexadecimal numeral system
--   using lower case digits.
npLowHex :: (Integral α, Printer p) => α -> p
npLowHex = nonPositive LowHex
{-# INLINE npLowHex #-}

-- | Print a non-positive number in the hexadecimal numeral system
--   using upper case digits.
npUpHex :: (Integral α, Printer p) => α -> p
npUpHex = nonPositive UpHex
{-# INLINE npUpHex #-}

-- | Print a non-positive two-compliment binary number in the specified
--   positional numeral system. For example, @'npBits' 'UpHex' (-/0xABC/)@
--   would print \"ABC\".
npBits :: (BitSystem s, Ord α, Num α, Bits α, Printer p) => s -> α -> p
npBits s n = case testBit n 0 of
    True -> go mempty (shiftR (negate n) digitBits) <> printDigitIn s d
      where !d = intToDigitIn s $ radix - lastDigitIn s n
    False -> case n > negRadix of
        True -> printDigitIn s d'
        False -> go mempty m <> printDigitIn s d'
          where m | d == 0    = negate $ shiftR n digitBits
                  | otherwise = complement $ shiftR n digitBits
      where !d  = lastDigitIn s n
            !d' = intToDigitIn s $ (radix - d) .&. digitMask
  where go p 0 = p
        go p m = go p (shiftR m digitBits) <> printDigitIn s d
          where !d = intToDigitIn s $ lastDigitIn s m
        radix     = radixIn s
        digitMask = digitMaskIn s
        digitBits = digitBitsIn s
        negRadix  = complement $ digitMaskIn s
{-# SPECIALIZE npBits :: Printer p => Binary -> Int -> p #-}
{-# SPECIALIZE npBits :: Printer p => Binary -> Int8 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Binary -> Int16 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Binary -> Int32 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Binary -> Int64 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Binary -> Word -> p #-}
{-# SPECIALIZE npBits :: Printer p => Binary -> Word8 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Binary -> Word16 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Binary -> Word32 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Binary -> Word64 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Octal -> Int -> p #-}
{-# SPECIALIZE npBits :: Printer p => Octal -> Int8 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Octal -> Int16 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Octal -> Int32 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Octal -> Int64 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Octal -> Word -> p #-}
{-# SPECIALIZE npBits :: Printer p => Octal -> Word8 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Octal -> Word16 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Octal -> Word32 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Octal -> Word64 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Int -> p #-}
{-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Int8 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Int16 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Int32 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Int64 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Word -> p #-}
{-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Word8 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Word16 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Word32 -> p #-}
{-# SPECIALIZE npBits :: Printer p => Hexadecimal -> Word64 -> p #-}
{-# SPECIALIZE npBits :: Printer p => LowHex -> Int -> p #-}
{-# SPECIALIZE npBits :: Printer p => LowHex -> Int8 -> p #-}
{-# SPECIALIZE npBits :: Printer p => LowHex -> Int16 -> p #-}
{-# SPECIALIZE npBits :: Printer p => LowHex -> Int32 -> p #-}
{-# SPECIALIZE npBits :: Printer p => LowHex -> Int64 -> p #-}
{-# SPECIALIZE npBits :: Printer p => LowHex -> Word -> p #-}
{-# SPECIALIZE npBits :: Printer p => LowHex -> Word8 -> p #-}
{-# SPECIALIZE npBits :: Printer p => LowHex -> Word16 -> p #-}
{-# SPECIALIZE npBits :: Printer p => LowHex -> Word32 -> p #-}
{-# SPECIALIZE npBits :: Printer p => LowHex -> Word64 -> p #-}
{-# SPECIALIZE npBits :: Printer p => UpHex -> Int -> p #-}
{-# SPECIALIZE npBits :: Printer p => UpHex -> Int8 -> p #-}
{-# SPECIALIZE npBits :: Printer p => UpHex -> Int16 -> p #-}
{-# SPECIALIZE npBits :: Printer p => UpHex -> Int32 -> p #-}
{-# SPECIALIZE npBits :: Printer p => UpHex -> Int64 -> p #-}
{-# SPECIALIZE npBits :: Printer p => UpHex -> Word -> p #-}
{-# SPECIALIZE npBits :: Printer p => UpHex -> Word8 -> p #-}
{-# SPECIALIZE npBits :: Printer p => UpHex -> Word16 -> p #-}
{-# SPECIALIZE npBits :: Printer p => UpHex -> Word32 -> p #-}
{-# SPECIALIZE npBits :: Printer p => UpHex -> Word64 -> p #-}
{-# SPECIALIZE npBits :: (Ord α, Num α, Bits α, Printer p) => Binary -> α -> p #-}
{-# SPECIALIZE npBits :: (Ord α, Num α, Bits α, Printer p) => Octal -> α -> p #-}
{-# SPECIALIZE npBits :: (Ord α, Num α, Bits α, Printer p) => Hexadecimal -> α -> p #-}
{-# SPECIALIZE npBits :: (Ord α, Num α, Bits α, Printer p) => LowHex -> α -> p #-}
{-# SPECIALIZE npBits :: (Ord α, Num α, Bits α, Printer p) => UpHex -> α -> p #-}

-- | Print a non-positive binary number in the binary numeral system.
npBinaryBits :: (Ord α, Num α, Bits α, Printer p) => α -> p
npBinaryBits = npBits Binary
{-# INLINE npBinaryBits #-}

-- | Print a non-positive binary number in the octal numeral system.
npOctalBits :: (Ord α, Num α, Bits α, Printer p) => α -> p
npOctalBits = npBits Octal
{-# INLINE npOctalBits #-}

-- | Print a non-positive binary number in the hexadecimal numeral system
--   using lower case digits.
npLowHexBits :: (Ord α, Num α, Bits α, Printer p) => α -> p
npLowHexBits = npBits LowHex
{-# INLINE npLowHexBits #-}

-- | Print a non-positive binary number in the hexadecimal numeral system
--   using upper case digits.
npUpHexBits :: (Ord α, Num α, Bits α, Printer p) => α -> p
npUpHexBits = npBits UpHex
{-# INLINE npUpHexBits #-}

-- | Print a number in the specified positional numeral system.
number' :: (PositionalSystem s, Ord α, Integral α, Printer p)
        => s
        -> p -- ^ Prefix for negative values
        -> p -- ^ Zero printer
        -> p -- ^ Prefix for positive values
        -> α -> p
number' s neg z pos n = case compare n 0 of
    LT -> go neg q <> printDigitIn s d
      where (q, r) = quotRem n (negate radix)
            !d     = intToDigitIn s $ negate $ fromIntegral r
    EQ -> z
    GT -> go pos q <> printDigitIn s d
      where (q, r) = quotRem n radix
            !d     = intToDigitIn s $ fromIntegral r
  where go p 0 = p
        go p m = go p q <> printDigitIn s d
          where (q, r) = quotRem m radix
                !d     = intToDigitIn s $ fromIntegral r
        radix = radixIn s
{-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Int -> p #-}
{-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Int8 -> p #-}
{-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Int16 -> p #-}
{-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Int32 -> p #-}
{-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Int64 -> p #-}
{-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Word -> p #-}
{-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Word8 -> p #-}
{-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Word16 -> p #-}
{-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Word32 -> p #-}
{-# SPECIALIZE number' :: Printer p => Decimal -> p -> p -> p -> Word64 -> p #-}
{-# SPECIALIZE number' :: (Ord α, Integral α, Printer p) => Binary -> p -> p -> p -> α -> p #-}
{-# SPECIALIZE number' :: (Ord α, Integral α, Printer p) => Decimal -> p -> p -> p -> α -> p #-}
{-# SPECIALIZE number' :: (Ord α, Integral α, Printer p) => Octal -> p -> p -> p -> α -> p #-}
{-# SPECIALIZE number' :: (Ord α, Integral α, Printer p) => Hexadecimal -> p -> p -> p -> α -> p #-}
{-# SPECIALIZE number' :: (Ord α, Integral α, Printer p) => LowHex -> p -> p -> p -> α -> p #-}
{-# SPECIALIZE number' :: (Ord α, Integral α, Printer p) => UpHex -> p -> p -> p -> α -> p #-}

-- | Print a number in the specified positional numeral system. Negative
--   values are prefixed with a minus sign.
number :: (PositionalSystem s, Ord α, Integral α, Printer p) => s -> α -> p
number s = number' s (char7 '-') (printZeroIn s) mempty
{-# INLINE number #-}

-- | Print a number in the binary numeral system.
binary' :: (Ord α, Integral α, Printer p)
        => p -- ^ Prefix for negative values
        -> p -- ^ Zero printer
        -> p -- ^ Prefix for positive values
        -> α -> p
binary' = number' Binary
{-# INLINE binary' #-}

-- | Print a number in the binary numeral system. Negative values
--   are prefixed with a minus sign.
binary :: (Ord α, Integral α, Printer p) => α -> p
binary = number Binary
{-# INLINE binary #-}

-- | Print a number in the octal numeral system.
octal' :: (Ord α, Integral α, Printer p)
       => p -- ^ Prefix for negative values
       -> p -- ^ Zero printer
       -> p -- ^ Prefix for positive values
       -> α -> p
octal' = number' Octal
{-# INLINE octal' #-}

-- | Print a number in the octal numeral system. Negative values
--   are prefixed with a minus sign.
octal :: (Ord α, Integral α, Printer p) => α -> p
octal = number Octal
{-# INLINE octal #-}

-- | Print a number in the decimal numeral system.
decimal' :: (Ord α, Integral α, Printer p)
         => p -- ^ Prefix for negative values
         -> p -- ^ Zero printer
         -> p -- ^ Prefix for positive values
         -> α -> p
decimal' = number' Decimal
{-# INLINE decimal' #-}

-- | Print a number in the decimal numeral system. Negative values
--   are prefixed with a minus sign.
decimal :: (Ord α, Integral α, Printer p) => α -> p
decimal = number Decimal
{-# INLINE decimal #-}

-- | Print a number in the hexadecimal numeral system using lower case
--   digits.
lowHex' :: (Ord α, Integral α, Printer p)
        => p -- ^ Prefix for negative values
        -> p -- ^ Zero printer
        -> p -- ^ Prefix for positive values
        -> α -> p
lowHex' = number' LowHex
{-# INLINE lowHex' #-}

-- | Print a number in the hexadecimal numeral system using lower case
--   digits. Negative values are prefixed with a minus sign.
lowHex :: (Ord α, Integral α, Printer p) => α -> p
lowHex = number LowHex
{-# INLINE lowHex #-}

-- | Print a number in the hexadecimal numeral system using upper case
--   digits.
upHex' :: (Ord α, Integral α, Printer p)
       => p -- ^ Prefix for negative values
       -> p -- ^ Zero printer
       -> p -- ^ Prefix for positive values
       -> α -> p
upHex' = number' UpHex
{-# INLINE upHex' #-}

-- | Print a number in the hexadecimal numeral system using upper case
--   digits. Negative values are prefixed with a minus sign.
upHex :: (Ord α, Integral α, Printer p) => α -> p
upHex = number UpHex
{-# INLINE upHex #-}

-- | Print a binary number in the specified positional numeral system.
bits' :: (BitSystem s, Ord α, Num α, Bits α, Printer p)
      => s
      -> p -- ^ Prefix for negative values
      -> p -- ^ Zero printer
      -> p -- ^ Prefix for positive values
      -> α -> p
bits' s neg z pos n = case compare n 0 of
    LT -> case testBit n 0 of
           True -> go neg (shiftR (negate n) digitBits) <> printDigitIn s d
             where !d = intToDigitIn s $ radix - lastDigitIn s n
           False -> case n > negRadix of
               True -> neg <> printDigitIn s d'
               False -> go neg m <> printDigitIn s d'
                 where m | d == 0    = negate $ shiftR n digitBits
                         | otherwise = complement $ shiftR n digitBits
             where !d  = lastDigitIn s n
                   !d' = intToDigitIn s $ (radix - d) .&. digitMask
    EQ -> z
    GT -> go pos (shiftR n digitBits) <> printDigitIn s d
      where !d = intToDigitIn s $ lastDigitIn s n
  where go p 0 = p
        go p m = go p (shiftR m digitBits) <> printDigitIn s d
          where !d = intToDigitIn s $ lastDigitIn s m
        radix     = radixIn s
        digitMask = digitMaskIn s
        digitBits = digitBitsIn s
        negRadix  = complement $ digitMaskIn s
{-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Int -> p #-}
{-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Int8 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Int16 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Int32 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Int64 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Word -> p #-}
{-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Word8 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Word16 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Word32 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Binary -> p -> p -> p -> Word64 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Int -> p #-}
{-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Int8 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Int16 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Int32 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Int64 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Word -> p #-}
{-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Word8 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Word16 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Word32 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Octal -> p -> p -> p -> Word64 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Int -> p #-}
{-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Int8 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Int16 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Int32 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Int64 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Word -> p #-}
{-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Word8 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Word16 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Word32 -> p #-}
{-# SPECIALIZE bits' :: Printer p => Hexadecimal -> p -> p -> p -> Word64 -> p #-}
{-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Int -> p #-}
{-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Int8 -> p #-}
{-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Int16 -> p #-}
{-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Int32 -> p #-}
{-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Int64 -> p #-}
{-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Word -> p #-}
{-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Word8 -> p #-}
{-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Word16 -> p #-}
{-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Word32 -> p #-}
{-# SPECIALIZE bits' :: Printer p => LowHex -> p -> p -> p -> Word64 -> p #-}
{-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Int -> p #-}
{-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Int8 -> p #-}
{-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Int16 -> p #-}
{-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Int32 -> p #-}
{-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Int64 -> p #-}
{-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Word -> p #-}
{-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Word8 -> p #-}
{-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Word16 -> p #-}
{-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Word32 -> p #-}
{-# SPECIALIZE bits' :: Printer p => UpHex -> p -> p -> p -> Word64 -> p #-}
{-# SPECIALIZE bits' :: (Ord α, Num α, Bits α, Printer p) => Binary -> p -> p -> p -> α -> p #-}
{-# SPECIALIZE bits' :: (Ord α, Num α, Bits α, Printer p) => Octal -> p -> p -> p -> α -> p #-}
{-# SPECIALIZE bits' :: (Ord α, Num α, Bits α, Printer p) => Hexadecimal -> p -> p -> p -> α -> p #-}
{-# SPECIALIZE bits' :: (Ord α, Num α, Bits α, Printer p) => LowHex -> p -> p -> p -> α -> p #-}
{-# SPECIALIZE bits' :: (Ord α, Num α, Bits α, Printer p) => UpHex -> p -> p -> p -> α -> p #-}

-- | Print a binary number in the specified positional numeral system.
--   Negative values are prefixed with a minus sign.
bits :: (BitSystem s, Ord α, Num α, Bits α, Printer p) => s -> α -> p
bits s = bits' s (char7 '-') (printZeroIn s) mempty
{-# INLINE bits #-}

-- | Print a binary number in the binary numeral system.
binaryBits' :: (Ord α, Num α, Bits α, Printer p)
            => p -- ^ Prefix for negative values
            -> p -- ^ Zero printer
            -> p -- ^ Prefix for positive values
            -> α -> p
binaryBits' = bits' Binary
{-# INLINE binaryBits' #-}

-- | Print a binary number in the binary numeral system. Negative values
--   are prefixed with a minus sign.
binaryBits :: (Ord α, Num α, Bits α, Printer p) => α -> p
binaryBits = bits Binary
{-# INLINE binaryBits #-}

-- | Print a binary number in the octal numeral system.
octalBits' :: (Ord α, Num α, Bits α, Printer p)
           => p -- ^ Prefix for negative values
           -> p -- ^ Zero printer
           -> p -- ^ Prefix for positive values
           -> α -> p
octalBits' = bits' Octal
{-# INLINE octalBits' #-}

-- | Print a binary number in the octal numeral system. Negative values
--   are prefixed with a minus sign.
octalBits :: (Ord α, Num α, Bits α, Printer p) => α -> p
octalBits = bits Octal
{-# INLINE octalBits #-}

-- | Print a binary number in the hexadecimal numeral system using lower
--   case digits.
lowHexBits' :: (Ord α, Num α, Bits α, Printer p)
            => p -- ^ Prefix for negative values
            -> p -- ^ Zero printer
            -> p -- ^ Prefix for positive values
            -> α -> p
lowHexBits' = bits' LowHex
{-# INLINE lowHexBits' #-}

-- | Print a binary number in the hexadecimal numeral system using lower
--   case digits. Negative values are prefixed with a minus sign.
lowHexBits :: (Ord α, Num α, Bits α, Printer p) => α -> p
lowHexBits = bits LowHex
{-# INLINE lowHexBits #-}

-- | Print a binary number in the hexadecimal numeral system using upper
--   case digits.
upHexBits' :: (Ord α, Num α, Bits α, Printer p)
           => p -- ^ Prefix for negative values
           -> p -- ^ Zero printer
           -> p -- ^ Prefix for positive values
           -> α -> p
upHexBits' = bits' UpHex
{-# INLINE upHexBits' #-}

-- | Print a binary number in the hexadecimal numeral system using upper
--   case digits. Negative values are prefixed with a minus sign.
upHexBits :: (Ord α, Num α, Bits α, Printer p) => α -> p
upHexBits = bits UpHex
{-# INLINE upHexBits #-}

</pre>