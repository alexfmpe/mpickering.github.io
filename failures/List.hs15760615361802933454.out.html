<a href="List.hs10260363647229181.out.html">prev</a></br><a href="failures.html">home</a></br><a href="List.hs17784705242076697922.out.html">next</a></br></br><pre>21c21
< listBind = [| \m -> \f -> concatMap f m |]
---
> listBind = [| \m ->    ->f -> concatMap f m |]
32a33
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE TemplateHaskell #-}

module MonadLab.List (
   listMonad
 ) where

import Prelude hiding (Monad)
import Language.Haskell.TH
import MonadLab.CommonTypes

listMonad :: Monad
listMonad = (listTypeCon , listReturn , listBind, [(List, [merge, halt])], listBaseLift)

listTypeCon :: MonadTypeCon
listTypeCon = \t -> appT listT t

listReturn :: ReturnExpQ
listReturn = [| \v -> [v] |]

listBind :: BindExpQ
listBind = [| \m -> \f -> concatMap f m |]

merge :: NonProperMorphismExpQ
merge = [| concat |]

halt :: NonProperMorphismExpQ
halt = [| [] |]


listBaseLift :: LiftExpQ
listBaseLift = [| id |]

</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE TemplateHaskell #-}

module MonadLab.List (
   listMonad
 ) where

import Prelude hiding (Monad)
import Language.Haskell.TH
import MonadLab.CommonTypes

listMonad :: Monad
listMonad = (listTypeCon , listReturn , listBind, [(List, [merge, halt])], listBaseLift)

listTypeCon :: MonadTypeCon
listTypeCon = \t -> appT listT t

listReturn :: ReturnExpQ
listReturn = [| \v -> [v] |]

listBind :: BindExpQ
listBind = [| \m ->    ->f -> concatMap f m |]

merge :: NonProperMorphismExpQ
merge = [| concat |]

halt :: NonProperMorphismExpQ
halt = [| [] |]


listBaseLift :: LiftExpQ
listBaseLift = [| id |]


</pre>