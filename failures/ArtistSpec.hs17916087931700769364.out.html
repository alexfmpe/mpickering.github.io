<a href="Arbitrary.hs540506265432969045.out.html">prev</a></br><a href="failures.html">home</a></br><a href="ArtistSpec.hs1823359178606061956.out.html">next</a></br></br><pre>17d16
<   it "addTags" $
18d16
<     shouldHaveJson_ . privately $
19c17
<       addTags <*> artist "Егор Летов" <*> tags ["russian", "black metal"]
---
>   it "addTags" $
19a18
>     shouldHaveJson_ . privately $
19a19
>       addTags <*> artist "Егор Летов" <*> tags ["russian", "black metal"]
21c21
<   it "getTags-authenticated" $
---
>   it "getTags-authenticated" $
24c24
<     key "tags".key "tag".values.key "name"._String
---
>     key "tags".key "tag".values.key "name"._String
26d25
<   it "removeTag" $
27c26
<     shouldHaveJson_ . privately $
---
>   it "removeTag" $
27a27
>     shouldHaveJson_ . privately $
30d29
<   it "share" $
31c30
<     shouldHaveJson_ . privately $
---
>   it "share" $
31a31
>     shouldHaveJson_ . privately $
34d33
<   it "getCorrection" $
35c34
<     publicly (getCorrection <*> artist "Meshugah")
---
>   it "getCorrection" $
35a35
>     publicly (getCorrection <*> artist "Meshugah")
37c37
<     key "corrections".key "correction".key "artist".key "name"._String
---
>     key "corrections".key "correction".key "artist".key "name"._String
43d42
<     it "getEvents" $
44c43
<       publicly (getEvents <*> artist "Meshuggah" <* limit 2)
---
>     it "getEvents" $
44a44
>       publicly (getEvents <*> artist "Meshuggah" <* limit 2)
46c46
<       jsonQuery
---
>       jsonQuery
48d47
<     it "getEvents_mbid" $
49c48
<       publicly (getEvents <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 2)
---
>     it "getEvents_mbid" $
49a49
>       publicly (getEvents <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 2)
51c51
<       jsonQuery
---
>       jsonQuery
57d56
<     it "getInfo" $
58c57
<       publicly (getInfo <*> artist "Meshuggah")
---
>     it "getInfo" $
58a58
>       publicly (getInfo <*> artist "Meshuggah")
60c60
<       jsonQuery
---
>       jsonQuery
62d61
<     it "getInfo_mbid" $
63c62
<       publicly (getInfo <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413")
---
>     it "getInfo_mbid" $
63a63
>       publicly (getInfo <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413")
65c65
<       jsonQuery
---
>       jsonQuery
71c71
<     it "getPastEvents" $
---
>     it "getPastEvents" $
74c74
<       jsonQuery
---
>       jsonQuery
76c76
<     it "getPastEvents_mbid" $
---
>     it "getPastEvents_mbid" $
79c79
<       jsonQuery
---
>       jsonQuery
85d84
<     it "getPodcast" $
86c85
<       publicly (getPodcast <*> artist "Meshuggah")
---
>     it "getPodcast" $
86a86
>       publicly (getPodcast <*> artist "Meshuggah")
88c88
<       jsonQuery
---
>       jsonQuery
90d89
<     it "getPodcast_mbid" $
91c90
<       publicly (getPodcast <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413")
---
>     it "getPodcast_mbid" $
91a91
>       publicly (getPodcast <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413")
93c93
<       jsonQuery
---
>       jsonQuery
99d98
<     it "getShouts" $
100c99
<       publicly (getShouts <*> artist "Meshuggah" <* limit 5)
---
>     it "getShouts" $
100a100
>       publicly (getShouts <*> artist "Meshuggah" <* limit 5)
102c102
<       jsonQuery
---
>       jsonQuery
104d103
<     it "getShouts_mbid" $
105c104
<       publicly (getShouts <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 5)
---
>     it "getShouts_mbid" $
105a105
>       publicly (getShouts <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 5)
107c107
<       jsonQuery
---
>       jsonQuery
113d112
<     it "getSimilar" $
114c113
<       publicly (getSimilar <*> artist "Meshuggah" <* limit 3)
---
>     it "getSimilar" $
114a114
>       publicly (getSimilar <*> artist "Meshuggah" <* limit 3)
116c116
<       jsonQuery
---
>       jsonQuery
118d117
<     it "getSimilar_mbid" $
119c118
<       publicly (getSimilar <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 3)
---
>     it "getSimilar_mbid" $
119a119
>       publicly (getSimilar <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 3)
121c121
<       jsonQuery
---
>       jsonQuery
127d126
<     it "getTags" $
128c127
<       publicly (getTags <*> artist "Егор Летов" <* user "liblastfm")
---
>     it "getTags" $
128a128
>       publicly (getTags <*> artist "Егор Летов" <* user "liblastfm")
130c130
<       jsonQuery
---
>       jsonQuery
132d131
<     it "getTags_mbid" $
133c132
<       publicly (getTags <*> mbid "cfb3d32e-d095-4d63-946d-9daf06932180" <* user "liblastfm")
---
>     it "getTags_mbid" $
133a133
>       publicly (getTags <*> mbid "cfb3d32e-d095-4d63-946d-9daf06932180" <* user "liblastfm")
135c135
<       jsonQuery
---
>       jsonQuery
141d140
<     it "getTopAlbums" $
142c141
<       publicly (getTopAlbums <*> artist "Meshuggah" <* limit 3)
---
>     it "getTopAlbums" $
142a142
>       publicly (getTopAlbums <*> artist "Meshuggah" <* limit 3)
144c144
<       jsonQuery
---
>       jsonQuery
146d145
<     it "getTopAlbums_mbid" $
147c146
<       publicly (getTopAlbums <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 3)
---
>     it "getTopAlbums_mbid" $
147a147
>       publicly (getTopAlbums <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 3)
149c149
<       jsonQuery
---
>       jsonQuery
155d154
<     it "getTopFans" $
156c155
<       publicly (getTopFans <*> artist "Meshuggah")
---
>     it "getTopFans" $
156a156
>       publicly (getTopFans <*> artist "Meshuggah")
158c158
<       jsonQuery
---
>       jsonQuery
160d159
<     it "getTopFans_mbid" $
161c160
<       publicly (getTopFans <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413")
---
>     it "getTopFans_mbid" $
161a161
>       publicly (getTopFans <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413")
163c163
<       jsonQuery
---
>       jsonQuery
169d168
<     it "getTopTags" $
170c169
<       publicly (getTopTags <*> artist "Meshuggah")
---
>     it "getTopTags" $
170a170
>       publicly (getTopTags <*> artist "Meshuggah")
172c172
<       jsonQuery
---
>       jsonQuery
174d173
<     it "getTopTags_mbid" $
175c174
<       publicly (getTopTags <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413")
---
>     it "getTopTags_mbid" $
175a175
>       publicly (getTopTags <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413")
177c177
<       jsonQuery
---
>       jsonQuery
183d182
<     it "getTopTracks" $
184c183
<       publicly (getTopTracks <*> artist "Meshuggah" <* limit 3)
---
>     it "getTopTracks" $
184a184
>       publicly (getTopTracks <*> artist "Meshuggah" <* limit 3)
186c186
<       jsonQuery
---
>       jsonQuery
188d187
<     it "getTopTracks_mbid" $
189c188
<       publicly (getTopTracks <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 3)
---
>     it "getTopTracks_mbid" $
189a189
>       publicly (getTopTracks <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 3)
191c191
<       jsonQuery
---
>       jsonQuery
193c193
<   it "search" $
---
>   it "search" $
196c196
<     key "results".key "artistmatches".key "artist".values.key "name"._String
---
>     key "results".key "artistmatches".key "artist".values.key "name"._String
196a197
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE DataKinds #-}
{-# LANGUAGE OverloadedStrings #-}
module Json.ArtistSpec (spec) where

import Data.Aeson (Value)
import Data.Aeson.Lens
import Data.Text (Text)
import Network.Lastfm
import Network.Lastfm.Artist
import Test.Hspec

import SpecHelper


spec :: Spec
spec = do
  it "addTags" $
    shouldHaveJson_ . privately $
      addTags <*> artist "Егор Летов" <*> tags ["russian", "black metal"]

  it "getTags-authenticated" $
    privately (getTags <*> artist "Егор Летов")
   `shouldHaveJson`
    key "tags".key "tag".values.key "name"._String

  it "removeTag" $
    shouldHaveJson_ . privately $
      removeTag <*> artist "Егор Летов" <*> tag "russian"

  it "share" $
    shouldHaveJson_ . privately $
      share <*> artist "Sleep" <*> recipient "liblastfm" <* message "Just listen!"

  it "getCorrection" $
    publicly (getCorrection <*> artist "Meshugah")
   `shouldHaveJson`
    key "corrections".key "correction".key "artist".key "name"._String

  describe "getEvents*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "events".key "artist"._String

    it "getEvents" $
      publicly (getEvents <*> artist "Meshuggah" <* limit 2)
     `shouldHaveJson`
      jsonQuery

    it "getEvents_mbid" $
      publicly (getEvents <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 2)
     `shouldHaveJson`
      jsonQuery

  describe "getInfo*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "artist".key "stats".key "listeners"._String

    it "getInfo" $
      publicly (getInfo <*> artist "Meshuggah")
     `shouldHaveJson`
      jsonQuery

    it "getInfo_mbid" $
      publicly (getInfo <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413")
     `shouldHaveJson`
      jsonQuery

  describe "getPastEvents*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "events".key "event".values.key "title"._String

    it "getPastEvents" $
      publicly (getPastEvents <*> artist "Meshuggah" <* autocorrect True)
     `shouldHaveJson`
      jsonQuery

    it "getPastEvents_mbid" $
      publicly (getPastEvents <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* autocorrect True)
     `shouldHaveJson`
      jsonQuery

  describe "getPodcast*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "rss".key "channel".key "description"._String

    it "getPodcast" $
      publicly (getPodcast <*> artist "Meshuggah")
     `shouldHaveJson`
      jsonQuery

    it "getPodcast_mbid" $
      publicly (getPodcast <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413")
     `shouldHaveJson`
      jsonQuery

  describe "getShouts*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "shouts".key "shout".values.key "author"._String

    it "getShouts" $
      publicly (getShouts <*> artist "Meshuggah" <* limit 5)
     `shouldHaveJson`
      jsonQuery

    it "getShouts_mbid" $
      publicly (getShouts <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 5)
     `shouldHaveJson`
      jsonQuery

  describe "getSimilar*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "similarartists".key "artist".values.key "name"._String

    it "getSimilar" $
      publicly (getSimilar <*> artist "Meshuggah" <* limit 3)
     `shouldHaveJson`
      jsonQuery

    it "getSimilar_mbid" $
      publicly (getSimilar <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 3)
     `shouldHaveJson`
      jsonQuery

  describe "getTags*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "tags".key "tag".values.key "name"._String

    it "getTags" $
      publicly (getTags <*> artist "Егор Летов" <* user "liblastfm")
     `shouldHaveJson`
      jsonQuery

    it "getTags_mbid" $
      publicly (getTags <*> mbid "cfb3d32e-d095-4d63-946d-9daf06932180" <* user "liblastfm")
     `shouldHaveJson`
      jsonQuery

  describe "getTopAlbums*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "topalbums".key "album".values.key "name"._String

    it "getTopAlbums" $
      publicly (getTopAlbums <*> artist "Meshuggah" <* limit 3)
     `shouldHaveJson`
      jsonQuery

    it "getTopAlbums_mbid" $
      publicly (getTopAlbums <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 3)
     `shouldHaveJson`
      jsonQuery

  describe "getTopFans*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "topfans".key "user".values.key "name"._String

    it "getTopFans" $
      publicly (getTopFans <*> artist "Meshuggah")
     `shouldHaveJson`
      jsonQuery

    it "getTopFans_mbid" $
      publicly (getTopFans <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413")
     `shouldHaveJson`
      jsonQuery

  describe "getTopTags*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "toptags".key "tag".values.key "name"._String

    it "getTopTags" $
      publicly (getTopTags <*> artist "Meshuggah")
     `shouldHaveJson`
      jsonQuery

    it "getTopTags_mbid" $
      publicly (getTopTags <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413")
     `shouldHaveJson`
      jsonQuery

  describe "getTopTracks*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "toptracks".key "track".values.key "name"._String

    it "getTopTracks" $
      publicly (getTopTracks <*> artist "Meshuggah" <* limit 3)
     `shouldHaveJson`
      jsonQuery

    it "getTopTracks_mbid" $
      publicly (getTopTracks <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 3)
     `shouldHaveJson`
      jsonQuery

  it "search" $
    publicly (search <*> artist "Mesh" <* limit 3)
   `shouldHaveJson`
    key "results".key "artistmatches".key "artist".values.key "name"._String
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE DataKinds #-}
{-# LANGUAGE OverloadedStrings #-}
module Json.ArtistSpec (spec) where

import Data.Aeson (Value)
import Data.Aeson.Lens
import Data.Text (Text)
import Network.Lastfm
import Network.Lastfm.Artist
import Test.Hspec

import SpecHelper


spec :: Spec
spec = do
  it "addTags" $
    shouldHaveJson_ . privately $
      addTags <*> artist "Егор Летов" <*> tags ["russian", "black metal"]

  it "getTags-authenticated" $
    privately (getTags <*> artist "Егор Летов")
   `shouldHaveJson`
    key "tags".key "tag".values.key "name"._String

  it "removeTag" $
    shouldHaveJson_ . privately $
      removeTag <*> artist "Егор Летов" <*> tag "russian"

  it "share" $
    shouldHaveJson_ . privately $
      share <*> artist "Sleep" <*> recipient "liblastfm" <* message "Just listen!"

  it "getCorrection" $
    publicly (getCorrection <*> artist "Meshugah")
   `shouldHaveJson`
    key "corrections".key "correction".key "artist".key "name"._String

  describe "getEvents*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "events".key "artist"._String

    it "getEvents" $
      publicly (getEvents <*> artist "Meshuggah" <* limit 2)
     `shouldHaveJson`
      jsonQuery

    it "getEvents_mbid" $
      publicly (getEvents <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 2)
     `shouldHaveJson`
      jsonQuery

  describe "getInfo*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "artist".key "stats".key "listeners"._String

    it "getInfo" $
      publicly (getInfo <*> artist "Meshuggah")
     `shouldHaveJson`
      jsonQuery

    it "getInfo_mbid" $
      publicly (getInfo <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413")
     `shouldHaveJson`
      jsonQuery

  describe "getPastEvents*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "events".key "event".values.key "title"._String

    it "getPastEvents" $
      publicly (getPastEvents <*> artist "Meshuggah" <* autocorrect True)
     `shouldHaveJson`
      jsonQuery

    it "getPastEvents_mbid" $
      publicly (getPastEvents <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* autocorrect True)
     `shouldHaveJson`
      jsonQuery

  describe "getPodcast*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "rss".key "channel".key "description"._String

    it "getPodcast" $
      publicly (getPodcast <*> artist "Meshuggah")
     `shouldHaveJson`
      jsonQuery

    it "getPodcast_mbid" $
      publicly (getPodcast <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413")
     `shouldHaveJson`
      jsonQuery

  describe "getShouts*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "shouts".key "shout".values.key "author"._String

    it "getShouts" $
      publicly (getShouts <*> artist "Meshuggah" <* limit 5)
     `shouldHaveJson`
      jsonQuery

    it "getShouts_mbid" $
      publicly (getShouts <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 5)
     `shouldHaveJson`
      jsonQuery

  describe "getSimilar*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "similarartists".key "artist".values.key "name"._String

    it "getSimilar" $
      publicly (getSimilar <*> artist "Meshuggah" <* limit 3)
     `shouldHaveJson`
      jsonQuery

    it "getSimilar_mbid" $
      publicly (getSimilar <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 3)
     `shouldHaveJson`
      jsonQuery

  describe "getTags*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "tags".key "tag".values.key "name"._String

    it "getTags" $
      publicly (getTags <*> artist "Егор Летов" <* user "liblastfm")
     `shouldHaveJson`
      jsonQuery

    it "getTags_mbid" $
      publicly (getTags <*> mbid "cfb3d32e-d095-4d63-946d-9daf06932180" <* user "liblastfm")
     `shouldHaveJson`
      jsonQuery

  describe "getTopAlbums*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "topalbums".key "album".values.key "name"._String

    it "getTopAlbums" $
      publicly (getTopAlbums <*> artist "Meshuggah" <* limit 3)
     `shouldHaveJson`
      jsonQuery

    it "getTopAlbums_mbid" $
      publicly (getTopAlbums <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 3)
     `shouldHaveJson`
      jsonQuery

  describe "getTopFans*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "topfans".key "user".values.key "name"._String

    it "getTopFans" $
      publicly (getTopFans <*> artist "Meshuggah")
     `shouldHaveJson`
      jsonQuery

    it "getTopFans_mbid" $
      publicly (getTopFans <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413")
     `shouldHaveJson`
      jsonQuery

  describe "getTopTags*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "toptags".key "tag".values.key "name"._String

    it "getTopTags" $
      publicly (getTopTags <*> artist "Meshuggah")
     `shouldHaveJson`
      jsonQuery

    it "getTopTags_mbid" $
      publicly (getTopTags <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413")
     `shouldHaveJson`
      jsonQuery

  describe "getTopTracks*" $ do
    let jsonQuery :: Fold Value Text
        jsonQuery = key "toptracks".key "track".values.key "name"._String

    it "getTopTracks" $
      publicly (getTopTracks <*> artist "Meshuggah" <* limit 3)
     `shouldHaveJson`
      jsonQuery

    it "getTopTracks_mbid" $
      publicly (getTopTracks <*> mbid "cf8b3b8c-118e-4136-8d1d-c37091173413" <* limit 3)
     `shouldHaveJson`
      jsonQuery

  it "search" $
    publicly (search <*> artist "Mesh" <* limit 3)
   `shouldHaveJson`
    key "results".key "artistmatches".key "artist".values.key "name"._String

</pre>