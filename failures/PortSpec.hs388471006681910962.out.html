<a href="PortPool.hs11477222941070477904.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Position.hs19047979421400285365.out.html">next</a></br></br><pre>16c16
< class PortSpec n where portSpec ∷ n → [(Vector2, Vector2)]
---
> class PortSpec n where portSpec :: n -> [(Vector2, Vector2)]
18c18
< sameDir ∷ Vector2 → (Vector2, Vector2)
---
> sameDir :: Vector2 -> (Vector2, Vector2)
21c21
< portDir ∷ PortSpec n ⇒ n → [Vector2]
---
> portDir :: PortSpec n => n -> [Vector2]
24c24
< relPortPos ∷ PortSpec n ⇒ n → [Vector2]
---
> relPortPos :: PortSpec n => n -> [Vector2]
27c27
< absPortPos ∷ (PortSpec n, View Position n) ⇒ n → [Vector2]
---
> absPortPos :: (PortSpec n, View Position n) => n -> [Vector2]
30c30
< propOfPort ∷ View [Port] n ⇒ (n → [a]) → Edge → n → [a]
---
> propOfPort :: View [Port] n => (n -> [a]) -> Edge -> n -> [a]
32a33
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE UnicodeSyntax, FlexibleContexts #-}
module GraphRewriting.Layout.PortSpec
    (module GraphRewriting.Layout.PortSpec,
     module GraphRewriting.Layout.Position,
     module Data.View)
where

import Prelude.Unicode
import GraphRewriting.Graph
import GraphRewriting.Layout.Position
import Data.View
import Data.Maybe (catMaybes)


-- | Port position relative to the node center, and the direction in which edges should stick out.
class PortSpec n where portSpec ∷ n → [(Vector2, Vector2)]

sameDir ∷ Vector2 → (Vector2, Vector2)
sameDir r = (r,r)

portDir ∷ PortSpec n ⇒ n → [Vector2]
portDir = map snd . portSpec

relPortPos ∷ PortSpec n ⇒ n → [Vector2]
relPortPos = map fst . portSpec

absPortPos ∷ (PortSpec n, View Position n) ⇒ n → [Vector2]
absPortPos n = map (examine position n +) (relPortPos n)

propOfPort ∷ View [Port] n ⇒ (n → [a]) → Edge → n → [a]
propOfPort portProps e n = catMaybes $ zipWith filterE (inspect n) (portProps n)
    where filterE edge portPos = if edge ≡ e then Just portPos else Nothing
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE UnicodeSyntax, FlexibleContexts #-}
module GraphRewriting.Layout.PortSpec
    (module GraphRewriting.Layout.PortSpec,
     module GraphRewriting.Layout.Position,
     module Data.View)
where

import Prelude.Unicode
import GraphRewriting.Graph
import GraphRewriting.Layout.Position
import Data.View
import Data.Maybe (catMaybes)


-- | Port position relative to the node center, and the direction in which edges should stick out.
class PortSpec n where portSpec :: n -> [(Vector2, Vector2)]

sameDir :: Vector2 -> (Vector2, Vector2)
sameDir r = (r,r)

portDir :: PortSpec n => n -> [Vector2]
portDir = map snd . portSpec

relPortPos :: PortSpec n => n -> [Vector2]
relPortPos = map fst . portSpec

absPortPos :: (PortSpec n, View Position n) => n -> [Vector2]
absPortPos n = map (examine position n +) (relPortPos n)

propOfPort :: View [Port] n => (n -> [a]) -> Edge -> n -> [a]
propOfPort portProps e n = catMaybes $ zipWith filterE (inspect n) (portProps n)
    where filterE edge portPos = if edge ≡ e then Just portPos else Nothing

</pre>