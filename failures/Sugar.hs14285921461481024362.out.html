<a href="SubsumeCommon.hs1027960836431830537.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Sum.hs1895928381505945281.out.html">next</a></br></br><pre>30c30
<     [e| fromList $qExp |]
---
>     [| fromList qExp |]
31a32
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE Haskell2010, TemplateHaskell #-}

module Numeric.Matrix.Sugar (
        iMatrix, dMatrix
    ) where

import Numeric.Matrix
import Language.Haskell.TH
import Language.Haskell.TH.Quote

import Data.Data
import Data.Complex
import Data.Ratio

type ReadM a = String -> Matrix a

iMatrix = QuasiQuoter
            (quoter (read :: ReadM Integer))
            undefined undefined undefined

dMatrix = QuasiQuoter
            (quoter (read :: ReadM Double))
            undefined undefined undefined

quoter :: (Data e, MatrixElement e)
       => (String -> Matrix e) -> String -> Q Exp

quoter read str = do
    let qExp = dataToExpQ (const Nothing) (toList (read str))
    [e| fromList $qExp |]

</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE Haskell2010, TemplateHaskell #-}

module Numeric.Matrix.Sugar (
        iMatrix, dMatrix
    ) where

import Numeric.Matrix
import Language.Haskell.TH
import Language.Haskell.TH.Quote

import Data.Data
import Data.Complex
import Data.Ratio

type ReadM a = String -> Matrix a

iMatrix = QuasiQuoter
            (quoter (read :: ReadM Integer))
            undefined undefined undefined

dMatrix = QuasiQuoter
            (quoter (read :: ReadM Double))
            undefined undefined undefined

quoter :: (Data e, MatrixElement e)
       => (String -> Matrix e) -> String -> Q Exp

quoter read str = do
    let qExp = dataToExpQ (const Nothing) (toList (read str))
    [| fromList qExp |]


</pre>