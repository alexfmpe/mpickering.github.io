<a href="ListArrow.hs8669131121679612136.out.html">prev</a></br><a href="failures.html">home</a></br><a href="ListKind.hs3972156851624842919.out.html">next</a></br></br><pre>21c21
< listIoBind = [| \m -> \f -> concatMap (>>= f) m |]
---
> listIoBind = [| \m ->    ->f -> concatMap (>>= f) m |]
30a31
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE TemplateHaskell #-}

module MonadLab.ListIo (
   listIoMonad
 ) where

import Prelude hiding (Monad)
import Language.Haskell.TH
import MonadLab.CommonTypes

listIoMonad :: Monad
listIoMonad = (listIoTypeCon , listIoReturn , listIoBind, [(List, [merge]), (Io, [liftIO])], listIoBaseLift)

listIoTypeCon :: MonadTypeCon
listIoTypeCon = \t -> appT listT (appT (conT ''IO) t)

listIoReturn :: ReturnExpQ
listIoReturn = [| \v -> [return v] |]

listIoBind :: BindExpQ
listIoBind = [| \m -> \f -> concatMap (>>= f) m |]

liftIO :: NonProperMorphismExpQ
liftIO = [| \io -> [io] |]

merge :: NonProperMorphismExpQ
merge = [| concat |]

listIoBaseLift :: LiftExpQ
listIoBaseLift = [| map return |]
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE TemplateHaskell #-}

module MonadLab.ListIo (
   listIoMonad
 ) where

import Prelude hiding (Monad)
import Language.Haskell.TH
import MonadLab.CommonTypes

listIoMonad :: Monad
listIoMonad = (listIoTypeCon , listIoReturn , listIoBind, [(List, [merge]), (Io, [liftIO])], listIoBaseLift)

listIoTypeCon :: MonadTypeCon
listIoTypeCon = \t -> appT listT (appT (conT ''IO) t)

listIoReturn :: ReturnExpQ
listIoReturn = [| \v -> [return v] |]

listIoBind :: BindExpQ
listIoBind = [| \m ->    ->f -> concatMap (>>= f) m |]

liftIO :: NonProperMorphismExpQ
liftIO = [| \io -> [io] |]

merge :: NonProperMorphismExpQ
merge = [| concat |]

listIoBaseLift :: LiftExpQ
listIoBaseLift = [| map return |]

</pre>