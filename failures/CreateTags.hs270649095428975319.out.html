<a href="CreateSubnet.hs9964979722063936098.out.html">prev</a></br><a href="failures.html">home</a></br><a href="CreateVolume.hs6855834541351345223.out.html">next</a></br></br><pre>36c36
< EC2VALUETRANSACTION(CreateTags,"return")
---
> $(CreateTags,"return")
36a37
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE TypeFamilies
           , MultiParamTypeClasses
           , FlexibleInstances
           , OverloadedStrings
           , RecordWildCards
           , TemplateHaskell
           #-}

module Aws.Ec2.Commands.CreateTags where

import Aws.Ec2.TH
import qualified Network.HTTP.Types as HTTP

type Tag = (Text, Text)

data CreateTags = CreateTags
               { ct_resources :: [Text]
               , ct_tags :: [Tag]
               } deriving (Show)

enumerateTags :: [Tag] -> HTTP.Query
enumerateTags = enumerateLists "Tag." . fmap unroll
  where
    unroll (key, value) = [ ("Key", qArg key)
                          , ("Value", qArg value)
                          ]

instance SignQuery CreateTags where
    type ServiceConfiguration CreateTags = EC2Configuration
    signQuery CreateTags{..} = ec2SignQuery $
                                           [ ("Action", qArg "CreateTags")
                                           , defVersion
                                           ] +++ enumerate "ResourceId" ct_resources qArg
                                             +++ enumerateTags ct_tags

EC2VALUETRANSACTION(CreateTags,"return")
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE TypeFamilies
           , MultiParamTypeClasses
           , FlexibleInstances
           , OverloadedStrings
           , RecordWildCards
           , TemplateHaskell
           #-}

module Aws.Ec2.Commands.CreateTags where

import Aws.Ec2.TH
import qualified Network.HTTP.Types as HTTP

type Tag = (Text, Text)

data CreateTags = CreateTags
               { ct_resources :: [Text]
               , ct_tags :: [Tag]
               } deriving (Show)

enumerateTags :: [Tag] -> HTTP.Query
enumerateTags = enumerateLists "Tag." . fmap unroll
  where
    unroll (key, value) = [ ("Key", qArg key)
                          , ("Value", qArg value)
                          ]

instance SignQuery CreateTags where
    type ServiceConfiguration CreateTags = EC2Configuration
    signQuery CreateTags{..} = ec2SignQuery $
                                           [ ("Action", qArg "CreateTags")
                                           , defVersion
                                           ] +++ enumerate "ResourceId" ct_resources qArg
                                             +++ enumerateTags ct_tags

$(CreateTags,"return")

</pre>