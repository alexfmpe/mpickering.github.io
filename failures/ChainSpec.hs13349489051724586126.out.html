<a href="ChainCodes.hs6855834541351345223.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Channels.hs340756291478446501.out.html">next</a></br></br><pre>22d21
<         readImg x = readRGB8 x >>= \case
23d21
<           Left _ → fail $ "Failed reading " ++ img
24c22
<           Right s → return s
---
>         readImg x = readRGB8 x >>= 
24a23
>           Left _ -> fail $ "Failed reading " ++ img
24a24
>           Right s -> return s
27c27
<       i ← readImg img
---
>       i <- readImg img
31c31
<       i ← readImg "test/res/c.gif"
---
>       i <- readImg "test/res/c.gif"
35c35
<       i ← readImg img
---
>       i <- readImg img
36a37
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE UnicodeSyntax #-}
{-# LANGUAGE LambdaCase #-}
{-# OPTIONS_GHC -fno-warn-orphans #-}

module Data.ChainCodes.ChainSpec (main, spec) where

import Data.ChainCodes
import Data.ChainCodes.Blobs
import Test.Hspec
import Codec.Picture

main :: IO ()
main = hspec spec

spec :: Spec
spec = do
  describe "parseString" $ do
    let img = "test/res/a.gif"
        white = PixelRGB8 255 255 255
        black = PixelRGB8 0 0 0
        red = PixelRGB8 255 0 0
        readImg x = readRGB8 x >>= \case
          Left _ → fail $ "Failed reading " ++ img
          Right s → return s

    it "can find a spot" $ do
      i ← readImg img
      findSpot i black `shouldBe`Just (67, 1)

    it "fails with Nothing when it can't find a spot" $ do
      i ← readImg "test/res/c.gif"
      findSpot i red `shouldBe` Nothing

    it "can read in the correct chaincode" $ do
      i ← readImg img
      chainCode i black `shouldBe` Just agifChain
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE UnicodeSyntax #-}
{-# LANGUAGE LambdaCase #-}
{-# OPTIONS_GHC -fno-warn-orphans #-}

module Data.ChainCodes.ChainSpec (main, spec) where

import Data.ChainCodes
import Data.ChainCodes.Blobs
import Test.Hspec
import Codec.Picture

main :: IO ()
main = hspec spec

spec :: Spec
spec = do
  describe "parseString" $ do
    let img = "test/res/a.gif"
        white = PixelRGB8 255 255 255
        black = PixelRGB8 0 0 0
        red = PixelRGB8 255 0 0
        readImg x = readRGB8 x >>= 
          Left _ -> fail $ "Failed reading " ++ img
          Right s -> return s

    it "can find a spot" $ do
      i <- readImg img
      findSpot i black `shouldBe`Just (67, 1)

    it "fails with Nothing when it can't find a spot" $ do
      i <- readImg "test/res/c.gif"
      findSpot i red `shouldBe` Nothing

    it "can read in the correct chaincode" $ do
      i <- readImg img
      chainCode i black `shouldBe` Just agifChain

</pre>