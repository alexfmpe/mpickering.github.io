<a href="test-trivial.hs8629295931300601360.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Test.hs10447881241927702196.out.html">next</a></br></br><pre>10d9
< import "base" Control.Monad      ( (=<<) )
11d9
< import "base" Data.Function      ( ($) )
12d9
< import "base" Prelude            ( String )
13d9
< import "base" System.Environment ( getArgs )
14d9
< import "base" System.IO          ( IO )
15d9
< import "base-unicode-symbols" Prelude.Unicode ( ℤ )
16d9
< import "HUnit" Test.HUnit.Base ( assertEqual )
17c10
< import "test-framework" Test.Framework
---
> import  Control.Monad      ( (=<<) )
17a11
> import  Data.Function      ( ($) )
17a12
> import  Prelude            ( String )
17a13
> import  System.Environment ( getArgs )
17a14
> import  System.IO          ( IO )
17a15
> import  Prelude.Unicode ( ℤ )
17a16
> import  Test.HUnit.Base ( assertEqual )
17a17
> import  Test.Framework
19d18
< import "test-framework-hunit" Test.Framework.Providers.HUnit ( testCase )
20c19
< import "terminal-progress-bar" System.ProgressBar
---
> import  Test.Framework.Providers.HUnit ( testCase )
20a20
> import  System.ProgressBar
27d26
< main ∷ IO ()
28c27
< main = do opts ← interpretArgsOrExit =<< getArgs
---
> main :: IO ()
28a28
> main = do opts <- interpretArgsOrExit =<< getArgs
31c31
< tests ∷ [Test]
---
> tests :: [Test]
63c63
< eqTest ∷ String → String → Label → Label → ℤ → ℤ → ℤ → Test
---
> eqTest :: String -> String -> Label -> Label -> ℤ -> ℤ -> ℤ -> Test
69a70
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE NoImplicitPrelude, PackageImports, UnicodeSyntax #-}

module Main where


--------------------------------------------------------------------------------
-- Imports
--------------------------------------------------------------------------------

import "base" Control.Monad      ( (=<<) )
import "base" Data.Function      ( ($) )
import "base" Prelude            ( String )
import "base" System.Environment ( getArgs )
import "base" System.IO          ( IO )
import "base-unicode-symbols" Prelude.Unicode ( ℤ )
import "HUnit" Test.HUnit.Base ( assertEqual )
import "test-framework" Test.Framework
    ( defaultMainWithOpts, interpretArgsOrExit, Test, testGroup )
import "test-framework-hunit" Test.Framework.Providers.HUnit ( testCase )
import "terminal-progress-bar" System.ProgressBar
    ( mkProgressBar, Label, noLabel, msg, percentage, exact )

--------------------------------------------------------------------------------
-- Test suite
--------------------------------------------------------------------------------

main ∷ IO ()
main = do opts ← interpretArgsOrExit =<< getArgs
          defaultMainWithOpts tests opts

tests ∷ [Test]
tests =
  [ testGroup "Label padding"
    [ eqTest "no labels"  "[]"          noLabel     noLabel      0 0 0
    , eqTest "pre"        "pre []"      (msg "pre") noLabel      0 0 0
    , eqTest "post"       "[] post"     noLabel     (msg "post") 0 0 0
    , eqTest "pre & post" "pre [] post" (msg "pre") (msg "post") 0 0 0
    ]
  , testGroup "Bar fill"
    [ eqTest "empty"       "[....]" noLabel noLabel 6  0   1
    , eqTest "almost half" "[=>..]" noLabel noLabel 6 49 100
    , eqTest "half"        "[==>.]" noLabel noLabel 6  1   2
    , eqTest "almost full" "[===>]" noLabel noLabel 6 99 100
    , eqTest "full"        "[====]" noLabel noLabel 6  1   1
    , eqTest "overfull"    "[====]" noLabel noLabel 6  2   1
    ]
  , testGroup "Labels"
    [ testGroup "Percentage"
      [ eqTest "  0%" "  0% [....]" percentage noLabel 11 0 1
      , eqTest "100%" "100% [====]" percentage noLabel 11 1 1
      , eqTest " 50%" " 50% [==>.]" percentage noLabel 11 1 2
      , eqTest "200%" "200% [====]" percentage noLabel 11 2 1
      ]
    , testGroup "Exact"
      [ eqTest "0/0" "0/0 [....]" exact noLabel 10 0 0
      , eqTest "1/1" "1/1 [====]" exact noLabel 10 1 1
      , eqTest "1/2" "1/2 [==>.]" exact noLabel 10 1 2
      , eqTest "2/1" "2/1 [====]" exact noLabel 10 2 1
      ]
    ]
  ]

eqTest ∷ String → String → Label → Label → ℤ → ℤ → ℤ → Test
eqTest name expected mkPreLabel mkPostLabel width todo done =
    testCase name $ assertEqual errMsg expected actual
  where
    actual = mkProgressBar mkPreLabel mkPostLabel width todo done
    errMsg = "Expected result doesn't match actual result"

</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE NoImplicitPrelude, PackageImports, UnicodeSyntax #-}

module Main where


--------------------------------------------------------------------------------
-- Imports
--------------------------------------------------------------------------------

import  Control.Monad      ( (=<<) )
import  Data.Function      ( ($) )
import  Prelude            ( String )
import  System.Environment ( getArgs )
import  System.IO          ( IO )
import  Prelude.Unicode ( ℤ )
import  Test.HUnit.Base ( assertEqual )
import  Test.Framework
    ( defaultMainWithOpts, interpretArgsOrExit, Test, testGroup )
import  Test.Framework.Providers.HUnit ( testCase )
import  System.ProgressBar
    ( mkProgressBar, Label, noLabel, msg, percentage, exact )

--------------------------------------------------------------------------------
-- Test suite
--------------------------------------------------------------------------------

main :: IO ()
main = do opts <- interpretArgsOrExit =<< getArgs
          defaultMainWithOpts tests opts

tests :: [Test]
tests =
  [ testGroup "Label padding"
    [ eqTest "no labels"  "[]"          noLabel     noLabel      0 0 0
    , eqTest "pre"        "pre []"      (msg "pre") noLabel      0 0 0
    , eqTest "post"       "[] post"     noLabel     (msg "post") 0 0 0
    , eqTest "pre & post" "pre [] post" (msg "pre") (msg "post") 0 0 0
    ]
  , testGroup "Bar fill"
    [ eqTest "empty"       "[....]" noLabel noLabel 6  0   1
    , eqTest "almost half" "[=>..]" noLabel noLabel 6 49 100
    , eqTest "half"        "[==>.]" noLabel noLabel 6  1   2
    , eqTest "almost full" "[===>]" noLabel noLabel 6 99 100
    , eqTest "full"        "[====]" noLabel noLabel 6  1   1
    , eqTest "overfull"    "[====]" noLabel noLabel 6  2   1
    ]
  , testGroup "Labels"
    [ testGroup "Percentage"
      [ eqTest "  0%" "  0% [....]" percentage noLabel 11 0 1
      , eqTest "100%" "100% [====]" percentage noLabel 11 1 1
      , eqTest " 50%" " 50% [==>.]" percentage noLabel 11 1 2
      , eqTest "200%" "200% [====]" percentage noLabel 11 2 1
      ]
    , testGroup "Exact"
      [ eqTest "0/0" "0/0 [....]" exact noLabel 10 0 0
      , eqTest "1/1" "1/1 [====]" exact noLabel 10 1 1
      , eqTest "1/2" "1/2 [==>.]" exact noLabel 10 1 2
      , eqTest "2/1" "2/1 [====]" exact noLabel 10 2 1
      ]
    ]
  ]

eqTest :: String -> String -> Label -> Label -> ℤ -> ℤ -> ℤ -> Test
eqTest name expected mkPreLabel mkPostLabel width todo done =
    testCase name $ assertEqual errMsg expected actual
  where
    actual = mkProgressBar mkPreLabel mkPostLabel width todo done
    errMsg = "Expected result doesn't match actual result"


</pre>