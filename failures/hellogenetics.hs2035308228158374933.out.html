<a href="HDifunctor.hs571540977194847408.out.html">prev</a></br><a href="failures.html">home</a></br><a href="hledger-chart.hs1075260298824938981.out.html">next</a></br></br><pre>1d0
< #!/usr/bin/env runhaskell
2a2
> 
49a50
> 
</pre></br><h2>original</h2></br><pre>#!/usr/bin/env runhaskell

{-# LANGUAGE TypeSynonymInstances #-}
{-# LANGUAGE FlexibleInstances #-}

import Data.Random (RVar, runRVar)
import Data.Random.List (randomElement)
import Data.Random.Source.DevRandom

import Genetics
import Control.Monad (replicateM)
import Data.Char (ord, chr)

target :: String
target = "Hello World!"

generations :: Int
generations = 2 ^ 16

indexSpace :: [Int]
indexSpace = [0 .. length target - 1]

randomIndex :: IO Int
randomIndex = runRVar (randomElement indexSpace) DevRandom

charSpace :: String
charSpace = [' ' .. '~']

randomChar :: IO Char
randomChar = runRVar (randomElement charSpace) DevRandom

randomGene :: IO String
randomGene = replicateM (length target) randomChar

instance Gene String where
  fitness gene = sum (zipWith (\t g -> if t == g then 1 else 0) target gene) / fromIntegral (length target)

  mutate gene = do
    i <- randomIndex
    c <- randomChar
    return $ take i gene ++ [c] ++ drop (i + 1) gene

  species _ = 8

main :: IO ()
main = do
  pool <- replicateM (species [""]) randomGene
  pool' <- evolve generations pool
  putStrLn $ best pool'
</pre></br><h2>printed</h2></br><pre>

{-# LANGUAGE TypeSynonymInstances #-}
{-# LANGUAGE FlexibleInstances #-}

import Data.Random (RVar, runRVar)
import Data.Random.List (randomElement)
import Data.Random.Source.DevRandom

import Genetics
import Control.Monad (replicateM)
import Data.Char (ord, chr)

target :: String
target = "Hello World!"

generations :: Int
generations = 2 ^ 16

indexSpace :: [Int]
indexSpace = [0 .. length target - 1]

randomIndex :: IO Int
randomIndex = runRVar (randomElement indexSpace) DevRandom

charSpace :: String
charSpace = [' ' .. '~']

randomChar :: IO Char
randomChar = runRVar (randomElement charSpace) DevRandom

randomGene :: IO String
randomGene = replicateM (length target) randomChar

instance Gene String where
  fitness gene = sum (zipWith (\t g -> if t == g then 1 else 0) target gene) / fromIntegral (length target)

  mutate gene = do
    i <- randomIndex
    c <- randomChar
    return $ take i gene ++ [c] ++ drop (i + 1) gene

  species _ = 8

main :: IO ()
main = do
  pool <- replicateM (species [""]) randomGene
  pool' <- evolve generations pool
  putStrLn $ best pool'

</pre>