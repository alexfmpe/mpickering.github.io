<a href="Utils.hs10422278781847320614.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Utils.hs126623352623929712.out.html">next</a></br></br><pre>3d2
< 
4d2
< 
5d2
< {-# LINE 1 "HGamer3D\\Bindings\\CAudio\\Utils.chs" #-}{-# LANGUAGE ForeignFunctionInterface #-}
24d20
< -- limitations under the License.
25d20
< 
26c21
< module HGamer3D.Bindings.CAudio.Utils where
---
> -- limitations under the License.module HGamer3D.Bindings.CAudio.Utils where
38d32
< {-# LINE 33 "HGamer3D\\Bindings\\CAudio\\Utils.chs" #-}
40d33
< {-# LINE 34 "HGamer3D\\Bindings\\CAudio\\Utils.chs" #-}
94d86
< {-# LINE 85 "HGamer3D\\Bindings\\CAudio\\Utils.chs" #-}
95d86
< ;
96d86
< 
101d90
<   return ()
102d90
< {-# LINE 89 "HGamer3D\\Bindings\\CAudio\\Utils.chs" #-}
103d90
< ;
104d90
< 
105c91
< fUCreateAudioCapture :: Bool -> IO (HG3DClass)
---
>   return () :: Bool -> IO (HG3DClass)
111d96
<   return (a2'')
112d96
< {-# LINE 95 "HGamer3D\\Bindings\\CAudio\\Utils.chs" #-}
113d96
< ;
114d96
< 
115c97
< fUDestroyAudioCapture :: HG3DClass -> IO ()
---
>   return (a2'') :: HG3DClass -> IO ()
119d100
<   return ()
120d100
< {-# LINE 99 "HGamer3D\\Bindings\\CAudio\\Utils.chs" #-}
121d100
< ;
122d100
< 
123c101
< fUGetLogger :: IO (HG3DClass)
---
>   return () :: IO (HG3DClass)
129d106
< {-# LINE 105 "HGamer3D\\Bindings\\CAudio\\Utils.chs" #-}
130d106
< ;
131d106
< 
139d113
< {-# LINE 111 "HGamer3D\\Bindings\\CAudio\\Utils.chs" #-}
140d113
< ;
141d113
< 
142d113
< 
143c114
< foreign import ccall safe "HGamer3D\\Bindings\\CAudio\\Utils.chs.h fU_createAudioManager_c"
---
> foreign import ccall safe "HGamer3D\Bindings\CAudio\Utils.chs.h fU_createAudioManager_c"
146c117
< foreign import ccall safe "HGamer3D\\Bindings\\CAudio\\Utils.chs.h fU_destroyAudioManager_c"
---
> foreign import ccall safe "HGamer3D\Bindings\CAudio\Utils.chs.h fU_destroyAudioManager_c"
149c120
< foreign import ccall safe "HGamer3D\\Bindings\\CAudio\\Utils.chs.h fU_createAudioCapture_c"
---
> foreign import ccall safe "HGamer3D\Bindings\CAudio\Utils.chs.h fU_createAudioCapture_c"
152c123
< foreign import ccall safe "HGamer3D\\Bindings\\CAudio\\Utils.chs.h fU_destroyAudioCapture_c"
---
> foreign import ccall safe "HGamer3D\Bindings\CAudio\Utils.chs.h fU_destroyAudioCapture_c"
155c126
< foreign import ccall safe "HGamer3D\\Bindings\\CAudio\\Utils.chs.h fU_getLogger_c"
---
> foreign import ccall safe "HGamer3D\Bindings\CAudio\Utils.chs.h fU_getLogger_c"
158c129
< foreign import ccall safe "HGamer3D\\Bindings\\CAudio\\Utils.chs.h fU_createAudioDeviceList_c"
---
> foreign import ccall safe "HGamer3D\Bindings\CAudio\Utils.chs.h fU_createAudioDeviceList_c"
159a131
> 
</pre></br><h2>original</h2></br><pre>-- GENERATED by C->Haskell Compiler, version 0.16.3 Crystal Seed, 24 Jan 2009 (Haskell)
-- Edit the ORIGNAL .chs file instead!


{-# LINE 1 "HGamer3D\\Bindings\\CAudio\\Utils.chs" #-}{-# LANGUAGE ForeignFunctionInterface #-}
{-# LANGUAGE TypeSynonymInstances #-}

-- This source file is part of HGamer3D
-- (A project to enable 3D game development in Haskell)
-- For the latest info, see http://www.althainz.de/HGamer3D.html
--
-- (c) 2012 Peter Althainz
--
-- Licensed under the Apache License, Version 2.0 (the "Lic.ense");
-- you may not use this file except in compliance with the License.
-- You may obtain a copy of the License at
--
--     http://www.apache.org/licenses/LICENSE-2.0
--
-- Unless required by applicable law or agreed to in writing, software
-- distributed under the License is distributed on an "AS IS" BASIS,
-- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-- See the License for the specific language governing permissions and
-- limitations under the License.

module HGamer3D.Bindings.CAudio.Utils where

import C2HS
import Foreign
import Foreign.Ptr
import Foreign.C
import Monad         (liftM, liftM2)

import HGamer3D.Data.HG3DClass
import HGamer3D.Bindings.CAudio.EnumDeviceType

import HGamer3D.Bindings.CAudio.ClassPtr
{-# LINE 33 "HGamer3D\\Bindings\\CAudio\\Utils.chs" #-}
import HGamer3D.Bindings.CAudio.TypeHG3DClass
{-# LINE 34 "HGamer3D\\Bindings\\CAudio\\Utils.chs" #-}



-- now here come different pieces of utilities
--

-- String Conversion functions
--

withCUString b f = withCWString b (f . castPtr)
peekCUString = peekCWString . castPtr
alloc64k = allocaBytes (1024 * 64)


-- c2hs replacements of utility functions, to get rid of annoying c2hs
-- deprecated messages

-- Passing Enums

cIntFromEnum :: Enum a => a -> CInt
cIntFromEnum = cIntConv . fromEnum

cIntToEnum :: Enum a => CInt -> a
cIntToEnum = toEnum . cIntConv


-- Passing Booleans by reference
--

withBoolUtil :: (Integral a, Storable a) => Bool -> (Ptr a -> IO b) -> IO b
withBoolUtil  = with . fromBool

peekBoolUtil :: (Integral a, Storable a) => Ptr a -> IO Bool
peekBoolUtil  = liftM toBool . peek


-- Passing enums by reference
--

withEnumUtil :: (Enum a, Integral b, Storable b) => a -> (Ptr b -> IO c) -> IO c
withEnumUtil  = with . cFromEnum

peekEnumUtil :: (Enum a, Integral b, Storable b) => Ptr b -> IO a
peekEnumUtil  = liftM cToEnum . peek


fUCreateAudioManager :: Bool -> IO (HG3DClass)
fUCreateAudioManager a1 =
  let {a1' = fromBool a1} in
  alloca $ \a2' ->
  fUCreateAudioManager'_ a1' a2' >>= \res ->
  peek  a2'>>= \a2'' ->
  return (a2'')
{-# LINE 85 "HGamer3D\\Bindings\\CAudio\\Utils.chs" #-}
;

fUDestroyAudioManager :: HG3DClass -> IO ()
fUDestroyAudioManager a1 =
  withHG3DClass a1 $ \a1' ->
  fUDestroyAudioManager'_ a1' >>= \res ->
  return ()
{-# LINE 89 "HGamer3D\\Bindings\\CAudio\\Utils.chs" #-}
;

fUCreateAudioCapture :: Bool -> IO (HG3DClass)
fUCreateAudioCapture a1 =
  let {a1' = fromBool a1} in
  alloca $ \a2' ->
  fUCreateAudioCapture'_ a1' a2' >>= \res ->
  peek  a2'>>= \a2'' ->
  return (a2'')
{-# LINE 95 "HGamer3D\\Bindings\\CAudio\\Utils.chs" #-}
;

fUDestroyAudioCapture :: HG3DClass -> IO ()
fUDestroyAudioCapture a1 =
  withHG3DClass a1 $ \a1' ->
  fUDestroyAudioCapture'_ a1' >>= \res ->
  return ()
{-# LINE 99 "HGamer3D\\Bindings\\CAudio\\Utils.chs" #-}
;

fUGetLogger :: IO (HG3DClass)
fUGetLogger =
  alloca $ \a1' ->
  fUGetLogger'_ a1' >>= \res ->
  peek  a1'>>= \a1'' ->
  return (a1'')
{-# LINE 105 "HGamer3D\\Bindings\\CAudio\\Utils.chs" #-}
;

fUCreateAudioDeviceList :: EnumDeviceType -> IO (HG3DClass)
fUCreateAudioDeviceList a1 =
  let {a1' = cIntFromEnum a1} in
  alloca $ \a2' ->
  fUCreateAudioDeviceList'_ a1' a2' >>= \res ->
  peek  a2'>>= \a2'' ->
  return (a2'')
{-# LINE 111 "HGamer3D\\Bindings\\CAudio\\Utils.chs" #-}
;


foreign import ccall safe "HGamer3D\\Bindings\\CAudio\\Utils.chs.h fU_createAudioManager_c"
  fUCreateAudioManager'_ :: (CInt -> ((HG3DClassPtr) -> (IO ())))

foreign import ccall safe "HGamer3D\\Bindings\\CAudio\\Utils.chs.h fU_destroyAudioManager_c"
  fUDestroyAudioManager'_ :: ((HG3DClassPtr) -> (IO ()))

foreign import ccall safe "HGamer3D\\Bindings\\CAudio\\Utils.chs.h fU_createAudioCapture_c"
  fUCreateAudioCapture'_ :: (CInt -> ((HG3DClassPtr) -> (IO ())))

foreign import ccall safe "HGamer3D\\Bindings\\CAudio\\Utils.chs.h fU_destroyAudioCapture_c"
  fUDestroyAudioCapture'_ :: ((HG3DClassPtr) -> (IO ()))

foreign import ccall safe "HGamer3D\\Bindings\\CAudio\\Utils.chs.h fU_getLogger_c"
  fUGetLogger'_ :: ((HG3DClassPtr) -> (IO ()))

foreign import ccall safe "HGamer3D\\Bindings\\CAudio\\Utils.chs.h fU_createAudioDeviceList_c"
  fUCreateAudioDeviceList'_ :: (CInt -> ((HG3DClassPtr) -> (IO ())))
</pre></br><h2>printed</h2></br><pre>-- GENERATED by C->Haskell Compiler, version 0.16.3 Crystal Seed, 24 Jan 2009 (Haskell)
-- Edit the ORIGNAL .chs file instead!
{-# LANGUAGE TypeSynonymInstances #-}

-- This source file is part of HGamer3D
-- (A project to enable 3D game development in Haskell)
-- For the latest info, see http://www.althainz.de/HGamer3D.html
--
-- (c) 2012 Peter Althainz
--
-- Licensed under the Apache License, Version 2.0 (the "Lic.ense");
-- you may not use this file except in compliance with the License.
-- You may obtain a copy of the License at
--
--     http://www.apache.org/licenses/LICENSE-2.0
--
-- Unless required by applicable law or agreed to in writing, software
-- distributed under the License is distributed on an "AS IS" BASIS,
-- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-- See the License for the specific language governing permissions and
-- limitations under the License.module HGamer3D.Bindings.CAudio.Utils where

import C2HS
import Foreign
import Foreign.Ptr
import Foreign.C
import Monad         (liftM, liftM2)

import HGamer3D.Data.HG3DClass
import HGamer3D.Bindings.CAudio.EnumDeviceType

import HGamer3D.Bindings.CAudio.ClassPtr
import HGamer3D.Bindings.CAudio.TypeHG3DClass



-- now here come different pieces of utilities
--

-- String Conversion functions
--

withCUString b f = withCWString b (f . castPtr)
peekCUString = peekCWString . castPtr
alloc64k = allocaBytes (1024 * 64)


-- c2hs replacements of utility functions, to get rid of annoying c2hs
-- deprecated messages

-- Passing Enums

cIntFromEnum :: Enum a => a -> CInt
cIntFromEnum = cIntConv . fromEnum

cIntToEnum :: Enum a => CInt -> a
cIntToEnum = toEnum . cIntConv


-- Passing Booleans by reference
--

withBoolUtil :: (Integral a, Storable a) => Bool -> (Ptr a -> IO b) -> IO b
withBoolUtil  = with . fromBool

peekBoolUtil :: (Integral a, Storable a) => Ptr a -> IO Bool
peekBoolUtil  = liftM toBool . peek


-- Passing enums by reference
--

withEnumUtil :: (Enum a, Integral b, Storable b) => a -> (Ptr b -> IO c) -> IO c
withEnumUtil  = with . cFromEnum

peekEnumUtil :: (Enum a, Integral b, Storable b) => Ptr b -> IO a
peekEnumUtil  = liftM cToEnum . peek


fUCreateAudioManager :: Bool -> IO (HG3DClass)
fUCreateAudioManager a1 =
  let {a1' = fromBool a1} in
  alloca $ \a2' ->
  fUCreateAudioManager'_ a1' a2' >>= \res ->
  peek  a2'>>= \a2'' ->
  return (a2'')
fUDestroyAudioManager :: HG3DClass -> IO ()
fUDestroyAudioManager a1 =
  withHG3DClass a1 $ \a1' ->
  fUDestroyAudioManager'_ a1' >>= \res ->
  return () :: Bool -> IO (HG3DClass)
fUCreateAudioCapture a1 =
  let {a1' = fromBool a1} in
  alloca $ \a2' ->
  fUCreateAudioCapture'_ a1' a2' >>= \res ->
  peek  a2'>>= \a2'' ->
  return (a2'') :: HG3DClass -> IO ()
fUDestroyAudioCapture a1 =
  withHG3DClass a1 $ \a1' ->
  fUDestroyAudioCapture'_ a1' >>= \res ->
  return () :: IO (HG3DClass)
fUGetLogger =
  alloca $ \a1' ->
  fUGetLogger'_ a1' >>= \res ->
  peek  a1'>>= \a1'' ->
  return (a1'')
fUCreateAudioDeviceList :: EnumDeviceType -> IO (HG3DClass)
fUCreateAudioDeviceList a1 =
  let {a1' = cIntFromEnum a1} in
  alloca $ \a2' ->
  fUCreateAudioDeviceList'_ a1' a2' >>= \res ->
  peek  a2'>>= \a2'' ->
  return (a2'')
foreign import ccall safe "HGamer3D\Bindings\CAudio\Utils.chs.h fU_createAudioManager_c"
  fUCreateAudioManager'_ :: (CInt -> ((HG3DClassPtr) -> (IO ())))

foreign import ccall safe "HGamer3D\Bindings\CAudio\Utils.chs.h fU_destroyAudioManager_c"
  fUDestroyAudioManager'_ :: ((HG3DClassPtr) -> (IO ()))

foreign import ccall safe "HGamer3D\Bindings\CAudio\Utils.chs.h fU_createAudioCapture_c"
  fUCreateAudioCapture'_ :: (CInt -> ((HG3DClassPtr) -> (IO ())))

foreign import ccall safe "HGamer3D\Bindings\CAudio\Utils.chs.h fU_destroyAudioCapture_c"
  fUDestroyAudioCapture'_ :: ((HG3DClassPtr) -> (IO ()))

foreign import ccall safe "HGamer3D\Bindings\CAudio\Utils.chs.h fU_getLogger_c"
  fUGetLogger'_ :: ((HG3DClassPtr) -> (IO ()))

foreign import ccall safe "HGamer3D\Bindings\CAudio\Utils.chs.h fU_createAudioDeviceList_c"
  fUCreateAudioDeviceList'_ :: (CInt -> ((HG3DClassPtr) -> (IO ())))

</pre>