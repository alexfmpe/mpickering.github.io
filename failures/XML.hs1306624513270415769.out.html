<a href="WxFormImplementation.hs2020739063107554536.out.html">prev</a></br><a href="failures.html">home</a></br><a href="XMPPClient.hs10397696271333685350.out.html">next</a></br></br><pre>1d0
< {-# LINE 1 "XML.hs.neat" #-}
9d7
<  output (File path block) = ({-# LINE 8 "XML.hs.neat" #-}
10d7
<   "<?xml version=\"1.0\"?>\n<File path=" ++ ({-# LINE 9 "XML.hs.neat" #-}
11d7
<   output (quote $ path)) ++ {-# LINE 9 "XML.hs.neat" #-}
12d7
<   ">" ++ ({-# LINE 10 "XML.hs.neat" #-}
13d7
<   output (block)) ++ {-# LINE 10 "XML.hs.neat" #-}
14c8
<   "\n</File>"){-# LINE 12 "XML.hs.neat" #-}
---
>  output (File path block) = ( ++ (
14a9
>   output (quote $ path)) ++ ++ (
14a10
>   output (block)) ++)
16a13
> 
18d14
<  output (Block chunks) = ({-# LINE 15 "XML.hs.neat" #-}
19c15
<   "\n  <Block>" ++ ({-# LINE 17 "XML.hs.neat" #-}
---
>  output (Block chunks) = ( ++ (
19a16
> 
22d18
<       then _l >>= \{-# LINE 17 "XML.hs.neat" #-}
23d18
<   chunk -> ({-# LINE 17 "XML.hs.neat" #-}
24d18
<     "" ++ ({-# LINE 18 "XML.hs.neat" #-}
25d18
<     output (chunk)) ++ {-# LINE 18 "XML.hs.neat" #-}
26d18
<     "")
27d18
<       else []) ++ {-# LINE 19 "XML.hs.neat" #-}
28c19
<   "\n  </Block>"){-# LINE 21 "XML.hs.neat" #-}
---
>       then  _l >>= \ -> ( ++ (
28a20
>     output (chunk)))
28a21
>       else) ++)
30a24
> 
32d25
<  output (Chunk location element) = ({-# LINE 24 "XML.hs.neat" #-}
33d25
<   "\n  <Chunk " ++ ({-# LINE 25 "XML.hs.neat" #-}
34d25
<   output (location)) ++ {-# LINE 25 "XML.hs.neat" #-}
35d25
<   ">" ++ ({-# LINE 26 "XML.hs.neat" #-}
36d25
<   output (element)) ++ {-# LINE 26 "XML.hs.neat" #-}
37c26
<   "\n  </Chunk>"){-# LINE 28 "XML.hs.neat" #-}
---
>  output (Chunk location element) = ( ++ (
37a27
>   output (location)) ++ ++ (
37a28
>   output (element)) ++)
39a31
> 
41d32
<  output (Case pattern block) = ({-# LINE 31 "XML.hs.neat" #-}
42d32
<   "\n  <Case>" ++ ({-# LINE 33 "XML.hs.neat" #-}
43d32
<   output (pattern)) ++ {-# LINE 33 "XML.hs.neat" #-}
44d32
<   "" ++ ({-# LINE 34 "XML.hs.neat" #-}
45d32
<   output (block)) ++ {-# LINE 34 "XML.hs.neat" #-}
46c33
<   "\n  </Case>"){-# LINE 36 "XML.hs.neat" #-}
---
>  output (Case pattern block) = ( ++ (
47a35
>   output (pattern)) ++ ++ (
47a36
>   output (block)) ++)
49d37
< instance Output Location where
50d37
<  output (Location file line) = ({-# LINE 39 "XML.hs.neat" #-}
51d37
<   "file=" ++ ({-# LINE 39 "XML.hs.neat" #-}
52d37
<   output (quote $ file)) ++ {-# LINE 39 "XML.hs.neat" #-}
53d37
<   " line=\"" ++ ({-# LINE 39 "XML.hs.neat" #-}
54d37
<   output (line)) ++ {-# LINE 39 "XML.hs.neat" #-}
55d37
<   "\""){-# LINE 39 "XML.hs.neat" #-}
57a40
> instance Output Location where
57a41
>  output (Location file line) = ( ++ ( (quote $ file)) ++ ++ ( (line)) ++)
57a42
> 
59d43
<  output (Value location pipeline) = ({-# LINE 42 "XML.hs.neat" #-}
60d43
<   "\n  <Value " ++ ({-# LINE 43 "XML.hs.neat" #-}
61d43
<   output (location)) ++ {-# LINE 43 "XML.hs.neat" #-}
62c44
<   ">\n    <Pipeline>" ++ ({-# LINE 45 "XML.hs.neat" #-}
---
>  output (Value location pipeline) = ( ++ (
62a45
>   output (location)) ++ ++ (
62a46
> 
65d48
<       then _l >>= \{-# LINE 45 "XML.hs.neat" #-}
66d48
<   pipe -> ({-# LINE 45 "XML.hs.neat" #-}
67d48
<     "\n        <Pipe><![CDATA[" ++ ({-# LINE 46 "XML.hs.neat" #-}
68d48
<     output (pipe)) ++ {-# LINE 46 "XML.hs.neat" #-}
69d48
<     "]]></Pipe>")
70d48
<       else []) ++ {-# LINE 47 "XML.hs.neat" #-}
71c49
<   "\n    </Pipeline>\n  </Value>"){-# LINE 50 "XML.hs.neat" #-}
---
>       then _l >>= \ -> ( ++ (
71a50
>     output (pipe)) ++)
71a51
>       else) ++)
73a54
> 
73a55
> 
75d56
<  output (Pattern location pattern) = ({-# LINE 53 "XML.hs.neat" #-}
76d56
<   "\n  <Pattern " ++ ({-# LINE 54 "XML.hs.neat" #-}
77d56
<   output (location)) ++ {-# LINE 54 "XML.hs.neat" #-}
78d56
<   "><![CDATA[" ++ ({-# LINE 54 "XML.hs.neat" #-}
79d56
<   output (pattern)) ++ {-# LINE 54 "XML.hs.neat" #-}
80c57
<   "]]></Pattern>"){-# LINE 55 "XML.hs.neat" #-}
---
>  output (Pattern location pattern) = ( ++ (
80a58
>   output (location)) ++ ++ ( (pattern)) ++)
84d61
<  output (Output value) = ({-# LINE 58 "XML.hs.neat" #-}
85d61
<   "\n  <Output>" ++ ({-# LINE 59 "XML.hs.neat" #-}
86d61
<   output (value)) ++ {-# LINE 59 "XML.hs.neat" #-}
87c62
<   "</Output>"){-# LINE 60 "XML.hs.neat" #-}
---
>  output (Output value) = ( ++ (
87a63
>   output (value)) ++)
90d65
<  output (Comment comment) = ({-# LINE 62 "XML.hs.neat" #-}
91d65
<   "\n  <Comment><![CDATA[" ++ ({-# LINE 63 "XML.hs.neat" #-}
92d65
<   output (comment)) ++ {-# LINE 63 "XML.hs.neat" #-}
93c66
<   "]]></Output>"){-# LINE 64 "XML.hs.neat" #-}
---
>  output (Comment comment) = ( ++ (
93a67
>   output (comment)) ++)
96d69
<  output (Define (Function location name pattern) block) = ({-# LINE 66 "XML.hs.neat" #-}
97d69
<   "\n  <Define name=" ++ ({-# LINE 67 "XML.hs.neat" #-}
98d69
<   output (quote $ name)) ++ {-# LINE 67 "XML.hs.neat" #-}
99d69
<   " " ++ ({-# LINE 67 "XML.hs.neat" #-}
100d69
<   output (location)) ++ {-# LINE 67 "XML.hs.neat" #-}
101d69
<   ">" ++ ({-# LINE 68 "XML.hs.neat" #-}
102d69
<   output (pattern)) ++ {-# LINE 68 "XML.hs.neat" #-}
103d69
<   "" ++ ({-# LINE 69 "XML.hs.neat" #-}
104d69
<   output (block)) ++ {-# LINE 69 "XML.hs.neat" #-}
105c70
<   "\n  </Define>"){-# LINE 71 "XML.hs.neat" #-}
---
>  output (Define (Function location name pattern) block) = ( ++ (
105a71
>   output (quote $ name)) ++ ++ ( (location)) ++ (
105a72
>   output (pattern)) ++ ++ (
105a73
>   output (block)) ++)
108d75
<  output (Filter value block) = ({-# LINE 73 "XML.hs.neat" #-}
109d75
<   "\n  <Filter>" ++ ({-# LINE 75 "XML.hs.neat" #-}
110d75
<   output (value)) ++ {-# LINE 75 "XML.hs.neat" #-}
111d75
<   "" ++ ({-# LINE 76 "XML.hs.neat" #-}
112d75
<   output (block)) ++ {-# LINE 76 "XML.hs.neat" #-}
113d75
<   "\n  </Filter>"){-# LINE 78 "XML.hs.neat" #-}
114a77
>  output (Filter value block) = ( ++ (
116d78
<  output (For binding block else') = ({-# LINE 80 "XML.hs.neat" #-}
117d78
<   "\n  <For>" ++ ({-# LINE 82 "XML.hs.neat" #-}
118d78
<   output (binding)) ++ {-# LINE 82 "XML.hs.neat" #-}
119d78
<   "" ++ ({-# LINE 83 "XML.hs.neat" #-}
120d78
<   output (block)) ++ {-# LINE 83 "XML.hs.neat" #-}
121c79
<   "" ++ ({-# LINE 84 "XML.hs.neat" #-}
---
>   output (value)) ++ ++ (
121a80
>   output (block)) ++)
121a81
> 
121a82
> 
121a83
> 
121a84
>  output (For binding block else') = ( ++ (
121a85
> 
121a86
>   output (binding)) ++ ++ (
121a87
>   output (block)) ++ ++ (
123d88
<     then ({-# LINE 84 "XML.hs.neat" #-}
124d88
<     "<Else>" ++ ({-# LINE 84 "XML.hs.neat" #-}
125d88
<     output (else')) ++ {-# LINE 84 "XML.hs.neat" #-}
126d88
<     "</Else>")
127d88
<     else []) ++ {-# LINE 84 "XML.hs.neat" #-}
128c89
<   "\n  </For>"){-# LINE 86 "XML.hs.neat" #-}
---
>     then      ( ++ ( (else')) ++)
128a90
>     else []) ++)
131d92
<  output (If value block else') = ({-# LINE 88 "XML.hs.neat" #-}
132d92
<   "\n  <If>" ++ ({-# LINE 90 "XML.hs.neat" #-}
133d92
<   output (value)) ++ {-# LINE 90 "XML.hs.neat" #-}
134d92
<   "" ++ ({-# LINE 91 "XML.hs.neat" #-}
135d92
<   output (block)) ++ {-# LINE 91 "XML.hs.neat" #-}
136c93
<   "" ++ ({-# LINE 92 "XML.hs.neat" #-}
---
> 
136a94
>  output (If value block else') = ( ++ (
136a95
> 
136a96
>   output (value)) ++ ++ (
136a97
>   output (block)) ++ ++ (
138d98
<     then ({-# LINE 92 "XML.hs.neat" #-}
139d98
<     "<Else>" ++ ({-# LINE 92 "XML.hs.neat" #-}
140d98
<     output (else')) ++ {-# LINE 92 "XML.hs.neat" #-}
141d98
<     "</Else>")
142d98
<     else []) ++ {-# LINE 92 "XML.hs.neat" #-}
143c99
<   "\n  </If>"){-# LINE 94 "XML.hs.neat" #-}
---
>     then      ( ++ ( (else')) ++)
143a100
>     else []) ++)
146d102
<  output (Switch value cases default') = ({-# LINE 96 "XML.hs.neat" #-}
147d102
<   "\n  <Switch>" ++ ({-# LINE 98 "XML.hs.neat" #-}
148d102
<   output (value)) ++ {-# LINE 98 "XML.hs.neat" #-}
149c103
<   "" ++ ({-# LINE 99 "XML.hs.neat" #-}
---
> 
149a104
>  output (Switch value cases default') = ( ++ (
149a105
> 
149a106
>   output (value)) ++ ++ (
152d108
<       then _l >>= \{-# LINE 99 "XML.hs.neat" #-}
153d108
<   case' -> ({-# LINE 99 "XML.hs.neat" #-}
154d108
<     "" ++ ({-# LINE 100 "XML.hs.neat" #-}
155d108
<     output (case')) ++ {-# LINE 100 "XML.hs.neat" #-}
156d108
<     "")
157d108
<       else []) ++ {-# LINE 101 "XML.hs.neat" #-}
158c109
<   "" ++ ({-# LINE 102 "XML.hs.neat" #-}
---
>       then  _l >>= \ -> ( ++ (
158a110
>     output (case')))
158a111
>       else) ++ ++ (
160d112
<     then ({-# LINE 102 "XML.hs.neat" #-}
161d112
<     "<Default>" ++ ({-# LINE 102 "XML.hs.neat" #-}
162d112
<     output (default')) ++ {-# LINE 102 "XML.hs.neat" #-}
163d112
<     "</Default>")
164d112
<     else []) ++ {-# LINE 102 "XML.hs.neat" #-}
165c113
<   "\n  </Switch>"){-# LINE 104 "XML.hs.neat" #-}
---
>     then         ( ++ ( (default')) ++)
165a114
>     else []) ++)
168d116
<  output (With binding block) = ({-# LINE 106 "XML.hs.neat" #-}
169d116
<   "\n  <With>" ++ ({-# LINE 108 "XML.hs.neat" #-}
170d116
<   output (binding)) ++ {-# LINE 108 "XML.hs.neat" #-}
171d116
<   "" ++ ({-# LINE 109 "XML.hs.neat" #-}
172d116
<   output (block)) ++ {-# LINE 109 "XML.hs.neat" #-}
173d116
<   "\n  </With>"){-# LINE 111 "XML.hs.neat" #-}
174a118
>  output (With binding block) = ( ++ (
176d119
<  output (Text text) = ({-# LINE 113 "XML.hs.neat" #-}
177d119
<   "<Text><![CDATA[" ++ ({-# LINE 113 "XML.hs.neat" #-}
178d119
<   output (text)) ++ {-# LINE 113 "XML.hs.neat" #-}
179c120
<   "]]></Text>"){-# LINE 113 "XML.hs.neat" #-}
---
>   output (binding)) ++ ++ (
179a121
>   output (block)) ++)
182a125
>  output (Text text) = ( ++ ( (text)) ++)
182a126
> 
182a127
> 
184a130
> 
</pre></br><h2>original</h2></br><pre>{-# LINE 1 "XML.hs.neat" #-}
module Text.Neat.Output.XML (outputXML) where

import Text.Neat.Template
import Text.Neat.Output


instance Output File where
 output (File path block) = ({-# LINE 8 "XML.hs.neat" #-}
  "<?xml version=\"1.0\"?>\n<File path=" ++ ({-# LINE 9 "XML.hs.neat" #-}
  output (quote $ path)) ++ {-# LINE 9 "XML.hs.neat" #-}
  ">" ++ ({-# LINE 10 "XML.hs.neat" #-}
  output (block)) ++ {-# LINE 10 "XML.hs.neat" #-}
  "\n</File>"){-# LINE 12 "XML.hs.neat" #-}


instance Output Block where
 output (Block chunks) = ({-# LINE 15 "XML.hs.neat" #-}
  "\n  <Block>" ++ ({-# LINE 17 "XML.hs.neat" #-}
  let _l = list (chunks) in
    if (not . null) _l
      then _l >>= \{-# LINE 17 "XML.hs.neat" #-}
  chunk -> ({-# LINE 17 "XML.hs.neat" #-}
    "" ++ ({-# LINE 18 "XML.hs.neat" #-}
    output (chunk)) ++ {-# LINE 18 "XML.hs.neat" #-}
    "")
      else []) ++ {-# LINE 19 "XML.hs.neat" #-}
  "\n  </Block>"){-# LINE 21 "XML.hs.neat" #-}


instance Output Chunk where
 output (Chunk location element) = ({-# LINE 24 "XML.hs.neat" #-}
  "\n  <Chunk " ++ ({-# LINE 25 "XML.hs.neat" #-}
  output (location)) ++ {-# LINE 25 "XML.hs.neat" #-}
  ">" ++ ({-# LINE 26 "XML.hs.neat" #-}
  output (element)) ++ {-# LINE 26 "XML.hs.neat" #-}
  "\n  </Chunk>"){-# LINE 28 "XML.hs.neat" #-}


instance Output Case where
 output (Case pattern block) = ({-# LINE 31 "XML.hs.neat" #-}
  "\n  <Case>" ++ ({-# LINE 33 "XML.hs.neat" #-}
  output (pattern)) ++ {-# LINE 33 "XML.hs.neat" #-}
  "" ++ ({-# LINE 34 "XML.hs.neat" #-}
  output (block)) ++ {-# LINE 34 "XML.hs.neat" #-}
  "\n  </Case>"){-# LINE 36 "XML.hs.neat" #-}


instance Output Location where
 output (Location file line) = ({-# LINE 39 "XML.hs.neat" #-}
  "file=" ++ ({-# LINE 39 "XML.hs.neat" #-}
  output (quote $ file)) ++ {-# LINE 39 "XML.hs.neat" #-}
  " line=\"" ++ ({-# LINE 39 "XML.hs.neat" #-}
  output (line)) ++ {-# LINE 39 "XML.hs.neat" #-}
  "\""){-# LINE 39 "XML.hs.neat" #-}


instance Output Value where
 output (Value location pipeline) = ({-# LINE 42 "XML.hs.neat" #-}
  "\n  <Value " ++ ({-# LINE 43 "XML.hs.neat" #-}
  output (location)) ++ {-# LINE 43 "XML.hs.neat" #-}
  ">\n    <Pipeline>" ++ ({-# LINE 45 "XML.hs.neat" #-}
  let _l = list (pipeline) in
    if (not . null) _l
      then _l >>= \{-# LINE 45 "XML.hs.neat" #-}
  pipe -> ({-# LINE 45 "XML.hs.neat" #-}
    "\n        <Pipe><![CDATA[" ++ ({-# LINE 46 "XML.hs.neat" #-}
    output (pipe)) ++ {-# LINE 46 "XML.hs.neat" #-}
    "]]></Pipe>")
      else []) ++ {-# LINE 47 "XML.hs.neat" #-}
  "\n    </Pipeline>\n  </Value>"){-# LINE 50 "XML.hs.neat" #-}


instance Output Pattern where
 output (Pattern location pattern) = ({-# LINE 53 "XML.hs.neat" #-}
  "\n  <Pattern " ++ ({-# LINE 54 "XML.hs.neat" #-}
  output (location)) ++ {-# LINE 54 "XML.hs.neat" #-}
  "><![CDATA[" ++ ({-# LINE 54 "XML.hs.neat" #-}
  output (pattern)) ++ {-# LINE 54 "XML.hs.neat" #-}
  "]]></Pattern>"){-# LINE 55 "XML.hs.neat" #-}


instance Output Element where
 output (Output value) = ({-# LINE 58 "XML.hs.neat" #-}
  "\n  <Output>" ++ ({-# LINE 59 "XML.hs.neat" #-}
  output (value)) ++ {-# LINE 59 "XML.hs.neat" #-}
  "</Output>"){-# LINE 60 "XML.hs.neat" #-}


 output (Comment comment) = ({-# LINE 62 "XML.hs.neat" #-}
  "\n  <Comment><![CDATA[" ++ ({-# LINE 63 "XML.hs.neat" #-}
  output (comment)) ++ {-# LINE 63 "XML.hs.neat" #-}
  "]]></Output>"){-# LINE 64 "XML.hs.neat" #-}


 output (Define (Function location name pattern) block) = ({-# LINE 66 "XML.hs.neat" #-}
  "\n  <Define name=" ++ ({-# LINE 67 "XML.hs.neat" #-}
  output (quote $ name)) ++ {-# LINE 67 "XML.hs.neat" #-}
  " " ++ ({-# LINE 67 "XML.hs.neat" #-}
  output (location)) ++ {-# LINE 67 "XML.hs.neat" #-}
  ">" ++ ({-# LINE 68 "XML.hs.neat" #-}
  output (pattern)) ++ {-# LINE 68 "XML.hs.neat" #-}
  "" ++ ({-# LINE 69 "XML.hs.neat" #-}
  output (block)) ++ {-# LINE 69 "XML.hs.neat" #-}
  "\n  </Define>"){-# LINE 71 "XML.hs.neat" #-}


 output (Filter value block) = ({-# LINE 73 "XML.hs.neat" #-}
  "\n  <Filter>" ++ ({-# LINE 75 "XML.hs.neat" #-}
  output (value)) ++ {-# LINE 75 "XML.hs.neat" #-}
  "" ++ ({-# LINE 76 "XML.hs.neat" #-}
  output (block)) ++ {-# LINE 76 "XML.hs.neat" #-}
  "\n  </Filter>"){-# LINE 78 "XML.hs.neat" #-}


 output (For binding block else') = ({-# LINE 80 "XML.hs.neat" #-}
  "\n  <For>" ++ ({-# LINE 82 "XML.hs.neat" #-}
  output (binding)) ++ {-# LINE 82 "XML.hs.neat" #-}
  "" ++ ({-# LINE 83 "XML.hs.neat" #-}
  output (block)) ++ {-# LINE 83 "XML.hs.neat" #-}
  "" ++ ({-# LINE 84 "XML.hs.neat" #-}
  if (not . zero) (else')
    then ({-# LINE 84 "XML.hs.neat" #-}
    "<Else>" ++ ({-# LINE 84 "XML.hs.neat" #-}
    output (else')) ++ {-# LINE 84 "XML.hs.neat" #-}
    "</Else>")
    else []) ++ {-# LINE 84 "XML.hs.neat" #-}
  "\n  </For>"){-# LINE 86 "XML.hs.neat" #-}


 output (If value block else') = ({-# LINE 88 "XML.hs.neat" #-}
  "\n  <If>" ++ ({-# LINE 90 "XML.hs.neat" #-}
  output (value)) ++ {-# LINE 90 "XML.hs.neat" #-}
  "" ++ ({-# LINE 91 "XML.hs.neat" #-}
  output (block)) ++ {-# LINE 91 "XML.hs.neat" #-}
  "" ++ ({-# LINE 92 "XML.hs.neat" #-}
  if (not . zero) (else')
    then ({-# LINE 92 "XML.hs.neat" #-}
    "<Else>" ++ ({-# LINE 92 "XML.hs.neat" #-}
    output (else')) ++ {-# LINE 92 "XML.hs.neat" #-}
    "</Else>")
    else []) ++ {-# LINE 92 "XML.hs.neat" #-}
  "\n  </If>"){-# LINE 94 "XML.hs.neat" #-}


 output (Switch value cases default') = ({-# LINE 96 "XML.hs.neat" #-}
  "\n  <Switch>" ++ ({-# LINE 98 "XML.hs.neat" #-}
  output (value)) ++ {-# LINE 98 "XML.hs.neat" #-}
  "" ++ ({-# LINE 99 "XML.hs.neat" #-}
  let _l = list (cases) in
    if (not . null) _l
      then _l >>= \{-# LINE 99 "XML.hs.neat" #-}
  case' -> ({-# LINE 99 "XML.hs.neat" #-}
    "" ++ ({-# LINE 100 "XML.hs.neat" #-}
    output (case')) ++ {-# LINE 100 "XML.hs.neat" #-}
    "")
      else []) ++ {-# LINE 101 "XML.hs.neat" #-}
  "" ++ ({-# LINE 102 "XML.hs.neat" #-}
  if (not . zero) (default')
    then ({-# LINE 102 "XML.hs.neat" #-}
    "<Default>" ++ ({-# LINE 102 "XML.hs.neat" #-}
    output (default')) ++ {-# LINE 102 "XML.hs.neat" #-}
    "</Default>")
    else []) ++ {-# LINE 102 "XML.hs.neat" #-}
  "\n  </Switch>"){-# LINE 104 "XML.hs.neat" #-}


 output (With binding block) = ({-# LINE 106 "XML.hs.neat" #-}
  "\n  <With>" ++ ({-# LINE 108 "XML.hs.neat" #-}
  output (binding)) ++ {-# LINE 108 "XML.hs.neat" #-}
  "" ++ ({-# LINE 109 "XML.hs.neat" #-}
  output (block)) ++ {-# LINE 109 "XML.hs.neat" #-}
  "\n  </With>"){-# LINE 111 "XML.hs.neat" #-}


 output (Text text) = ({-# LINE 113 "XML.hs.neat" #-}
  "<Text><![CDATA[" ++ ({-# LINE 113 "XML.hs.neat" #-}
  output (text)) ++ {-# LINE 113 "XML.hs.neat" #-}
  "]]></Text>"){-# LINE 113 "XML.hs.neat" #-}



outputXML :: File -> String
outputXML = output
</pre></br><h2>printed</h2></br><pre>module Text.Neat.Output.XML (outputXML) where

import Text.Neat.Template
import Text.Neat.Output


instance Output File where
 output (File path block) = ( ++ (
  output (quote $ path)) ++ ++ (
  output (block)) ++)



instance Output Block where
 output (Block chunks) = ( ++ (

  let _l = list (chunks) in
    if (not . null) _l
      then  _l >>= \ -> ( ++ (
    output (chunk)))
      else) ++)



instance Output Chunk where
 output (Chunk location element) = ( ++ (
  output (location)) ++ ++ (
  output (element)) ++)



instance Output Case where
 output (Case pattern block) = ( ++ (

  output (pattern)) ++ ++ (
  output (block)) ++)



instance Output Location where
 output (Location file line) = ( ++ ( (quote $ file)) ++ ++ ( (line)) ++)

instance Output Value where
 output (Value location pipeline) = ( ++ (
  output (location)) ++ ++ (

  let _l = list (pipeline) in
    if (not . null) _l
      then _l >>= \ -> ( ++ (
    output (pipe)) ++)
      else) ++)




instance Output Pattern where
 output (Pattern location pattern) = ( ++ (
  output (location)) ++ ++ ( (pattern)) ++)


instance Output Element where
 output (Output value) = ( ++ (
  output (value)) ++)


 output (Comment comment) = ( ++ (
  output (comment)) ++)


 output (Define (Function location name pattern) block) = ( ++ (
  output (quote $ name)) ++ ++ ( (location)) ++ (
  output (pattern)) ++ ++ (
  output (block)) ++)



 output (Filter value block) = ( ++ (

  output (value)) ++ ++ (
  output (block)) ++)



 output (For binding block else') = ( ++ (

  output (binding)) ++ ++ (
  output (block)) ++ ++ (
  if (not . zero) (else')
    then      ( ++ ( (else')) ++)
    else []) ++)



 output (If value block else') = ( ++ (

  output (value)) ++ ++ (
  output (block)) ++ ++ (
  if (not . zero) (else')
    then      ( ++ ( (else')) ++)
    else []) ++)



 output (Switch value cases default') = ( ++ (

  output (value)) ++ ++ (
  let _l = list (cases) in
    if (not . null) _l
      then  _l >>= \ -> ( ++ (
    output (case')))
      else) ++ ++ (
  if (not . zero) (default')
    then         ( ++ ( (default')) ++)
    else []) ++)



 output (With binding block) = ( ++ (

  output (binding)) ++ ++ (
  output (block)) ++)



 output (Text text) = ( ++ ( (text)) ++)


outputXML :: File -> String
outputXML = output

</pre>