<a href="Bits.hs2128236579784558821.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Bool.hs5322361231023129506.out.html">next</a></br></br><pre>58d57
< INSTANCE_CIPHER(Blowfish64, "blowfish64", 8)
59d57
< INSTANCE_CIPHER(Blowfish128, "blowfish128", 16)
60d57
< INSTANCE_CIPHER(Blowfish256, "blowfish256", 32)
61c58
< INSTANCE_CIPHER(Blowfish448, "blowfish448", 56)
---
> instanceINSTANCE_CIPHER(Blowfish64,where"blowfish64"{ cipherName, 8)  _ =  "blowfish64" ; cipherKeySize _ = KeySizeFixed  8 ; cipherInit k = either error Blowfish64 $ initBlowfish (toBytes k) }; instance BlockCipher Blowfish64 where { blockSize _ = 8 ; ecbEncrypt (Blowfish64 bf) = encrypt bf ; ecbDecrypt (Blowfish64 bf) = decrypt bf };
61a59
> instanceINSTANCE_CIPHER(Blowfish128,where"blowfish128"{ cipherName, 16)_ =  "blowfish128" ; cipherKeySize _ = KeySizeFixed  16 ; cipherInit k = either error Blowfish128 $ initBlowfish (toBytes k) }; instance BlockCipher Blowfish128 where { blockSize _ = 8 ; ecbEncrypt (Blowfish128 bf) = encrypt bf ; ecbDecrypt (Blowfish128 bf) = decrypt bf };
61a60
> instanceINSTANCE_CIPHER(Blowfish256,where"blowfish256"{ cipherName, 32)_ =  "blowfish256" ; cipherKeySize _ = KeySizeFixed  32 ; cipherInit k = either error Blowfish256 $ initBlowfish (toBytes k) }; instance BlockCipher Blowfish256 where { blockSize _ = 8 ; ecbEncrypt (Blowfish256 bf) = encrypt bf ; ecbDecrypt (Blowfish256 bf) = decrypt bf };
61a61
> instanceINSTANCE_CIPHER(Blowfish448,where"blowfish448"{ cipherName, 56)_ =  "blowfish448" ; cipherKeySize _ = KeySizeFixed  56 ; cipherInit k = either error Blowfish448 $ initBlowfish (toBytes k) }; instance BlockCipher Blowfish448 where { blockSize _ = 8 ; ecbEncrypt (Blowfish448 bf) = encrypt bf ; ecbDecrypt (Blowfish448 bf) = decrypt bf };
61a62
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE CPP #-}
-- |
-- Module      : Crypto.Cipher.Blowfish
-- License     : BSD-style
-- Maintainer  : Vincent Hanquez <vincent@snarc.org>
-- Stability   : stable
-- Portability : good
--
module Crypto.Cipher.Blowfish
    ( Blowfish
    , Blowfish64
    , Blowfish128
    , Blowfish256
    , Blowfish448
    ) where

import Data.Byteable
import Crypto.Cipher.Types
import Crypto.Cipher.Blowfish.Primitive

-- | variable keyed blowfish state
newtype Blowfish = Blowfish Context

-- | 64 bit keyed blowfish state
newtype Blowfish64 = Blowfish64 Context

-- | 128 bit keyed blowfish state
newtype Blowfish128 = Blowfish128 Context

-- | 256 bit keyed blowfish state
newtype Blowfish256 = Blowfish256 Context

-- | 448 bit keyed blowfish state
newtype Blowfish448 = Blowfish448 Context

instance Cipher Blowfish where
    cipherName _    = "blowfish"
    cipherKeySize _ = KeySizeRange 6 56
    cipherInit k = either error Blowfish $ initBlowfish (toBytes k)

instance BlockCipher Blowfish where
    blockSize _ = 8
    ecbEncrypt (Blowfish bf) = encrypt bf
    ecbDecrypt (Blowfish bf) = decrypt bf

#define INSTANCE_CIPHER(CSTR, NAME, KEYSIZE) \
instance Cipher CSTR where \
    { cipherName _ = NAME \
    ; cipherKeySize _ = KeySizeFixed KEYSIZE \
    ; cipherInit k = either error CSTR $ initBlowfish (toBytes k) \
    }; \
instance BlockCipher CSTR where \
    { blockSize _ = 8 \
    ; ecbEncrypt (CSTR bf) = encrypt bf \
    ; ecbDecrypt (CSTR bf) = decrypt bf \
    };

INSTANCE_CIPHER(Blowfish64, "blowfish64", 8)
INSTANCE_CIPHER(Blowfish128, "blowfish128", 16)
INSTANCE_CIPHER(Blowfish256, "blowfish256", 32)
INSTANCE_CIPHER(Blowfish448, "blowfish448", 56)
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE CPP #-}
-- |
-- Module      : Crypto.Cipher.Blowfish
-- License     : BSD-style
-- Maintainer  : Vincent Hanquez <vincent@snarc.org>
-- Stability   : stable
-- Portability : good
--
module Crypto.Cipher.Blowfish
    ( Blowfish
    , Blowfish64
    , Blowfish128
    , Blowfish256
    , Blowfish448
    ) where

import Data.Byteable
import Crypto.Cipher.Types
import Crypto.Cipher.Blowfish.Primitive

-- | variable keyed blowfish state
newtype Blowfish = Blowfish Context

-- | 64 bit keyed blowfish state
newtype Blowfish64 = Blowfish64 Context

-- | 128 bit keyed blowfish state
newtype Blowfish128 = Blowfish128 Context

-- | 256 bit keyed blowfish state
newtype Blowfish256 = Blowfish256 Context

-- | 448 bit keyed blowfish state
newtype Blowfish448 = Blowfish448 Context

instance Cipher Blowfish where
    cipherName _    = "blowfish"
    cipherKeySize _ = KeySizeRange 6 56
    cipherInit k = either error Blowfish $ initBlowfish (toBytes k)

instance BlockCipher Blowfish where
    blockSize _ = 8
    ecbEncrypt (Blowfish bf) = encrypt bf
    ecbDecrypt (Blowfish bf) = decrypt bf

#define INSTANCE_CIPHER(CSTR, NAME, KEYSIZE) \
instance Cipher CSTR where \
    { cipherName _ = NAME \
    ; cipherKeySize _ = KeySizeFixed KEYSIZE \
    ; cipherInit k = either error CSTR $ initBlowfish (toBytes k) \
    }; \
instance BlockCipher CSTR where \
    { blockSize _ = 8 \
    ; ecbEncrypt (CSTR bf) = encrypt bf \
    ; ecbDecrypt (CSTR bf) = decrypt bf \
    };

instanceINSTANCE_CIPHER(Blowfish64,where"blowfish64"{ cipherName, 8)  _ =  "blowfish64" ; cipherKeySize _ = KeySizeFixed  8 ; cipherInit k = either error Blowfish64 $ initBlowfish (toBytes k) }; instance BlockCipher Blowfish64 where { blockSize _ = 8 ; ecbEncrypt (Blowfish64 bf) = encrypt bf ; ecbDecrypt (Blowfish64 bf) = decrypt bf };
instanceINSTANCE_CIPHER(Blowfish128,where"blowfish128"{ cipherName, 16)_ =  "blowfish128" ; cipherKeySize _ = KeySizeFixed  16 ; cipherInit k = either error Blowfish128 $ initBlowfish (toBytes k) }; instance BlockCipher Blowfish128 where { blockSize _ = 8 ; ecbEncrypt (Blowfish128 bf) = encrypt bf ; ecbDecrypt (Blowfish128 bf) = decrypt bf };
instanceINSTANCE_CIPHER(Blowfish256,where"blowfish256"{ cipherName, 32)_ =  "blowfish256" ; cipherKeySize _ = KeySizeFixed  32 ; cipherInit k = either error Blowfish256 $ initBlowfish (toBytes k) }; instance BlockCipher Blowfish256 where { blockSize _ = 8 ; ecbEncrypt (Blowfish256 bf) = encrypt bf ; ecbDecrypt (Blowfish256 bf) = decrypt bf };
instanceINSTANCE_CIPHER(Blowfish448,where"blowfish448"{ cipherName, 56)_ =  "blowfish448" ; cipherKeySize _ = KeySizeFixed  56 ; cipherInit k = either error Blowfish448 $ initBlowfish (toBytes k) }; instance BlockCipher Blowfish448 where { blockSize _ = 8 ; ecbEncrypt (Blowfish448 bf) = encrypt bf ; ecbDecrypt (Blowfish448 bf) = decrypt bf };

</pre>