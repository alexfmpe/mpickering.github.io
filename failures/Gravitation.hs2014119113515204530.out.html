<a href="GraphWidget.hs2721122891398556760.out.html">prev</a></br><a href="failures.html">home</a></br><a href="GRead2.hs750597385971307217.out.html">next</a></br></br><pre>14c14
< centralGravitation ∷ View Position n ⇒ Node → WithGraph n Force
---
> centralGravitation :: View Position n => Node -> WithGraph n Force
17c17
< gravitation ∷ View Position n ⇒ Node -> Rewrite n Force
---
> gravitation :: View Position n => Node -> Rewrite n Force
19d18
<     n ← examine position <$> readNode node
20d18
<     ns ← fmap (map $ examine position) (mapM readNode =<< readNodeList)
21c19
<     return $ fsum [attraction n' n | n' ← ns]
---
>     n <- examine position <$> readNode node
21a20
>     ns <- fmap (map $ examine position) (mapM readNode =<< readNodeList)
21a21
>     return $ fsum [attraction n' n | n' <- ns]
21a22
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE UnicodeSyntax, FlexibleContexts #-}
module GraphRewriting.Layout.Gravitation where

import Data.View
import Data.Vector.Class
import Data.Vector.V2
import Data.Functor
import GraphRewriting.Graph.Types
import GraphRewriting.Graph.Read
import GraphRewriting.Layout.Position
import GraphRewriting.Layout.Force


centralGravitation ∷ View Position n ⇒ Node → WithGraph n Force
centralGravitation = fmap (attraction (vpromote 0) . examine position) . readNode

gravitation ∷ View Position n ⇒ Node -> Rewrite n Force
gravitation node = do
    n ← examine position <$> readNode node
    ns ← fmap (map $ examine position) (mapM readNode =<< readNodeList)
    return $ fsum [attraction n' n | n' ← ns]
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE UnicodeSyntax, FlexibleContexts #-}
module GraphRewriting.Layout.Gravitation where

import Data.View
import Data.Vector.Class
import Data.Vector.V2
import Data.Functor
import GraphRewriting.Graph.Types
import GraphRewriting.Graph.Read
import GraphRewriting.Layout.Position
import GraphRewriting.Layout.Force


centralGravitation :: View Position n => Node -> WithGraph n Force
centralGravitation = fmap (attraction (vpromote 0) . examine position) . readNode

gravitation :: View Position n => Node -> Rewrite n Force
gravitation node = do
    n <- examine position <$> readNode node
    ns <- fmap (map $ examine position) (mapM readNode =<< readNodeList)
    return $ fsum [attraction n' n | n' <- ns]

</pre>