<a href="Docs.hs1311517960910200912.out.html">prev</a></br><a href="failures.html">home</a></br><a href="DSL.hs4803851221441716381.out.html">next</a></br></br><pre>27d26
<       if | isDir     -> goDir  path
28d26
<          | isFile    -> goFile path
29c27
<          | otherwise -> empty
---
>       if | isDir        goDir  path
29a28
>          | isFile       goFile path
29a29
>          | otherwise    empty
32a33
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE MultiWayIf #-}

module Main (main) where

import Control.Applicative
import Control.Monad
import Control.Monad.List
import Data.List
import System.Directory
import System.FilePath
import Test.DocTest

main :: IO ()
main = do
  sources <- findSources "src"
  doctest ("-isrc" : sources)

findSources :: FilePath -> IO [FilePath]
findSources dir = runListT (goDir dir)
  where
    goItem :: FilePath -> FilePath -> ListT IO FilePath
    goItem _ ('.':_) = empty
    goItem parent name = do
      let path = parent </> name
      isDir  <- liftIO (doesDirectoryExist path)
      isFile <- liftIO (doesFileExist path)
      if | isDir     -> goDir  path
         | isFile    -> goFile path
         | otherwise -> empty

    goDir  path = goItem path =<< ListT (getDirectoryContents path)
    goFile path = path <$ guard (".hs" `isSuffixOf` path)
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE MultiWayIf #-}

module Main (main) where

import Control.Applicative
import Control.Monad
import Control.Monad.List
import Data.List
import System.Directory
import System.FilePath
import Test.DocTest

main :: IO ()
main = do
  sources <- findSources "src"
  doctest ("-isrc" : sources)

findSources :: FilePath -> IO [FilePath]
findSources dir = runListT (goDir dir)
  where
    goItem :: FilePath -> FilePath -> ListT IO FilePath
    goItem _ ('.':_) = empty
    goItem parent name = do
      let path = parent </> name
      isDir  <- liftIO (doesDirectoryExist path)
      isFile <- liftIO (doesFileExist path)
      if | isDir        goDir  path
         | isFile       goFile path
         | otherwise    empty

    goDir  path = goItem path =<< ListT (getDirectoryContents path)
    goFile path = path <$ guard (".hs" `isSuffixOf` path)

</pre>