<a href="Date.hs823378840143542612.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Dates.hs9671137552124639789.out.html">next</a></br></br><pre>13c13
< dateType ∷ String → DateType
---
> dateType :: String -> DateType
20c20
< pSpecDate ∷ DateTime → Parsec String st (DateType, DateTime)
---
> pSpecDate :: DateTime -> Parsec String st (DateType, DateTime)
22c22
<   tp ← choice $ map string ["start","end","deadline"]
---
>   tp <- choice $ map string ["start","end","deadline"]
24c24
<   dt ← pDateTime date
---
>   dt <- pDateTime date
28c28
< pSpecDates ∷ DateTime → Parsec String st [(DateType, DateTime)]
---
> pSpecDates :: DateTime -> Parsec String st [(DateType, DateTime)]
31c31
<   pairs ← (pSpecDate date) `sepBy1` (string "; ")
---
>   pairs <- (pSpecDate date) `sepBy1` (string "; ")
34a35
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE UnicodeSyntax #-}
-- | Operations with dates
module Todos.Dates
  (parseDate, getCurrentDateTime,
   pSpecDates)
  where

import Data.Dates
import Text.Parsec

import Todos.Types

dateType ∷ String → DateType
dateType "start" = StartDate
dateType "end"   = EndDate
dateType "deadline" = Deadline
dateType _ = error "unknown date type"

-- | Parse date/time with date type
pSpecDate ∷ DateTime → Parsec String st (DateType, DateTime)
pSpecDate date = do
  tp ← choice $ map string ["start","end","deadline"]
  string ": "
  dt ← pDateTime date
  return (dateType tp, dt)

-- | Parse set of dates with types (in parenthesis)
pSpecDates ∷ DateTime → Parsec String st [(DateType, DateTime)]
pSpecDates date = do
  char '('
  pairs ← (pSpecDate date) `sepBy1` (string "; ")
  string ") "
  return pairs

</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE UnicodeSyntax #-}
-- | Operations with dates
module Todos.Dates
  (parseDate, getCurrentDateTime,
   pSpecDates)
  where

import Data.Dates
import Text.Parsec

import Todos.Types

dateType :: String -> DateType
dateType "start" = StartDate
dateType "end"   = EndDate
dateType "deadline" = Deadline
dateType _ = error "unknown date type"

-- | Parse date/time with date type
pSpecDate :: DateTime -> Parsec String st (DateType, DateTime)
pSpecDate date = do
  tp <- choice $ map string ["start","end","deadline"]
  string ": "
  dt <- pDateTime date
  return (dateType tp, dt)

-- | Parse set of dates with types (in parenthesis)
pSpecDates :: DateTime -> Parsec String st [(DateType, DateTime)]
pSpecDates date = do
  char '('
  pairs <- (pSpecDate date) `sepBy1` (string "; ")
  string ") "
  return pairs


</pre>