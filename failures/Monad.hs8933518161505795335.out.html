<a href="Monad.hs8235644401115438165.out.html">prev</a></br><a href="failures.html">home</a></br><a href="MonadApt.hs13418536351808266298.out.html">next</a></br></br><pre>12d11
< import "mtl" Control.Monad.Reader
13c12
< import "mtl" Control.Monad.Writer
---
> import  Control.Monad.Reader
13a13
> import  Control.Monad.Writer
28a29
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE PackageImports, GeneralizedNewtypeDeriving #-}
module QuickTest.Monad
  ( module QuickTest.Types
  , QuickTest
  , runQuickTest
  , asks
  , emit
  , askOption
  ) where

import Control.Monad
import "mtl" Control.Monad.Reader
import "mtl" Control.Monad.Writer

import QuickTest.Types

newtype QuickTest a = QuickTest { runQT :: WriterT [Snippet] (Reader QuickTestState) a }
  deriving (Monad, MonadWriter [Snippet], MonadReader QuickTestState)

runQuickTest :: QuickTestState -> QuickTest () -> [Snippet]
runQuickTest st = snd . flip runReader st . runWriterT . runQT

emit :: Snippet -> QuickTest ()
emit = tell . lines

askOption :: (Options -> a) -> QuickTest a
askOption f = asks (f . qtsOptions)

</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE PackageImports, GeneralizedNewtypeDeriving #-}
module QuickTest.Monad
  ( module QuickTest.Types
  , QuickTest
  , runQuickTest
  , asks
  , emit
  , askOption
  ) where

import Control.Monad
import  Control.Monad.Reader
import  Control.Monad.Writer

import QuickTest.Types

newtype QuickTest a = QuickTest { runQT :: WriterT [Snippet] (Reader QuickTestState) a }
  deriving (Monad, MonadWriter [Snippet], MonadReader QuickTestState)

runQuickTest :: QuickTestState -> QuickTest () -> [Snippet]
runQuickTest st = snd . flip runReader st . runWriterT . runQT

emit :: Snippet -> QuickTest ()
emit = tell . lines

askOption :: (Options -> a) -> QuickTest a
askOption f = asks (f . qtsOptions)


</pre>