<a href="IdMap.hs14656452031461495731.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Ignore.hs14587779232007237709.out.html">next</a></br></br><pre>27c27
< (f |::| g) (a,b) opq = case dePair opq of
---
>    |::|      g  (a,b) opq = case dePair opq of
31c31
< (f |->| g) (a,b) opq = case dePair opq of
---
>    |->|      g  (a,b) opq = case dePair opq of
36c36
< (f |<>| g) (a,b) opq = case dePair opq of
---
>    |<>|      g  (a,b) opq = case dePair opq of
37a38
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE TypeOperators
            ,BangPatterns
  #-}
-- |
-- Module      : Data.OI.IFun
-- Copyright   : (c) Nobuo Yamashita 2012
-- License     : BSD3
-- Author      : Nobuo Yamashita
-- Maintainer  : nobsun@sampou.org
-- Stability   : experimental
--
module Data.OI.IFun
  (
  -- * Type of function with interaction
   IFun
  -- * IFun combinator
  ,(|::|)
  ,(|->|)
  ,(|<>|)
  ) where

import Data.OI.Internal

type IFun p a b = a -> p :-> b

(|::|) :: IFun p a c -> IFun q  b d -> IFun (p,q) (a,b) (c,d)
(f |::| g) (a,b) opq = case dePair opq of
  (p,q) -> (f a p, g b q)

(|->|) :: IFun p a (b',c) -> IFun q (b',b) d -> IFun (p,q) (a,b) (c,d)
(f |->| g) (a,b) opq = case dePair opq of
  (p,q) -> case f a p of
    (b',c) -> (c, g (b',b) q)

(|<>|) :: IFun p (a',a) (b',c) -> IFun q (b',b) (a',d) -> IFun (p,q) (a,b) (c,d)
(f |<>| g) (a,b) opq = case dePair opq of
  (p,q) -> (c,d) where (b',c) = f (a',a) p; (a',d) = g (b',b) q
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE TypeOperators
            ,BangPatterns
  #-}
-- |
-- Module      : Data.OI.IFun
-- Copyright   : (c) Nobuo Yamashita 2012
-- License     : BSD3
-- Author      : Nobuo Yamashita
-- Maintainer  : nobsun@sampou.org
-- Stability   : experimental
--
module Data.OI.IFun
  (
  -- * Type of function with interaction
   IFun
  -- * IFun combinator
  ,(|::|)
  ,(|->|)
  ,(|<>|)
  ) where

import Data.OI.Internal

type IFun p a b = a -> p :-> b

(|::|) :: IFun p a c -> IFun q  b d -> IFun (p,q) (a,b) (c,d)
   |::|      g  (a,b) opq = case dePair opq of
  (p,q) -> (f a p, g b q)

(|->|) :: IFun p a (b',c) -> IFun q (b',b) d -> IFun (p,q) (a,b) (c,d)
   |->|      g  (a,b) opq = case dePair opq of
  (p,q) -> case f a p of
    (b',c) -> (c, g (b',b) q)

(|<>|) :: IFun p (a',a) (b',c) -> IFun q (b',b) (a',d) -> IFun (p,q) (a,b) (c,d)
   |<>|      g  (a,b) opq = case dePair opq of
  (p,q) -> (c,d) where (b',c) = f (a',a) p; (a',d) = g (b',b) q

</pre>