<a href="Diff.hs8965443031474833169.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Dim2.hs1580723810704877633.out.html">next</a></br></br><pre>5c5
< module Data.Vect.Flt.Util.Dim2 where
---
> module Data.Vect.Double.Util.Dim2Data.Vect.Flt.Util.Dim2 wherewhere
7c7
< import Data.Vect.Flt.Base
---
> import Data.Vect.Double.BaseData.Vect.Flt.Base
10c10
< structVec2 :: [Flt] -> [Vec2]
---
> structVec2 :: [DoubleFlt] ->] ->[Vec2Vec2]  ]
16c16
< destructVec2 :: [Vec2] -> [Flt]
---
> destructVec2 :: [Vec2] -> [DoubleFlt]  ]
20c20
< det2 :: Vec2 -> Vec2 -> Flt
---
> det2 :: Vec2 -> Vec2 -> DoubleFlt
29d28
< translate2X :: Flt -> Vec2 -> Vec2
30c29
< translate2Y :: Flt -> Vec2 -> Vec2
---
> translate2X :: DoubleFlt -> ->Vec2-> ->Vec2
30a30
> translate2Y :: DoubleFlt -> ->Vec2-> ->Vec2
37c37
< sinCos :: Flt -> Vec2
---
> sinCos :: DoubleFlt -> ->Vec2
40c40
< sinCos' {- ' CPP is sensitive to primes -} :: Flt -> Normal2
---
> sinCos' {- ' CPP is sensitive to primes -} :: DoubleFlt -> ->Normal2
43d42
< sinCosRadius :: Flt    -- ^ angle (in radians)
44c43
<              -> Flt    -- ^ radius
---
> sinCosRadius :: DoubleFlt    -- ^ angle (in radians)-- ^ angle (in radians)
44a44
>              -> DoubleFlt    -- ^ radius-- ^ radius
49c49
< angle2 :: Vec2 -> Flt
---
> angle2 :: Vec2 -> DoubleFlt
52c52
< angle2' {- ' CPP is sensitive to primes -} :: Normal2 -> Flt
---
> angle2' {- ' CPP is sensitive to primes -} :: Normal2 -> DoubleFlt
56c56
< rotMatrix2 :: Flt -> Mat2
---
> rotMatrix2 :: DoubleFlt -> ->Mat2
59c59
< rotMatrixOrtho2 :: Flt -> Ortho2
---
> rotMatrixOrtho2 :: DoubleFlt -> ->Ortho2
62c62
< rotate2 :: Flt -> Vec2 -> Vec2
---
> rotate2 :: DoubleFlt -> ->Vec2-> ->Vec2
73a74
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE CPP #-}
#define Flt Double
#define VECT_Double

module Data.Vect.Flt.Util.Dim2 where

import Data.Vect.Flt.Base

-- | Example: @structVec2 [1,2,3,4] = [ Vec2 1 2 , Vec2 3 4 ]@.
structVec2 :: [Flt] -> [Vec2]
structVec2 [] = []
structVec2 (x:y:ls) = (Vec2 x y):(structVec2 ls)
structVec2 _ = error "structVec2"

-- | The opposite of "structVec2".
destructVec2 :: [Vec2] -> [Flt]
destructVec2 [] = []
destructVec2 ((Vec2 x y):ls) = x:y:(destructVec2 ls)

det2 :: Vec2 -> Vec2 -> Flt
det2 u v = det (u,v)

vec2X :: Vec2
vec2Y :: Vec2

vec2X = Vec2 1 0
vec2Y = Vec2 0 1

translate2X :: Flt -> Vec2 -> Vec2
translate2Y :: Flt -> Vec2 -> Vec2

translate2X t (Vec2 x y) = Vec2 (x+t) y
translate2Y t (Vec2 x y) = Vec2 x (y+t)

-- | unit vector with given angle relative to the positive X axis (in the positive direction, that is, CCW).
-- A more precise name would be @cosSin@, but that sounds bad :)
sinCos :: Flt -> Vec2
sinCos a = Vec2 (cos a) (sin a)

sinCos' {- ' CPP is sensitive to primes -} :: Flt -> Normal2
sinCos' = toNormalUnsafe . sinCos

sinCosRadius :: Flt    -- ^ angle (in radians)
             -> Flt    -- ^ radius
             -> Vec2
sinCosRadius a r = Vec2 (r * cos a) (r * sin a)

-- | The angle relative to the positive X axis
angle2 :: Vec2 -> Flt
angle2 (Vec2 x y) = atan2 y x

angle2' {- ' CPP is sensitive to primes -} :: Normal2 -> Flt
angle2' = angle2 . fromNormal

-- | Rotation matrix by a given angle (in radians), counterclockwise.
rotMatrix2 :: Flt -> Mat2
rotMatrix2 a = Mat2 (Vec2 c s) (Vec2 (-s) c) where c = cos a; s = sin a

rotMatrixOrtho2 :: Flt -> Ortho2
rotMatrixOrtho2 = toOrthoUnsafe . rotMatrix2

rotate2 :: Flt -> Vec2 -> Vec2
rotate2 a v = v .* (rotMatrix2 a)

-- |Rotates counterclockwise by 90 degrees.
rotateCCW :: Vec2 -> Vec2
rotateCCW (Vec2 x y) = Vec2 (-y) x

-- |Rotates clockwise by 90 degrees.
rotateCW :: Vec2 -> Vec2
rotateCW (Vec2 x y) = Vec2 y (-x)


</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE CPP #-}
#define Flt Double
#define VECT_Double

module Data.Vect.Double.Util.Dim2Data.Vect.Flt.Util.Dim2 wherewhere

import Data.Vect.Double.BaseData.Vect.Flt.Base

-- | Example: @structVec2 [1,2,3,4] = [ Vec2 1 2 , Vec2 3 4 ]@.
structVec2 :: [DoubleFlt] ->] ->[Vec2Vec2]  ]
structVec2 [] = []
structVec2 (x:y:ls) = (Vec2 x y):(structVec2 ls)
structVec2 _ = error "structVec2"

-- | The opposite of "structVec2".
destructVec2 :: [Vec2] -> [DoubleFlt]  ]
destructVec2 [] = []
destructVec2 ((Vec2 x y):ls) = x:y:(destructVec2 ls)

det2 :: Vec2 -> Vec2 -> DoubleFlt
det2 u v = det (u,v)

vec2X :: Vec2
vec2Y :: Vec2

vec2X = Vec2 1 0
vec2Y = Vec2 0 1

translate2X :: DoubleFlt -> ->Vec2-> ->Vec2
translate2Y :: DoubleFlt -> ->Vec2-> ->Vec2

translate2X t (Vec2 x y) = Vec2 (x+t) y
translate2Y t (Vec2 x y) = Vec2 x (y+t)

-- | unit vector with given angle relative to the positive X axis (in the positive direction, that is, CCW).
-- A more precise name would be @cosSin@, but that sounds bad :)
sinCos :: DoubleFlt -> ->Vec2
sinCos a = Vec2 (cos a) (sin a)

sinCos' {- ' CPP is sensitive to primes -} :: DoubleFlt -> ->Normal2
sinCos' = toNormalUnsafe . sinCos

sinCosRadius :: DoubleFlt    -- ^ angle (in radians)-- ^ angle (in radians)
             -> DoubleFlt    -- ^ radius-- ^ radius
             -> Vec2
sinCosRadius a r = Vec2 (r * cos a) (r * sin a)

-- | The angle relative to the positive X axis
angle2 :: Vec2 -> DoubleFlt
angle2 (Vec2 x y) = atan2 y x

angle2' {- ' CPP is sensitive to primes -} :: Normal2 -> DoubleFlt
angle2' = angle2 . fromNormal

-- | Rotation matrix by a given angle (in radians), counterclockwise.
rotMatrix2 :: DoubleFlt -> ->Mat2
rotMatrix2 a = Mat2 (Vec2 c s) (Vec2 (-s) c) where c = cos a; s = sin a

rotMatrixOrtho2 :: DoubleFlt -> ->Ortho2
rotMatrixOrtho2 = toOrthoUnsafe . rotMatrix2

rotate2 :: DoubleFlt -> ->Vec2-> ->Vec2
rotate2 a v = v .* (rotMatrix2 a)

-- |Rotates counterclockwise by 90 degrees.
rotateCCW :: Vec2 -> Vec2
rotateCCW (Vec2 x y) = Vec2 (-y) x

-- |Rotates clockwise by 90 degrees.
rotateCW :: Vec2 -> Vec2
rotateCW (Vec2 x y) = Vec2 y (-x)



</pre>