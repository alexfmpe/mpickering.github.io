<a href="Semantics.hs750597385971307217.out.html">prev</a></br><a href="failures.html">home</a></br><a href="SemHsTokens.hs16807282475249.out.html">next</a></br></br><pre>4d3
< module SemHsTokens where
5d3
< {-# LINE 2 "src-ag/HsToken.ag" #-}
6d3
< 
7c4
< import CommonTypes
---
> module SemHsTokens where CommonTypes
9d5
< {-# LINE 10 "dist/build/SemHsTokens.hs" #-}
10d5
< 
11d5
< {-# LINE 4 "src-ag/SemHsTokens.ag" #-}
12d5
< 
21c14
< {-# LINE 22 "dist/build/SemHsTokens.hs" #-}
---
> 
21a15
> 
21a16
> 
21a17
> 
21a18
> 
21a19
> 
21a20
> 
21a21
> 
21a22
> 
24d24
< {-# LINE 58 "src-ag/SemHsTokens.ag" #-}
26d25
< isNTname allnts (Just (NT nt _ _)) = nt `elem` allnts
27d25
< isNTname allnts _                  = False
28c26
< {-# LINE 29 "dist/build/SemHsTokens.hs" #-}
---
> 
28a27
> 
28a28
> 
28a29
> 
31c32
< data Inh_HsToken  = Inh_HsToken { allfields_Inh_HsToken :: ([(Identifier,Type,ChildKind)]), allnts_Inh_HsToken :: ([Identifier]), attrs_Inh_HsToken :: ([(Identifier,Identifier)]), con_Inh_HsToken :: (Identifier), fieldnames_Inh_HsToken :: ([Identifier]), nt_Inh_HsToken :: (Identifier), options_Inh_HsToken :: (Options) }
---
> 
31a33
> 
31a34
> 
31a35
> 
31a36
> 
31a37
> 
31a38
> 
31a39
> 
31a40
> 
31a41
> 
31a42
> 
31a43
> 
31a44
> -- cata
31a45
> 
31a46
> 
31a47
> 
31a48
> 
31a49
> 
31a50
> 
31a51
> 
31a52
> 
31a53
> 
31a54
> -- semantic domain
31a55
> 
31a56
> 
31a57
> 
31a58
> 
31a59
> 
31a60
> isNTname allnts (Just (NT nt _ _)) = nt `elem` allnts
31a61
> isNTname allnts _                  = False Inh_HsToken  = Inh_HsToken { allfields_Inh_HsToken :: ([(Identifier,Type,ChildKind)]), allnts_Inh_HsToken :: ([Identifier]), attrs_Inh_HsToken :: ([(Identifier,Identifier)]), con_Inh_HsToken :: (Identifier), fieldnames_Inh_HsToken :: ([Identifier]), nt_Inh_HsToken :: (Identifier), options_Inh_HsToken :: (Options) }
43c73
< -- cata
---
> 
53c83
< -- semantic domain
---
> 
90d119
<    {-# LINE 66 "src-ag/SemHsTokens.ag" #-}
91d119
<    rule0 = \ pos_ rdesc_ var_ ->
92d119
<                                 {-# LINE 66 "src-ag/SemHsTokens.ag" #-}
93d119
<                                 AGLocal var_ pos_ rdesc_
94c120
<                                 {-# LINE 95 "dist/build/SemHsTokens.hs"#-}
---
> 
94a121
> 
94a122
> 
94a123
> 
94a124
> 
96d125
<    {-# LINE 67 "src-ag/SemHsTokens.ag" #-}
97d125
<    rule1 = \ pos_ rdesc_ var_ ->
98d125
<                                 {-# LINE 67 "src-ag/SemHsTokens.ag" #-}
99d125
<                                 AGField _LOC var_ pos_ rdesc_
100c126
<                                 {-# LINE 101 "dist/build/SemHsTokens.hs"#-}
---
> 
100a127
> 
100a128
> 
100a129
> 
100a130
> 
102d131
<    {-# LINE 69 "src-ag/SemHsTokens.ag" #-}
103d131
<    rule2 = \ ((_lhsIallfields) :: [(Identifier,Type,ChildKind)]) ((_lhsIallnts) :: [Identifier]) ((_lhsIattrs) :: [(Identifier,Identifier)]) ((_lhsIcon) :: Identifier) ((_lhsIfieldnames) :: [Identifier]) ((_lhsInt) :: Identifier) ((_lhsIoptions) :: Options) _tkAsField _tkAsLocal pos_ var_ ->
104d131
<                        {-# LINE 69 "src-ag/SemHsTokens.ag" #-}
105d131
<                        if var_ `elem` _lhsIfieldnames
106d131
<                        then if  isNTname _lhsIallnts (lookup var_ (map (\(n,t,_) -> (n,t)) _lhsIallfields))
107d131
<                             then (Seq.singleton(ChildAsLocal _lhsInt _lhsIcon var_), _tkAsLocal    ,(pos_,fieldname var_), []    )
108d131
<                             else (Seq.empty, _tkAsLocal    , (pos_,fieldname var_), []    )
109d131
<                        else if (_LOC,var_) `elem` _lhsIattrs
110d131
<                             then (Seq.empty                                      , _tkAsField    , (pos_,locname _lhsIoptions var_), [var_])
111d131
<                             else (Seq.singleton(UndefLocal _lhsInt _lhsIcon var_), _tkAsField    , (pos_,locname _lhsIoptions var_), []    )
112c132
<                        {-# LINE 113 "dist/build/SemHsTokens.hs"#-}
---
> 
112a133
> 
112a134
> 
112a135
> 
112a136
> 
112a137
> 
112a138
> 
112a139
> 
112a140
> 
112a141
> 
112a142
> 
114d143
<    {-# LINE 104 "src-ag/SemHsTokens.ag" #-}
115d143
<    rule3 = \ ((_lhsIfieldnames) :: [Identifier]) var_ ->
116d143
<                                {-# LINE 104 "src-ag/SemHsTokens.ag" #-}
117d143
<                                if var_ `elem` _lhsIfieldnames
118d143
<                                 then Seq.singleton var_
119d143
<                                 else Seq.empty
120c144
<                                {-# LINE 121 "dist/build/SemHsTokens.hs"#-}
---
> 
120a145
> 
120a146
> 
120a147
> 
120a148
> 
120a149
> 
120a150
> 
135c165
<      _tok
---
>      _tok = \ pos_ rdesc_ var_ ->AGLocal var_ pos_ rdesc_
135a166
>    rule1 = \ pos_ rdesc_ var_ ->AGField _LOC var_ pos_ rdesc_
135a167
> 
135a168
>    rule2 = \ ((_lhsIallfields) :: [(Identifier,Type,ChildKind)]) ((_lhsIallnts) :: [Identifier]) ((_lhsIattrs) :: [(Identifier,Identifier)]) ((_lhsIcon) :: Identifier) ((_lhsIfieldnames) :: [Identifier]) ((_lhsInt) :: Identifier) ((_lhsIoptions) :: Options) _tkAsField _tkAsLocal pos_ var_ -> var_ `elem` _lhsIfieldnames
135a169
>                        then if  isNTname _lhsIallnts (lookup var_ (map (\(n,t,_) -> (n,t)) _lhsIallfields))
135a170
>                             then (Seq.singleton(ChildAsLocal _lhsInt _lhsIcon var_), _tkAsLocal    ,(pos_,fieldname var_), []    )
135a171
>                             else (Seq.empty, _tkAsLocal    , (pos_,fieldname var_), []    )
135a172
>                        else if (_LOC,var_) `elem` _lhsIattrs
135a173
>                             then (Seq.empty                                      , _tkAsField    , (pos_,locname _lhsIoptions var_), [var_])
135a174
>                             else (Seq.singleton(UndefLocal _lhsInt _lhsIcon var_), _tkAsField    , (pos_,locname _lhsIoptions var_), []    )
135a175
> 
135a176
> 
135a177
> 
135a178
> 
135a179
> 
135a180
> 
135a181
> 
135a182
> 
135a183
> 
135a184
> 
135a185
> 
135a186
> 
135a187
> 
135a188
> 
135a189
> 
135a190
> 
135a191
> 
135a192
> 
135a193
> 
135a194
> 
135a195
> 
135a196
> 
135a197
> 
135a198
> 
135a199
> 
135a200
> 
135a201
> 
135a202
> 
135a203
>    rule3 = \ ((_lhsIfieldnames) :: [Identifier]) var_ -> var_ `elem` _lhsIfieldnames
135a204
>                                 then Seq.singleton var_
135a205
>                                 else Seq.empty
135a206
> 
135a207
> 
135a208
> 
135a209
> 
135a210
> 
135a211
> 
135a212
> 
135a213
> 
135a214
> 
135a215
> 
135a216
> 
135a217
> 
135a218
> 
135a219
> 
135a220
> 
135a221
> 
135a222
> 
135a223
> 
135a224
> 
135a225
> 
135a226
> 
135a227
> 
135a228
> 
135a229
> 
135a230
> 
135a231
> 
135a232
> 
135a233
> 
135a234
> 
160d258
<    {-# LINE 78 "src-ag/SemHsTokens.ag" #-}
161d258
<    rule9 = \ ((_lhsIattrs) :: [(Identifier,Identifier)]) ((_lhsIcon) :: Identifier) ((_lhsIfieldnames) :: [Identifier]) ((_lhsInt) :: Identifier) attr_ field_ ->
162d258
<                              {-# LINE 78 "src-ag/SemHsTokens.ag" #-}
163d258
<                              if (field_,attr_) `elem` _lhsIattrs
164d258
<                              then Seq.empty
165d258
<                              else if not(field_ `elem` (_LHS : _LOC: _lhsIfieldnames))
166d258
<                                   then Seq.singleton (UndefChild _lhsInt _lhsIcon field_)
167d258
<                                   else Seq.singleton (UndefAttr _lhsInt _lhsIcon field_ attr_ False)
168c259
<                              {-# LINE 169 "dist/build/SemHsTokens.hs"#-}
---
> 
168a260
> 
168a261
> 
168a262
> 
168a263
> 
168a264
> 
168a265
> 
168a266
> 
168a267
> 
170d268
<    {-# LINE 93 "src-ag/SemHsTokens.ag" #-}
171d268
<    rule10 = \ attr_ field_ ->
172d268
<                   {-# LINE 93 "src-ag/SemHsTokens.ag" #-}
173d268
<                   if field_ == _LOC
174d268
<                   then ([], [attr_])
175d268
<                   else ([(field_,attr_)], [])
176c269
<                   {-# LINE 177 "dist/build/SemHsTokens.hs"#-}
---
> 
176a270
> 
176a271
> 
176a272
> 
176a273
> 
176a274
> 
176a275
> 
178d276
<    {-# LINE 123 "src-ag/SemHsTokens.ag" #-}
179d276
<    rule11 = \ attr_ field_ rdesc_ ->
180d276
<                         {-# LINE 123 "src-ag/SemHsTokens.ag" #-}
181d276
<                         case rdesc_ of
182d276
<                           Just d  -> \x -> "(trace " ++ show (d ++ " -> " ++ show field_ ++ "." ++ show attr_) ++ " (" ++ x ++ "))"
183d276
<                           Nothing -> id
184c277
<                         {-# LINE 185 "dist/build/SemHsTokens.hs"#-}
---
> 
184a278
> 
184a279
> 
184a280
> 
184a281
> 
184a282
> 
184a283
> 
186d284
<    {-# LINE 126 "src-ag/SemHsTokens.ag" #-}
187d284
<    rule12 = \ _addTrace ((_lhsIoptions) :: Options) attr_ field_ pos_ ->
188d284
<                    {-# LINE 126 "src-ag/SemHsTokens.ag" #-}
189d284
<                    (pos_, _addTrace     $ attrname _lhsIoptions True field_ attr_)
190c285
<                    {-# LINE 191 "dist/build/SemHsTokens.hs"#-}
---
> 
190a286
> 
190a287
> 
190a288
> 
190a289
> 
199c298
<      _output
---
>      _output = \ ((_lhsIattrs) :: [(Identifier,Identifier)]) ((_lhsIcon) :: Identifier) ((_lhsIfieldnames) :: [Identifier]) ((_lhsInt) :: Identifier) attr_ field_ -> (field_,attr_) `elem` _lhsIattrs
199a299
>                                  then Seq.empty
199a300
>                                  else if not(field_ `elem` (_LHS : _LOC: _lhsIfieldnames))
199a301
>                                       then Seq.singleton (UndefChild _lhsInt _lhsIcon field_)
199a302
>                                       else Seq.singleton (UndefAttr _lhsInt _lhsIcon field_ attr_ False)
199a303
> 
199a304
> 
199a305
> 
199a306
> 
199a307
> 
199a308
> 
199a309
> 
199a310
> 
199a311
> 
199a312
> 
199a313
>    rule10 = \ attr_ field_ -> field_ == _LOC
199a314
>                   then ([], [attr_])
199a315
>                   else ([(field_,attr_)], [])
199a316
> 
199a317
> 
199a318
> 
199a319
> 
199a320
> 
199a321
> 
199a322
> 
199a323
> 
199a324
> 
199a325
> 
199a326
> 
199a327
> 
199a328
> 
199a329
> 
199a330
> 
199a331
> 
199a332
> 
199a333
> 
199a334
> 
199a335
> 
199a336
> 
199a337
> 
199a338
> 
199a339
> 
199a340
> 
199a341
> 
199a342
> 
199a343
>    rule11 = \ attr_ field_ rdesc_ -> rdesc_ of
199a344
>                           Just d  -> \x -> "(trace " ++ show (d ++ " -> " ++ show field_ ++ "." ++ show attr_) ++ " (" ++ x ++ "))"
199a345
>                           Nothing -> id
199a346
>    rule12 = \ _addTrace ((_lhsIoptions) :: Options) attr_ field_ pos_ ->pos_, _addTrace     $ attrname _lhsIoptions True field_ attr_)
199a347
> 
199a348
> 
199a349
> 
199a350
> 
199a351
> 
199a352
> 
199a353
> 
199a354
> 
199a355
> 
199a356
> 
199a357
> 
199a358
> 
199a359
> 
199a360
> 
199a361
> 
199a362
> 
199a363
> 
199a364
> 
199a365
> 
199a366
> 
199a367
> 
199a368
> 
199a369
> 
199a370
> 
199a371
> 
199a372
> 
199a373
> 
199a374
> 
199a375
> 
199a376
> 
199a377
> 
199a378
> 
199a379
> 
199a380
> 
199a381
> 
199a382
> 
199a383
> 
199a384
> 
199a385
> 
199a386
> 
199a387
> 
199a388
> 
199a389
> 
199a390
> 
199a391
> 
199a392
> 
199a393
> 
199a394
> 
199a395
> 
199a396
> 
199a397
> 
199a398
> 
199a399
> 
199a400
> 
199a401
> 
199a402
> 
199a403
> 
199a404
> 
199a405
> 
199a406
> 
199a407
> 
199a408
> 
199a409
> 
199a410
> 
199a411
> 
199a412
> 
199a413
> 
199a414
> 
199a415
> 
199a416
> 
199a417
> 
199a418
> 
199a419
> 
224d443
<    {-# LINE 128 "src-ag/SemHsTokens.ag" #-}
225d443
<    rule16 = \ pos_ value_ ->
226d443
<                          {-# LINE 128 "src-ag/SemHsTokens.ag" #-}
227d443
<                          (pos_, value_)
228c444
<                          {-# LINE 229 "dist/build/SemHsTokens.hs"#-}
---
> 
228a445
> 
228a446
> 
228a447
> 
228a448
> 
246c466
<      _output
---
>      _output = \ pos_ value_ ->pos_, value_)
246a467
> 
246a468
> 
246a469
> 
246a470
> 
246a471
> 
246a472
> 
246a473
> 
246a474
> 
246a475
> 
246a476
> 
246a477
> 
246a478
> 
246a479
> 
246a480
> 
246a481
> 
246a482
> 
246a483
> 
246a484
> 
246a485
> 
246a486
> 
246a487
> 
246a488
> 
246a489
> 
246a490
> 
246a491
> 
246a492
> 
246a493
> 
246a494
> 
246a495
> 
246a496
> 
246a497
> 
246a498
> 
246a499
> 
246a500
> 
246a501
> 
246a502
> 
246a503
> 
246a504
> 
246a505
> 
246a506
> 
246a507
> 
246a508
> 
246a509
> 
246a510
> 
246a511
> 
246a512
> 
246a513
> 
246a514
> 
246a515
> 
246a516
> 
246a517
> 
246a518
> 
246a519
> 
246a520
> 
246a521
> 
246a522
> 
246a523
> 
246a524
> 
246a525
> 
246a526
> 
246a527
> 
246a528
> 
246a529
> 
246a530
> 
246a531
> 
246a532
> 
246a533
> 
246a534
> 
246a535
> 
246a536
> 
246a537
> 
246a538
> 
246a539
> 
246a540
> 
246a541
> 
246a542
> 
246a543
> 
246a544
> 
246a545
> 
246a546
> 
246a547
> 
246a548
> 
246a549
> 
246a550
> 
246a551
> 
246a552
> 
246a553
> 
246a554
> 
246a555
> 
246a556
> 
246a557
> 
246a558
> 
246a559
> 
246a560
> 
246a561
> 
246a562
> 
246a563
> 
246a564
> 
246a565
> 
246a566
> 
246a567
> 
246a568
> 
246a569
> 
246a570
> 
246a571
> 
246a572
> 
246a573
> 
246a574
> 
246a575
> 
246a576
> 
246a577
> 
246a578
> 
246a579
> 
246a580
> 
246a581
> 
246a582
> 
246a583
> 
246a584
> 
271d608
<    {-# LINE 130 "src-ag/SemHsTokens.ag" #-}
272d608
<    rule23 = \ pos_ value_ ->
273d608
<                            {-# LINE 130 "src-ag/SemHsTokens.ag" #-}
274d608
<                            (pos_, if null value_
275d608
<                                      then ""
276d608
<                                      else showCharShort (head value_)
277d608
<                            )
278c609
<                            {-# LINE 279 "dist/build/SemHsTokens.hs"#-}
---
> 
278a610
> 
278a611
> 
278a612
> 
278a613
> 
278a614
> 
278a615
> 
278a616
> 
296c634
<      _output
---
>      _output = \ pos_ value_ ->pos_, if null value_
296a635
>                                         then ""
296a636
>                                         else showCharShort (head value_)
296a637
>                               )
296a638
> 
296a639
> 
296a640
> 
296a641
> 
296a642
> 
296a643
> 
296a644
> 
296a645
> 
296a646
> 
296a647
> 
296a648
> 
296a649
> 
296a650
> 
296a651
> 
296a652
> 
296a653
> 
296a654
> 
296a655
> 
296a656
> 
296a657
> 
296a658
> 
296a659
> 
296a660
> 
296a661
> 
296a662
> 
296a663
> 
296a664
> 
296a665
> 
296a666
> 
296a667
> 
296a668
> 
296a669
> 
296a670
> 
296a671
> 
296a672
> 
296a673
> 
296a674
> 
296a675
> 
296a676
> 
296a677
> 
296a678
> 
296a679
> 
296a680
> 
296a681
> 
296a682
> 
296a683
> 
296a684
> 
296a685
> 
296a686
> 
296a687
> 
296a688
> 
296a689
> 
296a690
> 
296a691
> 
296a692
> 
296a693
> 
296a694
> 
296a695
> 
296a696
> 
296a697
> 
296a698
> 
296a699
> 
296a700
> 
296a701
> 
296a702
> 
296a703
> 
296a704
> 
296a705
> 
296a706
> 
296a707
> 
296a708
> 
296a709
> 
296a710
> 
296a711
> 
296a712
> 
296a713
> 
296a714
> 
296a715
> 
296a716
> 
296a717
> 
296a718
> 
296a719
> 
296a720
> 
296a721
> 
296a722
> 
296a723
> 
296a724
> 
296a725
> 
296a726
> 
296a727
> 
296a728
> 
296a729
> 
296a730
> 
296a731
> 
296a732
> 
296a733
> 
296a734
> 
296a735
> 
296a736
> 
296a737
> 
296a738
> 
296a739
> 
296a740
> 
296a741
> 
296a742
> 
296a743
> 
296a744
> 
296a745
> 
296a746
> 
296a747
> 
296a748
> 
296a749
> 
296a750
> 
296a751
> 
296a752
> 
296a753
> 
296a754
> 
296a755
> 
296a756
> 
296a757
> 
296a758
> 
296a759
> 
296a760
> 
296a761
> 
296a762
> 
296a763
> 
296a764
> 
296a765
> 
296a766
> 
296a767
> 
296a768
> 
296a769
> 
296a770
> 
296a771
> 
296a772
> 
296a773
> 
296a774
> 
296a775
> 
296a776
> 
296a777
> 
296a778
> 
296a779
> 
296a780
> 
296a781
> 
296a782
> 
296a783
> 
296a784
> 
296a785
> 
296a786
> 
296a787
> 
296a788
> 
296a789
> 
296a790
> 
296a791
> 
296a792
> 
296a793
> 
296a794
> 
296a795
> 
296a796
> 
296a797
> 
296a798
> 
296a799
> 
296a800
> 
321d824
<    {-# LINE 135 "src-ag/SemHsTokens.ag" #-}
322d824
<    rule30 = \ pos_ value_ ->
323d824
<                            {-# LINE 135 "src-ag/SemHsTokens.ag" #-}
324d824
<                            (pos_, showStrShort value_)
325c825
<                            {-# LINE 326 "dist/build/SemHsTokens.hs"#-}
---
> 
325a826
> 
325a827
> 
325a828
> 
325a829
> 
343c847
<      _output
---
>      _output = \ pos_ value_ ->pos_, showStrShort value_)
343a848
> 
343a849
> 
343a850
> 
343a851
> 
343a852
> 
343a853
> 
343a854
> 
343a855
> 
343a856
> 
343a857
> 
343a858
> 
343a859
> 
343a860
> 
343a861
> 
343a862
> 
343a863
> 
343a864
> 
343a865
> 
343a866
> 
343a867
> 
343a868
> 
343a869
> 
343a870
> 
343a871
> 
343a872
> 
343a873
> 
343a874
> 
343a875
> 
343a876
> 
343a877
> 
343a878
> 
343a879
> 
343a880
> 
343a881
> 
343a882
> 
343a883
> 
343a884
> 
343a885
> 
343a886
> 
343a887
> 
343a888
> 
343a889
> 
343a890
> 
343a891
> 
343a892
> 
343a893
> 
343a894
> 
343a895
> 
343a896
> 
343a897
> 
343a898
> 
343a899
> 
343a900
> 
343a901
> 
343a902
> 
343a903
> 
343a904
> 
343a905
> 
343a906
> 
343a907
> 
343a908
> 
343a909
> 
343a910
> 
343a911
> 
343a912
> 
343a913
> 
343a914
> 
343a915
> 
343a916
> 
343a917
> 
343a918
> 
343a919
> 
343a920
> 
343a921
> 
343a922
> 
343a923
> 
343a924
> 
343a925
> 
343a926
> 
343a927
> 
343a928
> 
343a929
> 
343a930
> 
343a931
> 
343a932
> 
343a933
> 
343a934
> 
343a935
> 
343a936
> 
343a937
> 
343a938
> 
343a939
> 
343a940
> 
343a941
> 
343a942
> 
343a943
> 
343a944
> 
343a945
> 
343a946
> 
343a947
> 
343a948
> 
343a949
> 
343a950
> 
343a951
> 
343a952
> 
343a953
> 
343a954
> 
343a955
> 
343a956
> 
343a957
> 
343a958
> 
343a959
> 
343a960
> 
343a961
> 
343a962
> 
343a963
> 
343a964
> 
343a965
> 
343a966
> 
343a967
> 
343a968
> 
343a969
> 
343a970
> 
343a971
> 
343a972
> 
343a973
> 
343a974
> 
343a975
> 
343a976
> 
343a977
> 
343a978
> 
343a979
> 
343a980
> 
343a981
> 
343a982
> 
343a983
> 
343a984
> 
343a985
> 
343a986
> 
343a987
> 
343a988
> 
343a989
> 
343a990
> 
343a991
> 
343a992
> 
343a993
> 
343a994
> 
343a995
> 
343a996
> 
343a997
> 
343a998
> 
343a999
> 
343a1000
> 
343a1001
> 
343a1002
> 
343a1003
> 
343a1004
> 
343a1005
> 
343a1006
> 
343a1007
> 
343a1008
> 
343a1009
> 
343a1010
> 
343a1011
> 
343a1012
> 
343a1013
> 
343a1014
> 
343a1015
> 
343a1016
> 
343a1017
> 
343a1018
> 
343a1019
> 
343a1020
> 
343a1021
> 
343a1022
> 
343a1023
> 
343a1024
> 
343a1025
> 
343a1026
> 
343a1027
> 
343a1028
> 
343a1029
> 
343a1030
> 
343a1031
> 
343a1032
> 
343a1033
> 
343a1034
> 
343a1035
> 
343a1036
> 
343a1037
> 
343a1038
> 
343a1039
> 
343a1040
> 
343a1041
> 
343a1042
> 
343a1043
> 
343a1044
> 
343a1045
> 
343a1046
> 
343a1047
> 
343a1048
> 
343a1049
> 
343a1050
> 
343a1051
> 
343a1052
> 
343a1053
> 
343a1054
> 
343a1055
> 
368d1079
<    {-# LINE 51 "src-ag/SemHsTokens.ag" #-}
369d1079
<    rule37 = \ mesg_ pos_ ->
370d1079
<                        {-# LINE 51 "src-ag/SemHsTokens.ag" #-}
371d1079
<                        let m = text mesg_
372d1079
<                        in Seq.singleton (CustomError False pos_ m)
373c1080
<                        {-# LINE 374 "dist/build/SemHsTokens.hs"#-}
---
> 
373a1081
> 
373a1082
> 
373a1083
> 
373a1084
> 
373a1085
> 
375d1086
<    {-# LINE 136 "src-ag/SemHsTokens.ag" #-}
376d1086
<    rule38 = \ pos_ ->
377d1086
<                            {-# LINE 136 "src-ag/SemHsTokens.ag" #-}
378d1086
<                            (pos_, "")
379c1087
<                            {-# LINE 380 "dist/build/SemHsTokens.hs"#-}
---
> 
379a1088
> 
379a1089
> 
379a1090
> 
379a1091
> 
394c1106
<      _output
---
>      _output = \ mesg_ pos_ -> m = text mesg_
394a1107
>                               in Seq.singleton (CustomError False pos_ m)
395a1109
> 
395a1110
> 
395a1111
> 
395a1112
> 
395a1113
> 
395a1114
> 
395a1115
> 
395a1116
> 
395a1117
> 
395a1118
> 
395a1119
> 
395a1120
> 
395a1121
> 
395a1122
> 
395a1123
> 
395a1124
> 
395a1125
> 
395a1126
> 
395a1127
> 
395a1128
> 
395a1129
> 
395a1130
> 
395a1131
> 
395a1132
> 
395a1133
> 
395a1134
> 
395a1135
> 
395a1136
> 
395a1137
> 
395a1138
> 
395a1139
> 
395a1140
> 
395a1141
> 
395a1142
> 
395a1143
> 
395a1144
> 
395a1145
> 
395a1146
> 
395a1147
> 
395a1148
> 
395a1149
> 
395a1150
> 
395a1151
> 
395a1152
> 
395a1153
> 
395a1154
> 
395a1155
> 
395a1156
> 
395a1157
> 
395a1158
> 
395a1159
> 
395a1160
> 
395a1161
> 
395a1162
> 
395a1163
> 
395a1164
> 
395a1165
> 
395a1166
> 
395a1167
> 
395a1168
> 
395a1169
> 
395a1170
> 
395a1171
> 
395a1172
> 
395a1173
> 
395a1174
> 
395a1175
> 
395a1176
> 
395a1177
> 
395a1178
> 
395a1179
> 
395a1180
> 
395a1181
> 
395a1182
> 
395a1183
> 
395a1184
> 
395a1185
> 
395a1186
> 
395a1187
> 
395a1188
> 
395a1189
> 
395a1190
> 
395a1191
>    rule38 = \ pos_ ->      (pos_, "")
395a1192
> 
395a1193
> 
395a1194
> 
395a1195
> 
395a1196
> 
395a1197
> 
395a1198
> 
395a1199
> 
395a1200
> 
395a1201
> 
395a1202
> 
395a1203
> 
395a1204
> 
395a1205
> 
395a1206
> 
395a1207
> 
395a1208
> 
395a1209
> 
395a1210
> 
395a1211
> 
395a1212
> 
395a1213
> 
395a1214
> 
395a1215
> 
395a1216
> 
395a1217
> 
395a1218
> 
395a1219
> 
395a1220
> 
395a1221
> 
395a1222
> 
395a1223
> 
395a1224
> 
395a1225
> 
395a1226
> 
395a1227
> 
395a1228
> 
395a1229
> 
395a1230
> 
395a1231
> 
395a1232
> 
395a1233
> 
395a1234
> 
395a1235
> 
395a1236
> 
395a1237
> 
395a1238
> 
395a1239
> 
395a1240
> 
395a1241
> 
395a1242
> 
395a1243
> 
395a1244
> 
395a1245
> 
395a1246
> 
395a1247
> 
395a1248
> 
395a1249
> 
395a1250
> 
395a1251
> 
395a1252
> 
395a1253
> 
395a1254
> 
395a1255
> 
395a1256
> 
395a1257
> 
395a1258
> 
395a1259
> 
395a1260
> 
395a1261
> 
395a1262
> 
395a1263
> 
395a1264
> 
395a1265
> 
395a1266
> 
395a1267
> 
395a1268
> 
395a1269
> 
395a1270
> 
395a1271
> 
395a1272
> 
395a1273
> 
395a1274
> 
395a1275
> 
395a1276
> 
395a1277
> 
395a1278
> 
395a1279
> 
395a1280
> 
395a1281
> 
395a1282
> 
395a1283
> 
395a1284
> 
395a1285
> 
395a1286
> 
395a1287
> 
395a1288
> 
395a1289
> 
395a1290
> 
395a1291
> 
395a1292
> 
395a1293
> 
395a1294
> 
395a1295
> 
395a1296
> 
395a1297
> 
395a1298
> 
395a1299
> 
395a1300
> 
395a1301
> 
395a1302
> 
395a1303
> 
395a1304
> 
395a1305
> 
395a1306
> 
395a1307
> 
395a1308
> 
395a1309
> 
395a1310
> 
395a1311
> 
395a1312
> 
395a1313
> 
395a1314
> 
395a1315
> 
395a1316
> 
395a1317
> 
395a1318
> 
395a1319
> 
395a1320
> 
395a1321
> 
395a1322
> 
395a1323
> 
395a1324
> 
395a1325
> 
395a1326
> 
395a1327
> 
395a1328
> 
395a1329
> 
395a1330
> 
395a1331
> 
395a1332
> 
395a1333
> 
395a1334
> 
395a1335
> 
395a1336
> 
395a1337
> 
395a1338
> 
395a1339
> 
395a1340
> 
395a1341
> 
395a1342
> 
395a1343
> 
395a1344
> 
395a1345
> 
395a1346
> 
395a1347
> 
395a1348
> 
395a1349
> 
395a1350
> 
395a1351
> 
395a1352
> 
395a1353
> 
395a1354
> 
395a1355
> 
395a1356
> 
395a1357
> 
395a1358
> 
395a1359
> 
395a1360
> 
395a1361
> 
395a1362
> 
395a1363
> 
395a1364
> 
395a1365
> 
395a1366
> 
395a1367
> 
395a1368
> 
395a1369
> 
395a1370
> 
395a1371
> 
395a1372
> 
395a1373
> 
395a1374
> 
395a1375
> 
395a1376
> 
395a1377
> 
395a1378
> 
395a1379
> 
395a1380
> 
395a1381
> 
395a1382
> 
395a1383
> 
395a1384
> 
395a1385
> 
395a1386
> 
395a1387
> 
395a1388
> 
395a1389
> 
395a1390
> 
395a1391
> 
395a1392
> 
395a1393
> 
395a1394
> 
395a1395
> 
395a1396
> 
395a1397
> 
395a1398
> 
395a1399
> 
395a1400
> 
395a1401
> 
395a1402
> 
395a1403
> 
395a1404
> 
395a1405
> 
395a1406
> 
395a1407
> 
395a1408
> 
395a1409
> 
395a1410
> 
395a1411
> 
395a1412
> 
395a1413
> 
395a1414
> 
395a1415
> 
395a1416
> 
395a1417
> 
395a1418
> 
395a1419
> 
395a1420
> 
395a1421
> 
395a1422
> 
395a1423
> 
395a1424
> 
395a1425
> 
395a1426
> 
395a1427
> 
395a1428
> 
395a1429
> 
395a1430
> 
395a1431
> 
395a1432
> 
395a1433
> 
395a1434
> 
395a1435
> 
395a1436
> 
395a1437
> 
395a1438
> 
395a1439
> 
395a1440
> 
395a1441
> 
395a1442
> 
395a1443
> 
395a1444
> 
395a1445
> 
395a1446
> 
395a1447
> 
395a1448
> 
395a1449
> 
395a1450
> 
468d1522
<    {-# LINE 118 "src-ag/SemHsTokens.ag" #-}
469d1522
<    rule44 = \ ((_hdItok) :: (Pos,String)) ((_tlItks) :: [(Pos,String)]) ->
470d1522
<                      {-# LINE 118 "src-ag/SemHsTokens.ag" #-}
471d1522
<                      _hdItok : _tlItks
472c1523
<                      {-# LINE 473 "dist/build/SemHsTokens.hs"#-}
---
> 
472a1524
> 
472a1525
> 
472a1526
> 
472a1527
> 
532c1587
<      _lhsIoptions
---
>      _lhsIoptions = \ ((_hdItok) :: (Pos,String)) ((_tlItks) :: [(Pos,String)]) -> : _tlItks
532a1588
> 
532a1589
> 
532a1590
> 
532a1591
> 
532a1592
> 
532a1593
> 
532a1594
> 
532a1595
> 
532a1596
> 
532a1597
> 
532a1598
> 
532a1599
> 
532a1600
> 
532a1601
> 
532a1602
> 
532a1603
> 
532a1604
> 
532a1605
> 
532a1606
> 
532a1607
> 
532a1608
> 
532a1609
> 
532a1610
> 
532a1611
> 
532a1612
> 
532a1613
> 
532a1614
> 
532a1615
> 
532a1616
> 
532a1617
> 
532a1618
> 
532a1619
> 
532a1620
> 
532a1621
> 
532a1622
> 
532a1623
> 
532a1624
> 
532a1625
> 
532a1626
> 
532a1627
> 
532a1628
> 
532a1629
> 
532a1630
> 
532a1631
> 
532a1632
> 
532a1633
> 
532a1634
> 
532a1635
> 
532a1636
> 
532a1637
> 
532a1638
> 
532a1639
> 
532a1640
> 
532a1641
> 
532a1642
> 
532a1643
> 
532a1644
> 
532a1645
> 
532a1646
> 
532a1647
> 
532a1648
> 
532a1649
> 
532a1650
> 
532a1651
> 
532a1652
> 
532a1653
> 
532a1654
> 
532a1655
> 
532a1656
> 
532a1657
> 
532a1658
> 
532a1659
> 
532a1660
> 
532a1661
> 
532a1662
> 
532a1663
> 
532a1664
> 
532a1665
> 
532a1666
> 
532a1667
> 
532a1668
> 
532a1669
> 
532a1670
> 
532a1671
> 
532a1672
> 
532a1673
> 
532a1674
> 
532a1675
> 
532a1676
> 
532a1677
> 
532a1678
> 
532a1679
> 
532a1680
> 
532a1681
> 
532a1682
> 
532a1683
> 
532a1684
> 
532a1685
> 
532a1686
> 
532a1687
> 
532a1688
> 
532a1689
> 
532a1690
> 
532a1691
> 
532a1692
> 
532a1693
> 
532a1694
> 
532a1695
> 
532a1696
> 
532a1697
> 
532a1698
> 
532a1699
> 
532a1700
> 
532a1701
> 
532a1702
> 
532a1703
> 
532a1704
> 
532a1705
> 
532a1706
> 
532a1707
> 
532a1708
> 
532a1709
> 
532a1710
> 
532a1711
> 
532a1712
> 
532a1713
> 
532a1714
> 
532a1715
> 
532a1716
> 
532a1717
> 
532a1718
> 
532a1719
> 
532a1720
> 
532a1721
> 
532a1722
> 
532a1723
> 
532a1724
> 
532a1725
> 
532a1726
> 
532a1727
> 
532a1728
> 
532a1729
> 
532a1730
> 
532a1731
> 
532a1732
> 
532a1733
> 
532a1734
> 
532a1735
> 
532a1736
> 
532a1737
> 
532a1738
> 
532a1739
> 
532a1740
> 
532a1741
> 
532a1742
> 
532a1743
> 
532a1744
> 
532a1745
> 
532a1746
> 
532a1747
> 
532a1748
> 
532a1749
> 
532a1750
> 
532a1751
> 
532a1752
> 
532a1753
> 
532a1754
> 
532a1755
> 
532a1756
> 
532a1757
> 
532a1758
> 
532a1759
> 
532a1760
> 
532a1761
> 
532a1762
> 
532a1763
> 
532a1764
> 
532a1765
> 
532a1766
> 
532a1767
> 
532a1768
> 
532a1769
> 
532a1770
> 
532a1771
> 
532a1772
> 
532a1773
> 
532a1774
> 
532a1775
> 
532a1776
> 
532a1777
> 
532a1778
> 
532a1779
> 
532a1780
> 
532a1781
> 
532a1782
> 
532a1783
> 
532a1784
> 
532a1785
> 
532a1786
> 
532a1787
> 
532a1788
> 
532a1789
> 
532a1790
> 
532a1791
> 
532a1792
> 
532a1793
> 
532a1794
> 
532a1795
> 
532a1796
> 
532a1797
> 
532a1798
> 
532a1799
> 
532a1800
> 
532a1801
> 
532a1802
> 
532a1803
> 
532a1804
> 
532a1805
> 
532a1806
> 
532a1807
> 
532a1808
> 
532a1809
> 
532a1810
> 
532a1811
> 
532a1812
> 
532a1813
> 
532a1814
> 
532a1815
> 
532a1816
> 
532a1817
> 
532a1818
> 
532a1819
> 
532a1820
> 
532a1821
> 
532a1822
> 
532a1823
> 
532a1824
> 
532a1825
> 
532a1826
> 
532a1827
> 
532a1828
> 
532a1829
> 
532a1830
> 
532a1831
> 
532a1832
> 
532a1833
> 
532a1834
> 
532a1835
> 
532a1836
> 
532a1837
> 
532a1838
> 
532a1839
> 
532a1840
> 
532a1841
> 
532a1842
> 
532a1843
> 
532a1844
> 
532a1845
> 
532a1846
> 
532a1847
> 
532a1848
> 
532a1849
> 
532a1850
> 
532a1851
> 
532a1852
> 
532a1853
> 
532a1854
> 
532a1855
> 
532a1856
> 
532a1857
> 
532a1858
> 
532a1859
> 
532a1860
> 
532a1861
> 
532a1862
> 
532a1863
> 
532a1864
> 
532a1865
> 
532a1866
> 
532a1867
> 
532a1868
> 
532a1869
> 
532a1870
> 
532a1871
> 
532a1872
> 
532a1873
> 
532a1874
> 
532a1875
> 
532a1876
> 
532a1877
> 
532a1878
> 
532a1879
> 
532a1880
> 
532a1881
> 
532a1882
> 
532a1883
> 
532a1884
> 
532a1885
> 
532a1886
> 
532a1887
> 
532a1888
> 
532a1889
> 
532a1890
> 
532a1891
> 
532a1892
> 
532a1893
> 
532a1894
> 
532a1895
> 
532a1896
> 
532a1897
> 
532a1898
> 
532a1899
> 
532a1900
> 
532a1901
> 
532a1902
> 
532a1903
> 
532a1904
> 
532a1905
> 
532a1906
> 
532a1907
> 
532a1908
> 
532a1909
> 
532a1910
> 
532a1911
> 
532a1912
> 
532a1913
> 
532a1914
> 
532a1915
> 
532a1916
> 
532a1917
> 
532a1918
> 
532a1919
> 
532a1920
> 
532a1921
> 
532a1922
> 
532a1923
> 
532a1924
> 
532a1925
> 
532a1926
> 
532a1927
> 
532a1928
> 
532a1929
> 
532a1930
> 
532a1931
> 
532a1932
> 
532a1933
> 
532a1934
> 
532a1935
> 
532a1936
> 
532a1937
> 
532a1938
> 
532a1939
> 
532a1940
> 
532a1941
> 
532a1942
> 
532a1943
> 
532a1944
> 
532a1945
> 
532a1946
> 
532a1947
> 
532a1948
> 
532a1949
> 
532a1950
> 
532a1951
> 
532a1952
> 
532a1953
> 
532a1954
> 
532a1955
> 
532a1956
> 
532a1957
> 
532a1958
> 
532a1959
> 
532a1960
> 
532a1961
> 
532a1962
> 
532a1963
> 
532a1964
> 
532a1965
> 
532a1966
> 
532a1967
> 
532a1968
> 
532a1969
> 
532a1970
> 
532a1971
> 
532a1972
> 
532a1973
> 
532a1974
> 
532a1975
> 
532a1976
> 
532a1977
> 
532a1978
> 
532a1979
> 
532a1980
> 
532a1981
> 
532a1982
> 
532a1983
> 
532a1984
> 
532a1985
> 
532a1986
> 
532a1987
> 
532a1988
> 
532a1989
> 
532a1990
> 
532a1991
> 
532a1992
> 
532a1993
> 
532a1994
> 
532a1995
> 
532a1996
> 
532a1997
> 
532a1998
> 
532a1999
> 
532a2000
> 
532a2001
> 
557d2025
<    {-# LINE 119 "src-ag/SemHsTokens.ag" #-}
558d2025
<    rule65 = \  (_ :: ()) ->
559d2025
<                      {-# LINE 119 "src-ag/SemHsTokens.ag" #-}
560d2025
<                      []
561c2026
<                      {-# LINE 562 "dist/build/SemHsTokens.hs"#-}
---
> 
561a2027
> 
561a2028
> 
561a2029
> 
561a2030
> 
579c2048
<      _output
---
>      _output = \  (_ :: ()) ->]
580a2050
> 
580a2051
> 
580a2052
> 
580a2053
> 
580a2054
> 
580a2055
> 
580a2056
> 
580a2057
> 
580a2058
> 
580a2059
> 
580a2060
> 
580a2061
> 
580a2062
> 
580a2063
> 
580a2064
> 
580a2065
> 
580a2066
> 
580a2067
> 
580a2068
> 
580a2069
> 
580a2070
> 
580a2071
> 
580a2072
> 
580a2073
> 
580a2074
> 
580a2075
> 
580a2076
> 
580a2077
> 
580a2078
> 
580a2079
> 
580a2080
> 
580a2081
> 
580a2082
> 
580a2083
> 
580a2084
> 
580a2085
> 
580a2086
> 
580a2087
> 
580a2088
> 
580a2089
> 
580a2090
> 
580a2091
> 
580a2092
> 
580a2093
> 
580a2094
> 
580a2095
> 
580a2096
> 
580a2097
> 
580a2098
> 
580a2099
> 
580a2100
> 
580a2101
> 
580a2102
> 
580a2103
> 
580a2104
> 
580a2105
> 
580a2106
> 
580a2107
> 
580a2108
> 
580a2109
> 
580a2110
> 
580a2111
> 
580a2112
> 
580a2113
> 
580a2114
> 
580a2115
> 
580a2116
> 
580a2117
> 
580a2118
> 
580a2119
> 
580a2120
> 
580a2121
> 
580a2122
> 
580a2123
> 
580a2124
> 
580a2125
> 
580a2126
> 
580a2127
> 
580a2128
> 
580a2129
> 
580a2130
> 
580a2131
> 
580a2132
> 
580a2133
> 
580a2134
> 
580a2135
> 
580a2136
> 
580a2137
> 
580a2138
> 
580a2139
> 
580a2140
> 
580a2141
> 
580a2142
> 
580a2143
> 
580a2144
> 
580a2145
> 
580a2146
> 
580a2147
> 
580a2148
> 
580a2149
> 
580a2150
> 
580a2151
> 
580a2152
> 
580a2153
> 
580a2154
> 
580a2155
> 
580a2156
> 
580a2157
> 
580a2158
> 
580a2159
> 
580a2160
> 
580a2161
> 
580a2162
> 
580a2163
> 
580a2164
> 
580a2165
> 
580a2166
> 
580a2167
> 
580a2168
> 
580a2169
> 
580a2170
> 
580a2171
> 
580a2172
> 
580a2173
> 
580a2174
> 
580a2175
> 
580a2176
> 
580a2177
> 
580a2178
> 
580a2179
> 
580a2180
> 
580a2181
> 
580a2182
> 
580a2183
> 
580a2184
> 
580a2185
> 
580a2186
> 
580a2187
> 
580a2188
> 
580a2189
> 
580a2190
> 
580a2191
> 
580a2192
> 
580a2193
> 
580a2194
> 
580a2195
> 
580a2196
> 
580a2197
> 
580a2198
> 
580a2199
> 
580a2200
> 
580a2201
> 
580a2202
> 
580a2203
> 
580a2204
> 
580a2205
> 
580a2206
> 
580a2207
> 
580a2208
> 
580a2209
> 
580a2210
> 
580a2211
> 
580a2212
> 
580a2213
> 
580a2214
> 
580a2215
> 
580a2216
> 
580a2217
> 
580a2218
> 
580a2219
> 
580a2220
> 
580a2221
> 
580a2222
> 
580a2223
> 
580a2224
> 
580a2225
> 
580a2226
> 
580a2227
> 
580a2228
> 
580a2229
> 
580a2230
> 
580a2231
> 
580a2232
> 
580a2233
> 
580a2234
> 
580a2235
> 
580a2236
> 
580a2237
> 
580a2238
> 
580a2239
> 
580a2240
> 
580a2241
> 
580a2242
> 
580a2243
> 
580a2244
> 
580a2245
> 
580a2246
> 
580a2247
> 
580a2248
> 
580a2249
> 
580a2250
> 
580a2251
> 
580a2252
> 
580a2253
> 
580a2254
> 
580a2255
> 
580a2256
> 
580a2257
> 
580a2258
> 
580a2259
> 
580a2260
> 
580a2261
> 
580a2262
> 
580a2263
> 
580a2264
> 
580a2265
> 
580a2266
> 
580a2267
> 
580a2268
> 
580a2269
> 
580a2270
> 
580a2271
> 
580a2272
> 
580a2273
> 
580a2274
> 
580a2275
> 
580a2276
> 
580a2277
> 
580a2278
> 
580a2279
> 
580a2280
> 
580a2281
> 
580a2282
> 
580a2283
> 
580a2284
> 
580a2285
> 
580a2286
> 
580a2287
> 
580a2288
> 
580a2289
> 
580a2290
> 
580a2291
> 
580a2292
> 
580a2293
> 
580a2294
> 
580a2295
> 
580a2296
> 
580a2297
> 
580a2298
> 
580a2299
> 
580a2300
> 
580a2301
> 
580a2302
> 
580a2303
> 
580a2304
> 
580a2305
> 
580a2306
> 
580a2307
> 
580a2308
> 
580a2309
> 
580a2310
> 
580a2311
> 
580a2312
> 
580a2313
> 
580a2314
> 
580a2315
> 
580a2316
> 
580a2317
> 
580a2318
> 
580a2319
> 
580a2320
> 
580a2321
> 
580a2322
> 
580a2323
> 
580a2324
> 
580a2325
> 
580a2326
> 
580a2327
> 
580a2328
> 
580a2329
> 
580a2330
> 
580a2331
> 
580a2332
> 
580a2333
> 
580a2334
> 
580a2335
> 
580a2336
> 
580a2337
> 
580a2338
> 
580a2339
> 
580a2340
> 
580a2341
> 
580a2342
> 
580a2343
> 
580a2344
> 
580a2345
> 
580a2346
> 
580a2347
> 
580a2348
> 
580a2349
> 
580a2350
> 
580a2351
> 
580a2352
> 
580a2353
> 
580a2354
> 
580a2355
> 
580a2356
> 
580a2357
> 
580a2358
> 
580a2359
> 
580a2360
> 
580a2361
> 
580a2362
> 
580a2363
> 
580a2364
> 
580a2365
> 
580a2366
> 
580a2367
> 
580a2368
> 
580a2369
> 
580a2370
> 
580a2371
> 
580a2372
> 
580a2373
> 
580a2374
> 
580a2375
> 
580a2376
> 
580a2377
> 
580a2378
> 
580a2379
> 
580a2380
> 
580a2381
> 
580a2382
> 
580a2383
> 
580a2384
> 
580a2385
> 
580a2386
> 
580a2387
> 
580a2388
> 
580a2389
> 
580a2390
> 
580a2391
> 
580a2392
> 
580a2393
> 
580a2394
> 
580a2395
> 
580a2396
> 
580a2397
> 
580a2398
> 
580a2399
> 
580a2400
> 
580a2401
> 
580a2402
> 
580a2403
> 
580a2404
> 
580a2405
> 
580a2406
> 
580a2407
> 
580a2408
> 
580a2409
> 
580a2410
> 
580a2411
> 
580a2412
> 
580a2413
> 
580a2414
> 
580a2415
> 
580a2416
> 
580a2417
> 
580a2418
> 
580a2419
> 
580a2420
> 
580a2421
> 
580a2422
> 
580a2423
> 
580a2424
> 
580a2425
> 
580a2426
> 
580a2427
> 
580a2428
> 
580a2429
> 
580a2430
> 
580a2431
> 
580a2432
> 
580a2433
> 
580a2434
> 
580a2435
> 
580a2436
> 
580a2437
> 
580a2438
> 
580a2439
> 
580a2440
> 
580a2441
> 
580a2442
> 
580a2443
> 
580a2444
> 
580a2445
> 
580a2446
> 
580a2447
> 
580a2448
> 
580a2449
> 
580a2450
> 
580a2451
> 
580a2452
> 
580a2453
> 
580a2454
> 
580a2455
> 
580a2456
> 
580a2457
> 
580a2458
> 
580a2459
> 
580a2460
> 
580a2461
> 
580a2462
> 
580a2463
> 
580a2464
> 
580a2465
> 
580a2466
> 
580a2467
> 
580a2468
> 
580a2469
> 
580a2470
> 
580a2471
> 
580a2472
> 
580a2473
> 
580a2474
> 
580a2475
> 
580a2476
> 
580a2477
> 
580a2478
> 
580a2479
> 
580a2480
> 
580a2481
> 
580a2482
> 
580a2483
> 
580a2484
> 
580a2485
> 
580a2486
> 
580a2487
> 
580a2488
> 
580a2489
> 
580a2490
> 
580a2491
> 
580a2492
> 
580a2493
> 
580a2494
> 
580a2495
> 
580a2496
> 
580a2497
> 
580a2498
> 
580a2499
> 
580a2500
> 
580a2501
> 
580a2502
> 
580a2503
> 
580a2504
> 
580a2505
> 
580a2506
> 
580a2507
> 
580a2508
> 
580a2509
> 
643d2571
<    {-# LINE 39 "src-ag/SemHsTokens.ag" #-}
644d2571
<    rule72 = \ ((_lhsIallfields) :: [(Identifier,Type,ChildKind)]) ->
645d2571
<                                        {-# LINE 39 "src-ag/SemHsTokens.ag" #-}
646d2571
<                                        map (\(n,_,_) -> n) _lhsIallfields
647c2572
<                                        {-# LINE 648 "dist/build/SemHsTokens.hs"#-}
---
> 
647a2573
> 
647a2574
> 
647a2575
> 
647a2576
> 
649d2577
<    {-# LINE 108 "src-ag/SemHsTokens.ag" #-}
650d2577
<    rule73 = \ ((_tokensIusedFields) :: Seq Identifier) ->
651d2577
<                                     {-# LINE 108 "src-ag/SemHsTokens.ag" #-}
652d2577
<                                     toList _tokensIusedFields
653c2578
<                                     {-# LINE 654 "dist/build/SemHsTokens.hs"#-}
---
> 
653a2579
> 
653a2580
> 
653a2581
> 
653a2582
> 
655d2583
<    {-# LINE 115 "src-ag/SemHsTokens.ag" #-}
656d2583
<    rule74 = \ ((_tokensItks) :: [(Pos,String)]) ->
657d2583
<                                    {-# LINE 115 "src-ag/SemHsTokens.ag" #-}
658d2583
<                                    showTokens _tokensItks
659c2584
<                                    {-# LINE 660 "dist/build/SemHsTokens.hs"#-}
---
> 
659a2585
> 
659a2586
> 
659a2587
> 
659a2588
> 
689c2618
<      _lhsIoptions
---
>      _lhsIoptions = \ ((_lhsIallfields) :: [(Identifier,Type,ChildKind)]) -> (\(n,_,_) -> n) _lhsIallfields
689a2619
> 
689a2620
> 
689a2621
> 
689a2622
> 
689a2623
> 
689a2624
> 
689a2625
> 
689a2626
> 
689a2627
> 
689a2628
> 
689a2629
> 
689a2630
> 
689a2631
> 
689a2632
> 
689a2633
> 
689a2634
> 
689a2635
> 
689a2636
> 
689a2637
> 
689a2638
> 
689a2639
> 
689a2640
> 
689a2641
> 
689a2642
> 
689a2643
> 
689a2644
> 
689a2645
> 
689a2646
> 
689a2647
> 
689a2648
> 
689a2649
> 
689a2650
> 
689a2651
> 
689a2652
> 
689a2653
> 
689a2654
> 
689a2655
> 
689a2656
> 
689a2657
> 
689a2658
> 
689a2659
> 
689a2660
> 
689a2661
> 
689a2662
> 
689a2663
> 
689a2664
> 
689a2665
> 
689a2666
> 
689a2667
> 
689a2668
> 
689a2669
> 
689a2670
> 
689a2671
> 
689a2672
> 
689a2673
> 
689a2674
> 
689a2675
> 
689a2676
> 
689a2677
> 
689a2678
> 
689a2679
> 
689a2680
> 
689a2681
> 
689a2682
> 
689a2683
> 
689a2684
> 
689a2685
> 
689a2686
> 
689a2687
>    rule73 = \ ((_tokensIusedFields) :: Seq Identifier) -> _tokensIusedFields
689a2688
> 
689a2689
> 
689a2690
> 
689a2691
> 
689a2692
> 
689a2693
> 
689a2694
>    rule74 = \ ((_tokensItks) :: [(Pos,String)]) -> _tokensItks
689a2695
> 
689a2696
> 
689a2697
> 
689a2698
> 
689a2699
> 
689a2700
> 
689a2701
> 
689a2702
> 
689a2703
> 
689a2704
> 
689a2705
> 
689a2706
> 
689a2707
> 
689a2708
> 
689a2709
> 
689a2710
> 
689a2711
> 
689a2712
> 
689a2713
> 
689a2714
> 
689a2715
> 
689a2716
> 
689a2717
> 
689a2718
> 
689a2719
> 
689a2720
> 
689a2721
> 
689a2722
> 
689a2723
> 
689a2724
> 
689a2725
> 
689a2726
> 
689a2727
> 
689a2728
> 
689a2729
> 
689a2730
> 
689a2731
> 
689a2732
> 
689a2733
> 
689a2734
> 
689a2735
> 
689a2736
> 
689a2737
> 
689a2738
> 
689a2739
> 
689a2740
> 
689a2741
> 
689a2742
> 
689a2743
> 
689a2744
> 
689a2745
> 
689a2746
> 
689a2747
> 
689a2748
> 
689a2749
> 
689a2750
> 
689a2751
> 
689a2752
> 
689a2753
> 
689a2754
> 
689a2755
> 
689a2756
> 
689a2757
> 
689a2758
> 
689a2759
> 
689a2760
> 
689a2761
> 
689a2762
> 
689a2763
> 
689a2764
> 
689a2765
> 
689a2766
> 
689a2767
> 
689a2768
> 
689a2769
> 
689a2770
> 
689a2771
> 
689a2772
> 
689a2773
> 
689a2774
> 
689a2775
> 
689a2776
> 
689a2777
> 
689a2778
> 
689a2779
> 
689a2780
> 
689a2781
> 
689a2782
> 
689a2783
> 
689a2784
> 
689a2785
> 
689a2786
> 
689a2787
> 
689a2788
> 
689a2789
> 
689a2790
> 
689a2791
> 
689a2792
> 
689a2793
> 
689a2794
> 
689a2795
> 
689a2796
> 
689a2797
> 
689a2798
> 
689a2799
> 
689a2800
> 
689a2801
> 
689a2802
> 
689a2803
> 
689a2804
> 
689a2805
> 
689a2806
> 
689a2807
> 
689a2808
> 
689a2809
> 
689a2810
> 
689a2811
> 
689a2812
> 
689a2813
> 
689a2814
> 
689a2815
> 
689a2816
> 
689a2817
> 
689a2818
> 
689a2819
> 
689a2820
> 
689a2821
> 
689a2822
> 
689a2823
> 
689a2824
> 
689a2825
> 
689a2826
> 
689a2827
> 
689a2828
> 
689a2829
> 
689a2830
> 
689a2831
> 
689a2832
> 
689a2833
> 
689a2834
> 
689a2835
> 
689a2836
> 
689a2837
> 
689a2838
> 
689a2839
> 
689a2840
> 
689a2841
> 
689a2842
> 
689a2843
> 
689a2844
> 
689a2845
> 
689a2846
> 
689a2847
> 
689a2848
> 
689a2849
> 
689a2850
> 
689a2851
> 
689a2852
> 
689a2853
> 
689a2854
> 
689a2855
> 
689a2856
> 
689a2857
> 
689a2858
> 
689a2859
> 
689a2860
> 
689a2861
> 
689a2862
> 
689a2863
> 
689a2864
> 
689a2865
> 
689a2866
> 
689a2867
> 
689a2868
> 
689a2869
> 
689a2870
> 
689a2871
> 
689a2872
> 
689a2873
> 
689a2874
> 
689a2875
> 
689a2876
> 
689a2877
> 
689a2878
> 
689a2879
> 
689a2880
> 
689a2881
> 
689a2882
> 
689a2883
> 
689a2884
> 
689a2885
> 
689a2886
> 
689a2887
> 
689a2888
> 
689a2889
> 
689a2890
> 
689a2891
> 
689a2892
> 
689a2893
> 
689a2894
> 
689a2895
> 
689a2896
> 
689a2897
> 
689a2898
> 
689a2899
> 
689a2900
> 
689a2901
> 
689a2902
> 
689a2903
> 
689a2904
> 
689a2905
> 
689a2906
> 
689a2907
> 
689a2908
> 
689a2909
> 
689a2910
> 
689a2911
> 
689a2912
> 
689a2913
> 
689a2914
> 
689a2915
> 
689a2916
> 
689a2917
> 
689a2918
> 
689a2919
> 
689a2920
> 
689a2921
> 
689a2922
> 
689a2923
> 
689a2924
> 
689a2925
> 
689a2926
> 
689a2927
> 
689a2928
> 
689a2929
> 
689a2930
> 
689a2931
> 
689a2932
> 
689a2933
> 
689a2934
> 
689a2935
> 
689a2936
> 
689a2937
> 
689a2938
> 
689a2939
> 
689a2940
> 
689a2941
> 
689a2942
> 
689a2943
> 
689a2944
> 
689a2945
> 
689a2946
> 
689a2947
> 
689a2948
> 
689a2949
> 
689a2950
> 
689a2951
> 
689a2952
> 
689a2953
> 
689a2954
> 
689a2955
> 
689a2956
> 
689a2957
> 
689a2958
> 
689a2959
> 
689a2960
> 
689a2961
> 
689a2962
> 
689a2963
> 
689a2964
> 
689a2965
> 
689a2966
> 
689a2967
> 
689a2968
> 
689a2969
> 
689a2970
> 
689a2971
> 
689a2972
> 
689a2973
> 
689a2974
> 
689a2975
> 
689a2976
> 
689a2977
> 
689a2978
> 
689a2979
> 
689a2980
> 
689a2981
> 
689a2982
> 
689a2983
> 
689a2984
> 
689a2985
> 
689a2986
> 
689a2987
> 
689a2988
> 
689a2989
> 
689a2990
> 
689a2991
> 
689a2992
> 
689a2993
> 
689a2994
> 
689a2995
> 
689a2996
> 
689a2997
> 
689a2998
> 
689a2999
> 
689a3000
> 
689a3001
> 
689a3002
> 
689a3003
> 
689a3004
> 
689a3005
> 
689a3006
> 
689a3007
> 
689a3008
> 
689a3009
> 
689a3010
> 
689a3011
> 
689a3012
> 
689a3013
> 
689a3014
> 
689a3015
> 
689a3016
> 
689a3017
> 
689a3018
> 
689a3019
> 
689a3020
> 
689a3021
> 
689a3022
> 
689a3023
> 
689a3024
> 
689a3025
> 
689a3026
> 
689a3027
> 
689a3028
> 
689a3029
> 
689a3030
> 
689a3031
> 
689a3032
> 
689a3033
> 
689a3034
> 
689a3035
> 
689a3036
> 
689a3037
> 
689a3038
> 
689a3039
> 
689a3040
> 
689a3041
> 
689a3042
> 
689a3043
> 
689a3044
> 
689a3045
> 
689a3046
> 
689a3047
> 
689a3048
> 
689a3049
> 
689a3050
> 
689a3051
> 
689a3052
> 
689a3053
> 
689a3054
> 
689a3055
> 
689a3056
> 
689a3057
> 
689a3058
> 
689a3059
> 
689a3060
> 
689a3061
> 
689a3062
> 
689a3063
> 
689a3064
> 
689a3065
> 
689a3066
> 
689a3067
> 
689a3068
> 
689a3069
> 
689a3070
> 
689a3071
> 
689a3072
> 
689a3073
> 
689a3074
> 
689a3075
> 
689a3076
> 
689a3077
> 
689a3078
> 
689a3079
> 
689a3080
> 
689a3081
> 
689a3082
> 
689a3083
> 
689a3084
> 
689a3085
> 
689a3086
> 
689a3087
> 
689a3088
> 
689a3089
> 
689a3090
> 
689a3091
> 
689a3092
> 
689a3093
> 
689a3094
> 
689a3095
> 
689a3096
> 
689a3097
> 
689a3098
> 
689a3099
> 
689a3100
> 
689a3101
> 
689a3102
> 
689a3103
> 
689a3104
> 
689a3105
> 
689a3106
> 
689a3107
> 
689a3108
> 
689a3109
> 
689a3110
> 
689a3111
> 
689a3112
> 
689a3113
> 
689a3114
> 
689a3115
> 
689a3116
> 
689a3117
> 
689a3118
> 
689a3119
> 
689a3120
> 
689a3121
> 
689a3122
> 
689a3123
> 
689a3124
> 
689a3125
> 
689a3126
> 
689a3127
> 
689a3128
> 
689a3129
> 
689a3130
> 
689a3131
> 
689a3132
> 
689a3133
> 
689a3134
> 
689a3135
> 
689a3136
> 
689a3137
> 
689a3138
> 
689a3139
> 
689a3140
> 
689a3141
> 
689a3142
> 
689a3143
> 
689a3144
> 
689a3145
> 
689a3146
> 
689a3147
> 
689a3148
> 
689a3149
> 
689a3150
> 
689a3151
> 
689a3152
> 
689a3153
> 
689a3154
> 
689a3155
> 
689a3156
> 
689a3157
> 
689a3158
> 
689a3159
> 
689a3160
> 
689a3161
> 
689a3162
> 
689a3163
> 
689a3164
> 
689a3165
> 
689a3166
> 
689a3167
> 
689a3168
> 
689a3169
> 
689a3170
> 
689a3171
> 
689a3172
> 
689a3173
> 
689a3174
> 
689a3175
> 
689a3176
> 
689a3177
> 
689a3178
> 
689a3179
> 
689a3180
> 
689a3181
> 
689a3182
> 
689a3183
> 
689a3184
> 
689a3185
> 
689a3186
> 
689a3187
> 
689a3188
> 
689a3189
> 
689a3190
> 
689a3191
> 
689a3192
> 
689a3193
> 
689a3194
> 
689a3195
> 
689a3196
> 
689a3197
> 
689a3198
> 
689a3199
> 
689a3200
> 
689a3201
> 
689a3202
> 
689a3203
> 
689a3204
> 
689a3205
> 
689a3206
> 
689a3207
> 
689a3208
> 
689a3209
> 
689a3210
> 
689a3211
> 
689a3212
> 
689a3213
> 
689a3214
> 
689a3215
> 
689a3216
> 
689a3217
> 
689a3218
> 
689a3219
> 
689a3220
> 
689a3221
> 
689a3222
> 
689a3223
> 
689a3224
> 
689a3225
> 
689a3226
> 
689a3227
> 
689a3228
> 
689a3229
> 
689a3230
> 
689a3231
> 
689a3232
> 
689a3233
> 
689a3234
> 
689a3235
> 
689a3236
> 
689a3237
> 
689a3238
> 
689a3239
> 
689a3240
> 
689a3241
> 
689a3242
> 
689a3243
> 
689a3244
> 
689a3245
> 
689a3246
> 
689a3247
> 
689a3248
> 
689a3249
> 
689a3250
> 
689a3251
> 
689a3252
> 
689a3253
> 
689a3254
> 
689a3255
> 
689a3256
> 
689a3257
> 
689a3258
> 
689a3259
> 
689a3260
> 
689a3261
> 
689a3262
> 
689a3263
> 
689a3264
> 
689a3265
> 
689a3266
> 
689a3267
> 
689a3268
> 
689a3269
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE Rank2Types, GADTs #-}
{-# LANGUAGE ScopedTypeVariables #-}

module SemHsTokens where
{-# LINE 2 "src-ag/HsToken.ag" #-}

import CommonTypes
import UU.Scanner.Position(Pos)
{-# LINE 10 "dist/build/SemHsTokens.hs" #-}

{-# LINE 4 "src-ag/SemHsTokens.ag" #-}

import qualified Data.Sequence as Seq
import Data.Sequence(Seq,empty,singleton,(><))
import Data.Foldable(toList)
import Pretty

import TokenDef
import HsToken
import ErrorMessages
{-# LINE 22 "dist/build/SemHsTokens.hs" #-}
import Control.Monad.Identity (Identity)
import qualified Control.Monad.Identity
{-# LINE 58 "src-ag/SemHsTokens.ag" #-}

isNTname allnts (Just (NT nt _ _)) = nt `elem` allnts
isNTname allnts _                  = False
{-# LINE 29 "dist/build/SemHsTokens.hs" #-}
-- HsToken -----------------------------------------------------
-- wrapper
data Inh_HsToken  = Inh_HsToken { allfields_Inh_HsToken :: ([(Identifier,Type,ChildKind)]), allnts_Inh_HsToken :: ([Identifier]), attrs_Inh_HsToken :: ([(Identifier,Identifier)]), con_Inh_HsToken :: (Identifier), fieldnames_Inh_HsToken :: ([Identifier]), nt_Inh_HsToken :: (Identifier), options_Inh_HsToken :: (Options) }
data Syn_HsToken  = Syn_HsToken { errors_Syn_HsToken :: (Seq Error), output_Syn_HsToken :: (HsToken), tok_Syn_HsToken :: ((Pos,String)), usedAttrs_Syn_HsToken :: ([(Identifier,Identifier)]), usedFields_Syn_HsToken :: (Seq Identifier), usedLocals_Syn_HsToken :: ([Identifier]) }
{-# INLINABLE wrap_HsToken #-}
wrap_HsToken :: T_HsToken  -> Inh_HsToken  -> (Syn_HsToken )
wrap_HsToken (T_HsToken act) (Inh_HsToken _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) =
   Control.Monad.Identity.runIdentity (
     do sem <- act
        let arg1 = T_HsToken_vIn1 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions
        (T_HsToken_vOut1 _lhsOerrors _lhsOoutput _lhsOtok _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals) <- return (inv_HsToken_s2 sem arg1)
        return (Syn_HsToken _lhsOerrors _lhsOoutput _lhsOtok _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals)
   )

-- cata
{-# NOINLINE sem_HsToken #-}
sem_HsToken :: HsToken  -> T_HsToken
sem_HsToken ( AGLocal var_ pos_ rdesc_ ) = sem_HsToken_AGLocal var_ pos_ rdesc_
sem_HsToken ( AGField field_ attr_ pos_ rdesc_ ) = sem_HsToken_AGField field_ attr_ pos_ rdesc_
sem_HsToken ( HsToken value_ pos_ ) = sem_HsToken_HsToken value_ pos_
sem_HsToken ( CharToken value_ pos_ ) = sem_HsToken_CharToken value_ pos_
sem_HsToken ( StrToken value_ pos_ ) = sem_HsToken_StrToken value_ pos_
sem_HsToken ( Err mesg_ pos_ ) = sem_HsToken_Err mesg_ pos_

-- semantic domain
newtype T_HsToken  = T_HsToken {
                               attach_T_HsToken :: Identity (T_HsToken_s2 )
                               }
newtype T_HsToken_s2  = C_HsToken_s2 {
                                     inv_HsToken_s2 :: (T_HsToken_v1 )
                                     }
data T_HsToken_s3  = C_HsToken_s3
type T_HsToken_v1  = (T_HsToken_vIn1 ) -> (T_HsToken_vOut1 )
data T_HsToken_vIn1  = T_HsToken_vIn1 ([(Identifier,Type,ChildKind)]) ([Identifier]) ([(Identifier,Identifier)]) (Identifier) ([Identifier]) (Identifier) (Options)
data T_HsToken_vOut1  = T_HsToken_vOut1 (Seq Error) (HsToken) ((Pos,String)) ([(Identifier,Identifier)]) (Seq Identifier) ([Identifier])
{-# NOINLINE sem_HsToken_AGLocal #-}
sem_HsToken_AGLocal :: (Identifier) -> (Pos) -> (Maybe String) -> T_HsToken
sem_HsToken_AGLocal arg_var_ arg_pos_ arg_rdesc_ = T_HsToken (return st2) where
   {-# NOINLINE st2 #-}
   st2 = let
      v1 :: T_HsToken_v1
      v1 = \ (T_HsToken_vIn1 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) -> ( let
         _tkAsLocal = rule0 arg_pos_ arg_rdesc_ arg_var_
         _tkAsField = rule1 arg_pos_ arg_rdesc_ arg_var_
         (_errors,_output,_tok,_usedLocals) = rule2 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions _tkAsField _tkAsLocal arg_pos_ arg_var_
         _lhsOusedFields :: Seq Identifier
         _lhsOusedFields = rule3 _lhsIfieldnames arg_var_
         _lhsOerrors :: Seq Error
         _lhsOerrors = rule4 _errors
         _lhsOusedAttrs :: [(Identifier,Identifier)]
         _lhsOusedAttrs = rule5  ()
         _lhsOusedLocals :: [Identifier]
         _lhsOusedLocals = rule6 _usedLocals
         _lhsOoutput :: HsToken
         _lhsOoutput = rule7 _output
         _lhsOtok :: (Pos,String)
         _lhsOtok = rule8 _tok
         __result_ = T_HsToken_vOut1 _lhsOerrors _lhsOoutput _lhsOtok _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals
         in __result_ )
     in C_HsToken_s2 v1
   {-# INLINE rule0 #-}
   {-# LINE 66 "src-ag/SemHsTokens.ag" #-}
   rule0 = \ pos_ rdesc_ var_ ->
                                {-# LINE 66 "src-ag/SemHsTokens.ag" #-}
                                AGLocal var_ pos_ rdesc_
                                {-# LINE 95 "dist/build/SemHsTokens.hs"#-}
   {-# INLINE rule1 #-}
   {-# LINE 67 "src-ag/SemHsTokens.ag" #-}
   rule1 = \ pos_ rdesc_ var_ ->
                                {-# LINE 67 "src-ag/SemHsTokens.ag" #-}
                                AGField _LOC var_ pos_ rdesc_
                                {-# LINE 101 "dist/build/SemHsTokens.hs"#-}
   {-# INLINE rule2 #-}
   {-# LINE 69 "src-ag/SemHsTokens.ag" #-}
   rule2 = \ ((_lhsIallfields) :: [(Identifier,Type,ChildKind)]) ((_lhsIallnts) :: [Identifier]) ((_lhsIattrs) :: [(Identifier,Identifier)]) ((_lhsIcon) :: Identifier) ((_lhsIfieldnames) :: [Identifier]) ((_lhsInt) :: Identifier) ((_lhsIoptions) :: Options) _tkAsField _tkAsLocal pos_ var_ ->
                       {-# LINE 69 "src-ag/SemHsTokens.ag" #-}
                       if var_ `elem` _lhsIfieldnames
                       then if  isNTname _lhsIallnts (lookup var_ (map (\(n,t,_) -> (n,t)) _lhsIallfields))
                            then (Seq.singleton(ChildAsLocal _lhsInt _lhsIcon var_), _tkAsLocal    ,(pos_,fieldname var_), []    )
                            else (Seq.empty, _tkAsLocal    , (pos_,fieldname var_), []    )
                       else if (_LOC,var_) `elem` _lhsIattrs
                            then (Seq.empty                                      , _tkAsField    , (pos_,locname _lhsIoptions var_), [var_])
                            else (Seq.singleton(UndefLocal _lhsInt _lhsIcon var_), _tkAsField    , (pos_,locname _lhsIoptions var_), []    )
                       {-# LINE 113 "dist/build/SemHsTokens.hs"#-}
   {-# INLINE rule3 #-}
   {-# LINE 104 "src-ag/SemHsTokens.ag" #-}
   rule3 = \ ((_lhsIfieldnames) :: [Identifier]) var_ ->
                               {-# LINE 104 "src-ag/SemHsTokens.ag" #-}
                               if var_ `elem` _lhsIfieldnames
                                then Seq.singleton var_
                                else Seq.empty
                               {-# LINE 121 "dist/build/SemHsTokens.hs"#-}
   {-# INLINE rule4 #-}
   rule4 = \ _errors ->
     _errors
   {-# INLINE rule5 #-}
   rule5 = \  (_ :: ()) ->
     []
   {-# INLINE rule6 #-}
   rule6 = \ _usedLocals ->
     _usedLocals
   {-# INLINE rule7 #-}
   rule7 = \ _output ->
     _output
   {-# INLINE rule8 #-}
   rule8 = \ _tok ->
     _tok
{-# NOINLINE sem_HsToken_AGField #-}
sem_HsToken_AGField :: (Identifier) -> (Identifier) -> (Pos) -> (Maybe String) -> T_HsToken
sem_HsToken_AGField arg_field_ arg_attr_ arg_pos_ arg_rdesc_ = T_HsToken (return st2) where
   {-# NOINLINE st2 #-}
   st2 = let
      v1 :: T_HsToken_v1
      v1 = \ (T_HsToken_vIn1 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) -> ( let
         _lhsOerrors :: Seq Error
         _lhsOerrors = rule9 _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt arg_attr_ arg_field_
         _lhsOusedAttrs :: [(Identifier,Identifier)]
         _lhsOusedLocals :: [Identifier]
         (_lhsOusedAttrs,_lhsOusedLocals) = rule10 arg_attr_ arg_field_
         _addTrace = rule11 arg_attr_ arg_field_ arg_rdesc_
         _lhsOtok :: (Pos,String)
         _lhsOtok = rule12 _addTrace _lhsIoptions arg_attr_ arg_field_ arg_pos_
         _lhsOusedFields :: Seq Identifier
         _lhsOusedFields = rule13  ()
         _output = rule14 arg_attr_ arg_field_ arg_pos_ arg_rdesc_
         _lhsOoutput :: HsToken
         _lhsOoutput = rule15 _output
         __result_ = T_HsToken_vOut1 _lhsOerrors _lhsOoutput _lhsOtok _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals
         in __result_ )
     in C_HsToken_s2 v1
   {-# INLINE rule9 #-}
   {-# LINE 78 "src-ag/SemHsTokens.ag" #-}
   rule9 = \ ((_lhsIattrs) :: [(Identifier,Identifier)]) ((_lhsIcon) :: Identifier) ((_lhsIfieldnames) :: [Identifier]) ((_lhsInt) :: Identifier) attr_ field_ ->
                             {-# LINE 78 "src-ag/SemHsTokens.ag" #-}
                             if (field_,attr_) `elem` _lhsIattrs
                             then Seq.empty
                             else if not(field_ `elem` (_LHS : _LOC: _lhsIfieldnames))
                                  then Seq.singleton (UndefChild _lhsInt _lhsIcon field_)
                                  else Seq.singleton (UndefAttr _lhsInt _lhsIcon field_ attr_ False)
                             {-# LINE 169 "dist/build/SemHsTokens.hs"#-}
   {-# INLINE rule10 #-}
   {-# LINE 93 "src-ag/SemHsTokens.ag" #-}
   rule10 = \ attr_ field_ ->
                  {-# LINE 93 "src-ag/SemHsTokens.ag" #-}
                  if field_ == _LOC
                  then ([], [attr_])
                  else ([(field_,attr_)], [])
                  {-# LINE 177 "dist/build/SemHsTokens.hs"#-}
   {-# INLINE rule11 #-}
   {-# LINE 123 "src-ag/SemHsTokens.ag" #-}
   rule11 = \ attr_ field_ rdesc_ ->
                        {-# LINE 123 "src-ag/SemHsTokens.ag" #-}
                        case rdesc_ of
                          Just d  -> \x -> "(trace " ++ show (d ++ " -> " ++ show field_ ++ "." ++ show attr_) ++ " (" ++ x ++ "))"
                          Nothing -> id
                        {-# LINE 185 "dist/build/SemHsTokens.hs"#-}
   {-# INLINE rule12 #-}
   {-# LINE 126 "src-ag/SemHsTokens.ag" #-}
   rule12 = \ _addTrace ((_lhsIoptions) :: Options) attr_ field_ pos_ ->
                   {-# LINE 126 "src-ag/SemHsTokens.ag" #-}
                   (pos_, _addTrace     $ attrname _lhsIoptions True field_ attr_)
                   {-# LINE 191 "dist/build/SemHsTokens.hs"#-}
   {-# INLINE rule13 #-}
   rule13 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule14 #-}
   rule14 = \ attr_ field_ pos_ rdesc_ ->
     AGField field_ attr_ pos_ rdesc_
   {-# INLINE rule15 #-}
   rule15 = \ _output ->
     _output
{-# NOINLINE sem_HsToken_HsToken #-}
sem_HsToken_HsToken :: (String) -> (Pos) -> T_HsToken
sem_HsToken_HsToken arg_value_ arg_pos_ = T_HsToken (return st2) where
   {-# NOINLINE st2 #-}
   st2 = let
      v1 :: T_HsToken_v1
      v1 = \ (T_HsToken_vIn1 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) -> ( let
         _lhsOtok :: (Pos,String)
         _lhsOtok = rule16 arg_pos_ arg_value_
         _lhsOerrors :: Seq Error
         _lhsOerrors = rule17  ()
         _lhsOusedAttrs :: [(Identifier,Identifier)]
         _lhsOusedAttrs = rule18  ()
         _lhsOusedFields :: Seq Identifier
         _lhsOusedFields = rule19  ()
         _lhsOusedLocals :: [Identifier]
         _lhsOusedLocals = rule20  ()
         _output = rule21 arg_pos_ arg_value_
         _lhsOoutput :: HsToken
         _lhsOoutput = rule22 _output
         __result_ = T_HsToken_vOut1 _lhsOerrors _lhsOoutput _lhsOtok _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals
         in __result_ )
     in C_HsToken_s2 v1
   {-# INLINE rule16 #-}
   {-# LINE 128 "src-ag/SemHsTokens.ag" #-}
   rule16 = \ pos_ value_ ->
                         {-# LINE 128 "src-ag/SemHsTokens.ag" #-}
                         (pos_, value_)
                         {-# LINE 229 "dist/build/SemHsTokens.hs"#-}
   {-# INLINE rule17 #-}
   rule17 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule18 #-}
   rule18 = \  (_ :: ()) ->
     []
   {-# INLINE rule19 #-}
   rule19 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule20 #-}
   rule20 = \  (_ :: ()) ->
     []
   {-# INLINE rule21 #-}
   rule21 = \ pos_ value_ ->
     HsToken value_ pos_
   {-# INLINE rule22 #-}
   rule22 = \ _output ->
     _output
{-# NOINLINE sem_HsToken_CharToken #-}
sem_HsToken_CharToken :: (String) -> (Pos) -> T_HsToken
sem_HsToken_CharToken arg_value_ arg_pos_ = T_HsToken (return st2) where
   {-# NOINLINE st2 #-}
   st2 = let
      v1 :: T_HsToken_v1
      v1 = \ (T_HsToken_vIn1 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) -> ( let
         _lhsOtok :: (Pos,String)
         _lhsOtok = rule23 arg_pos_ arg_value_
         _lhsOerrors :: Seq Error
         _lhsOerrors = rule24  ()
         _lhsOusedAttrs :: [(Identifier,Identifier)]
         _lhsOusedAttrs = rule25  ()
         _lhsOusedFields :: Seq Identifier
         _lhsOusedFields = rule26  ()
         _lhsOusedLocals :: [Identifier]
         _lhsOusedLocals = rule27  ()
         _output = rule28 arg_pos_ arg_value_
         _lhsOoutput :: HsToken
         _lhsOoutput = rule29 _output
         __result_ = T_HsToken_vOut1 _lhsOerrors _lhsOoutput _lhsOtok _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals
         in __result_ )
     in C_HsToken_s2 v1
   {-# INLINE rule23 #-}
   {-# LINE 130 "src-ag/SemHsTokens.ag" #-}
   rule23 = \ pos_ value_ ->
                           {-# LINE 130 "src-ag/SemHsTokens.ag" #-}
                           (pos_, if null value_
                                     then ""
                                     else showCharShort (head value_)
                           )
                           {-# LINE 279 "dist/build/SemHsTokens.hs"#-}
   {-# INLINE rule24 #-}
   rule24 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule25 #-}
   rule25 = \  (_ :: ()) ->
     []
   {-# INLINE rule26 #-}
   rule26 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule27 #-}
   rule27 = \  (_ :: ()) ->
     []
   {-# INLINE rule28 #-}
   rule28 = \ pos_ value_ ->
     CharToken value_ pos_
   {-# INLINE rule29 #-}
   rule29 = \ _output ->
     _output
{-# NOINLINE sem_HsToken_StrToken #-}
sem_HsToken_StrToken :: (String) -> (Pos) -> T_HsToken
sem_HsToken_StrToken arg_value_ arg_pos_ = T_HsToken (return st2) where
   {-# NOINLINE st2 #-}
   st2 = let
      v1 :: T_HsToken_v1
      v1 = \ (T_HsToken_vIn1 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) -> ( let
         _lhsOtok :: (Pos,String)
         _lhsOtok = rule30 arg_pos_ arg_value_
         _lhsOerrors :: Seq Error
         _lhsOerrors = rule31  ()
         _lhsOusedAttrs :: [(Identifier,Identifier)]
         _lhsOusedAttrs = rule32  ()
         _lhsOusedFields :: Seq Identifier
         _lhsOusedFields = rule33  ()
         _lhsOusedLocals :: [Identifier]
         _lhsOusedLocals = rule34  ()
         _output = rule35 arg_pos_ arg_value_
         _lhsOoutput :: HsToken
         _lhsOoutput = rule36 _output
         __result_ = T_HsToken_vOut1 _lhsOerrors _lhsOoutput _lhsOtok _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals
         in __result_ )
     in C_HsToken_s2 v1
   {-# INLINE rule30 #-}
   {-# LINE 135 "src-ag/SemHsTokens.ag" #-}
   rule30 = \ pos_ value_ ->
                           {-# LINE 135 "src-ag/SemHsTokens.ag" #-}
                           (pos_, showStrShort value_)
                           {-# LINE 326 "dist/build/SemHsTokens.hs"#-}
   {-# INLINE rule31 #-}
   rule31 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule32 #-}
   rule32 = \  (_ :: ()) ->
     []
   {-# INLINE rule33 #-}
   rule33 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule34 #-}
   rule34 = \  (_ :: ()) ->
     []
   {-# INLINE rule35 #-}
   rule35 = \ pos_ value_ ->
     StrToken value_ pos_
   {-# INLINE rule36 #-}
   rule36 = \ _output ->
     _output
{-# NOINLINE sem_HsToken_Err #-}
sem_HsToken_Err :: (String) -> (Pos) -> T_HsToken
sem_HsToken_Err arg_mesg_ arg_pos_ = T_HsToken (return st2) where
   {-# NOINLINE st2 #-}
   st2 = let
      v1 :: T_HsToken_v1
      v1 = \ (T_HsToken_vIn1 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) -> ( let
         _lhsOerrors :: Seq Error
         _lhsOerrors = rule37 arg_mesg_ arg_pos_
         _lhsOtok :: (Pos,String)
         _lhsOtok = rule38 arg_pos_
         _lhsOusedAttrs :: [(Identifier,Identifier)]
         _lhsOusedAttrs = rule39  ()
         _lhsOusedFields :: Seq Identifier
         _lhsOusedFields = rule40  ()
         _lhsOusedLocals :: [Identifier]
         _lhsOusedLocals = rule41  ()
         _output = rule42 arg_mesg_ arg_pos_
         _lhsOoutput :: HsToken
         _lhsOoutput = rule43 _output
         __result_ = T_HsToken_vOut1 _lhsOerrors _lhsOoutput _lhsOtok _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals
         in __result_ )
     in C_HsToken_s2 v1
   {-# INLINE rule37 #-}
   {-# LINE 51 "src-ag/SemHsTokens.ag" #-}
   rule37 = \ mesg_ pos_ ->
                       {-# LINE 51 "src-ag/SemHsTokens.ag" #-}
                       let m = text mesg_
                       in Seq.singleton (CustomError False pos_ m)
                       {-# LINE 374 "dist/build/SemHsTokens.hs"#-}
   {-# INLINE rule38 #-}
   {-# LINE 136 "src-ag/SemHsTokens.ag" #-}
   rule38 = \ pos_ ->
                           {-# LINE 136 "src-ag/SemHsTokens.ag" #-}
                           (pos_, "")
                           {-# LINE 380 "dist/build/SemHsTokens.hs"#-}
   {-# INLINE rule39 #-}
   rule39 = \  (_ :: ()) ->
     []
   {-# INLINE rule40 #-}
   rule40 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule41 #-}
   rule41 = \  (_ :: ()) ->
     []
   {-# INLINE rule42 #-}
   rule42 = \ mesg_ pos_ ->
     Err mesg_ pos_
   {-# INLINE rule43 #-}
   rule43 = \ _output ->
     _output

-- HsTokens ----------------------------------------------------
-- wrapper
data Inh_HsTokens  = Inh_HsTokens { allfields_Inh_HsTokens :: ([(Identifier,Type,ChildKind)]), allnts_Inh_HsTokens :: ([Identifier]), attrs_Inh_HsTokens :: ([(Identifier,Identifier)]), con_Inh_HsTokens :: (Identifier), fieldnames_Inh_HsTokens :: ([Identifier]), nt_Inh_HsTokens :: (Identifier), options_Inh_HsTokens :: (Options) }
data Syn_HsTokens  = Syn_HsTokens { errors_Syn_HsTokens :: (Seq Error), output_Syn_HsTokens :: (HsTokens), tks_Syn_HsTokens :: ([(Pos,String)]), usedAttrs_Syn_HsTokens :: ([(Identifier,Identifier)]), usedFields_Syn_HsTokens :: (Seq Identifier), usedLocals_Syn_HsTokens :: ([Identifier]) }
{-# INLINABLE wrap_HsTokens #-}
wrap_HsTokens :: T_HsTokens  -> Inh_HsTokens  -> (Syn_HsTokens )
wrap_HsTokens (T_HsTokens act) (Inh_HsTokens _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) =
   Control.Monad.Identity.runIdentity (
     do sem <- act
        let arg4 = T_HsTokens_vIn4 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions
        (T_HsTokens_vOut4 _lhsOerrors _lhsOoutput _lhsOtks _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals) <- return (inv_HsTokens_s5 sem arg4)
        return (Syn_HsTokens _lhsOerrors _lhsOoutput _lhsOtks _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals)
   )

-- cata
{-# NOINLINE sem_HsTokens #-}
sem_HsTokens :: HsTokens  -> T_HsTokens
sem_HsTokens list = Prelude.foldr sem_HsTokens_Cons sem_HsTokens_Nil (Prelude.map sem_HsToken list)

-- semantic domain
newtype T_HsTokens  = T_HsTokens {
                                 attach_T_HsTokens :: Identity (T_HsTokens_s5 )
                                 }
newtype T_HsTokens_s5  = C_HsTokens_s5 {
                                       inv_HsTokens_s5 :: (T_HsTokens_v4 )
                                       }
data T_HsTokens_s6  = C_HsTokens_s6
type T_HsTokens_v4  = (T_HsTokens_vIn4 ) -> (T_HsTokens_vOut4 )
data T_HsTokens_vIn4  = T_HsTokens_vIn4 ([(Identifier,Type,ChildKind)]) ([Identifier]) ([(Identifier,Identifier)]) (Identifier) ([Identifier]) (Identifier) (Options)
data T_HsTokens_vOut4  = T_HsTokens_vOut4 (Seq Error) (HsTokens) ([(Pos,String)]) ([(Identifier,Identifier)]) (Seq Identifier) ([Identifier])
{-# NOINLINE sem_HsTokens_Cons #-}
sem_HsTokens_Cons :: T_HsToken  -> T_HsTokens  -> T_HsTokens
sem_HsTokens_Cons arg_hd_ arg_tl_ = T_HsTokens (return st5) where
   {-# NOINLINE st5 #-}
   st5 = let
      v4 :: T_HsTokens_v4
      v4 = \ (T_HsTokens_vIn4 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) -> ( let
         _hdX2 = Control.Monad.Identity.runIdentity (attach_T_HsToken (arg_hd_))
         _tlX5 = Control.Monad.Identity.runIdentity (attach_T_HsTokens (arg_tl_))
         (T_HsToken_vOut1 _hdIerrors _hdIoutput _hdItok _hdIusedAttrs _hdIusedFields _hdIusedLocals) = inv_HsToken_s2 _hdX2 (T_HsToken_vIn1 _hdOallfields _hdOallnts _hdOattrs _hdOcon _hdOfieldnames _hdOnt _hdOoptions)
         (T_HsTokens_vOut4 _tlIerrors _tlIoutput _tlItks _tlIusedAttrs _tlIusedFields _tlIusedLocals) = inv_HsTokens_s5 _tlX5 (T_HsTokens_vIn4 _tlOallfields _tlOallnts _tlOattrs _tlOcon _tlOfieldnames _tlOnt _tlOoptions)
         _lhsOtks :: [(Pos,String)]
         _lhsOtks = rule44 _hdItok _tlItks
         _lhsOerrors :: Seq Error
         _lhsOerrors = rule45 _hdIerrors _tlIerrors
         _lhsOusedAttrs :: [(Identifier,Identifier)]
         _lhsOusedAttrs = rule46 _hdIusedAttrs _tlIusedAttrs
         _lhsOusedFields :: Seq Identifier
         _lhsOusedFields = rule47 _hdIusedFields _tlIusedFields
         _lhsOusedLocals :: [Identifier]
         _lhsOusedLocals = rule48 _hdIusedLocals _tlIusedLocals
         _output = rule49 _hdIoutput _tlIoutput
         _lhsOoutput :: HsTokens
         _lhsOoutput = rule50 _output
         _hdOallfields = rule51 _lhsIallfields
         _hdOallnts = rule52 _lhsIallnts
         _hdOattrs = rule53 _lhsIattrs
         _hdOcon = rule54 _lhsIcon
         _hdOfieldnames = rule55 _lhsIfieldnames
         _hdOnt = rule56 _lhsInt
         _hdOoptions = rule57 _lhsIoptions
         _tlOallfields = rule58 _lhsIallfields
         _tlOallnts = rule59 _lhsIallnts
         _tlOattrs = rule60 _lhsIattrs
         _tlOcon = rule61 _lhsIcon
         _tlOfieldnames = rule62 _lhsIfieldnames
         _tlOnt = rule63 _lhsInt
         _tlOoptions = rule64 _lhsIoptions
         __result_ = T_HsTokens_vOut4 _lhsOerrors _lhsOoutput _lhsOtks _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals
         in __result_ )
     in C_HsTokens_s5 v4
   {-# INLINE rule44 #-}
   {-# LINE 118 "src-ag/SemHsTokens.ag" #-}
   rule44 = \ ((_hdItok) :: (Pos,String)) ((_tlItks) :: [(Pos,String)]) ->
                     {-# LINE 118 "src-ag/SemHsTokens.ag" #-}
                     _hdItok : _tlItks
                     {-# LINE 473 "dist/build/SemHsTokens.hs"#-}
   {-# INLINE rule45 #-}
   rule45 = \ ((_hdIerrors) :: Seq Error) ((_tlIerrors) :: Seq Error) ->
     _hdIerrors Seq.>< _tlIerrors
   {-# INLINE rule46 #-}
   rule46 = \ ((_hdIusedAttrs) :: [(Identifier,Identifier)]) ((_tlIusedAttrs) :: [(Identifier,Identifier)]) ->
     _hdIusedAttrs ++ _tlIusedAttrs
   {-# INLINE rule47 #-}
   rule47 = \ ((_hdIusedFields) :: Seq Identifier) ((_tlIusedFields) :: Seq Identifier) ->
     _hdIusedFields Seq.>< _tlIusedFields
   {-# INLINE rule48 #-}
   rule48 = \ ((_hdIusedLocals) :: [Identifier]) ((_tlIusedLocals) :: [Identifier]) ->
     _hdIusedLocals ++ _tlIusedLocals
   {-# INLINE rule49 #-}
   rule49 = \ ((_hdIoutput) :: HsToken) ((_tlIoutput) :: HsTokens) ->
     (:) _hdIoutput _tlIoutput
   {-# INLINE rule50 #-}
   rule50 = \ _output ->
     _output
   {-# INLINE rule51 #-}
   rule51 = \ ((_lhsIallfields) :: [(Identifier,Type,ChildKind)]) ->
     _lhsIallfields
   {-# INLINE rule52 #-}
   rule52 = \ ((_lhsIallnts) :: [Identifier]) ->
     _lhsIallnts
   {-# INLINE rule53 #-}
   rule53 = \ ((_lhsIattrs) :: [(Identifier,Identifier)]) ->
     _lhsIattrs
   {-# INLINE rule54 #-}
   rule54 = \ ((_lhsIcon) :: Identifier) ->
     _lhsIcon
   {-# INLINE rule55 #-}
   rule55 = \ ((_lhsIfieldnames) :: [Identifier]) ->
     _lhsIfieldnames
   {-# INLINE rule56 #-}
   rule56 = \ ((_lhsInt) :: Identifier) ->
     _lhsInt
   {-# INLINE rule57 #-}
   rule57 = \ ((_lhsIoptions) :: Options) ->
     _lhsIoptions
   {-# INLINE rule58 #-}
   rule58 = \ ((_lhsIallfields) :: [(Identifier,Type,ChildKind)]) ->
     _lhsIallfields
   {-# INLINE rule59 #-}
   rule59 = \ ((_lhsIallnts) :: [Identifier]) ->
     _lhsIallnts
   {-# INLINE rule60 #-}
   rule60 = \ ((_lhsIattrs) :: [(Identifier,Identifier)]) ->
     _lhsIattrs
   {-# INLINE rule61 #-}
   rule61 = \ ((_lhsIcon) :: Identifier) ->
     _lhsIcon
   {-# INLINE rule62 #-}
   rule62 = \ ((_lhsIfieldnames) :: [Identifier]) ->
     _lhsIfieldnames
   {-# INLINE rule63 #-}
   rule63 = \ ((_lhsInt) :: Identifier) ->
     _lhsInt
   {-# INLINE rule64 #-}
   rule64 = \ ((_lhsIoptions) :: Options) ->
     _lhsIoptions
{-# NOINLINE sem_HsTokens_Nil #-}
sem_HsTokens_Nil ::  T_HsTokens
sem_HsTokens_Nil  = T_HsTokens (return st5) where
   {-# NOINLINE st5 #-}
   st5 = let
      v4 :: T_HsTokens_v4
      v4 = \ (T_HsTokens_vIn4 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) -> ( let
         _lhsOtks :: [(Pos,String)]
         _lhsOtks = rule65  ()
         _lhsOerrors :: Seq Error
         _lhsOerrors = rule66  ()
         _lhsOusedAttrs :: [(Identifier,Identifier)]
         _lhsOusedAttrs = rule67  ()
         _lhsOusedFields :: Seq Identifier
         _lhsOusedFields = rule68  ()
         _lhsOusedLocals :: [Identifier]
         _lhsOusedLocals = rule69  ()
         _output = rule70  ()
         _lhsOoutput :: HsTokens
         _lhsOoutput = rule71 _output
         __result_ = T_HsTokens_vOut4 _lhsOerrors _lhsOoutput _lhsOtks _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals
         in __result_ )
     in C_HsTokens_s5 v4
   {-# INLINE rule65 #-}
   {-# LINE 119 "src-ag/SemHsTokens.ag" #-}
   rule65 = \  (_ :: ()) ->
                     {-# LINE 119 "src-ag/SemHsTokens.ag" #-}
                     []
                     {-# LINE 562 "dist/build/SemHsTokens.hs"#-}
   {-# INLINE rule66 #-}
   rule66 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule67 #-}
   rule67 = \  (_ :: ()) ->
     []
   {-# INLINE rule68 #-}
   rule68 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule69 #-}
   rule69 = \  (_ :: ()) ->
     []
   {-# INLINE rule70 #-}
   rule70 = \  (_ :: ()) ->
     []
   {-# INLINE rule71 #-}
   rule71 = \ _output ->
     _output

-- HsTokensRoot ------------------------------------------------
-- wrapper
data Inh_HsTokensRoot  = Inh_HsTokensRoot { allfields_Inh_HsTokensRoot :: ([(Identifier,Type,ChildKind)]), allnts_Inh_HsTokensRoot :: ([Identifier]), attrs_Inh_HsTokensRoot :: ([(Identifier,Identifier)]), con_Inh_HsTokensRoot :: (Identifier), nt_Inh_HsTokensRoot :: (Identifier), options_Inh_HsTokensRoot :: (Options) }
data Syn_HsTokensRoot  = Syn_HsTokensRoot { errors_Syn_HsTokensRoot :: (Seq Error), output_Syn_HsTokensRoot :: ([HsToken]), textLines_Syn_HsTokensRoot :: ([String]), usedAttrs_Syn_HsTokensRoot :: ([(Identifier,Identifier)]), usedFields_Syn_HsTokensRoot :: ([Identifier]), usedLocals_Syn_HsTokensRoot :: ([Identifier]) }
{-# INLINABLE wrap_HsTokensRoot #-}
wrap_HsTokensRoot :: T_HsTokensRoot  -> Inh_HsTokensRoot  -> (Syn_HsTokensRoot )
wrap_HsTokensRoot (T_HsTokensRoot act) (Inh_HsTokensRoot _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsInt _lhsIoptions) =
   Control.Monad.Identity.runIdentity (
     do sem <- act
        let arg7 = T_HsTokensRoot_vIn7 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsInt _lhsIoptions
        (T_HsTokensRoot_vOut7 _lhsOerrors _lhsOoutput _lhsOtextLines _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals) <- return (inv_HsTokensRoot_s8 sem arg7)
        return (Syn_HsTokensRoot _lhsOerrors _lhsOoutput _lhsOtextLines _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals)
   )

-- cata
{-# INLINE sem_HsTokensRoot #-}
sem_HsTokensRoot :: HsTokensRoot  -> T_HsTokensRoot
sem_HsTokensRoot ( HsTokensRoot tokens_ ) = sem_HsTokensRoot_HsTokensRoot ( sem_HsTokens tokens_ )

-- semantic domain
newtype T_HsTokensRoot  = T_HsTokensRoot {
                                         attach_T_HsTokensRoot :: Identity (T_HsTokensRoot_s8 )
                                         }
newtype T_HsTokensRoot_s8  = C_HsTokensRoot_s8 {
                                               inv_HsTokensRoot_s8 :: (T_HsTokensRoot_v7 )
                                               }
data T_HsTokensRoot_s9  = C_HsTokensRoot_s9
type T_HsTokensRoot_v7  = (T_HsTokensRoot_vIn7 ) -> (T_HsTokensRoot_vOut7 )
data T_HsTokensRoot_vIn7  = T_HsTokensRoot_vIn7 ([(Identifier,Type,ChildKind)]) ([Identifier]) ([(Identifier,Identifier)]) (Identifier) (Identifier) (Options)
data T_HsTokensRoot_vOut7  = T_HsTokensRoot_vOut7 (Seq Error) ([HsToken]) ([String]) ([(Identifier,Identifier)]) ([Identifier]) ([Identifier])
{-# NOINLINE sem_HsTokensRoot_HsTokensRoot #-}
sem_HsTokensRoot_HsTokensRoot :: T_HsTokens  -> T_HsTokensRoot
sem_HsTokensRoot_HsTokensRoot arg_tokens_ = T_HsTokensRoot (return st8) where
   {-# NOINLINE st8 #-}
   st8 = let
      v7 :: T_HsTokensRoot_v7
      v7 = \ (T_HsTokensRoot_vIn7 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsInt _lhsIoptions) -> ( let
         _tokensX5 = Control.Monad.Identity.runIdentity (attach_T_HsTokens (arg_tokens_))
         (T_HsTokens_vOut4 _tokensIerrors _tokensIoutput _tokensItks _tokensIusedAttrs _tokensIusedFields _tokensIusedLocals) = inv_HsTokens_s5 _tokensX5 (T_HsTokens_vIn4 _tokensOallfields _tokensOallnts _tokensOattrs _tokensOcon _tokensOfieldnames _tokensOnt _tokensOoptions)
         _tokensOfieldnames = rule72 _lhsIallfields
         _lhsOusedFields :: [Identifier]
         _lhsOusedFields = rule73 _tokensIusedFields
         _lhsOtextLines :: [String]
         _lhsOtextLines = rule74 _tokensItks
         _lhsOerrors :: Seq Error
         _lhsOerrors = rule75 _tokensIerrors
         _lhsOoutput :: [HsToken]
         _lhsOoutput = rule76 _tokensIoutput
         _lhsOusedAttrs :: [(Identifier,Identifier)]
         _lhsOusedAttrs = rule77 _tokensIusedAttrs
         _lhsOusedLocals :: [Identifier]
         _lhsOusedLocals = rule78 _tokensIusedLocals
         _tokensOallfields = rule79 _lhsIallfields
         _tokensOallnts = rule80 _lhsIallnts
         _tokensOattrs = rule81 _lhsIattrs
         _tokensOcon = rule82 _lhsIcon
         _tokensOnt = rule83 _lhsInt
         _tokensOoptions = rule84 _lhsIoptions
         __result_ = T_HsTokensRoot_vOut7 _lhsOerrors _lhsOoutput _lhsOtextLines _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals
         in __result_ )
     in C_HsTokensRoot_s8 v7
   {-# INLINE rule72 #-}
   {-# LINE 39 "src-ag/SemHsTokens.ag" #-}
   rule72 = \ ((_lhsIallfields) :: [(Identifier,Type,ChildKind)]) ->
                                       {-# LINE 39 "src-ag/SemHsTokens.ag" #-}
                                       map (\(n,_,_) -> n) _lhsIallfields
                                       {-# LINE 648 "dist/build/SemHsTokens.hs"#-}
   {-# INLINE rule73 #-}
   {-# LINE 108 "src-ag/SemHsTokens.ag" #-}
   rule73 = \ ((_tokensIusedFields) :: Seq Identifier) ->
                                    {-# LINE 108 "src-ag/SemHsTokens.ag" #-}
                                    toList _tokensIusedFields
                                    {-# LINE 654 "dist/build/SemHsTokens.hs"#-}
   {-# INLINE rule74 #-}
   {-# LINE 115 "src-ag/SemHsTokens.ag" #-}
   rule74 = \ ((_tokensItks) :: [(Pos,String)]) ->
                                   {-# LINE 115 "src-ag/SemHsTokens.ag" #-}
                                   showTokens _tokensItks
                                   {-# LINE 660 "dist/build/SemHsTokens.hs"#-}
   {-# INLINE rule75 #-}
   rule75 = \ ((_tokensIerrors) :: Seq Error) ->
     _tokensIerrors
   {-# INLINE rule76 #-}
   rule76 = \ ((_tokensIoutput) :: HsTokens) ->
     _tokensIoutput
   {-# INLINE rule77 #-}
   rule77 = \ ((_tokensIusedAttrs) :: [(Identifier,Identifier)]) ->
     _tokensIusedAttrs
   {-# INLINE rule78 #-}
   rule78 = \ ((_tokensIusedLocals) :: [Identifier]) ->
     _tokensIusedLocals
   {-# INLINE rule79 #-}
   rule79 = \ ((_lhsIallfields) :: [(Identifier,Type,ChildKind)]) ->
     _lhsIallfields
   {-# INLINE rule80 #-}
   rule80 = \ ((_lhsIallnts) :: [Identifier]) ->
     _lhsIallnts
   {-# INLINE rule81 #-}
   rule81 = \ ((_lhsIattrs) :: [(Identifier,Identifier)]) ->
     _lhsIattrs
   {-# INLINE rule82 #-}
   rule82 = \ ((_lhsIcon) :: Identifier) ->
     _lhsIcon
   {-# INLINE rule83 #-}
   rule83 = \ ((_lhsInt) :: Identifier) ->
     _lhsInt
   {-# INLINE rule84 #-}
   rule84 = \ ((_lhsIoptions) :: Options) ->
     _lhsIoptions
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE Rank2Types, GADTs #-}
{-# LANGUAGE ScopedTypeVariables #-}

module SemHsTokens where CommonTypes
import UU.Scanner.Position(Pos)
import qualified Data.Sequence as Seq
import Data.Sequence(Seq,empty,singleton,(><))
import Data.Foldable(toList)
import Pretty

import TokenDef
import HsToken
import ErrorMessages









import Control.Monad.Identity (Identity)
import qualified Control.Monad.Identity





-- HsToken -----------------------------------------------------
-- wrapper












-- cata









-- semantic domain





isNTname allnts (Just (NT nt _ _)) = nt `elem` allnts
isNTname allnts _                  = False Inh_HsToken  = Inh_HsToken { allfields_Inh_HsToken :: ([(Identifier,Type,ChildKind)]), allnts_Inh_HsToken :: ([Identifier]), attrs_Inh_HsToken :: ([(Identifier,Identifier)]), con_Inh_HsToken :: (Identifier), fieldnames_Inh_HsToken :: ([Identifier]), nt_Inh_HsToken :: (Identifier), options_Inh_HsToken :: (Options) }
data Syn_HsToken  = Syn_HsToken { errors_Syn_HsToken :: (Seq Error), output_Syn_HsToken :: (HsToken), tok_Syn_HsToken :: ((Pos,String)), usedAttrs_Syn_HsToken :: ([(Identifier,Identifier)]), usedFields_Syn_HsToken :: (Seq Identifier), usedLocals_Syn_HsToken :: ([Identifier]) }
{-# INLINABLE wrap_HsToken #-}
wrap_HsToken :: T_HsToken  -> Inh_HsToken  -> (Syn_HsToken )
wrap_HsToken (T_HsToken act) (Inh_HsToken _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) =
   Control.Monad.Identity.runIdentity (
     do sem <- act
        let arg1 = T_HsToken_vIn1 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions
        (T_HsToken_vOut1 _lhsOerrors _lhsOoutput _lhsOtok _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals) <- return (inv_HsToken_s2 sem arg1)
        return (Syn_HsToken _lhsOerrors _lhsOoutput _lhsOtok _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals)
   )


{-# NOINLINE sem_HsToken #-}
sem_HsToken :: HsToken  -> T_HsToken
sem_HsToken ( AGLocal var_ pos_ rdesc_ ) = sem_HsToken_AGLocal var_ pos_ rdesc_
sem_HsToken ( AGField field_ attr_ pos_ rdesc_ ) = sem_HsToken_AGField field_ attr_ pos_ rdesc_
sem_HsToken ( HsToken value_ pos_ ) = sem_HsToken_HsToken value_ pos_
sem_HsToken ( CharToken value_ pos_ ) = sem_HsToken_CharToken value_ pos_
sem_HsToken ( StrToken value_ pos_ ) = sem_HsToken_StrToken value_ pos_
sem_HsToken ( Err mesg_ pos_ ) = sem_HsToken_Err mesg_ pos_


newtype T_HsToken  = T_HsToken {
                               attach_T_HsToken :: Identity (T_HsToken_s2 )
                               }
newtype T_HsToken_s2  = C_HsToken_s2 {
                                     inv_HsToken_s2 :: (T_HsToken_v1 )
                                     }
data T_HsToken_s3  = C_HsToken_s3
type T_HsToken_v1  = (T_HsToken_vIn1 ) -> (T_HsToken_vOut1 )
data T_HsToken_vIn1  = T_HsToken_vIn1 ([(Identifier,Type,ChildKind)]) ([Identifier]) ([(Identifier,Identifier)]) (Identifier) ([Identifier]) (Identifier) (Options)
data T_HsToken_vOut1  = T_HsToken_vOut1 (Seq Error) (HsToken) ((Pos,String)) ([(Identifier,Identifier)]) (Seq Identifier) ([Identifier])
{-# NOINLINE sem_HsToken_AGLocal #-}
sem_HsToken_AGLocal :: (Identifier) -> (Pos) -> (Maybe String) -> T_HsToken
sem_HsToken_AGLocal arg_var_ arg_pos_ arg_rdesc_ = T_HsToken (return st2) where
   {-# NOINLINE st2 #-}
   st2 = let
      v1 :: T_HsToken_v1
      v1 = \ (T_HsToken_vIn1 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) -> ( let
         _tkAsLocal = rule0 arg_pos_ arg_rdesc_ arg_var_
         _tkAsField = rule1 arg_pos_ arg_rdesc_ arg_var_
         (_errors,_output,_tok,_usedLocals) = rule2 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions _tkAsField _tkAsLocal arg_pos_ arg_var_
         _lhsOusedFields :: Seq Identifier
         _lhsOusedFields = rule3 _lhsIfieldnames arg_var_
         _lhsOerrors :: Seq Error
         _lhsOerrors = rule4 _errors
         _lhsOusedAttrs :: [(Identifier,Identifier)]
         _lhsOusedAttrs = rule5  ()
         _lhsOusedLocals :: [Identifier]
         _lhsOusedLocals = rule6 _usedLocals
         _lhsOoutput :: HsToken
         _lhsOoutput = rule7 _output
         _lhsOtok :: (Pos,String)
         _lhsOtok = rule8 _tok
         __result_ = T_HsToken_vOut1 _lhsOerrors _lhsOoutput _lhsOtok _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals
         in __result_ )
     in C_HsToken_s2 v1
   {-# INLINE rule0 #-}





   {-# INLINE rule1 #-}





   {-# INLINE rule2 #-}











   {-# INLINE rule3 #-}







   {-# INLINE rule4 #-}
   rule4 = \ _errors ->
     _errors
   {-# INLINE rule5 #-}
   rule5 = \  (_ :: ()) ->
     []
   {-# INLINE rule6 #-}
   rule6 = \ _usedLocals ->
     _usedLocals
   {-# INLINE rule7 #-}
   rule7 = \ _output ->
     _output
   {-# INLINE rule8 #-}
   rule8 = \ _tok ->
     _tok = \ pos_ rdesc_ var_ ->AGLocal var_ pos_ rdesc_
   rule1 = \ pos_ rdesc_ var_ ->AGField _LOC var_ pos_ rdesc_

   rule2 = \ ((_lhsIallfields) :: [(Identifier,Type,ChildKind)]) ((_lhsIallnts) :: [Identifier]) ((_lhsIattrs) :: [(Identifier,Identifier)]) ((_lhsIcon) :: Identifier) ((_lhsIfieldnames) :: [Identifier]) ((_lhsInt) :: Identifier) ((_lhsIoptions) :: Options) _tkAsField _tkAsLocal pos_ var_ -> var_ `elem` _lhsIfieldnames
                       then if  isNTname _lhsIallnts (lookup var_ (map (\(n,t,_) -> (n,t)) _lhsIallfields))
                            then (Seq.singleton(ChildAsLocal _lhsInt _lhsIcon var_), _tkAsLocal    ,(pos_,fieldname var_), []    )
                            else (Seq.empty, _tkAsLocal    , (pos_,fieldname var_), []    )
                       else if (_LOC,var_) `elem` _lhsIattrs
                            then (Seq.empty                                      , _tkAsField    , (pos_,locname _lhsIoptions var_), [var_])
                            else (Seq.singleton(UndefLocal _lhsInt _lhsIcon var_), _tkAsField    , (pos_,locname _lhsIoptions var_), []    )




























   rule3 = \ ((_lhsIfieldnames) :: [Identifier]) var_ -> var_ `elem` _lhsIfieldnames
                                then Seq.singleton var_
                                else Seq.empty





























{-# NOINLINE sem_HsToken_AGField #-}
sem_HsToken_AGField :: (Identifier) -> (Identifier) -> (Pos) -> (Maybe String) -> T_HsToken
sem_HsToken_AGField arg_field_ arg_attr_ arg_pos_ arg_rdesc_ = T_HsToken (return st2) where
   {-# NOINLINE st2 #-}
   st2 = let
      v1 :: T_HsToken_v1
      v1 = \ (T_HsToken_vIn1 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) -> ( let
         _lhsOerrors :: Seq Error
         _lhsOerrors = rule9 _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt arg_attr_ arg_field_
         _lhsOusedAttrs :: [(Identifier,Identifier)]
         _lhsOusedLocals :: [Identifier]
         (_lhsOusedAttrs,_lhsOusedLocals) = rule10 arg_attr_ arg_field_
         _addTrace = rule11 arg_attr_ arg_field_ arg_rdesc_
         _lhsOtok :: (Pos,String)
         _lhsOtok = rule12 _addTrace _lhsIoptions arg_attr_ arg_field_ arg_pos_
         _lhsOusedFields :: Seq Identifier
         _lhsOusedFields = rule13  ()
         _output = rule14 arg_attr_ arg_field_ arg_pos_ arg_rdesc_
         _lhsOoutput :: HsToken
         _lhsOoutput = rule15 _output
         __result_ = T_HsToken_vOut1 _lhsOerrors _lhsOoutput _lhsOtok _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals
         in __result_ )
     in C_HsToken_s2 v1
   {-# INLINE rule9 #-}









   {-# INLINE rule10 #-}







   {-# INLINE rule11 #-}







   {-# INLINE rule12 #-}





   {-# INLINE rule13 #-}
   rule13 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule14 #-}
   rule14 = \ attr_ field_ pos_ rdesc_ ->
     AGField field_ attr_ pos_ rdesc_
   {-# INLINE rule15 #-}
   rule15 = \ _output ->
     _output = \ ((_lhsIattrs) :: [(Identifier,Identifier)]) ((_lhsIcon) :: Identifier) ((_lhsIfieldnames) :: [Identifier]) ((_lhsInt) :: Identifier) attr_ field_ -> (field_,attr_) `elem` _lhsIattrs
                                 then Seq.empty
                                 else if not(field_ `elem` (_LHS : _LOC: _lhsIfieldnames))
                                      then Seq.singleton (UndefChild _lhsInt _lhsIcon field_)
                                      else Seq.singleton (UndefAttr _lhsInt _lhsIcon field_ attr_ False)










   rule10 = \ attr_ field_ -> field_ == _LOC
                  then ([], [attr_])
                  else ([(field_,attr_)], [])



























   rule11 = \ attr_ field_ rdesc_ -> rdesc_ of
                          Just d  -> \x -> "(trace " ++ show (d ++ " -> " ++ show field_ ++ "." ++ show attr_) ++ " (" ++ x ++ "))"
                          Nothing -> id
   rule12 = \ _addTrace ((_lhsIoptions) :: Options) attr_ field_ pos_ ->pos_, _addTrace     $ attrname _lhsIoptions True field_ attr_)









































































{-# NOINLINE sem_HsToken_HsToken #-}
sem_HsToken_HsToken :: (String) -> (Pos) -> T_HsToken
sem_HsToken_HsToken arg_value_ arg_pos_ = T_HsToken (return st2) where
   {-# NOINLINE st2 #-}
   st2 = let
      v1 :: T_HsToken_v1
      v1 = \ (T_HsToken_vIn1 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) -> ( let
         _lhsOtok :: (Pos,String)
         _lhsOtok = rule16 arg_pos_ arg_value_
         _lhsOerrors :: Seq Error
         _lhsOerrors = rule17  ()
         _lhsOusedAttrs :: [(Identifier,Identifier)]
         _lhsOusedAttrs = rule18  ()
         _lhsOusedFields :: Seq Identifier
         _lhsOusedFields = rule19  ()
         _lhsOusedLocals :: [Identifier]
         _lhsOusedLocals = rule20  ()
         _output = rule21 arg_pos_ arg_value_
         _lhsOoutput :: HsToken
         _lhsOoutput = rule22 _output
         __result_ = T_HsToken_vOut1 _lhsOerrors _lhsOoutput _lhsOtok _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals
         in __result_ )
     in C_HsToken_s2 v1
   {-# INLINE rule16 #-}





   {-# INLINE rule17 #-}
   rule17 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule18 #-}
   rule18 = \  (_ :: ()) ->
     []
   {-# INLINE rule19 #-}
   rule19 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule20 #-}
   rule20 = \  (_ :: ()) ->
     []
   {-# INLINE rule21 #-}
   rule21 = \ pos_ value_ ->
     HsToken value_ pos_
   {-# INLINE rule22 #-}
   rule22 = \ _output ->
     _output = \ pos_ value_ ->pos_, value_)






















































































































{-# NOINLINE sem_HsToken_CharToken #-}
sem_HsToken_CharToken :: (String) -> (Pos) -> T_HsToken
sem_HsToken_CharToken arg_value_ arg_pos_ = T_HsToken (return st2) where
   {-# NOINLINE st2 #-}
   st2 = let
      v1 :: T_HsToken_v1
      v1 = \ (T_HsToken_vIn1 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) -> ( let
         _lhsOtok :: (Pos,String)
         _lhsOtok = rule23 arg_pos_ arg_value_
         _lhsOerrors :: Seq Error
         _lhsOerrors = rule24  ()
         _lhsOusedAttrs :: [(Identifier,Identifier)]
         _lhsOusedAttrs = rule25  ()
         _lhsOusedFields :: Seq Identifier
         _lhsOusedFields = rule26  ()
         _lhsOusedLocals :: [Identifier]
         _lhsOusedLocals = rule27  ()
         _output = rule28 arg_pos_ arg_value_
         _lhsOoutput :: HsToken
         _lhsOoutput = rule29 _output
         __result_ = T_HsToken_vOut1 _lhsOerrors _lhsOoutput _lhsOtok _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals
         in __result_ )
     in C_HsToken_s2 v1
   {-# INLINE rule23 #-}








   {-# INLINE rule24 #-}
   rule24 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule25 #-}
   rule25 = \  (_ :: ()) ->
     []
   {-# INLINE rule26 #-}
   rule26 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule27 #-}
   rule27 = \  (_ :: ()) ->
     []
   {-# INLINE rule28 #-}
   rule28 = \ pos_ value_ ->
     CharToken value_ pos_
   {-# INLINE rule29 #-}
   rule29 = \ _output ->
     _output = \ pos_ value_ ->pos_, if null value_
                                        then ""
                                        else showCharShort (head value_)
                              )



































































































































































{-# NOINLINE sem_HsToken_StrToken #-}
sem_HsToken_StrToken :: (String) -> (Pos) -> T_HsToken
sem_HsToken_StrToken arg_value_ arg_pos_ = T_HsToken (return st2) where
   {-# NOINLINE st2 #-}
   st2 = let
      v1 :: T_HsToken_v1
      v1 = \ (T_HsToken_vIn1 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) -> ( let
         _lhsOtok :: (Pos,String)
         _lhsOtok = rule30 arg_pos_ arg_value_
         _lhsOerrors :: Seq Error
         _lhsOerrors = rule31  ()
         _lhsOusedAttrs :: [(Identifier,Identifier)]
         _lhsOusedAttrs = rule32  ()
         _lhsOusedFields :: Seq Identifier
         _lhsOusedFields = rule33  ()
         _lhsOusedLocals :: [Identifier]
         _lhsOusedLocals = rule34  ()
         _output = rule35 arg_pos_ arg_value_
         _lhsOoutput :: HsToken
         _lhsOoutput = rule36 _output
         __result_ = T_HsToken_vOut1 _lhsOerrors _lhsOoutput _lhsOtok _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals
         in __result_ )
     in C_HsToken_s2 v1
   {-# INLINE rule30 #-}





   {-# INLINE rule31 #-}
   rule31 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule32 #-}
   rule32 = \  (_ :: ()) ->
     []
   {-# INLINE rule33 #-}
   rule33 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule34 #-}
   rule34 = \  (_ :: ()) ->
     []
   {-# INLINE rule35 #-}
   rule35 = \ pos_ value_ ->
     StrToken value_ pos_
   {-# INLINE rule36 #-}
   rule36 = \ _output ->
     _output = \ pos_ value_ ->pos_, showStrShort value_)
















































































































































































































{-# NOINLINE sem_HsToken_Err #-}
sem_HsToken_Err :: (String) -> (Pos) -> T_HsToken
sem_HsToken_Err arg_mesg_ arg_pos_ = T_HsToken (return st2) where
   {-# NOINLINE st2 #-}
   st2 = let
      v1 :: T_HsToken_v1
      v1 = \ (T_HsToken_vIn1 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) -> ( let
         _lhsOerrors :: Seq Error
         _lhsOerrors = rule37 arg_mesg_ arg_pos_
         _lhsOtok :: (Pos,String)
         _lhsOtok = rule38 arg_pos_
         _lhsOusedAttrs :: [(Identifier,Identifier)]
         _lhsOusedAttrs = rule39  ()
         _lhsOusedFields :: Seq Identifier
         _lhsOusedFields = rule40  ()
         _lhsOusedLocals :: [Identifier]
         _lhsOusedLocals = rule41  ()
         _output = rule42 arg_mesg_ arg_pos_
         _lhsOoutput :: HsToken
         _lhsOoutput = rule43 _output
         __result_ = T_HsToken_vOut1 _lhsOerrors _lhsOoutput _lhsOtok _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals
         in __result_ )
     in C_HsToken_s2 v1
   {-# INLINE rule37 #-}






   {-# INLINE rule38 #-}





   {-# INLINE rule39 #-}
   rule39 = \  (_ :: ()) ->
     []
   {-# INLINE rule40 #-}
   rule40 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule41 #-}
   rule41 = \  (_ :: ()) ->
     []
   {-# INLINE rule42 #-}
   rule42 = \ mesg_ pos_ ->
     Err mesg_ pos_
   {-# INLINE rule43 #-}
   rule43 = \ _output ->
     _output = \ mesg_ pos_ -> m = text mesg_
                              in Seq.singleton (CustomError False pos_ m)



















































































   rule38 = \ pos_ ->      (pos_, "")



































































































































































































































































-- HsTokens ----------------------------------------------------
-- wrapper
data Inh_HsTokens  = Inh_HsTokens { allfields_Inh_HsTokens :: ([(Identifier,Type,ChildKind)]), allnts_Inh_HsTokens :: ([Identifier]), attrs_Inh_HsTokens :: ([(Identifier,Identifier)]), con_Inh_HsTokens :: (Identifier), fieldnames_Inh_HsTokens :: ([Identifier]), nt_Inh_HsTokens :: (Identifier), options_Inh_HsTokens :: (Options) }
data Syn_HsTokens  = Syn_HsTokens { errors_Syn_HsTokens :: (Seq Error), output_Syn_HsTokens :: (HsTokens), tks_Syn_HsTokens :: ([(Pos,String)]), usedAttrs_Syn_HsTokens :: ([(Identifier,Identifier)]), usedFields_Syn_HsTokens :: (Seq Identifier), usedLocals_Syn_HsTokens :: ([Identifier]) }
{-# INLINABLE wrap_HsTokens #-}
wrap_HsTokens :: T_HsTokens  -> Inh_HsTokens  -> (Syn_HsTokens )
wrap_HsTokens (T_HsTokens act) (Inh_HsTokens _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) =
   Control.Monad.Identity.runIdentity (
     do sem <- act
        let arg4 = T_HsTokens_vIn4 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions
        (T_HsTokens_vOut4 _lhsOerrors _lhsOoutput _lhsOtks _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals) <- return (inv_HsTokens_s5 sem arg4)
        return (Syn_HsTokens _lhsOerrors _lhsOoutput _lhsOtks _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals)
   )

-- cata
{-# NOINLINE sem_HsTokens #-}
sem_HsTokens :: HsTokens  -> T_HsTokens
sem_HsTokens list = Prelude.foldr sem_HsTokens_Cons sem_HsTokens_Nil (Prelude.map sem_HsToken list)

-- semantic domain
newtype T_HsTokens  = T_HsTokens {
                                 attach_T_HsTokens :: Identity (T_HsTokens_s5 )
                                 }
newtype T_HsTokens_s5  = C_HsTokens_s5 {
                                       inv_HsTokens_s5 :: (T_HsTokens_v4 )
                                       }
data T_HsTokens_s6  = C_HsTokens_s6
type T_HsTokens_v4  = (T_HsTokens_vIn4 ) -> (T_HsTokens_vOut4 )
data T_HsTokens_vIn4  = T_HsTokens_vIn4 ([(Identifier,Type,ChildKind)]) ([Identifier]) ([(Identifier,Identifier)]) (Identifier) ([Identifier]) (Identifier) (Options)
data T_HsTokens_vOut4  = T_HsTokens_vOut4 (Seq Error) (HsTokens) ([(Pos,String)]) ([(Identifier,Identifier)]) (Seq Identifier) ([Identifier])
{-# NOINLINE sem_HsTokens_Cons #-}
sem_HsTokens_Cons :: T_HsToken  -> T_HsTokens  -> T_HsTokens
sem_HsTokens_Cons arg_hd_ arg_tl_ = T_HsTokens (return st5) where
   {-# NOINLINE st5 #-}
   st5 = let
      v4 :: T_HsTokens_v4
      v4 = \ (T_HsTokens_vIn4 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) -> ( let
         _hdX2 = Control.Monad.Identity.runIdentity (attach_T_HsToken (arg_hd_))
         _tlX5 = Control.Monad.Identity.runIdentity (attach_T_HsTokens (arg_tl_))
         (T_HsToken_vOut1 _hdIerrors _hdIoutput _hdItok _hdIusedAttrs _hdIusedFields _hdIusedLocals) = inv_HsToken_s2 _hdX2 (T_HsToken_vIn1 _hdOallfields _hdOallnts _hdOattrs _hdOcon _hdOfieldnames _hdOnt _hdOoptions)
         (T_HsTokens_vOut4 _tlIerrors _tlIoutput _tlItks _tlIusedAttrs _tlIusedFields _tlIusedLocals) = inv_HsTokens_s5 _tlX5 (T_HsTokens_vIn4 _tlOallfields _tlOallnts _tlOattrs _tlOcon _tlOfieldnames _tlOnt _tlOoptions)
         _lhsOtks :: [(Pos,String)]
         _lhsOtks = rule44 _hdItok _tlItks
         _lhsOerrors :: Seq Error
         _lhsOerrors = rule45 _hdIerrors _tlIerrors
         _lhsOusedAttrs :: [(Identifier,Identifier)]
         _lhsOusedAttrs = rule46 _hdIusedAttrs _tlIusedAttrs
         _lhsOusedFields :: Seq Identifier
         _lhsOusedFields = rule47 _hdIusedFields _tlIusedFields
         _lhsOusedLocals :: [Identifier]
         _lhsOusedLocals = rule48 _hdIusedLocals _tlIusedLocals
         _output = rule49 _hdIoutput _tlIoutput
         _lhsOoutput :: HsTokens
         _lhsOoutput = rule50 _output
         _hdOallfields = rule51 _lhsIallfields
         _hdOallnts = rule52 _lhsIallnts
         _hdOattrs = rule53 _lhsIattrs
         _hdOcon = rule54 _lhsIcon
         _hdOfieldnames = rule55 _lhsIfieldnames
         _hdOnt = rule56 _lhsInt
         _hdOoptions = rule57 _lhsIoptions
         _tlOallfields = rule58 _lhsIallfields
         _tlOallnts = rule59 _lhsIallnts
         _tlOattrs = rule60 _lhsIattrs
         _tlOcon = rule61 _lhsIcon
         _tlOfieldnames = rule62 _lhsIfieldnames
         _tlOnt = rule63 _lhsInt
         _tlOoptions = rule64 _lhsIoptions
         __result_ = T_HsTokens_vOut4 _lhsOerrors _lhsOoutput _lhsOtks _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals
         in __result_ )
     in C_HsTokens_s5 v4
   {-# INLINE rule44 #-}





   {-# INLINE rule45 #-}
   rule45 = \ ((_hdIerrors) :: Seq Error) ((_tlIerrors) :: Seq Error) ->
     _hdIerrors Seq.>< _tlIerrors
   {-# INLINE rule46 #-}
   rule46 = \ ((_hdIusedAttrs) :: [(Identifier,Identifier)]) ((_tlIusedAttrs) :: [(Identifier,Identifier)]) ->
     _hdIusedAttrs ++ _tlIusedAttrs
   {-# INLINE rule47 #-}
   rule47 = \ ((_hdIusedFields) :: Seq Identifier) ((_tlIusedFields) :: Seq Identifier) ->
     _hdIusedFields Seq.>< _tlIusedFields
   {-# INLINE rule48 #-}
   rule48 = \ ((_hdIusedLocals) :: [Identifier]) ((_tlIusedLocals) :: [Identifier]) ->
     _hdIusedLocals ++ _tlIusedLocals
   {-# INLINE rule49 #-}
   rule49 = \ ((_hdIoutput) :: HsToken) ((_tlIoutput) :: HsTokens) ->
     (:) _hdIoutput _tlIoutput
   {-# INLINE rule50 #-}
   rule50 = \ _output ->
     _output
   {-# INLINE rule51 #-}
   rule51 = \ ((_lhsIallfields) :: [(Identifier,Type,ChildKind)]) ->
     _lhsIallfields
   {-# INLINE rule52 #-}
   rule52 = \ ((_lhsIallnts) :: [Identifier]) ->
     _lhsIallnts
   {-# INLINE rule53 #-}
   rule53 = \ ((_lhsIattrs) :: [(Identifier,Identifier)]) ->
     _lhsIattrs
   {-# INLINE rule54 #-}
   rule54 = \ ((_lhsIcon) :: Identifier) ->
     _lhsIcon
   {-# INLINE rule55 #-}
   rule55 = \ ((_lhsIfieldnames) :: [Identifier]) ->
     _lhsIfieldnames
   {-# INLINE rule56 #-}
   rule56 = \ ((_lhsInt) :: Identifier) ->
     _lhsInt
   {-# INLINE rule57 #-}
   rule57 = \ ((_lhsIoptions) :: Options) ->
     _lhsIoptions
   {-# INLINE rule58 #-}
   rule58 = \ ((_lhsIallfields) :: [(Identifier,Type,ChildKind)]) ->
     _lhsIallfields
   {-# INLINE rule59 #-}
   rule59 = \ ((_lhsIallnts) :: [Identifier]) ->
     _lhsIallnts
   {-# INLINE rule60 #-}
   rule60 = \ ((_lhsIattrs) :: [(Identifier,Identifier)]) ->
     _lhsIattrs
   {-# INLINE rule61 #-}
   rule61 = \ ((_lhsIcon) :: Identifier) ->
     _lhsIcon
   {-# INLINE rule62 #-}
   rule62 = \ ((_lhsIfieldnames) :: [Identifier]) ->
     _lhsIfieldnames
   {-# INLINE rule63 #-}
   rule63 = \ ((_lhsInt) :: Identifier) ->
     _lhsInt
   {-# INLINE rule64 #-}
   rule64 = \ ((_lhsIoptions) :: Options) ->
     _lhsIoptions = \ ((_hdItok) :: (Pos,String)) ((_tlItks) :: [(Pos,String)]) -> : _tlItks






























































































































































































































































































































































































































{-# NOINLINE sem_HsTokens_Nil #-}
sem_HsTokens_Nil ::  T_HsTokens
sem_HsTokens_Nil  = T_HsTokens (return st5) where
   {-# NOINLINE st5 #-}
   st5 = let
      v4 :: T_HsTokens_v4
      v4 = \ (T_HsTokens_vIn4 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsIfieldnames _lhsInt _lhsIoptions) -> ( let
         _lhsOtks :: [(Pos,String)]
         _lhsOtks = rule65  ()
         _lhsOerrors :: Seq Error
         _lhsOerrors = rule66  ()
         _lhsOusedAttrs :: [(Identifier,Identifier)]
         _lhsOusedAttrs = rule67  ()
         _lhsOusedFields :: Seq Identifier
         _lhsOusedFields = rule68  ()
         _lhsOusedLocals :: [Identifier]
         _lhsOusedLocals = rule69  ()
         _output = rule70  ()
         _lhsOoutput :: HsTokens
         _lhsOoutput = rule71 _output
         __result_ = T_HsTokens_vOut4 _lhsOerrors _lhsOoutput _lhsOtks _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals
         in __result_ )
     in C_HsTokens_s5 v4
   {-# INLINE rule65 #-}





   {-# INLINE rule66 #-}
   rule66 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule67 #-}
   rule67 = \  (_ :: ()) ->
     []
   {-# INLINE rule68 #-}
   rule68 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule69 #-}
   rule69 = \  (_ :: ()) ->
     []
   {-# INLINE rule70 #-}
   rule70 = \  (_ :: ()) ->
     []
   {-# INLINE rule71 #-}
   rule71 = \ _output ->
     _output = \  (_ :: ()) ->]













































































































































































































































































































































































































































































-- HsTokensRoot ------------------------------------------------
-- wrapper
data Inh_HsTokensRoot  = Inh_HsTokensRoot { allfields_Inh_HsTokensRoot :: ([(Identifier,Type,ChildKind)]), allnts_Inh_HsTokensRoot :: ([Identifier]), attrs_Inh_HsTokensRoot :: ([(Identifier,Identifier)]), con_Inh_HsTokensRoot :: (Identifier), nt_Inh_HsTokensRoot :: (Identifier), options_Inh_HsTokensRoot :: (Options) }
data Syn_HsTokensRoot  = Syn_HsTokensRoot { errors_Syn_HsTokensRoot :: (Seq Error), output_Syn_HsTokensRoot :: ([HsToken]), textLines_Syn_HsTokensRoot :: ([String]), usedAttrs_Syn_HsTokensRoot :: ([(Identifier,Identifier)]), usedFields_Syn_HsTokensRoot :: ([Identifier]), usedLocals_Syn_HsTokensRoot :: ([Identifier]) }
{-# INLINABLE wrap_HsTokensRoot #-}
wrap_HsTokensRoot :: T_HsTokensRoot  -> Inh_HsTokensRoot  -> (Syn_HsTokensRoot )
wrap_HsTokensRoot (T_HsTokensRoot act) (Inh_HsTokensRoot _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsInt _lhsIoptions) =
   Control.Monad.Identity.runIdentity (
     do sem <- act
        let arg7 = T_HsTokensRoot_vIn7 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsInt _lhsIoptions
        (T_HsTokensRoot_vOut7 _lhsOerrors _lhsOoutput _lhsOtextLines _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals) <- return (inv_HsTokensRoot_s8 sem arg7)
        return (Syn_HsTokensRoot _lhsOerrors _lhsOoutput _lhsOtextLines _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals)
   )

-- cata
{-# INLINE sem_HsTokensRoot #-}
sem_HsTokensRoot :: HsTokensRoot  -> T_HsTokensRoot
sem_HsTokensRoot ( HsTokensRoot tokens_ ) = sem_HsTokensRoot_HsTokensRoot ( sem_HsTokens tokens_ )

-- semantic domain
newtype T_HsTokensRoot  = T_HsTokensRoot {
                                         attach_T_HsTokensRoot :: Identity (T_HsTokensRoot_s8 )
                                         }
newtype T_HsTokensRoot_s8  = C_HsTokensRoot_s8 {
                                               inv_HsTokensRoot_s8 :: (T_HsTokensRoot_v7 )
                                               }
data T_HsTokensRoot_s9  = C_HsTokensRoot_s9
type T_HsTokensRoot_v7  = (T_HsTokensRoot_vIn7 ) -> (T_HsTokensRoot_vOut7 )
data T_HsTokensRoot_vIn7  = T_HsTokensRoot_vIn7 ([(Identifier,Type,ChildKind)]) ([Identifier]) ([(Identifier,Identifier)]) (Identifier) (Identifier) (Options)
data T_HsTokensRoot_vOut7  = T_HsTokensRoot_vOut7 (Seq Error) ([HsToken]) ([String]) ([(Identifier,Identifier)]) ([Identifier]) ([Identifier])
{-# NOINLINE sem_HsTokensRoot_HsTokensRoot #-}
sem_HsTokensRoot_HsTokensRoot :: T_HsTokens  -> T_HsTokensRoot
sem_HsTokensRoot_HsTokensRoot arg_tokens_ = T_HsTokensRoot (return st8) where
   {-# NOINLINE st8 #-}
   st8 = let
      v7 :: T_HsTokensRoot_v7
      v7 = \ (T_HsTokensRoot_vIn7 _lhsIallfields _lhsIallnts _lhsIattrs _lhsIcon _lhsInt _lhsIoptions) -> ( let
         _tokensX5 = Control.Monad.Identity.runIdentity (attach_T_HsTokens (arg_tokens_))
         (T_HsTokens_vOut4 _tokensIerrors _tokensIoutput _tokensItks _tokensIusedAttrs _tokensIusedFields _tokensIusedLocals) = inv_HsTokens_s5 _tokensX5 (T_HsTokens_vIn4 _tokensOallfields _tokensOallnts _tokensOattrs _tokensOcon _tokensOfieldnames _tokensOnt _tokensOoptions)
         _tokensOfieldnames = rule72 _lhsIallfields
         _lhsOusedFields :: [Identifier]
         _lhsOusedFields = rule73 _tokensIusedFields
         _lhsOtextLines :: [String]
         _lhsOtextLines = rule74 _tokensItks
         _lhsOerrors :: Seq Error
         _lhsOerrors = rule75 _tokensIerrors
         _lhsOoutput :: [HsToken]
         _lhsOoutput = rule76 _tokensIoutput
         _lhsOusedAttrs :: [(Identifier,Identifier)]
         _lhsOusedAttrs = rule77 _tokensIusedAttrs
         _lhsOusedLocals :: [Identifier]
         _lhsOusedLocals = rule78 _tokensIusedLocals
         _tokensOallfields = rule79 _lhsIallfields
         _tokensOallnts = rule80 _lhsIallnts
         _tokensOattrs = rule81 _lhsIattrs
         _tokensOcon = rule82 _lhsIcon
         _tokensOnt = rule83 _lhsInt
         _tokensOoptions = rule84 _lhsIoptions
         __result_ = T_HsTokensRoot_vOut7 _lhsOerrors _lhsOoutput _lhsOtextLines _lhsOusedAttrs _lhsOusedFields _lhsOusedLocals
         in __result_ )
     in C_HsTokensRoot_s8 v7
   {-# INLINE rule72 #-}





   {-# INLINE rule73 #-}





   {-# INLINE rule74 #-}





   {-# INLINE rule75 #-}
   rule75 = \ ((_tokensIerrors) :: Seq Error) ->
     _tokensIerrors
   {-# INLINE rule76 #-}
   rule76 = \ ((_tokensIoutput) :: HsTokens) ->
     _tokensIoutput
   {-# INLINE rule77 #-}
   rule77 = \ ((_tokensIusedAttrs) :: [(Identifier,Identifier)]) ->
     _tokensIusedAttrs
   {-# INLINE rule78 #-}
   rule78 = \ ((_tokensIusedLocals) :: [Identifier]) ->
     _tokensIusedLocals
   {-# INLINE rule79 #-}
   rule79 = \ ((_lhsIallfields) :: [(Identifier,Type,ChildKind)]) ->
     _lhsIallfields
   {-# INLINE rule80 #-}
   rule80 = \ ((_lhsIallnts) :: [Identifier]) ->
     _lhsIallnts
   {-# INLINE rule81 #-}
   rule81 = \ ((_lhsIattrs) :: [(Identifier,Identifier)]) ->
     _lhsIattrs
   {-# INLINE rule82 #-}
   rule82 = \ ((_lhsIcon) :: Identifier) ->
     _lhsIcon
   {-# INLINE rule83 #-}
   rule83 = \ ((_lhsInt) :: Identifier) ->
     _lhsInt
   {-# INLINE rule84 #-}
   rule84 = \ ((_lhsIoptions) :: Options) ->
     _lhsIoptions = \ ((_lhsIallfields) :: [(Identifier,Type,ChildKind)]) -> (\(n,_,_) -> n) _lhsIallfields




































































   rule73 = \ ((_tokensIusedFields) :: Seq Identifier) -> _tokensIusedFields






   rule74 = \ ((_tokensItks) :: [(Pos,String)]) -> _tokensItks































































































































































































































































































































































































































































































































































































</pre>