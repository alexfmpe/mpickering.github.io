<a href="Api.hs510616708590357944.out.html">prev</a></br><a href="failures.html">home</a></br><a href="API.hs828530767832633821.out.html">next</a></br></br><pre>116d115
< invalidateAccessTokens ∷ [Text] → Request a "invalidateAccessTokens" [SE AccessToken]
117c116
< invalidateAccessTokens (T.intercalate ";" → ts) =
---
> invalidateAccessTokens :: [Text] -> Request a "invalidateAccessTokens" [SE AccessToken]
117a117
> invalidateAccessTokens (T.intercalate ";" -> ts) =
123d122
< readAccessTokens ∷ [Text] → Request a "readAccessTokens" [SE AccessToken]
124c123
< readAccessTokens (T.intercalate ";" → ts) =
---
> readAccessTokens :: [Text] -> Request a "readAccessTokens" [SE AccessToken]
124a124
> readAccessTokens (T.intercalate ";" -> ts) =
130d129
< applicationDeAuthenticate ∷ [Text] → Request a "applicationDeAuthenticate" [SE AccessToken]
131c130
< applicationDeAuthenticate (T.intercalate ";" → ts) =
---
> applicationDeAuthenticate :: [Text] -> Request a "applicationDeAuthenticate" [SE AccessToken]
131a131
> applicationDeAuthenticate (T.intercalate ";" -> ts) =
145c145
< answers ∷ Request a "answers" [SE Answer]
---
> answers :: Request a "answers" [SE Answer]
154d153
< answersByIds ∷ [Int] → Request a "answersByIds" [SE Answer]
155c154
< answersByIds (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> answersByIds :: [Int] -> Request a "answersByIds" [SE Answer]
155a155
> answersByIds (T.intercalate ";" . map (toLazyText . decimal) -> is) =
164d163
< answersOnUsers ∷ [Int] → Request a "answersOnUsers" [SE Answer]
165c164
< answersOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> answersOnUsers :: [Int] -> Request a "answersOnUsers" [SE Answer]
165a165
> answersOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
175d174
< answersOnQuestions ∷ [Int] → Request a "answersOnQuestions" [SE Answer]
176c175
< answersOnQuestions (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> answersOnQuestions :: [Int] -> Request a "answersOnQuestions" [SE Answer]
176a176
> answersOnQuestions (T.intercalate ";" . map (toLazyText . decimal) -> is) =
182c182
< meAnswers ∷ Request RequireToken "meAnswers" [SE Answer]
---
> meAnswers :: Request RequireToken "meAnswers" [SE Answer]
191d190
< topUserAnswersInTags ∷ Int → [Text] → Request a "topUserAnswersInTags" [SE Answer]
192c191
< topUserAnswersInTags (toLazyText . decimal → i) (T.intercalate ";" → ts) =
---
> topUserAnswersInTags :: Int -> [Text] -> Request a "topUserAnswersInTags" [SE Answer]
192a192
> topUserAnswersInTags (toLazyText . decimal -> i) (T.intercalate ";" -> ts) =
198d197
< meTagsTopAnswers ∷ [Text] → Request RequireToken "meTagsTopAnswers" [SE Answer]
199c198
< meTagsTopAnswers (T.intercalate ";" → ts) =
---
> meTagsTopAnswers :: [Text] -> Request RequireToken "meTagsTopAnswers" [SE Answer]
199a199
> meTagsTopAnswers (T.intercalate ";" -> ts) =
213c213
< badges ∷ Request a "badges" [SE Badge]
---
> badges :: Request a "badges" [SE Badge]
222d221
< badgesByIds ∷ [Int] → Request a "badgesByIds" [SE Badge]
223c222
< badgesByIds (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> badgesByIds :: [Int] -> Request a "badgesByIds" [SE Badge]
223a223
> badgesByIds (T.intercalate ";" . map (toLazyText . decimal) -> is) =
232d231
< badgeRecipientsByIds ∷ [Int] → Request a "badgeRecipientsByIds" [SE Badge]
233c232
< badgeRecipientsByIds (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> badgeRecipientsByIds :: [Int] -> Request a "badgeRecipientsByIds" [SE Badge]
233a233
> badgeRecipientsByIds (T.intercalate ";" . map (toLazyText . decimal) -> is) =
243c243
< badgesByName ∷ Request a "badgesByName" [SE Badge]
---
> badgesByName :: Request a "badgesByName" [SE Badge]
253c253
< badgeRecipients ∷ Request a "badgeRecipients" [SE Badge]
---
> badgeRecipients :: Request a "badgeRecipients" [SE Badge]
264c264
< badgesByTag ∷ Request a "badgesByTag" [SE Badge]
---
> badgesByTag :: Request a "badgesByTag" [SE Badge]
274d273
< badgesOnUsers ∷ [Int] → Request a "badgesOnUsers" [SE Badge]
275c274
< badgesOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> badgesOnUsers :: [Int] -> Request a "badgesOnUsers" [SE Badge]
275a275
> badgesOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
281c281
< meBadges ∷ Request RequireToken "meBadges" [SE Badge]
---
> meBadges :: Request RequireToken "meBadges" [SE Badge]
295d294
< commentsOnAnswers ∷ [Int] → Request a "commentsOnAnswers" [SE Comment]
296c295
< commentsOnAnswers (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> commentsOnAnswers :: [Int] -> Request a "commentsOnAnswers" [SE Comment]
296a296
> commentsOnAnswers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
306c306
< comments ∷ Request a "comments" [SE Comment]
---
> comments :: Request a "comments" [SE Comment]
311d310
< deleteComment ∷ Int → Request RequireToken "deleteComment" ()
312c311
< deleteComment (toLazyText . decimal → i) =
---
> deleteComment :: Int -> Request RequireToken "deleteComment" ()
312a312
> deleteComment (toLazyText . decimal -> i) =
317d316
< editComment ∷ Int → Text → Request RequireToken "editComment" (SE Comment)
318c317
< editComment (toLazyText . decimal → i) body =
---
> editComment :: Int -> Text -> Request RequireToken "editComment" (SE Comment)
318a318
> editComment (toLazyText . decimal -> i) body =
329d328
< commentsByIds ∷ [Int] → Request a "commentsByIds" [SE Comment]
330c329
< commentsByIds (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> commentsByIds :: [Int] -> Request a "commentsByIds" [SE Comment]
330a330
> commentsByIds (T.intercalate ";" . map (toLazyText . decimal) -> is) =
339d338
< commentsOnPosts ∷ [Int] → Request a "commentsOnPosts" [SE Comment]
340c339
< commentsOnPosts (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> commentsOnPosts :: [Int] -> Request a "commentsOnPosts" [SE Comment]
340a340
> commentsOnPosts (T.intercalate ";" . map (toLazyText . decimal) -> is) =
346d345
< createComment ∷ Int → Text → Request RequireToken "createComment" (SE Comment)
347c346
< createComment (toLazyText . decimal → i) body =
---
> createComment :: Int -> Text -> Request RequireToken "createComment" (SE Comment)
347a347
> createComment (toLazyText . decimal -> i) body =
358d357
< commentsOnQuestions ∷ [Int] → Request a "commentsOnQuestions" [SE Comment]
359c358
< commentsOnQuestions (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> commentsOnQuestions :: [Int] -> Request a "commentsOnQuestions" [SE Comment]
359a359
> commentsOnQuestions (T.intercalate ";" . map (toLazyText . decimal) -> is) =
369d368
< commentsOnUsers ∷ [Int] → Request a "commentsOnUsers" [SE Comment]
370c369
< commentsOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> commentsOnUsers :: [Int] -> Request a "commentsOnUsers" [SE Comment]
370a370
> commentsOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
376c376
< meComments ∷ Request RequireToken "meComments" [SE Comment]
---
> meComments :: Request RequireToken "meComments" [SE Comment]
385d384
< commentsByUsersToUser ∷ [Int] → Int → Request a "commentsByUsersToUser" [SE Comment]
386d384
< commentsByUsersToUser (T.intercalate ";" . map (toLazyText . decimal) → is)
387c385
<                       (toLazyText . decimal → toid) =
---
> commentsByUsersToUser :: [Int] -> Int -> Request a "commentsByUsersToUser" [SE Comment]
387a386
> commentsByUsersToUser (T.intercalate ";" . map (toLazyText . decimal) -> is)
387a387
>                       (toLazyText . decimal -> toid) =
393d392
< meCommentsTo ∷ Int → Request RequireToken "meCommentsTo" [SE Comment]
394c393
< meCommentsTo (toLazyText . decimal → toid) =
---
> meCommentsTo :: Int -> Request RequireToken "meCommentsTo" [SE Comment]
394a394
> meCommentsTo (toLazyText . decimal -> toid) =
404d403
< mentionsOnUsers ∷ [Int] → Request a "mentionsOnUsers" [SE Comment]
405c404
< mentionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> mentionsOnUsers :: [Int] -> Request a "mentionsOnUsers" [SE Comment]
405a405
> mentionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
411c411
< meMentioned ∷ Request RequireToken "meMentioned" [SE Comment]
---
> meMentioned :: Request RequireToken "meMentioned" [SE Comment]
424c424
< errors ∷ Request a "errors" [SE Error]
---
> errors :: Request a "errors" [SE Error]
433c433
< events ∷ Request RequireToken "events" [SE Event]
---
> events :: Request RequireToken "events" [SE Event]
446d445
< createFilter ∷ [Text] → [Text] → Text → Request a "createFilter" (SE Filter)
447c446
< createFilter (T.intercalate ";" → include) (T.intercalate ";" → exclude) base =
---
> createFilter :: [Text] -> [Text] -> Text -> Request a "createFilter" (SE Filter)
447a447
> createFilter (T.intercalate ";" -> include) (T.intercalate ";" -> exclude) base =
458d457
< readFilter ∷ [Text] → Request a "readFilter" [SE Filter]
459c458
< readFilter (T.intercalate ";" → fs) =
---
> readFilter :: [Text] -> Request a "readFilter" [SE Filter]
459a459
> readFilter (T.intercalate ";" -> fs) =
469c469
< inbox ∷ Request RequireToken "inbox" [SE InboxItem]
---
> inbox :: Request RequireToken "inbox" [SE InboxItem]
476c476
< inboxUnread ∷ Request RequireToken "inboxUnread" [SE InboxItem]
---
> inboxUnread :: Request RequireToken "inboxUnread" [SE InboxItem]
483d482
< userInbox ∷ Int → Request RequireToken "userInbox" [SE InboxItem]
484c483
< userInbox (toLazyText . decimal → i) =
---
> userInbox :: Int -> Request RequireToken "userInbox" [SE InboxItem]
484a484
> userInbox (toLazyText . decimal -> i) =
490c490
< meInbox ∷ Request RequireToken "meInbox" [SE InboxItem]
---
> meInbox :: Request RequireToken "meInbox" [SE InboxItem]
497d496
< userUnreadInbox ∷ Int → Request RequireToken "userUnreadInbox" [SE InboxItem]
498c497
< userUnreadInbox (toLazyText . decimal → i) =
---
> userUnreadInbox :: Int -> Request RequireToken "userUnreadInbox" [SE InboxItem]
498a498
> userUnreadInbox (toLazyText . decimal -> i) =
504c504
< meUnreadInbox ∷ Request RequireToken "meUnreadInbox" [SE InboxItem]
---
> meUnreadInbox :: Request RequireToken "meUnreadInbox" [SE InboxItem]
519c519
< info ∷ Request a "info" (SE Info)
---
> info :: Request a "info" (SE Info)
532d531
< associatedUsers ∷ [Int] → Request a "associatedUsers" [SE NetworkUser]
533c532
< associatedUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> associatedUsers :: [Int] -> Request a "associatedUsers" [SE NetworkUser]
533a533
> associatedUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
539c539
< meAssociatedUsers ∷ Request RequireToken "meAssociatedUsers" [SE NetworkUser]
---
> meAssociatedUsers :: Request RequireToken "meAssociatedUsers" [SE NetworkUser]
554d553
< mergeHistory ∷ [Int] → Request a "mergeHistory" [SE AccountMerge]
555c554
< mergeHistory (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> mergeHistory :: [Int] -> Request a "mergeHistory" [SE AccountMerge]
555a555
> mergeHistory (T.intercalate ";" . map (toLazyText . decimal) -> is) =
561c561
< meMergeHistory ∷ Request RequireToken "meMergeHistory" [SE AccountMerge]
---
> meMergeHistory :: Request RequireToken "meMergeHistory" [SE AccountMerge]
572c572
< notifications ∷ Request RequireToken "notifications" [SE Notification]
---
> notifications :: Request RequireToken "notifications" [SE Notification]
577c577
< notificationsUnread ∷ Request RequireToken "notificationsUnread" [SE Notification]
---
> notificationsUnread :: Request RequireToken "notificationsUnread" [SE Notification]
582d581
< userNotifications ∷ Int → Request RequireToken "userNotifications" [SE Notification]
583c582
< userNotifications (toLazyText . decimal → i) =
---
> userNotifications :: Int -> Request RequireToken "userNotifications" [SE Notification]
583a583
> userNotifications (toLazyText . decimal -> i) =
589c589
< meNotifications ∷ Request RequireToken "meNotifications" [SE Notification]
---
> meNotifications :: Request RequireToken "meNotifications" [SE Notification]
596d595
< userUnreadNotifications ∷ Int → Request RequireToken "userUnreadNotifications" [SE Notification]
597c596
< userUnreadNotifications (toLazyText . decimal → i) =
---
> userUnreadNotifications :: Int -> Request RequireToken "userUnreadNotifications" [SE Notification]
597a597
> userUnreadNotifications (toLazyText . decimal -> i) =
603c603
< meUnreadNotifications ∷ Request RequireToken "meUnreadNotifications" [SE Notification]
---
> meUnreadNotifications :: Request RequireToken "meUnreadNotifications" [SE Notification]
618c618
< posts ∷ Request a "posts" [SE Post]
---
> posts :: Request a "posts" [SE Post]
627d626
< postsByIds ∷ [Int] → Request a "postsByIds" [SE Post]
628c627
< postsByIds (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> postsByIds :: [Int] -> Request a "postsByIds" [SE Post]
628a628
> postsByIds (T.intercalate ";" . map (toLazyText . decimal) -> is) =
641c641
< privileges ∷ Request a "privileges" [SE Privilege]
---
> privileges :: Request a "privileges" [SE Privilege]
650d649
< privilegesOnUsers ∷ Int → Request a "privilegesOnUsers" [SE Privilege]
651c650
< privilegesOnUsers (toLazyText . decimal → i) =
---
> privilegesOnUsers :: Int -> Request a "privilegesOnUsers" [SE Privilege]
651a651
> privilegesOnUsers (toLazyText . decimal -> i) =
657c657
< mePriviledges ∷ Request RequireToken "mePriviledges" [SE Privilege]
---
> mePriviledges :: Request RequireToken "mePriviledges" [SE Privilege]
670c670
< questions ∷ Request a "questions" [SE Question]
---
> questions :: Request a "questions" [SE Question]
679d678
< questionsByIds ∷ [Int] → Request a "questionsByIds" [SE Question]
680c679
< questionsByIds (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> questionsByIds :: [Int] -> Request a "questionsByIds" [SE Question]
680a680
> questionsByIds (T.intercalate ";" . map (toLazyText . decimal) -> is) =
689d688
< linkedQuestions ∷ [Int] → Request a "linkedQuestions" [SE Question]
690c689
< linkedQuestions (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> linkedQuestions :: [Int] -> Request a "linkedQuestions" [SE Question]
690a690
> linkedQuestions (T.intercalate ";" . map (toLazyText . decimal) -> is) =
700d699
< relatedQuestions ∷ [Int] → Request a "relatedQuestions" [SE Question]
701c700
< relatedQuestions (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> relatedQuestions :: [Int] -> Request a "relatedQuestions" [SE Question]
701a701
> relatedQuestions (T.intercalate ";" . map (toLazyText . decimal) -> is) =
711c711
< featuredQuestions ∷ Request a "featuredQuestions" [SE Question]
---
> featuredQuestions :: Request a "featuredQuestions" [SE Question]
721c721
< unansweredQuestions ∷ Request a "unansweredQuestions" [SE Question]
---
> unansweredQuestions :: Request a "unansweredQuestions" [SE Question]
732c732
< noAnswerQuestions ∷ Request a "noAnswerQuestions" [SE Question]
---
> noAnswerQuestions :: Request a "noAnswerQuestions" [SE Question]
743d742
< search ∷ Text → [Text] → Request a "search" [SE Question]
744c743
< search t (T.intercalate ";" → ts) =
---
> search :: Text -> [Text] -> Request a "search" [SE Question]
744a744
> search t (T.intercalate ";" -> ts) =
755c755
< advancedSearch ∷ Request a "advancedSearch" [SE Question]
---
> advancedSearch :: Request a "advancedSearch" [SE Question]
765d764
< similar ∷ Text → [Text] → Request a "similar" [SE Question]
766c765
< similar t (T.intercalate ";" → ts) =
---
> similar :: Text -> [Text] -> Request a "similar" [SE Question]
766a766
> similar t (T.intercalate ";" -> ts) =
777d776
< faqsByTags ∷ [Text] → Request a "faqsByTags" [SE Question]
778c777
< faqsByTags (T.intercalate ";" → ts) =
---
> faqsByTags :: [Text] -> Request a "faqsByTags" [SE Question]
778a778
> faqsByTags (T.intercalate ";" -> ts) =
788d787
< favoritesOnUsers ∷ [Int] → Request a "favoritesOnUsers" [SE Question]
789c788
< favoritesOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> favoritesOnUsers :: [Int] -> Request a "favoritesOnUsers" [SE Question]
789a789
> favoritesOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
795c795
< meFavorites ∷ Request RequireToken "meFavorites" [SE Question]
---
> meFavorites :: Request RequireToken "meFavorites" [SE Question]
804d803
< questionsOnUsers ∷ [Int] → Request a "questionsOnUsers" [SE Question]
805c804
< questionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> questionsOnUsers :: [Int] -> Request a "questionsOnUsers" [SE Question]
805a805
> questionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
811c811
< meQuestions ∷ Request RequireToken "meQuestions" [SE Question]
---
> meQuestions :: Request RequireToken "meQuestions" [SE Question]
820d819
< featuredQuestionsOnUsers ∷ [Int] → Request a "featuredQuestionsOnUsers" [SE Question]
821c820
< featuredQuestionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> featuredQuestionsOnUsers :: [Int] -> Request a "featuredQuestionsOnUsers" [SE Question]
821a821
> featuredQuestionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
827c827
< meFeaturedQuestions ∷ Request RequireToken "meFeaturedQuestions" [SE Question]
---
> meFeaturedQuestions :: Request RequireToken "meFeaturedQuestions" [SE Question]
837d836
< noAnswerQuestionsOnUsers ∷ [Int] → Request a "noAnswerQuestionsOnUsers" [SE Question]
838c837
< noAnswerQuestionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> noAnswerQuestionsOnUsers :: [Int] -> Request a "noAnswerQuestionsOnUsers" [SE Question]
838a838
> noAnswerQuestionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
844c844
< meNoAnswerQuestions ∷ Request RequireToken "meNoAnswerQuestions" [SE Question]
---
> meNoAnswerQuestions :: Request RequireToken "meNoAnswerQuestions" [SE Question]
853d852
< unacceptedQuestionsOnUsers ∷ [Int] → Request a "unacceptedQuestionsOnUsers" [SE Question]
854c853
< unacceptedQuestionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> unacceptedQuestionsOnUsers :: [Int] -> Request a "unacceptedQuestionsOnUsers" [SE Question]
854a854
> unacceptedQuestionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
860c860
< meUnacceptedQuestions ∷ Request RequireToken "meUnacceptedQuestions" [SE Question]
---
> meUnacceptedQuestions :: Request RequireToken "meUnacceptedQuestions" [SE Question]
870d869
< unansweredQuestionsOnUsers ∷ [Int] → Request a "unansweredQuestionsOnUsers" [SE Question]
871c870
< unansweredQuestionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> unansweredQuestionsOnUsers :: [Int] -> Request a "unansweredQuestionsOnUsers" [SE Question]
871a871
> unansweredQuestionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
877c877
< meUnansweredQuestions ∷ Request RequireToken "meUnansweredQuestions" [SE Question]
---
> meUnansweredQuestions :: Request RequireToken "meUnansweredQuestions" [SE Question]
886d885
< topUserQuestionsInTags ∷ Int → [Text] → Request a "topUserQuestionsInTags" [SE Question]
887c886
< topUserQuestionsInTags (toLazyText . decimal → i) (T.intercalate ";" → ts) =
---
> topUserQuestionsInTags :: Int -> [Text] -> Request a "topUserQuestionsInTags" [SE Question]
887a887
> topUserQuestionsInTags (toLazyText . decimal -> i) (T.intercalate ";" -> ts) =
893d892
< meTagsTopQuestions ∷ [Text] → Request RequireToken "meTagsTopQuestions" [SE Question]
894c893
< meTagsTopQuestions (T.intercalate ";" → ts) =
---
> meTagsTopQuestions :: [Text] -> Request RequireToken "meTagsTopQuestions" [SE Question]
894a894
> meTagsTopQuestions (T.intercalate ";" -> ts) =
908d907
< questionsTimeline ∷ [Int] → Request a "questionsTimeline" [SE QuestionTimeline]
909c908
< questionsTimeline (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> questionsTimeline :: [Int] -> Request a "questionsTimeline" [SE QuestionTimeline]
909a909
> questionsTimeline (T.intercalate ";" . map (toLazyText . decimal) -> is) =
923d922
< reputationOnUsers ∷ [Int] → Request a "reputationOnUsers" [SE Reputation]
924c923
< reputationOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> reputationOnUsers :: [Int] -> Request a "reputationOnUsers" [SE Reputation]
924a924
> reputationOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
930c930
< meReputation ∷ Request RequireToken "meReputation" [SE Reputation]
---
> meReputation :: Request RequireToken "meReputation" [SE Reputation]
943d942
< reputationHistory ∷ [Int] → Request a "reputationHistory" [SE ReputationHistory]
944c943
< reputationHistory (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> reputationHistory :: [Int] -> Request a "reputationHistory" [SE ReputationHistory]
944a944
> reputationHistory (T.intercalate ";" . map (toLazyText . decimal) -> is) =
950c950
< meReputationHistory ∷ Request RequireToken "meReputationHistory" [SE ReputationHistory]
---
> meReputationHistory :: Request RequireToken "meReputationHistory" [SE ReputationHistory]
957d956
< reputationHistoryFull ∷ [Int] → Request RequireToken "reputationHistoryFull" [SE ReputationHistory]
958c957
< reputationHistoryFull (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> reputationHistoryFull :: [Int] -> Request RequireToken "reputationHistoryFull" [SE ReputationHistory]
958a958
> reputationHistoryFull (T.intercalate ";" . map (toLazyText . decimal) -> is) =
964c964
< meReputationHistoryFull ∷ Request RequireToken "meReputationHistoryFull" [SE ReputationHistory]
---
> meReputationHistoryFull :: Request RequireToken "meReputationHistoryFull" [SE ReputationHistory]
979d978
< revisionsByIds ∷ [Int] → Request a "revisionsByIds" [SE Revision]
980c979
< revisionsByIds (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> revisionsByIds :: [Int] -> Request a "revisionsByIds" [SE Revision]
980a980
> revisionsByIds (T.intercalate ";" . map (toLazyText . decimal) -> is) =
990d989
< revisionsByGuids ∷ [Text] → Request a "revisionsByGuids" [SE Revision]
991c990
< revisionsByGuids (T.intercalate ";" → is) =
---
> revisionsByGuids :: [Text] -> Request a "revisionsByGuids" [SE Revision]
991a991
> revisionsByGuids (T.intercalate ";" -> is) =
1005c1005
< sites ∷ Request a "sites" [SE Site]
---
> sites :: Request a "sites" [SE Site]
1019d1018
< postsOnSuggestedEdits ∷ [Int] → Request a "postsOnSuggestedEdits" [SE SuggestedEdit]
1020c1019
< postsOnSuggestedEdits (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> postsOnSuggestedEdits :: [Int] -> Request a "postsOnSuggestedEdits" [SE SuggestedEdit]
1020a1020
> postsOnSuggestedEdits (T.intercalate ";" . map (toLazyText . decimal) -> is) =
1030c1030
< suggestedEdits ∷ Request a "suggestedEdits" [SE SuggestedEdit]
---
> suggestedEdits :: Request a "suggestedEdits" [SE SuggestedEdit]
1041d1040
< suggestedEditsByIds ∷ [Int] → Request a "suggestedEditsByIds" [SE SuggestedEdit]
1042c1041
< suggestedEditsByIds (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> suggestedEditsByIds :: [Int] -> Request a "suggestedEditsByIds" [SE SuggestedEdit]
1042a1042
> suggestedEditsByIds (T.intercalate ";" . map (toLazyText . decimal) -> is) =
1053d1052
< suggestedEditsOnUsers ∷ [Int] → Request a "suggestedEditsOnUsers" [SE SuggestedEdit]
1054c1053
< suggestedEditsOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> suggestedEditsOnUsers :: [Int] -> Request a "suggestedEditsOnUsers" [SE SuggestedEdit]
1054a1054
> suggestedEditsOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
1060c1060
< meSuggestedEdits ∷ Request RequireToken "meSuggestedEdits" [SE SuggestedEdit]
---
> meSuggestedEdits :: Request RequireToken "meSuggestedEdits" [SE SuggestedEdit]
1075c1075
< tags ∷ Request a "tags" [SE Tag]
---
> tags :: Request a "tags" [SE Tag]
1084c1084
< moderatorOnlyTags ∷ Request a "moderatorOnlyTags" [SE Tag]
---
> moderatorOnlyTags :: Request a "moderatorOnlyTags" [SE Tag]
1095c1095
< requiredTags ∷ Request a "requiredTags" [SE Tag]
---
> requiredTags :: Request a "requiredTags" [SE Tag]
1105d1104
< tagsByName ∷ [Text] → Request a "tagsByName" [SE Tag]
1106c1105
< tagsByName (T.intercalate ";" → ts) =
---
> tagsByName :: [Text] -> Request a "tagsByName" [SE Tag]
1106a1106
> tagsByName (T.intercalate ";" -> ts) =
1116d1115
< relatedTags ∷ [Text] → Request a "relatedTags" [SE Tag]
1117c1116
< relatedTags (T.intercalate ";" → ts) =
---
> relatedTags :: [Text] -> Request a "relatedTags" [SE Tag]
1117a1117
> relatedTags (T.intercalate ";" -> ts) =
1127d1126
< tagsOnUsers ∷ [Int] → Request a "tagsOnUsers" [SE Tag]
1128c1127
< tagsOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> tagsOnUsers :: [Int] -> Request a "tagsOnUsers" [SE Tag]
1128a1128
> tagsOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
1134c1134
< meTags ∷ Request RequireToken "meTags" [SE Tag]
---
> meTags :: Request RequireToken "meTags" [SE Tag]
1147c1147
< topAnswerersOnTag ∷ Text → Text → Request a "topAnswerersOnTag" [SE TagScore]
---
> topAnswerersOnTag :: Text -> Text -> Request a "topAnswerersOnTag" [SE TagScore]
1158c1158
< topAskersOnTag ∷ Text → Text → Request a "topAskersOnTag" [SE TagScore]
---
> topAskersOnTag :: Text -> Text -> Request a "topAskersOnTag" [SE TagScore]
1173c1173
< tagSynonyms ∷ Request a "tagSynonyms" [SE TagSynonym]
---
> tagSynonyms :: Request a "tagSynonyms" [SE TagSynonym]
1183d1182
< synonymsByTags ∷ [Text] → Request a "synonymsByTags" [SE TagSynonym]
1184c1183
< synonymsByTags (T.intercalate ";" → ts) =
---
> synonymsByTags :: [Text] -> Request a "synonymsByTags" [SE TagSynonym]
1184a1184
> synonymsByTags (T.intercalate ";" -> ts) =
1198d1197
< wikisByTags ∷ [Text] → Request a "wikisByTags" [SE TagWiki]
1199c1198
< wikisByTags (T.intercalate ";" → ts) =
---
> wikisByTags :: [Text] -> Request a "wikisByTags" [SE TagWiki]
1199a1199
> wikisByTags (T.intercalate ";" -> ts) =
1213d1212
< topAnswerTagsOnUsers ∷ Int → Request a "topAnswerTagsOnUsers" [SE TopTag]
1214c1213
< topAnswerTagsOnUsers (toLazyText . decimal → i) =
---
> topAnswerTagsOnUsers :: Int -> Request a "topAnswerTagsOnUsers" [SE TopTag]
1214a1214
> topAnswerTagsOnUsers (toLazyText . decimal -> i) =
1220c1220
< meTopAnswerTags ∷ Request RequireToken "meTopAnswerTags" [SE TopTag]
---
> meTopAnswerTags :: Request RequireToken "meTopAnswerTags" [SE TopTag]
1229d1228
< topQuestionTagsOnUsers ∷ Int → Request a "topQuestionTagsOnUsers" [SE TopTag]
1230c1229
< topQuestionTagsOnUsers (toLazyText . decimal → i) =
---
> topQuestionTagsOnUsers :: Int -> Request a "topQuestionTagsOnUsers" [SE TopTag]
1230a1230
> topQuestionTagsOnUsers (toLazyText . decimal -> i) =
1236c1236
< meTopQuestionTags ∷ Request RequireToken "meTopQuestionTags" [SE TopTag]
---
> meTopQuestionTags :: Request RequireToken "meTopQuestionTags" [SE TopTag]
1249c1249
< users ∷ Request a "users" [SE User]
---
> users :: Request a "users" [SE User]
1258d1257
< usersByIds ∷ [Int] → Request a "usersByIds" [SE User]
1259c1258
< usersByIds (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> usersByIds :: [Int] -> Request a "usersByIds" [SE User]
1259a1259
> usersByIds (T.intercalate ";" . map (toLazyText . decimal) -> is) =
1264c1264
< me ∷ Request RequireToken "me" (SE User)
---
> me :: Request RequireToken "me" (SE User)
1273c1273
< moderators ∷ Request a "moderators" [SE User]
---
> moderators :: Request a "moderators" [SE User]
1283c1283
< electedModerators ∷ Request a "electedModerators" [SE User]
---
> electedModerators :: Request a "electedModerators" [SE User]
1298d1297
< timelineOnUsers ∷ [Int] → Request a "timelineOnUsers" [SE UserTimeline]
1299c1298
< timelineOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
---
> timelineOnUsers :: [Int] -> Request a "timelineOnUsers" [SE UserTimeline]
1299a1299
> timelineOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
1305c1305
< meTimeline ∷ Request RequireToken "meTimeline" [SE UserTimeline]
---
> meTimeline :: Request RequireToken "meTimeline" [SE UserTimeline]
1318d1317
< writePermissions ∷ Int → Request a "writePermissions" [SE WritePermission]
1319c1318
< writePermissions (toLazyText . decimal → i) =
---
> writePermissions :: Int -> Request a "writePermissions" [SE WritePermission]
1319a1319
> writePermissions (toLazyText . decimal -> i) =
1325c1325
< meWritePermissions ∷ Request RequireToken "meWritePermissions" [SE WritePermission]
---
> meWritePermissions :: Request RequireToken "meWritePermissions" [SE WritePermission]
1329c1329
< attoparsec ∷ (Maybe Value → Maybe b) → String → ByteString → b
---
> attoparsec :: (Maybe Value -> Maybe b) -> String -> ByteString -> b
1331d1330
<   Right s → case f (Just s) of
1332d1330
<     Just b → b
1333d1330
<     Nothing → throw $ SEException request ("libstackexchange" ++ msg ++ "incorrect JSON content")
1334c1331
<   Left e → throw $ SEException request ("libstackexchange" ++ msg ++ e)
---
>   Right s -> case f (Just s) of
1334a1332
>     Just b -> b
1334a1333
>     Nothing -> throw $ SEException request ("libstackexchange" ++ msg ++ "incorrect JSON content")
1334a1334
>   Left e -> throw $ SEException request ("libstackexchange" ++ msg ++ e)
1337c1337
< items ∷ Maybe Value → Maybe [SE a]
---
> items :: Maybe Value -> Maybe [SE a]
1338a1339
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE DataKinds #-}
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE UnicodeSyntax #-}
{-# LANGUAGE ViewPatterns #-}
-- | API methods list
module Network.StackExchange.API
  ( -- * SE AccessToken
    readAccessTokens, invalidateAccessTokens, applicationDeAuthenticate
    -- * SE Answer
  , answers, answersByIds, answersOnUsers
  , answersOnQuestions, meAnswers, topUserAnswersInTags, meTagsTopAnswers
    -- * SE Badge
  , badges, badgesByIds, badgeRecipientsByIds
  , badgesByName, badgeRecipients, badgesByTag
  , badgesOnUsers, meBadges
    -- * SE Comment
  , commentsOnAnswers, comments, commentsByIds, deleteComment, editComment
  , commentsOnPosts, createComment, commentsOnQuestions
  , commentsOnUsers, meComments, commentsByUsersToUser, meCommentsTo
  , mentionsOnUsers, meMentioned
    -- * SE Error
  , errors
    -- * SE Event
  , events
    -- * SE Filter
  , createFilter, readFilter
    -- * SE InboxItems
  , inbox, inboxUnread, userInbox, meInbox, userUnreadInbox, meUnreadInbox
    -- * SE Info
  , info
    -- * SE NetworkUser
  , associatedUsers, meAssociatedUsers
    -- * SE AccountMerge
  , mergeHistory, meMergeHistory
    -- * SE Notification
  , notifications, notificationsUnread, userNotifications, meNotifications
  , userUnreadNotifications, meUnreadNotifications
    -- * SE Post
  , posts, postsByIds
    -- * SE Privilege
  , privileges, privilegesOnUsers, mePriviledges
    -- * SE Question
  , questions, questionsByIds, linkedQuestions, relatedQuestions
  , featuredQuestions, unansweredQuestions, noAnswerQuestions
  , search, advancedSearch, similar, faqsByTags, favoritesOnUsers
  , meFavorites, questionsOnUsers, meQuestions, featuredQuestionsOnUsers
  , meFeaturedQuestions, noAnswerQuestionsOnUsers, meNoAnswerQuestions
  , unacceptedQuestionsOnUsers, meUnacceptedQuestions, unansweredQuestionsOnUsers
  , meUnansweredQuestions, topUserQuestionsInTags, meTagsTopQuestions
    -- * SE QuestionTimeline
  , questionsTimeline
    -- * SE Reputation
  , reputationOnUsers, meReputation
    -- * SE ReputationHistory
  , reputationHistory, reputationHistoryFull
  , meReputationHistory, meReputationHistoryFull
    -- * SE Revision
  , revisionsByIds, revisionsByGuids
    -- * SE Site
  , sites
    -- * SE SuggestedEdit
  , postsOnSuggestedEdits, suggestedEdits, suggestedEditsByIds
  , suggestedEditsOnUsers, meSuggestedEdits
    -- * SE Tag
  , tags, moderatorOnlyTags, requiredTags
  , tagsByName, relatedTags, tagsOnUsers, meTags
    -- * SE TagScore
  , topAnswerersOnTag, topAskersOnTag
    -- * SE TagSynonym
  , tagSynonyms, synonymsByTags
    -- * SE TagWiki
  , wikisByTags
    -- * SE TopTag
  , topAnswerTagsOnUsers, topQuestionTagsOnUsers
  , meTopAnswerTags, meTopQuestionTags
    -- * SE User
  , users, usersByIds, me, moderators, electedModerators
    -- * SE UserTimeline
  , timelineOnUsers, meTimeline
    -- * SE WritePermission
  , writePermissions, meWritePermissions
  ) where

import Data.Monoid ((<>))

import           Control.Exception (throw)
import           Data.Aeson ((.:), Value)
import qualified Data.Aeson as A
import qualified Data.Aeson.Types as A
import qualified Data.Attoparsec.Lazy as AP
import           Data.ByteString.Lazy (ByteString)
import           Data.Text.Lazy (Text)
import qualified Data.Text.Lazy as T
import           Data.Text.Lazy.Builder (toLazyText)
import           Data.Text.Lazy.Builder.Int (decimal)

import Network.StackExchange.Response
import Network.StackExchange.Request

-- $setup
-- >>> import           Control.Applicative
-- >>> import           Control.Lens
-- >>> import qualified Data.Aeson.Lens as L
-- >>> import           Data.Maybe (catMaybes, isJust)
-- >>> let pagesize = 10 :: Int
-- >>> let checkLengthM f = ((== pagesize) . length) `fmap` f
-- >>> let k = key "Lhg6xe5d5BvNK*C0S8jijA(("
-- >>> let s = site "stackoverflow"
-- >>> let q = query [("pagesize", "10")]

--------------------------
-- Access Tokens
--------------------------

-- | <https://api.stackexchange.com/docs/invalidate-access-tokens>
invalidateAccessTokens ∷ [Text] → Request a "invalidateAccessTokens" [SE AccessToken]
invalidateAccessTokens (T.intercalate ";" → ts) =
  path ("access-tokens/" <> ts <> "/invalidate") <>
  parse (attoparsec items ".access-tokens/{accessTokens}/invalidate: ")


-- | <https://api.stackexchange.com/docs/read-access-tokens>
readAccessTokens ∷ [Text] → Request a "readAccessTokens" [SE AccessToken]
readAccessTokens (T.intercalate ";" → ts) =
  path ("access-tokens/" <> ts) <>
  parse (attoparsec items ".access-tokens/{accessTokens}: ")


-- | <https://api.stackexchange.com/docs/application-de-authenticate>
applicationDeAuthenticate ∷ [Text] → Request a "applicationDeAuthenticate" [SE AccessToken]
applicationDeAuthenticate (T.intercalate ";" → ts) =
  path ("apps/" <> ts <> "/de-authenticate") <>
  parse (attoparsec items ".apps/{accessTokens}/de-authenticate: ")


--------------------------
-- Answers
--------------------------

-- $answers
-- >>> checkLengthM $ askSE (answers <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/answers>
answers ∷ Request a "answers" [SE Answer]
answers = path "answers" <> parse (attoparsec items ".answers: ")


-- $answersByIds
-- >>> length `fmap` askSE (answersByIds [6841479, 215422, 8881376] <> s <> k)
-- 3

-- | <https://api.stackexchange.com/docs/answers-by-ids>
answersByIds ∷ [Int] → Request a "answersByIds" [SE Answer]
answersByIds (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("answers/" <> is) <> parse (attoparsec items ".answers/{ids}: ")


-- $answersOnUsers
-- >>> checkLengthM $ askSE (answersOnUsers [972985] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/answers-on-users>
answersOnUsers ∷ [Int] → Request a "answersOnUsers" [SE Answer]
answersOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is <> "/answers") <>
  parse (attoparsec items ".users/{ids}/answers: ")


-- $answersOnQuestions
-- >>> checkLengthM $ askSE (answersOnQuestions [394601] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/answers-on-questions>
answersOnQuestions ∷ [Int] → Request a "answersOnQuestions" [SE Answer]
answersOnQuestions (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("questions/" <> is <> "/answers") <>
  parse (attoparsec items ".questions/{ids}/answers: ")


-- | <https://api.stackexchange.com/docs/me-answers>
meAnswers ∷ Request RequireToken "meAnswers" [SE Answer]
meAnswers =
  path "me/answers" <> parse (attoparsec items ".me/answers: ")

-- $topUserAnswersInTags
-- >>> checkLengthM $ askSE (topUserAnswersInTags 1097181 ["haskell"] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/top-user-answers-in-tags>
topUserAnswersInTags ∷ Int → [Text] → Request a "topUserAnswersInTags" [SE Answer]
topUserAnswersInTags (toLazyText . decimal → i) (T.intercalate ";" → ts) =
  path ("users/" <> i <> "/tags/" <> ts <> "/top-answers") <>
  parse (attoparsec items ".users/{id}/tags/{tags}/top-answers: ")


-- | <https://api.stackexchange.com/docs/me-tags-top-answers>
meTagsTopAnswers ∷ [Text] → Request RequireToken "meTagsTopAnswers" [SE Answer]
meTagsTopAnswers (T.intercalate ";" → ts) =
  path ("me/tags/" <> ts <> "/top-answers") <>
  parse (attoparsec items ".me/tags/{tags}/top-answers: ")


--------------------------
-- Badges
--------------------------

-- $badges
-- >>> checkLengthM $ askSE (badges <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/badges>
badges ∷ Request a "badges" [SE Badge]
badges = path "badges" <> parse (attoparsec items ".badges: ")


-- $badgesByIds
-- >>> length `fmap` askSE (badgesByIds [20] <> s <> k <> q)
-- 1

-- | <https://api.stackexchange.com/docs/badges-by-ids>
badgesByIds ∷ [Int] → Request a "badgesByIds" [SE Badge]
badgesByIds (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("badges/" <> is) <> parse (attoparsec items ".badges/{ids}: ")


-- $badgeRecipientsByIds
-- >>> checkLengthM $ askSE (badgeRecipientsByIds [20] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/badge-recipients-by-ids>
badgeRecipientsByIds ∷ [Int] → Request a "badgeRecipientsByIds" [SE Badge]
badgeRecipientsByIds (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("badges/" <> is <> "/recipients") <>
  parse (attoparsec items ".badges/{ids}/recipients: ")


-- $badgesByName
-- >>> checkLengthM $ askSE (badgesByName <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/badges-by-name>
badgesByName ∷ Request a "badgesByName" [SE Badge]
badgesByName =
  path ("badges" <> "/name") <> parse (attoparsec items ".badges/name: ")


-- $badgeRecipients
-- >>> checkLengthM $ askSE (badgeRecipients <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/badge-recipients>
badgeRecipients ∷ Request a "badgeRecipients" [SE Badge]
badgeRecipients =
  path ("badges" <> "/recipients") <>
  parse (attoparsec items ".badges/recipients: ")


-- $badgesByTag
-- >>> checkLengthM $ askSE (badgesByTag <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/badges-by-tag>
badgesByTag ∷ Request a "badgesByTag" [SE Badge]
badgesByTag =
  path ("badges" <> "/tags") <> parse (attoparsec items ".badges/tags: ")


-- $badgesOnUsers
-- >>> checkLengthM $ askSE (badgesOnUsers [1097181] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/badges-on-users>
badgesOnUsers ∷ [Int] → Request a "badgesOnUsers" [SE Badge]
badgesOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is <> "/badges") <>
  parse (attoparsec items ".users/{ids}/badges: ")


-- | <https://api.stackexchange.com/docs/me-badges>
meBadges ∷ Request RequireToken "meBadges" [SE Badge]
meBadges = path "me/badges" <> parse (attoparsec items ".me/badges: ")



--------------------------
-- Comments
--------------------------

-- $commentsOnAnswers
-- >>> checkLengthM $ askSE (commentsOnAnswers [394837] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/comments-on-answers>
commentsOnAnswers ∷ [Int] → Request a "commentsOnAnswers" [SE Comment]
commentsOnAnswers (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("answers/" <> is <> "/comments") <>
  parse (attoparsec items ".answers/{ids}/comments: ")


-- $comments
-- >>> checkLengthM $ askSE (comments <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/comments>
comments ∷ Request a "comments" [SE Comment]
comments = path "comments" <> parse (attoparsec items ".comments: ")


-- | <https://api.stackexchange.com/docs/delete-comment>
deleteComment ∷ Int → Request RequireToken "deleteComment" ()
deleteComment (toLazyText . decimal → i) =
  path ("comments/" <> i <> "/delete")


-- | <https://api.stackexchange.com/docs/edit-comment>
editComment ∷ Int → Text → Request RequireToken "editComment" (SE Comment)
editComment (toLazyText . decimal → i) body =
  path ("comments/" <> i <> "/edit") <>
  query [("body", body)] <>
  parse (attoparsec (fmap SE) ".comments/{id}/edit:")


-- $commentsByIds
-- >>> length `fmap` askSE (commentsByIds [1218390] <> s <> k)
-- 1

-- | <https://api.stackexchange.com/docs/comments-by-ids>
commentsByIds ∷ [Int] → Request a "commentsByIds" [SE Comment]
commentsByIds (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("comments/" <> is) <> parse (attoparsec items ".comments/{ids}: ")


-- $commentsOnPosts
-- >>> checkLengthM $ askSE (commentsOnPosts [394837] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/comments-on-posts>
commentsOnPosts ∷ [Int] → Request a "commentsOnPosts" [SE Comment]
commentsOnPosts (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("posts/" <> is <> "/comments") <>
  parse (attoparsec items ".posts/{ids}/comments: ")


-- | <https://api.stackexchange.com/docs/create-comment>
createComment ∷ Int → Text → Request RequireToken "createComment" (SE Comment)
createComment (toLazyText . decimal → i) body =
  path ("posts/" <> i <> "/comments/add") <>
  query [("body", body)] <>
  parse (attoparsec (fmap SE) ".posts/{id}/comments/add:")


-- $commentsOnQuestions
-- >>> checkLengthM $ askSE (commentsOnQuestions [394601] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/comments-on-questions>
commentsOnQuestions ∷ [Int] → Request a "commentsOnQuestions" [SE Comment]
commentsOnQuestions (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("questions/" <> is <> "/comments") <>
  parse (attoparsec items ".questions/{ids}/comments: ")


-- $commentsOnUsers
-- >>> checkLengthM $ askSE (commentsOnUsers [1097181] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/comments-on-users>
commentsOnUsers ∷ [Int] → Request a "commentsOnUsers" [SE Comment]
commentsOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is <> "/comments") <>
  parse (attoparsec items ".users/{ids}/comments: ")


-- | <https://api.stackexchange.com/docs/me-comments>
meComments ∷ Request RequireToken "meComments" [SE Comment]
meComments = path "me/comments" <> parse (attoparsec items ".me/comments: ")


-- $commentsByUsersToUser
-- >>> checkLengthM $ askSE (commentsByUsersToUser [230461,1011995,157360] 1097181 <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/comments-by-users-to-user>
commentsByUsersToUser ∷ [Int] → Int → Request a "commentsByUsersToUser" [SE Comment]
commentsByUsersToUser (T.intercalate ";" . map (toLazyText . decimal) → is)
                      (toLazyText . decimal → toid) =
  path ("users/" <> is <> "/comments/" <> toid) <>
  parse (attoparsec items ".users/{ids}/comments/{toid}: ")


-- | <https://api.stackexchange.com/docs/me-comments-to>
meCommentsTo ∷ Int → Request RequireToken "meCommentsTo" [SE Comment]
meCommentsTo (toLazyText . decimal → toid) =
  path ("me/comments/" <> toid) <>
  parse (attoparsec items ".me/comments/{toid}:")


-- $mentionsOnUsers
-- >>> checkLengthM $ askSE (mentionsOnUsers [1097181] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/mentions-on-users>
mentionsOnUsers ∷ [Int] → Request a "mentionsOnUsers" [SE Comment]
mentionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is <> "/mentioned") <>
  parse (attoparsec items ".users/{ids}/mentioned: ")


-- | <https://api.stackexchange.com/docs/me-mentioned>
meMentioned ∷ Request RequireToken "meMentioned" [SE Comment]
meMentioned = path "me/mentioned" <> parse (attoparsec items ".me/mentioned: ")


--------------------------
-- Errors
--------------------------

-- $errors
-- >>> checkLengthM $ askSE (errors <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/errors>
errors ∷ Request a "errors" [SE Error]
errors = path "errors" <> parse (attoparsec items ".errors: ")


--------------------------
-- Events
--------------------------

-- | <https://api.stackexchange.com/docs/events>
events ∷ Request RequireToken "events" [SE Event]
events = path "events" <> parse (attoparsec items ".events: ")


--------------------------
-- Filters
--------------------------

-- $createFilter
-- >>> (^. from se . L.key "items" . L.nth 0 . L.key "filter" . L.asText) <$> askSE (createFilter [] [] "none" <> k)
-- Just "none"

-- | <https://api.stackexchange.com/docs/create-filter>
createFilter ∷ [Text] → [Text] → Text → Request a "createFilter" (SE Filter)
createFilter (T.intercalate ";" → include) (T.intercalate ";" → exclude) base =
  path "filter/create" <>
  query [("include", include), ("exclude", exclude), ("base", base)] <>
  parse (attoparsec (fmap SE) ".filter/create: ")


-- $readFilter
-- >>> (^.. traverse . from se . L.key "filter" . L.asText) <$> askSE (readFilter ["none"] <> k)
-- [Just "none"]

-- | <https://api.stackexchange.com/docs/read-filter>
readFilter ∷ [Text] → Request a "readFilter" [SE Filter]
readFilter (T.intercalate ";" → fs) =
  path ("filters/" <> fs) <>
  parse (attoparsec items ".filters/{filters}: ")


--------------------------
-- Inbox Items
--------------------------

-- | <https://api.stackexchange.com/docs/inbox>
inbox ∷ Request RequireToken "inbox" [SE InboxItem]
inbox =
  path "inbox" <>
  parse (attoparsec items ".inbox: ")


-- | <https://api.stackexchange.com/docs/inbox-unread>
inboxUnread ∷ Request RequireToken "inboxUnread" [SE InboxItem]
inboxUnread =
  path "inbox/unread" <>
  parse (attoparsec items ".inbox/unread: ")


-- | <https://api.stackexchange.com/docs/user-inbox>
userInbox ∷ Int → Request RequireToken "userInbox" [SE InboxItem]
userInbox (toLazyText . decimal → i) =
  path ("users/" <> i <> "/inbox") <>
  parse (attoparsec items ".users/{id}/inbox: ")


-- | <https://api.stackexchange.com/docs/me-inbox>
meInbox ∷ Request RequireToken "meInbox" [SE InboxItem]
meInbox =
  path "me/inbox" <>
  parse (attoparsec items ".me/inbox: ")


-- | <https://api.stackexchange.com/docs/user-unread-inbox>
userUnreadInbox ∷ Int → Request RequireToken "userUnreadInbox" [SE InboxItem]
userUnreadInbox (toLazyText . decimal → i) =
  path ("users/" <> i <> "/inbox/unread") <>
  parse (attoparsec items ".users/{id}/inbox/unread: ")


-- | <https://api.stackexchange.com/docs/me-unread-inbox>
meUnreadInbox ∷ Request RequireToken "meUnreadInbox" [SE InboxItem]
meUnreadInbox =
  path "me/inbox/unread" <>
  parse (attoparsec items ".me/inbox/unread: ")


--------------------------
-- Info
--------------------------

-- $info
-- >>> isJust . (^. from se . L.key "items" . L.nth 0 . L.key "total_users" . L.asDouble) <$> askSE (info <> s <> k)
-- True

-- | <https://api.stackexchange.com/docs/info>
info ∷ Request a "info" (SE Info)
info = path "info" <> parse (attoparsec (fmap SE) ".info: ")


--------------------------
-- Network Users
--------------------------

-- $associatedUsers
-- >>> length `fmap` askSE (associatedUsers [1097181] <> k)
-- 1

-- | <https://api.stackexchange.com/docs/associated-users>
associatedUsers ∷ [Int] → Request a "associatedUsers" [SE NetworkUser]
associatedUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is <> "/associated") <>
  parse (attoparsec items ".users/{ids}/associated: ")


-- | <https://api.stackexchange.com/docs/me-associated-users>
meAssociatedUsers ∷ Request RequireToken "meAssociatedUsers" [SE NetworkUser]
meAssociatedUsers =
  path "me/associated" <>
  parse (attoparsec items ".me/associated: ")


--------------------------
-- Merge History
--------------------------

-- $mergeHistory
-- >>> ((>= 1) . length) `fmap` askSE (mergeHistory [14] <> k)
-- True

-- | <https://api.stackexchange.com/docs/merge-history>
mergeHistory ∷ [Int] → Request a "mergeHistory" [SE AccountMerge]
mergeHistory (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is <> "/merges") <>
  parse (attoparsec items ".users/{ids}/merges: ")


-- | <https://api.stackexchange.com/docs/me-merge-history>
meMergeHistory ∷ Request RequireToken "meMergeHistory" [SE AccountMerge]
meMergeHistory =
  path "me/merges" <>
  parse (attoparsec items ".me/merges: ")


--------------------------
-- Notifications
--------------------------

-- | <https://api.stackexchange.com/docs/notifications>
notifications ∷ Request RequireToken "notifications" [SE Notification]
notifications = path "notifications" <> parse (attoparsec items ".notifications: ")


-- | <https://api.stackexchange.com/docs/notifications-unread>
notificationsUnread ∷ Request RequireToken "notificationsUnread" [SE Notification]
notificationsUnread = path "notifications/unread" <> parse (attoparsec items ".notifications/unread: ")


-- | <https://api.stackexchange.com/docs/user-notifications>
userNotifications ∷ Int → Request RequireToken "userNotifications" [SE Notification]
userNotifications (toLazyText . decimal → i) =
  path ("users/" <> i <> "/notifications") <>
  parse (attoparsec items ".users/{id}/notifications: ")


-- | <https://api.stackexchange.com/docs/me-notifications>
meNotifications ∷ Request RequireToken "meNotifications" [SE Notification]
meNotifications =
  path "me/notifications" <>
  parse (attoparsec items ".me/notifications: ")


-- | <https://api.stackexchange.com/docs/user-unread-notifications>
userUnreadNotifications ∷ Int → Request RequireToken "userUnreadNotifications" [SE Notification]
userUnreadNotifications (toLazyText . decimal → i) =
  path ("users/" <> i <> "/notifications/unread") <>
  parse (attoparsec items ".users/{id}/notifications/unread: ")


-- | <https://api.stackexchange.com/docs/me-unread-notifications>
meUnreadNotifications ∷ Request RequireToken "meUnreadNotifications" [SE Notification]
meUnreadNotifications =
  path "me/notifications" <>
  parse (attoparsec items ".me/notifications/unread: ")


--------------------------
-- Posts
--------------------------

-- $posts
-- >>> checkLengthM $ askSE (posts <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/posts>
posts ∷ Request a "posts" [SE Post]
posts = path "posts" <> parse (attoparsec items ".posts: ")


-- $postsByIds
-- >>> length `fmap` askSE (postsByIds [394601] <> s <> k)
-- 1

-- | <https://api.stackexchange.com/docs/posts-by-ids>
postsByIds ∷ [Int] → Request a "postsByIds" [SE Post]
postsByIds (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("posts/" <> is) <> parse (attoparsec items ".posts/{ids}: ")


--------------------------
-- Privileges
--------------------------

-- $privileges
-- >>> checkLengthM $ askSE (privileges <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/privileges>
privileges ∷ Request a "privileges" [SE Privilege]
privileges = path "privileges" <> parse (attoparsec items ".privileges: ")


-- $privilegesOnUsers
-- >>> checkLengthM $ askSE (privilegesOnUsers 1097181 <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/privileges-on-users>
privilegesOnUsers ∷ Int → Request a "privilegesOnUsers" [SE Privilege]
privilegesOnUsers (toLazyText . decimal → i) =
  path ("users/" <> i <> "/privileges") <>
  parse (attoparsec items ".users/{ids}/privileges: ")


-- | <https://api.stackexchange.com/docs/me-privileges>
mePriviledges ∷ Request RequireToken "mePriviledges" [SE Privilege]
mePriviledges = path "me/privileges" <> parse (attoparsec items ".me/privileges: ")


--------------------------
-- Questions
--------------------------

-- $questions
-- >>> checkLengthM $ askSE (questions <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/questions>
questions ∷ Request a "questions" [SE Question]
questions = path "questions" <> parse (attoparsec items ".questions: ")


-- $questionsByIds
-- >>> length `fmap` askSE (questionsByIds [394601] <> s <> k)
-- 1

-- | <https://api.stackexchange.com/docs/questions-by-ids>
questionsByIds ∷ [Int] → Request a "questionsByIds" [SE Question]
questionsByIds (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("questions/" <> is) <> parse (attoparsec items ".questions/{ids}: ")


-- $linkedQuestions
-- >>> checkLengthM $ askSE (linkedQuestions [394601] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/linked-questions>
linkedQuestions ∷ [Int] → Request a "linkedQuestions" [SE Question]
linkedQuestions (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("questions/" <> is <> "/linked") <>
  parse (attoparsec items ".questions/{ids}/linked: ")


-- $relatedQuestions
-- >>> checkLengthM $ askSE (relatedQuestions [394601] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/related-questions>
relatedQuestions ∷ [Int] → Request a "relatedQuestions" [SE Question]
relatedQuestions (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("questions/" <> is <> "/related") <>
  parse (attoparsec items ".questions/{ids}/related: ")


-- $featuredQuestions
-- >>> checkLengthM $ askSE (featuredQuestions <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/featured-questions>
featuredQuestions ∷ Request a "featuredQuestions" [SE Question]
featuredQuestions =
  path "questions/featured" <> parse (attoparsec items ".questions/featured: ")


-- $unansweredQuestions
-- >>> checkLengthM $ askSE (unansweredQuestions <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/unanswered-questions>
unansweredQuestions ∷ Request a "unansweredQuestions" [SE Question]
unansweredQuestions =
  path "questions/unanswered" <>
  parse (attoparsec items ".questions/unanswered: ")


-- $noAnswerQuestions
-- >>> checkLengthM $ askSE (noAnswerQuestions <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/no-answer-questions>
noAnswerQuestions ∷ Request a "noAnswerQuestions" [SE Question]
noAnswerQuestions =
  path "questions/no-answers" <>
  parse (attoparsec items ".questions/no-answers: ")


-- $search
-- >>> checkLengthM $ askSE (search "why" ["haskell"] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/search>
search ∷ Text → [Text] → Request a "search" [SE Question]
search t (T.intercalate ";" → ts) =
  path "search" <>
  query [("intitle",t),("tagged",ts)] <>
  parse (attoparsec items ".search: ")


-- $advancedSearch
-- >>> checkLengthM $ askSE (advancedSearch <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/advanced-search>
advancedSearch ∷ Request a "advancedSearch" [SE Question]
advancedSearch =
  path "search/advanced" <> parse (attoparsec items ".search/advanced: ")


-- $similar
-- >>> checkLengthM $ askSE (similar "sublists of list" ["haskell"] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/similar>
similar ∷ Text → [Text] → Request a "similar" [SE Question]
similar t (T.intercalate ";" → ts) =
  path "similar" <>
  query [("title",t),("tagged",ts)] <>
  parse (attoparsec items ".similar: ")


-- $faqsByTags
-- >>> checkLengthM $ askSE (faqsByTags ["haskell"] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/faqs-by-tags>
faqsByTags ∷ [Text] → Request a "faqsByTags" [SE Question]
faqsByTags (T.intercalate ";" → ts) =
  path ("tags/" <> ts <> "/faq") <>
  parse (attoparsec items ".tags/{tags}/faq: ")


-- $favoritesOnUsers
-- >>> checkLengthM $ askSE (favoritesOnUsers [9204] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/favorites-on-users>
favoritesOnUsers ∷ [Int] → Request a "favoritesOnUsers" [SE Question]
favoritesOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is <> "/favorites") <>
  parse (attoparsec items ".users/{ids}/favorites: ")


-- | <https://api.stackexchange.com/docs/me-favorites>
meFavorites ∷ Request RequireToken "meFavorites" [SE Question]
meFavorites = path "me/favorites" <> parse (attoparsec items ".me/favorites: ")


-- $questionsOnUsers
-- >>> checkLengthM $ askSE (questionsOnUsers [9204] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/questions-on-users>
questionsOnUsers ∷ [Int] → Request a "questionsOnUsers" [SE Question]
questionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is <> "/questions") <>
  parse (attoparsec items ".users/{ids}/questions: ")


-- | <https://api.stackexchange.com/docs/me-questions>
meQuestions ∷ Request RequireToken "meQuestions" [SE Question]
meQuestions = path "me/questions" <> parse (attoparsec items ".me/questions: ")

-- $featuredQuestionsOnUsers
-- >>> fq <- (map truncate :: [Double] -> [Int]) . catMaybes . (^.. traverse . from se . L.key "owner" . L.key "user_id" . L.asDouble) <$> askSE (featuredQuestions <> s <> k <> q)
-- >>> checkLengthM $ askSE $ featuredQuestionsOnUsers fq <> s <> k <> q
-- True

-- | <https://api.stackexchange.com/docs/featured-questions-on-users>
featuredQuestionsOnUsers ∷ [Int] → Request a "featuredQuestionsOnUsers" [SE Question]
featuredQuestionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is <> "/questions/featured") <>
  parse (attoparsec items ".users/{ids}/questions/featured: ")


-- | <https://api.stackexchange.com/docs/me-featured-questions>
meFeaturedQuestions ∷ Request RequireToken "meFeaturedQuestions" [SE Question]
meFeaturedQuestions = path "me/questions/featured" <> parse (attoparsec items ".me/questions/featured: ")


-- $noAnswerQuestionsOnUsers
-- >>> naaq <- (map truncate :: [Double] -> [Int]) . catMaybes . (^.. traverse . from se . L.key "owner" . L.key "user_id" . L.asDouble) <$> askSE (noAnswerQuestions <> s <> k <> q)
-- >>> checkLengthM $ askSE (noAnswerQuestionsOnUsers naaq <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/no-answer-questions-on-users>
noAnswerQuestionsOnUsers ∷ [Int] → Request a "noAnswerQuestionsOnUsers" [SE Question]
noAnswerQuestionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is <> "/questions/no-answers") <>
  parse (attoparsec items ".users/{ids}/questions/no-answers: ")


-- | <https://api.stackexchange.com/docs/me-no-answer-questions>
meNoAnswerQuestions ∷ Request RequireToken "meNoAnswerQuestions" [SE Question]
meNoAnswerQuestions = path "me/questions/no-answers" <> parse (attoparsec items ".me/questions/no-answers: ")


-- $unacceptedQuestionsOnUsers
-- >>> null `fmap` askSE (unacceptedQuestionsOnUsers [570689] <> s <> k <> q)
-- False
--
-- | <https://api.stackexchange.com/docs/unaccepted-questions-on-users>
unacceptedQuestionsOnUsers ∷ [Int] → Request a "unacceptedQuestionsOnUsers" [SE Question]
unacceptedQuestionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is <> "/questions/unaccepted") <>
  parse (attoparsec items ".users/{ids}/questions/unaccepted: ")


-- | <https://api.stackexchange.com/docs/me-unaccepted-questions>
meUnacceptedQuestions ∷ Request RequireToken "meUnacceptedQuestions" [SE Question]
meUnacceptedQuestions = path "me/questions/unaccepted" <> parse (attoparsec items ".me/questions/unaccepted: ")


-- $unansweredQuestionsOnUsers
-- >>> uaq <- (map truncate :: [Double] -> [Int]) . catMaybes . (^.. traverse . from se . L.key "owner" . L.key "user_id" . L.asDouble) <$> askSE (unansweredQuestions <> s <> k <> q)
-- >>> checkLengthM $ askSE (unansweredQuestionsOnUsers uaq <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/unanswered-questions-on-users>
unansweredQuestionsOnUsers ∷ [Int] → Request a "unansweredQuestionsOnUsers" [SE Question]
unansweredQuestionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is <> "/questions/unanswered") <>
  parse (attoparsec items ".users/{ids}/questions/unanswered: ")


-- | <https://api.stackexchange.com/docs/me-unanswered-questions>
meUnansweredQuestions ∷ Request RequireToken "meUnansweredQuestions" [SE Question]
meUnansweredQuestions = path "me/questions/unanswered" <> parse (attoparsec items ".me/questions/unanswered: ")


-- $topUserQuestionsInTags
-- >>> checkLengthM $ askSE (topUserQuestionsInTags 570689 ["haskell"] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/top-user-questions-in-tags>
topUserQuestionsInTags ∷ Int → [Text] → Request a "topUserQuestionsInTags" [SE Question]
topUserQuestionsInTags (toLazyText . decimal → i) (T.intercalate ";" → ts) =
  path ("users/" <> i <> "/tags/" <> ts <> "/top-questions") <>
    parse (attoparsec items ".users/{id}/tags/{tags}/top-questions: ")


-- | <https://api.stackexchange.com/docs/me-tags-top-questions>
meTagsTopQuestions ∷ [Text] → Request RequireToken "meTagsTopQuestions" [SE Question]
meTagsTopQuestions (T.intercalate ";" → ts) =
  path ("me/tags/" <> ts <> "/top-questions") <>
  parse (attoparsec items ".me/tags/{tags}/top-questions: ")


--------------------------
-- Question Timelines
--------------------------

-- $questionsTimeline
-- >>> checkLengthM $ askSE (questionsTimeline [570689] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/questions-timeline>
questionsTimeline ∷ [Int] → Request a "questionsTimeline" [SE QuestionTimeline]
questionsTimeline (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("questions/" <> is <> "/timeline") <>
  parse (attoparsec items ".questions/{ids}/timeline: ")


--------------------------
-- Reputation
--------------------------

-- $reputationOnUsers
-- >>> checkLengthM $ askSE (reputationOnUsers [1097181] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/reputation-on-users>
reputationOnUsers ∷ [Int] → Request a "reputationOnUsers" [SE Reputation]
reputationOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is <> "/reputation") <>
  parse (attoparsec items ".users/{ids}/reputation: ")


-- | <https://api.stackexchange.com/docs/me-reputation>
meReputation ∷ Request RequireToken "meReputation" [SE Reputation]
meReputation = path "me/reputation" <> parse (attoparsec items ".me/reputation: ")


--------------------------
-- Reputation History
-------------------------

-- $reputationHistory
-- >>> checkLengthM $ askSE (reputationHistory [1097181] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/reputation-history>
reputationHistory ∷ [Int] → Request a "reputationHistory" [SE ReputationHistory]
reputationHistory (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is <> "/reputation-history") <>
  parse (attoparsec items ".users/{ids}/reputation-history: ")


-- | <https://api.stackexchange.com/docs/me-reputation-history>
meReputationHistory ∷ Request RequireToken "meReputationHistory" [SE ReputationHistory]
meReputationHistory =
  path "me/reputation-history" <>
  parse (attoparsec items ".me/reputation-history: ")


-- | <https://api.stackexchange.com/docs/full-reputation-history>
reputationHistoryFull ∷ [Int] → Request RequireToken "reputationHistoryFull" [SE ReputationHistory]
reputationHistoryFull (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is <> "/reputation-history/full") <>
  parse (attoparsec items ".users/{ids}/reputation-history/full: ")


-- | <https://api.stackexchange.com/docs/me-full-reputation-history>
meReputationHistoryFull ∷ Request RequireToken "meReputationHistoryFull" [SE ReputationHistory]
meReputationHistoryFull =
  path "me/reputation-history/full" <>
  parse (attoparsec items ".me/reputation-history/full: ")


--------------------------
-- Revisions
--------------------------

-- $revisionsByIds
-- >>> checkLengthM $ askSE (revisionsByIds [1218390] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/revisions-by-ids>
revisionsByIds ∷ [Int] → Request a "revisionsByIds" [SE Revision]
revisionsByIds (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("posts/" <> is <> "/revisions") <>
  parse (attoparsec items ".posts/{ids}/revisions: ")


-- $revisionsByGuids
-- >>> length `fmap` askSE (revisionsByGuids ["881687CA-9A98-46CC-B9F0-4063322B5E2F"] <> s <> k <> q)
-- 1

-- | <https://api.stackexchange.com/docs/revisions-by-guids>
revisionsByGuids ∷ [Text] → Request a "revisionsByGuids" [SE Revision]
revisionsByGuids (T.intercalate ";" → is) =
  path ("revisions/" <> is) <>
  parse (attoparsec items ".revisions/{ids}: ")


--------------------------
-- Sites
--------------------------

-- $sites
-- >>> checkLengthM $ askSE (sites <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/sites>
sites ∷ Request a "sites" [SE Site]
sites = path "sites" <> parse (attoparsec items ".sites: ")


--------------------------
-- Suggested Edits
--------------------------

-- $postsOnSuggestedEdits
-- >>> se' <- (map truncate :: [Double] -> [Int]) . catMaybes . (^.. traverse . from se . L.key "post_id" . L.asDouble) <$> askSE (suggestedEdits <> s <> k <> q)
-- >>> checkLengthM $ askSE (postsOnSuggestedEdits se' <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/posts-on-suggested-edits>
postsOnSuggestedEdits ∷ [Int] → Request a "postsOnSuggestedEdits" [SE SuggestedEdit]
postsOnSuggestedEdits (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("posts/" <> is <> "/suggested-edits") <>
  parse (attoparsec items ".posts/{ids}/suggested-edits: ")


-- $suggestedEdits
-- >>> checkLengthM $ askSE (suggestedEdits <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/suggested-edits>
suggestedEdits ∷ Request a "suggestedEdits" [SE SuggestedEdit]
suggestedEdits =
  path "suggested-edits" <> parse (attoparsec items ".suggested-edits: ")


-- $suggestedEditsByIds
-- >>> se' <- (map truncate :: [Double] -> [Int]) . catMaybes . (^.. traverse . from se . L.key "suggested_edit_id" . L.asDouble) <$> askSE (suggestedEdits <> s <> k <> q)
-- >>> checkLengthM $ askSE (suggestedEditsByIds se' <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/suggested-edits-by-ids>
suggestedEditsByIds ∷ [Int] → Request a "suggestedEditsByIds" [SE SuggestedEdit]
suggestedEditsByIds (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("suggested-edits/" <> is ) <>
  parse (attoparsec items ".suggested-edits/{ids}: ")


-- $suggestedEditsOnUsers
-- >>> se' <- (map truncate :: [Double] -> [Int]) . catMaybes . (^.. traverse . from se . L.key "proposing_user" . L.key "user_id" . L.asDouble) <$> askSE (suggestedEdits <> s <> k <> q)
-- >>> checkLengthM $ askSE (suggestedEditsOnUsers se' <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/suggested-edits-on-users>
suggestedEditsOnUsers ∷ [Int] → Request a "suggestedEditsOnUsers" [SE SuggestedEdit]
suggestedEditsOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is <> "/suggested-edits") <>
  parse (attoparsec items ".users/{ids}/suggested-edits: ")


-- | <https://api.stackexchange.com/docs/me-suggested-edits>
meSuggestedEdits ∷ Request RequireToken "meSuggestedEdits" [SE SuggestedEdit]
meSuggestedEdits =
  path "me/suggested-edits" <>
  parse (attoparsec items ".me/suggested-edits: ")


--------------------------
-- Tags
--------------------------

-- $tags
-- >>> checkLengthM $ askSE (tags <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/tags>
tags ∷ Request a "tags" [SE Tag]
tags = path "tags" <> parse (attoparsec items ".tags: ")


-- $moderatorOnlyTags
-- >>> checkLengthM $ askSE (moderatorOnlyTags <> site "meta.serverfault" <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/moderator-only-tags>
moderatorOnlyTags ∷ Request a "moderatorOnlyTags" [SE Tag]
moderatorOnlyTags =
  path "tags/moderator-only" <>
  parse (attoparsec items ".tags/moderator-only: ")


-- $requiredTags
-- >>> (( > 0) . length) `fmap` askSE (requiredTags <> site "meta.serverfault" <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/required-tags>
requiredTags ∷ Request a "requiredTags" [SE Tag]
requiredTags =
  path "tags/required" <> parse (attoparsec items ".tags/required: ")


-- $tagsByName
-- >>> ((> 0) . length) `fmap` askSE (tagsByName ["haskell"] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/tags-by-name>
tagsByName ∷ [Text] → Request a "tagsByName" [SE Tag]
tagsByName (T.intercalate ";" → ts) =
  path ("tags/" <> ts <> "/info") <>
  parse (attoparsec items ".tags/{tags}/info: ")


-- $relatedTags
-- >>> checkLengthM $ askSE (relatedTags ["haskell"] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/related-tags>
relatedTags ∷ [Text] → Request a "relatedTags" [SE Tag]
relatedTags (T.intercalate ";" → ts) =
  path ("tags/" <> ts <> "/related") <>
  parse (attoparsec items ".tags/{tags}/related: ")


-- $tagsOnUsers
-- >>> checkLengthM $ askSE (tagsOnUsers [1097181] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/tags-on-users>
tagsOnUsers ∷ [Int] → Request a "tagsOnUsers" [SE Tag]
tagsOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is <> "/tags") <>
  parse (attoparsec items ".users/{ids}/tags: ")


-- | <https://api.stackexchange.com/docs/me-tags>
meTags ∷ Request RequireToken "meTags" [SE Tag]
meTags = path "me/tags" <> parse (attoparsec items ".me/tags: ")


--------------------------
-- Tag Scores
--------------------------

-- $topAnswerersOnTag
-- >>> checkLengthM $ askSE (topAnswerersOnTag "haskell" "Month" <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/top-answerers-on-tags>
topAnswerersOnTag ∷ Text → Text → Request a "topAnswerersOnTag" [SE TagScore]
topAnswerersOnTag t p =
  path ("tags/" <> t <> "/top-answerers/" <> p) <>
  parse (attoparsec items ".tags/{tag}/top-answerers/{period}: ")


-- $topAskersOnTag
-- >>> checkLengthM $ askSE (topAskersOnTag "haskell" "Month" <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/top-askers-on-tags>
topAskersOnTag ∷ Text → Text → Request a "topAskersOnTag" [SE TagScore]
topAskersOnTag t p =
  path ("tags/" <> t <> "/top-askers/" <> p) <>
  parse (attoparsec items ".tags/{tag}/top-askers/{period}: ")


--------------------------
-- Tag Synonyms
--------------------------

-- $tagSynonyms
-- >>> checkLengthM $ askSE (tagSynonyms <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/tag-synonyms>
tagSynonyms ∷ Request a "tagSynonyms" [SE TagSynonym]
tagSynonyms =
  path "tags/synonyms" <> parse (attoparsec items ".tags/synonyms: ")


-- $synonymsByTags
-- >>> checkLengthM $ askSE (synonymsByTags ["iphone","java"] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/synonyms-by-tags>
synonymsByTags ∷ [Text] → Request a "synonymsByTags" [SE TagSynonym]
synonymsByTags (T.intercalate ";" → ts) =
  path ("tags/" <> ts <> "/synonyms") <>
  parse (attoparsec items ".tags/{tags}/synonyms: ")


--------------------------
-- Tag Wikis
--------------------------

-- $wikisByTags
-- >>> length `fmap` askSE (wikisByTags ["haskell"] <> s <> k <> q)
-- 1

-- | <https://api.stackexchange.com/docs/wikis-by-tags>
wikisByTags ∷ [Text] → Request a "wikisByTags" [SE TagWiki]
wikisByTags (T.intercalate ";" → ts) =
  path ("tags/" <> ts <> "/wikis") <>
  parse (attoparsec items ".tags/{tags}/wikis: ")


--------------------------
-- Top Tags
--------------------------

-- $topAnswerTagsOnUsers
-- >>> checkLengthM $ askSE (topAnswerTagsOnUsers 1097181 <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/top-answer-tags-on-users>
topAnswerTagsOnUsers ∷ Int → Request a "topAnswerTagsOnUsers" [SE TopTag]
topAnswerTagsOnUsers (toLazyText . decimal → i) =
  path ("users/" <> i <> "/top-answer-tags") <>
  parse (attoparsec items ".users/{id}/top-answer-tags: ")


-- | <https://api.stackexchange.com/docs/me-top-answer-tags>
meTopAnswerTags ∷ Request RequireToken "meTopAnswerTags" [SE TopTag]
meTopAnswerTags = path "me/top-answer-tags" <> parse (attoparsec items ".me/top-answer-tags: ")


-- $topQuestionTagsOnUsers
-- >>> checkLengthM $ askSE (topQuestionTagsOnUsers 570689 <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/top-question-tags-on-users>
topQuestionTagsOnUsers ∷ Int → Request a "topQuestionTagsOnUsers" [SE TopTag]
topQuestionTagsOnUsers (toLazyText . decimal → i) =
  path ("users/" <> i <> "/top-question-tags") <>
  parse (attoparsec items ".users/{id}/top-question-tags: ")


-- | <https://api.stackexchange.com/docs/me-top-question-tags>
meTopQuestionTags ∷ Request RequireToken "meTopQuestionTags" [SE TopTag]
meTopQuestionTags = path "me/top-question-tags" <> parse (attoparsec items ".me/top-question-tags: ")


--------------------------
-- Users
--------------------------

-- $users
-- >>> checkLengthM $ askSE (users <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/users>
users ∷ Request a "users" [SE User]
users = path "users" <> parse (attoparsec items ".users: ")


-- $users
-- >>> length `fmap` askSE (usersByIds [1097181] <> s <> k <> q)
-- 1

-- | <https://api.stackexchange.com/docs/users-by-ids>
usersByIds ∷ [Int] → Request a "usersByIds" [SE User]
usersByIds (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is) <> parse (attoparsec items ".users/{ids}: ")


-- | <https://api.stackexchange.com/docs/me>
me ∷ Request RequireToken "me" (SE User)
me = path "me" <> parse (head . attoparsec items ".me: ")


-- $moderators
-- >>> checkLengthM $ askSE (moderators <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/moderators>
moderators ∷ Request a "moderators" [SE User]
moderators =
  path "users/moderators" <> parse (attoparsec items ".users/moderators: ")


-- $electedModerators
-- >>> checkLengthM $ askSE (electedModerators <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/elected-moderators>
electedModerators ∷ Request a "electedModerators" [SE User]
electedModerators =
  path "users/moderators/elected" <>
  parse (attoparsec items ".users/moderators/elected: ")


--------------------------
-- User Timeline
--------------------------

-- $timelineOnUsers
-- >>> checkLengthM $ askSE (timelineOnUsers [1097181] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/timeline-on-users>
timelineOnUsers ∷ [Int] → Request a "timelineOnUsers" [SE UserTimeline]
timelineOnUsers (T.intercalate ";" . map (toLazyText . decimal) → is) =
  path ("users/" <> is <> "/timeline") <>
  parse (attoparsec items ".users/{ids}/timeline: ")


-- | <https://api.stackexchange.com/docs/me-timeline>
meTimeline ∷ Request RequireToken "meTimeline" [SE UserTimeline]
meTimeline = path "me/timeline" <> parse (attoparsec items ".me/timeline: ")


--------------------------
-- Write Permissions
--------------------------

-- $writePermissions
-- >>> length `fmap` askSE (writePermissions 1097181 <> s <> k <> q)
-- 1

-- | <https://api.stackexchange.com/docs/write-permissions>
writePermissions ∷ Int → Request a "writePermissions" [SE WritePermission]
writePermissions (toLazyText . decimal → i) =
  path ("users/" <> i <> "/write-permissions") <>
  parse (attoparsec items ".users/{id}/write-permissions: ")


-- | <https://api.stackexchange.com/docs/me-write-permissions>
meWritePermissions ∷ Request RequireToken "meWritePermissions" [SE WritePermission]
meWritePermissions = path "me/write-permissions" <> parse (attoparsec items ".me/write-permissions: ")


attoparsec ∷ (Maybe Value → Maybe b) → String → ByteString → b
attoparsec f msg request = case AP.eitherResult $ AP.parse A.json request of
  Right s → case f (Just s) of
    Just b → b
    Nothing → throw $ SEException request ("libstackexchange" ++ msg ++ "incorrect JSON content")
  Left e → throw $ SEException request ("libstackexchange" ++ msg ++ e)


items ∷ Maybe Value → Maybe [SE a]
items s = fmap (map SE) . A.parseMaybe (\o -> A.parseJSON o >>= (.: "items")) =<< s
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE DataKinds #-}
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE UnicodeSyntax #-}
{-# LANGUAGE ViewPatterns #-}
-- | API methods list
module Network.StackExchange.API
  ( -- * SE AccessToken
    readAccessTokens, invalidateAccessTokens, applicationDeAuthenticate
    -- * SE Answer
  , answers, answersByIds, answersOnUsers
  , answersOnQuestions, meAnswers, topUserAnswersInTags, meTagsTopAnswers
    -- * SE Badge
  , badges, badgesByIds, badgeRecipientsByIds
  , badgesByName, badgeRecipients, badgesByTag
  , badgesOnUsers, meBadges
    -- * SE Comment
  , commentsOnAnswers, comments, commentsByIds, deleteComment, editComment
  , commentsOnPosts, createComment, commentsOnQuestions
  , commentsOnUsers, meComments, commentsByUsersToUser, meCommentsTo
  , mentionsOnUsers, meMentioned
    -- * SE Error
  , errors
    -- * SE Event
  , events
    -- * SE Filter
  , createFilter, readFilter
    -- * SE InboxItems
  , inbox, inboxUnread, userInbox, meInbox, userUnreadInbox, meUnreadInbox
    -- * SE Info
  , info
    -- * SE NetworkUser
  , associatedUsers, meAssociatedUsers
    -- * SE AccountMerge
  , mergeHistory, meMergeHistory
    -- * SE Notification
  , notifications, notificationsUnread, userNotifications, meNotifications
  , userUnreadNotifications, meUnreadNotifications
    -- * SE Post
  , posts, postsByIds
    -- * SE Privilege
  , privileges, privilegesOnUsers, mePriviledges
    -- * SE Question
  , questions, questionsByIds, linkedQuestions, relatedQuestions
  , featuredQuestions, unansweredQuestions, noAnswerQuestions
  , search, advancedSearch, similar, faqsByTags, favoritesOnUsers
  , meFavorites, questionsOnUsers, meQuestions, featuredQuestionsOnUsers
  , meFeaturedQuestions, noAnswerQuestionsOnUsers, meNoAnswerQuestions
  , unacceptedQuestionsOnUsers, meUnacceptedQuestions, unansweredQuestionsOnUsers
  , meUnansweredQuestions, topUserQuestionsInTags, meTagsTopQuestions
    -- * SE QuestionTimeline
  , questionsTimeline
    -- * SE Reputation
  , reputationOnUsers, meReputation
    -- * SE ReputationHistory
  , reputationHistory, reputationHistoryFull
  , meReputationHistory, meReputationHistoryFull
    -- * SE Revision
  , revisionsByIds, revisionsByGuids
    -- * SE Site
  , sites
    -- * SE SuggestedEdit
  , postsOnSuggestedEdits, suggestedEdits, suggestedEditsByIds
  , suggestedEditsOnUsers, meSuggestedEdits
    -- * SE Tag
  , tags, moderatorOnlyTags, requiredTags
  , tagsByName, relatedTags, tagsOnUsers, meTags
    -- * SE TagScore
  , topAnswerersOnTag, topAskersOnTag
    -- * SE TagSynonym
  , tagSynonyms, synonymsByTags
    -- * SE TagWiki
  , wikisByTags
    -- * SE TopTag
  , topAnswerTagsOnUsers, topQuestionTagsOnUsers
  , meTopAnswerTags, meTopQuestionTags
    -- * SE User
  , users, usersByIds, me, moderators, electedModerators
    -- * SE UserTimeline
  , timelineOnUsers, meTimeline
    -- * SE WritePermission
  , writePermissions, meWritePermissions
  ) where

import Data.Monoid ((<>))

import           Control.Exception (throw)
import           Data.Aeson ((.:), Value)
import qualified Data.Aeson as A
import qualified Data.Aeson.Types as A
import qualified Data.Attoparsec.Lazy as AP
import           Data.ByteString.Lazy (ByteString)
import           Data.Text.Lazy (Text)
import qualified Data.Text.Lazy as T
import           Data.Text.Lazy.Builder (toLazyText)
import           Data.Text.Lazy.Builder.Int (decimal)

import Network.StackExchange.Response
import Network.StackExchange.Request

-- $setup
-- >>> import           Control.Applicative
-- >>> import           Control.Lens
-- >>> import qualified Data.Aeson.Lens as L
-- >>> import           Data.Maybe (catMaybes, isJust)
-- >>> let pagesize = 10 :: Int
-- >>> let checkLengthM f = ((== pagesize) . length) `fmap` f
-- >>> let k = key "Lhg6xe5d5BvNK*C0S8jijA(("
-- >>> let s = site "stackoverflow"
-- >>> let q = query [("pagesize", "10")]

--------------------------
-- Access Tokens
--------------------------

-- | <https://api.stackexchange.com/docs/invalidate-access-tokens>
invalidateAccessTokens :: [Text] -> Request a "invalidateAccessTokens" [SE AccessToken]
invalidateAccessTokens (T.intercalate ";" -> ts) =
  path ("access-tokens/" <> ts <> "/invalidate") <>
  parse (attoparsec items ".access-tokens/{accessTokens}/invalidate: ")


-- | <https://api.stackexchange.com/docs/read-access-tokens>
readAccessTokens :: [Text] -> Request a "readAccessTokens" [SE AccessToken]
readAccessTokens (T.intercalate ";" -> ts) =
  path ("access-tokens/" <> ts) <>
  parse (attoparsec items ".access-tokens/{accessTokens}: ")


-- | <https://api.stackexchange.com/docs/application-de-authenticate>
applicationDeAuthenticate :: [Text] -> Request a "applicationDeAuthenticate" [SE AccessToken]
applicationDeAuthenticate (T.intercalate ";" -> ts) =
  path ("apps/" <> ts <> "/de-authenticate") <>
  parse (attoparsec items ".apps/{accessTokens}/de-authenticate: ")


--------------------------
-- Answers
--------------------------

-- $answers
-- >>> checkLengthM $ askSE (answers <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/answers>
answers :: Request a "answers" [SE Answer]
answers = path "answers" <> parse (attoparsec items ".answers: ")


-- $answersByIds
-- >>> length `fmap` askSE (answersByIds [6841479, 215422, 8881376] <> s <> k)
-- 3

-- | <https://api.stackexchange.com/docs/answers-by-ids>
answersByIds :: [Int] -> Request a "answersByIds" [SE Answer]
answersByIds (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("answers/" <> is) <> parse (attoparsec items ".answers/{ids}: ")


-- $answersOnUsers
-- >>> checkLengthM $ askSE (answersOnUsers [972985] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/answers-on-users>
answersOnUsers :: [Int] -> Request a "answersOnUsers" [SE Answer]
answersOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is <> "/answers") <>
  parse (attoparsec items ".users/{ids}/answers: ")


-- $answersOnQuestions
-- >>> checkLengthM $ askSE (answersOnQuestions [394601] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/answers-on-questions>
answersOnQuestions :: [Int] -> Request a "answersOnQuestions" [SE Answer]
answersOnQuestions (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("questions/" <> is <> "/answers") <>
  parse (attoparsec items ".questions/{ids}/answers: ")


-- | <https://api.stackexchange.com/docs/me-answers>
meAnswers :: Request RequireToken "meAnswers" [SE Answer]
meAnswers =
  path "me/answers" <> parse (attoparsec items ".me/answers: ")

-- $topUserAnswersInTags
-- >>> checkLengthM $ askSE (topUserAnswersInTags 1097181 ["haskell"] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/top-user-answers-in-tags>
topUserAnswersInTags :: Int -> [Text] -> Request a "topUserAnswersInTags" [SE Answer]
topUserAnswersInTags (toLazyText . decimal -> i) (T.intercalate ";" -> ts) =
  path ("users/" <> i <> "/tags/" <> ts <> "/top-answers") <>
  parse (attoparsec items ".users/{id}/tags/{tags}/top-answers: ")


-- | <https://api.stackexchange.com/docs/me-tags-top-answers>
meTagsTopAnswers :: [Text] -> Request RequireToken "meTagsTopAnswers" [SE Answer]
meTagsTopAnswers (T.intercalate ";" -> ts) =
  path ("me/tags/" <> ts <> "/top-answers") <>
  parse (attoparsec items ".me/tags/{tags}/top-answers: ")


--------------------------
-- Badges
--------------------------

-- $badges
-- >>> checkLengthM $ askSE (badges <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/badges>
badges :: Request a "badges" [SE Badge]
badges = path "badges" <> parse (attoparsec items ".badges: ")


-- $badgesByIds
-- >>> length `fmap` askSE (badgesByIds [20] <> s <> k <> q)
-- 1

-- | <https://api.stackexchange.com/docs/badges-by-ids>
badgesByIds :: [Int] -> Request a "badgesByIds" [SE Badge]
badgesByIds (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("badges/" <> is) <> parse (attoparsec items ".badges/{ids}: ")


-- $badgeRecipientsByIds
-- >>> checkLengthM $ askSE (badgeRecipientsByIds [20] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/badge-recipients-by-ids>
badgeRecipientsByIds :: [Int] -> Request a "badgeRecipientsByIds" [SE Badge]
badgeRecipientsByIds (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("badges/" <> is <> "/recipients") <>
  parse (attoparsec items ".badges/{ids}/recipients: ")


-- $badgesByName
-- >>> checkLengthM $ askSE (badgesByName <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/badges-by-name>
badgesByName :: Request a "badgesByName" [SE Badge]
badgesByName =
  path ("badges" <> "/name") <> parse (attoparsec items ".badges/name: ")


-- $badgeRecipients
-- >>> checkLengthM $ askSE (badgeRecipients <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/badge-recipients>
badgeRecipients :: Request a "badgeRecipients" [SE Badge]
badgeRecipients =
  path ("badges" <> "/recipients") <>
  parse (attoparsec items ".badges/recipients: ")


-- $badgesByTag
-- >>> checkLengthM $ askSE (badgesByTag <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/badges-by-tag>
badgesByTag :: Request a "badgesByTag" [SE Badge]
badgesByTag =
  path ("badges" <> "/tags") <> parse (attoparsec items ".badges/tags: ")


-- $badgesOnUsers
-- >>> checkLengthM $ askSE (badgesOnUsers [1097181] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/badges-on-users>
badgesOnUsers :: [Int] -> Request a "badgesOnUsers" [SE Badge]
badgesOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is <> "/badges") <>
  parse (attoparsec items ".users/{ids}/badges: ")


-- | <https://api.stackexchange.com/docs/me-badges>
meBadges :: Request RequireToken "meBadges" [SE Badge]
meBadges = path "me/badges" <> parse (attoparsec items ".me/badges: ")



--------------------------
-- Comments
--------------------------

-- $commentsOnAnswers
-- >>> checkLengthM $ askSE (commentsOnAnswers [394837] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/comments-on-answers>
commentsOnAnswers :: [Int] -> Request a "commentsOnAnswers" [SE Comment]
commentsOnAnswers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("answers/" <> is <> "/comments") <>
  parse (attoparsec items ".answers/{ids}/comments: ")


-- $comments
-- >>> checkLengthM $ askSE (comments <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/comments>
comments :: Request a "comments" [SE Comment]
comments = path "comments" <> parse (attoparsec items ".comments: ")


-- | <https://api.stackexchange.com/docs/delete-comment>
deleteComment :: Int -> Request RequireToken "deleteComment" ()
deleteComment (toLazyText . decimal -> i) =
  path ("comments/" <> i <> "/delete")


-- | <https://api.stackexchange.com/docs/edit-comment>
editComment :: Int -> Text -> Request RequireToken "editComment" (SE Comment)
editComment (toLazyText . decimal -> i) body =
  path ("comments/" <> i <> "/edit") <>
  query [("body", body)] <>
  parse (attoparsec (fmap SE) ".comments/{id}/edit:")


-- $commentsByIds
-- >>> length `fmap` askSE (commentsByIds [1218390] <> s <> k)
-- 1

-- | <https://api.stackexchange.com/docs/comments-by-ids>
commentsByIds :: [Int] -> Request a "commentsByIds" [SE Comment]
commentsByIds (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("comments/" <> is) <> parse (attoparsec items ".comments/{ids}: ")


-- $commentsOnPosts
-- >>> checkLengthM $ askSE (commentsOnPosts [394837] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/comments-on-posts>
commentsOnPosts :: [Int] -> Request a "commentsOnPosts" [SE Comment]
commentsOnPosts (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("posts/" <> is <> "/comments") <>
  parse (attoparsec items ".posts/{ids}/comments: ")


-- | <https://api.stackexchange.com/docs/create-comment>
createComment :: Int -> Text -> Request RequireToken "createComment" (SE Comment)
createComment (toLazyText . decimal -> i) body =
  path ("posts/" <> i <> "/comments/add") <>
  query [("body", body)] <>
  parse (attoparsec (fmap SE) ".posts/{id}/comments/add:")


-- $commentsOnQuestions
-- >>> checkLengthM $ askSE (commentsOnQuestions [394601] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/comments-on-questions>
commentsOnQuestions :: [Int] -> Request a "commentsOnQuestions" [SE Comment]
commentsOnQuestions (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("questions/" <> is <> "/comments") <>
  parse (attoparsec items ".questions/{ids}/comments: ")


-- $commentsOnUsers
-- >>> checkLengthM $ askSE (commentsOnUsers [1097181] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/comments-on-users>
commentsOnUsers :: [Int] -> Request a "commentsOnUsers" [SE Comment]
commentsOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is <> "/comments") <>
  parse (attoparsec items ".users/{ids}/comments: ")


-- | <https://api.stackexchange.com/docs/me-comments>
meComments :: Request RequireToken "meComments" [SE Comment]
meComments = path "me/comments" <> parse (attoparsec items ".me/comments: ")


-- $commentsByUsersToUser
-- >>> checkLengthM $ askSE (commentsByUsersToUser [230461,1011995,157360] 1097181 <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/comments-by-users-to-user>
commentsByUsersToUser :: [Int] -> Int -> Request a "commentsByUsersToUser" [SE Comment]
commentsByUsersToUser (T.intercalate ";" . map (toLazyText . decimal) -> is)
                      (toLazyText . decimal -> toid) =
  path ("users/" <> is <> "/comments/" <> toid) <>
  parse (attoparsec items ".users/{ids}/comments/{toid}: ")


-- | <https://api.stackexchange.com/docs/me-comments-to>
meCommentsTo :: Int -> Request RequireToken "meCommentsTo" [SE Comment]
meCommentsTo (toLazyText . decimal -> toid) =
  path ("me/comments/" <> toid) <>
  parse (attoparsec items ".me/comments/{toid}:")


-- $mentionsOnUsers
-- >>> checkLengthM $ askSE (mentionsOnUsers [1097181] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/mentions-on-users>
mentionsOnUsers :: [Int] -> Request a "mentionsOnUsers" [SE Comment]
mentionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is <> "/mentioned") <>
  parse (attoparsec items ".users/{ids}/mentioned: ")


-- | <https://api.stackexchange.com/docs/me-mentioned>
meMentioned :: Request RequireToken "meMentioned" [SE Comment]
meMentioned = path "me/mentioned" <> parse (attoparsec items ".me/mentioned: ")


--------------------------
-- Errors
--------------------------

-- $errors
-- >>> checkLengthM $ askSE (errors <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/errors>
errors :: Request a "errors" [SE Error]
errors = path "errors" <> parse (attoparsec items ".errors: ")


--------------------------
-- Events
--------------------------

-- | <https://api.stackexchange.com/docs/events>
events :: Request RequireToken "events" [SE Event]
events = path "events" <> parse (attoparsec items ".events: ")


--------------------------
-- Filters
--------------------------

-- $createFilter
-- >>> (^. from se . L.key "items" . L.nth 0 . L.key "filter" . L.asText) <$> askSE (createFilter [] [] "none" <> k)
-- Just "none"

-- | <https://api.stackexchange.com/docs/create-filter>
createFilter :: [Text] -> [Text] -> Text -> Request a "createFilter" (SE Filter)
createFilter (T.intercalate ";" -> include) (T.intercalate ";" -> exclude) base =
  path "filter/create" <>
  query [("include", include), ("exclude", exclude), ("base", base)] <>
  parse (attoparsec (fmap SE) ".filter/create: ")


-- $readFilter
-- >>> (^.. traverse . from se . L.key "filter" . L.asText) <$> askSE (readFilter ["none"] <> k)
-- [Just "none"]

-- | <https://api.stackexchange.com/docs/read-filter>
readFilter :: [Text] -> Request a "readFilter" [SE Filter]
readFilter (T.intercalate ";" -> fs) =
  path ("filters/" <> fs) <>
  parse (attoparsec items ".filters/{filters}: ")


--------------------------
-- Inbox Items
--------------------------

-- | <https://api.stackexchange.com/docs/inbox>
inbox :: Request RequireToken "inbox" [SE InboxItem]
inbox =
  path "inbox" <>
  parse (attoparsec items ".inbox: ")


-- | <https://api.stackexchange.com/docs/inbox-unread>
inboxUnread :: Request RequireToken "inboxUnread" [SE InboxItem]
inboxUnread =
  path "inbox/unread" <>
  parse (attoparsec items ".inbox/unread: ")


-- | <https://api.stackexchange.com/docs/user-inbox>
userInbox :: Int -> Request RequireToken "userInbox" [SE InboxItem]
userInbox (toLazyText . decimal -> i) =
  path ("users/" <> i <> "/inbox") <>
  parse (attoparsec items ".users/{id}/inbox: ")


-- | <https://api.stackexchange.com/docs/me-inbox>
meInbox :: Request RequireToken "meInbox" [SE InboxItem]
meInbox =
  path "me/inbox" <>
  parse (attoparsec items ".me/inbox: ")


-- | <https://api.stackexchange.com/docs/user-unread-inbox>
userUnreadInbox :: Int -> Request RequireToken "userUnreadInbox" [SE InboxItem]
userUnreadInbox (toLazyText . decimal -> i) =
  path ("users/" <> i <> "/inbox/unread") <>
  parse (attoparsec items ".users/{id}/inbox/unread: ")


-- | <https://api.stackexchange.com/docs/me-unread-inbox>
meUnreadInbox :: Request RequireToken "meUnreadInbox" [SE InboxItem]
meUnreadInbox =
  path "me/inbox/unread" <>
  parse (attoparsec items ".me/inbox/unread: ")


--------------------------
-- Info
--------------------------

-- $info
-- >>> isJust . (^. from se . L.key "items" . L.nth 0 . L.key "total_users" . L.asDouble) <$> askSE (info <> s <> k)
-- True

-- | <https://api.stackexchange.com/docs/info>
info :: Request a "info" (SE Info)
info = path "info" <> parse (attoparsec (fmap SE) ".info: ")


--------------------------
-- Network Users
--------------------------

-- $associatedUsers
-- >>> length `fmap` askSE (associatedUsers [1097181] <> k)
-- 1

-- | <https://api.stackexchange.com/docs/associated-users>
associatedUsers :: [Int] -> Request a "associatedUsers" [SE NetworkUser]
associatedUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is <> "/associated") <>
  parse (attoparsec items ".users/{ids}/associated: ")


-- | <https://api.stackexchange.com/docs/me-associated-users>
meAssociatedUsers :: Request RequireToken "meAssociatedUsers" [SE NetworkUser]
meAssociatedUsers =
  path "me/associated" <>
  parse (attoparsec items ".me/associated: ")


--------------------------
-- Merge History
--------------------------

-- $mergeHistory
-- >>> ((>= 1) . length) `fmap` askSE (mergeHistory [14] <> k)
-- True

-- | <https://api.stackexchange.com/docs/merge-history>
mergeHistory :: [Int] -> Request a "mergeHistory" [SE AccountMerge]
mergeHistory (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is <> "/merges") <>
  parse (attoparsec items ".users/{ids}/merges: ")


-- | <https://api.stackexchange.com/docs/me-merge-history>
meMergeHistory :: Request RequireToken "meMergeHistory" [SE AccountMerge]
meMergeHistory =
  path "me/merges" <>
  parse (attoparsec items ".me/merges: ")


--------------------------
-- Notifications
--------------------------

-- | <https://api.stackexchange.com/docs/notifications>
notifications :: Request RequireToken "notifications" [SE Notification]
notifications = path "notifications" <> parse (attoparsec items ".notifications: ")


-- | <https://api.stackexchange.com/docs/notifications-unread>
notificationsUnread :: Request RequireToken "notificationsUnread" [SE Notification]
notificationsUnread = path "notifications/unread" <> parse (attoparsec items ".notifications/unread: ")


-- | <https://api.stackexchange.com/docs/user-notifications>
userNotifications :: Int -> Request RequireToken "userNotifications" [SE Notification]
userNotifications (toLazyText . decimal -> i) =
  path ("users/" <> i <> "/notifications") <>
  parse (attoparsec items ".users/{id}/notifications: ")


-- | <https://api.stackexchange.com/docs/me-notifications>
meNotifications :: Request RequireToken "meNotifications" [SE Notification]
meNotifications =
  path "me/notifications" <>
  parse (attoparsec items ".me/notifications: ")


-- | <https://api.stackexchange.com/docs/user-unread-notifications>
userUnreadNotifications :: Int -> Request RequireToken "userUnreadNotifications" [SE Notification]
userUnreadNotifications (toLazyText . decimal -> i) =
  path ("users/" <> i <> "/notifications/unread") <>
  parse (attoparsec items ".users/{id}/notifications/unread: ")


-- | <https://api.stackexchange.com/docs/me-unread-notifications>
meUnreadNotifications :: Request RequireToken "meUnreadNotifications" [SE Notification]
meUnreadNotifications =
  path "me/notifications" <>
  parse (attoparsec items ".me/notifications/unread: ")


--------------------------
-- Posts
--------------------------

-- $posts
-- >>> checkLengthM $ askSE (posts <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/posts>
posts :: Request a "posts" [SE Post]
posts = path "posts" <> parse (attoparsec items ".posts: ")


-- $postsByIds
-- >>> length `fmap` askSE (postsByIds [394601] <> s <> k)
-- 1

-- | <https://api.stackexchange.com/docs/posts-by-ids>
postsByIds :: [Int] -> Request a "postsByIds" [SE Post]
postsByIds (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("posts/" <> is) <> parse (attoparsec items ".posts/{ids}: ")


--------------------------
-- Privileges
--------------------------

-- $privileges
-- >>> checkLengthM $ askSE (privileges <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/privileges>
privileges :: Request a "privileges" [SE Privilege]
privileges = path "privileges" <> parse (attoparsec items ".privileges: ")


-- $privilegesOnUsers
-- >>> checkLengthM $ askSE (privilegesOnUsers 1097181 <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/privileges-on-users>
privilegesOnUsers :: Int -> Request a "privilegesOnUsers" [SE Privilege]
privilegesOnUsers (toLazyText . decimal -> i) =
  path ("users/" <> i <> "/privileges") <>
  parse (attoparsec items ".users/{ids}/privileges: ")


-- | <https://api.stackexchange.com/docs/me-privileges>
mePriviledges :: Request RequireToken "mePriviledges" [SE Privilege]
mePriviledges = path "me/privileges" <> parse (attoparsec items ".me/privileges: ")


--------------------------
-- Questions
--------------------------

-- $questions
-- >>> checkLengthM $ askSE (questions <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/questions>
questions :: Request a "questions" [SE Question]
questions = path "questions" <> parse (attoparsec items ".questions: ")


-- $questionsByIds
-- >>> length `fmap` askSE (questionsByIds [394601] <> s <> k)
-- 1

-- | <https://api.stackexchange.com/docs/questions-by-ids>
questionsByIds :: [Int] -> Request a "questionsByIds" [SE Question]
questionsByIds (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("questions/" <> is) <> parse (attoparsec items ".questions/{ids}: ")


-- $linkedQuestions
-- >>> checkLengthM $ askSE (linkedQuestions [394601] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/linked-questions>
linkedQuestions :: [Int] -> Request a "linkedQuestions" [SE Question]
linkedQuestions (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("questions/" <> is <> "/linked") <>
  parse (attoparsec items ".questions/{ids}/linked: ")


-- $relatedQuestions
-- >>> checkLengthM $ askSE (relatedQuestions [394601] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/related-questions>
relatedQuestions :: [Int] -> Request a "relatedQuestions" [SE Question]
relatedQuestions (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("questions/" <> is <> "/related") <>
  parse (attoparsec items ".questions/{ids}/related: ")


-- $featuredQuestions
-- >>> checkLengthM $ askSE (featuredQuestions <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/featured-questions>
featuredQuestions :: Request a "featuredQuestions" [SE Question]
featuredQuestions =
  path "questions/featured" <> parse (attoparsec items ".questions/featured: ")


-- $unansweredQuestions
-- >>> checkLengthM $ askSE (unansweredQuestions <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/unanswered-questions>
unansweredQuestions :: Request a "unansweredQuestions" [SE Question]
unansweredQuestions =
  path "questions/unanswered" <>
  parse (attoparsec items ".questions/unanswered: ")


-- $noAnswerQuestions
-- >>> checkLengthM $ askSE (noAnswerQuestions <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/no-answer-questions>
noAnswerQuestions :: Request a "noAnswerQuestions" [SE Question]
noAnswerQuestions =
  path "questions/no-answers" <>
  parse (attoparsec items ".questions/no-answers: ")


-- $search
-- >>> checkLengthM $ askSE (search "why" ["haskell"] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/search>
search :: Text -> [Text] -> Request a "search" [SE Question]
search t (T.intercalate ";" -> ts) =
  path "search" <>
  query [("intitle",t),("tagged",ts)] <>
  parse (attoparsec items ".search: ")


-- $advancedSearch
-- >>> checkLengthM $ askSE (advancedSearch <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/advanced-search>
advancedSearch :: Request a "advancedSearch" [SE Question]
advancedSearch =
  path "search/advanced" <> parse (attoparsec items ".search/advanced: ")


-- $similar
-- >>> checkLengthM $ askSE (similar "sublists of list" ["haskell"] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/similar>
similar :: Text -> [Text] -> Request a "similar" [SE Question]
similar t (T.intercalate ";" -> ts) =
  path "similar" <>
  query [("title",t),("tagged",ts)] <>
  parse (attoparsec items ".similar: ")


-- $faqsByTags
-- >>> checkLengthM $ askSE (faqsByTags ["haskell"] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/faqs-by-tags>
faqsByTags :: [Text] -> Request a "faqsByTags" [SE Question]
faqsByTags (T.intercalate ";" -> ts) =
  path ("tags/" <> ts <> "/faq") <>
  parse (attoparsec items ".tags/{tags}/faq: ")


-- $favoritesOnUsers
-- >>> checkLengthM $ askSE (favoritesOnUsers [9204] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/favorites-on-users>
favoritesOnUsers :: [Int] -> Request a "favoritesOnUsers" [SE Question]
favoritesOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is <> "/favorites") <>
  parse (attoparsec items ".users/{ids}/favorites: ")


-- | <https://api.stackexchange.com/docs/me-favorites>
meFavorites :: Request RequireToken "meFavorites" [SE Question]
meFavorites = path "me/favorites" <> parse (attoparsec items ".me/favorites: ")


-- $questionsOnUsers
-- >>> checkLengthM $ askSE (questionsOnUsers [9204] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/questions-on-users>
questionsOnUsers :: [Int] -> Request a "questionsOnUsers" [SE Question]
questionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is <> "/questions") <>
  parse (attoparsec items ".users/{ids}/questions: ")


-- | <https://api.stackexchange.com/docs/me-questions>
meQuestions :: Request RequireToken "meQuestions" [SE Question]
meQuestions = path "me/questions" <> parse (attoparsec items ".me/questions: ")

-- $featuredQuestionsOnUsers
-- >>> fq <- (map truncate :: [Double] -> [Int]) . catMaybes . (^.. traverse . from se . L.key "owner" . L.key "user_id" . L.asDouble) <$> askSE (featuredQuestions <> s <> k <> q)
-- >>> checkLengthM $ askSE $ featuredQuestionsOnUsers fq <> s <> k <> q
-- True

-- | <https://api.stackexchange.com/docs/featured-questions-on-users>
featuredQuestionsOnUsers :: [Int] -> Request a "featuredQuestionsOnUsers" [SE Question]
featuredQuestionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is <> "/questions/featured") <>
  parse (attoparsec items ".users/{ids}/questions/featured: ")


-- | <https://api.stackexchange.com/docs/me-featured-questions>
meFeaturedQuestions :: Request RequireToken "meFeaturedQuestions" [SE Question]
meFeaturedQuestions = path "me/questions/featured" <> parse (attoparsec items ".me/questions/featured: ")


-- $noAnswerQuestionsOnUsers
-- >>> naaq <- (map truncate :: [Double] -> [Int]) . catMaybes . (^.. traverse . from se . L.key "owner" . L.key "user_id" . L.asDouble) <$> askSE (noAnswerQuestions <> s <> k <> q)
-- >>> checkLengthM $ askSE (noAnswerQuestionsOnUsers naaq <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/no-answer-questions-on-users>
noAnswerQuestionsOnUsers :: [Int] -> Request a "noAnswerQuestionsOnUsers" [SE Question]
noAnswerQuestionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is <> "/questions/no-answers") <>
  parse (attoparsec items ".users/{ids}/questions/no-answers: ")


-- | <https://api.stackexchange.com/docs/me-no-answer-questions>
meNoAnswerQuestions :: Request RequireToken "meNoAnswerQuestions" [SE Question]
meNoAnswerQuestions = path "me/questions/no-answers" <> parse (attoparsec items ".me/questions/no-answers: ")


-- $unacceptedQuestionsOnUsers
-- >>> null `fmap` askSE (unacceptedQuestionsOnUsers [570689] <> s <> k <> q)
-- False
--
-- | <https://api.stackexchange.com/docs/unaccepted-questions-on-users>
unacceptedQuestionsOnUsers :: [Int] -> Request a "unacceptedQuestionsOnUsers" [SE Question]
unacceptedQuestionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is <> "/questions/unaccepted") <>
  parse (attoparsec items ".users/{ids}/questions/unaccepted: ")


-- | <https://api.stackexchange.com/docs/me-unaccepted-questions>
meUnacceptedQuestions :: Request RequireToken "meUnacceptedQuestions" [SE Question]
meUnacceptedQuestions = path "me/questions/unaccepted" <> parse (attoparsec items ".me/questions/unaccepted: ")


-- $unansweredQuestionsOnUsers
-- >>> uaq <- (map truncate :: [Double] -> [Int]) . catMaybes . (^.. traverse . from se . L.key "owner" . L.key "user_id" . L.asDouble) <$> askSE (unansweredQuestions <> s <> k <> q)
-- >>> checkLengthM $ askSE (unansweredQuestionsOnUsers uaq <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/unanswered-questions-on-users>
unansweredQuestionsOnUsers :: [Int] -> Request a "unansweredQuestionsOnUsers" [SE Question]
unansweredQuestionsOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is <> "/questions/unanswered") <>
  parse (attoparsec items ".users/{ids}/questions/unanswered: ")


-- | <https://api.stackexchange.com/docs/me-unanswered-questions>
meUnansweredQuestions :: Request RequireToken "meUnansweredQuestions" [SE Question]
meUnansweredQuestions = path "me/questions/unanswered" <> parse (attoparsec items ".me/questions/unanswered: ")


-- $topUserQuestionsInTags
-- >>> checkLengthM $ askSE (topUserQuestionsInTags 570689 ["haskell"] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/top-user-questions-in-tags>
topUserQuestionsInTags :: Int -> [Text] -> Request a "topUserQuestionsInTags" [SE Question]
topUserQuestionsInTags (toLazyText . decimal -> i) (T.intercalate ";" -> ts) =
  path ("users/" <> i <> "/tags/" <> ts <> "/top-questions") <>
    parse (attoparsec items ".users/{id}/tags/{tags}/top-questions: ")


-- | <https://api.stackexchange.com/docs/me-tags-top-questions>
meTagsTopQuestions :: [Text] -> Request RequireToken "meTagsTopQuestions" [SE Question]
meTagsTopQuestions (T.intercalate ";" -> ts) =
  path ("me/tags/" <> ts <> "/top-questions") <>
  parse (attoparsec items ".me/tags/{tags}/top-questions: ")


--------------------------
-- Question Timelines
--------------------------

-- $questionsTimeline
-- >>> checkLengthM $ askSE (questionsTimeline [570689] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/questions-timeline>
questionsTimeline :: [Int] -> Request a "questionsTimeline" [SE QuestionTimeline]
questionsTimeline (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("questions/" <> is <> "/timeline") <>
  parse (attoparsec items ".questions/{ids}/timeline: ")


--------------------------
-- Reputation
--------------------------

-- $reputationOnUsers
-- >>> checkLengthM $ askSE (reputationOnUsers [1097181] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/reputation-on-users>
reputationOnUsers :: [Int] -> Request a "reputationOnUsers" [SE Reputation]
reputationOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is <> "/reputation") <>
  parse (attoparsec items ".users/{ids}/reputation: ")


-- | <https://api.stackexchange.com/docs/me-reputation>
meReputation :: Request RequireToken "meReputation" [SE Reputation]
meReputation = path "me/reputation" <> parse (attoparsec items ".me/reputation: ")


--------------------------
-- Reputation History
-------------------------

-- $reputationHistory
-- >>> checkLengthM $ askSE (reputationHistory [1097181] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/reputation-history>
reputationHistory :: [Int] -> Request a "reputationHistory" [SE ReputationHistory]
reputationHistory (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is <> "/reputation-history") <>
  parse (attoparsec items ".users/{ids}/reputation-history: ")


-- | <https://api.stackexchange.com/docs/me-reputation-history>
meReputationHistory :: Request RequireToken "meReputationHistory" [SE ReputationHistory]
meReputationHistory =
  path "me/reputation-history" <>
  parse (attoparsec items ".me/reputation-history: ")


-- | <https://api.stackexchange.com/docs/full-reputation-history>
reputationHistoryFull :: [Int] -> Request RequireToken "reputationHistoryFull" [SE ReputationHistory]
reputationHistoryFull (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is <> "/reputation-history/full") <>
  parse (attoparsec items ".users/{ids}/reputation-history/full: ")


-- | <https://api.stackexchange.com/docs/me-full-reputation-history>
meReputationHistoryFull :: Request RequireToken "meReputationHistoryFull" [SE ReputationHistory]
meReputationHistoryFull =
  path "me/reputation-history/full" <>
  parse (attoparsec items ".me/reputation-history/full: ")


--------------------------
-- Revisions
--------------------------

-- $revisionsByIds
-- >>> checkLengthM $ askSE (revisionsByIds [1218390] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/revisions-by-ids>
revisionsByIds :: [Int] -> Request a "revisionsByIds" [SE Revision]
revisionsByIds (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("posts/" <> is <> "/revisions") <>
  parse (attoparsec items ".posts/{ids}/revisions: ")


-- $revisionsByGuids
-- >>> length `fmap` askSE (revisionsByGuids ["881687CA-9A98-46CC-B9F0-4063322B5E2F"] <> s <> k <> q)
-- 1

-- | <https://api.stackexchange.com/docs/revisions-by-guids>
revisionsByGuids :: [Text] -> Request a "revisionsByGuids" [SE Revision]
revisionsByGuids (T.intercalate ";" -> is) =
  path ("revisions/" <> is) <>
  parse (attoparsec items ".revisions/{ids}: ")


--------------------------
-- Sites
--------------------------

-- $sites
-- >>> checkLengthM $ askSE (sites <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/sites>
sites :: Request a "sites" [SE Site]
sites = path "sites" <> parse (attoparsec items ".sites: ")


--------------------------
-- Suggested Edits
--------------------------

-- $postsOnSuggestedEdits
-- >>> se' <- (map truncate :: [Double] -> [Int]) . catMaybes . (^.. traverse . from se . L.key "post_id" . L.asDouble) <$> askSE (suggestedEdits <> s <> k <> q)
-- >>> checkLengthM $ askSE (postsOnSuggestedEdits se' <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/posts-on-suggested-edits>
postsOnSuggestedEdits :: [Int] -> Request a "postsOnSuggestedEdits" [SE SuggestedEdit]
postsOnSuggestedEdits (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("posts/" <> is <> "/suggested-edits") <>
  parse (attoparsec items ".posts/{ids}/suggested-edits: ")


-- $suggestedEdits
-- >>> checkLengthM $ askSE (suggestedEdits <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/suggested-edits>
suggestedEdits :: Request a "suggestedEdits" [SE SuggestedEdit]
suggestedEdits =
  path "suggested-edits" <> parse (attoparsec items ".suggested-edits: ")


-- $suggestedEditsByIds
-- >>> se' <- (map truncate :: [Double] -> [Int]) . catMaybes . (^.. traverse . from se . L.key "suggested_edit_id" . L.asDouble) <$> askSE (suggestedEdits <> s <> k <> q)
-- >>> checkLengthM $ askSE (suggestedEditsByIds se' <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/suggested-edits-by-ids>
suggestedEditsByIds :: [Int] -> Request a "suggestedEditsByIds" [SE SuggestedEdit]
suggestedEditsByIds (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("suggested-edits/" <> is ) <>
  parse (attoparsec items ".suggested-edits/{ids}: ")


-- $suggestedEditsOnUsers
-- >>> se' <- (map truncate :: [Double] -> [Int]) . catMaybes . (^.. traverse . from se . L.key "proposing_user" . L.key "user_id" . L.asDouble) <$> askSE (suggestedEdits <> s <> k <> q)
-- >>> checkLengthM $ askSE (suggestedEditsOnUsers se' <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/suggested-edits-on-users>
suggestedEditsOnUsers :: [Int] -> Request a "suggestedEditsOnUsers" [SE SuggestedEdit]
suggestedEditsOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is <> "/suggested-edits") <>
  parse (attoparsec items ".users/{ids}/suggested-edits: ")


-- | <https://api.stackexchange.com/docs/me-suggested-edits>
meSuggestedEdits :: Request RequireToken "meSuggestedEdits" [SE SuggestedEdit]
meSuggestedEdits =
  path "me/suggested-edits" <>
  parse (attoparsec items ".me/suggested-edits: ")


--------------------------
-- Tags
--------------------------

-- $tags
-- >>> checkLengthM $ askSE (tags <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/tags>
tags :: Request a "tags" [SE Tag]
tags = path "tags" <> parse (attoparsec items ".tags: ")


-- $moderatorOnlyTags
-- >>> checkLengthM $ askSE (moderatorOnlyTags <> site "meta.serverfault" <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/moderator-only-tags>
moderatorOnlyTags :: Request a "moderatorOnlyTags" [SE Tag]
moderatorOnlyTags =
  path "tags/moderator-only" <>
  parse (attoparsec items ".tags/moderator-only: ")


-- $requiredTags
-- >>> (( > 0) . length) `fmap` askSE (requiredTags <> site "meta.serverfault" <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/required-tags>
requiredTags :: Request a "requiredTags" [SE Tag]
requiredTags =
  path "tags/required" <> parse (attoparsec items ".tags/required: ")


-- $tagsByName
-- >>> ((> 0) . length) `fmap` askSE (tagsByName ["haskell"] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/tags-by-name>
tagsByName :: [Text] -> Request a "tagsByName" [SE Tag]
tagsByName (T.intercalate ";" -> ts) =
  path ("tags/" <> ts <> "/info") <>
  parse (attoparsec items ".tags/{tags}/info: ")


-- $relatedTags
-- >>> checkLengthM $ askSE (relatedTags ["haskell"] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/related-tags>
relatedTags :: [Text] -> Request a "relatedTags" [SE Tag]
relatedTags (T.intercalate ";" -> ts) =
  path ("tags/" <> ts <> "/related") <>
  parse (attoparsec items ".tags/{tags}/related: ")


-- $tagsOnUsers
-- >>> checkLengthM $ askSE (tagsOnUsers [1097181] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/tags-on-users>
tagsOnUsers :: [Int] -> Request a "tagsOnUsers" [SE Tag]
tagsOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is <> "/tags") <>
  parse (attoparsec items ".users/{ids}/tags: ")


-- | <https://api.stackexchange.com/docs/me-tags>
meTags :: Request RequireToken "meTags" [SE Tag]
meTags = path "me/tags" <> parse (attoparsec items ".me/tags: ")


--------------------------
-- Tag Scores
--------------------------

-- $topAnswerersOnTag
-- >>> checkLengthM $ askSE (topAnswerersOnTag "haskell" "Month" <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/top-answerers-on-tags>
topAnswerersOnTag :: Text -> Text -> Request a "topAnswerersOnTag" [SE TagScore]
topAnswerersOnTag t p =
  path ("tags/" <> t <> "/top-answerers/" <> p) <>
  parse (attoparsec items ".tags/{tag}/top-answerers/{period}: ")


-- $topAskersOnTag
-- >>> checkLengthM $ askSE (topAskersOnTag "haskell" "Month" <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/top-askers-on-tags>
topAskersOnTag :: Text -> Text -> Request a "topAskersOnTag" [SE TagScore]
topAskersOnTag t p =
  path ("tags/" <> t <> "/top-askers/" <> p) <>
  parse (attoparsec items ".tags/{tag}/top-askers/{period}: ")


--------------------------
-- Tag Synonyms
--------------------------

-- $tagSynonyms
-- >>> checkLengthM $ askSE (tagSynonyms <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/tag-synonyms>
tagSynonyms :: Request a "tagSynonyms" [SE TagSynonym]
tagSynonyms =
  path "tags/synonyms" <> parse (attoparsec items ".tags/synonyms: ")


-- $synonymsByTags
-- >>> checkLengthM $ askSE (synonymsByTags ["iphone","java"] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/synonyms-by-tags>
synonymsByTags :: [Text] -> Request a "synonymsByTags" [SE TagSynonym]
synonymsByTags (T.intercalate ";" -> ts) =
  path ("tags/" <> ts <> "/synonyms") <>
  parse (attoparsec items ".tags/{tags}/synonyms: ")


--------------------------
-- Tag Wikis
--------------------------

-- $wikisByTags
-- >>> length `fmap` askSE (wikisByTags ["haskell"] <> s <> k <> q)
-- 1

-- | <https://api.stackexchange.com/docs/wikis-by-tags>
wikisByTags :: [Text] -> Request a "wikisByTags" [SE TagWiki]
wikisByTags (T.intercalate ";" -> ts) =
  path ("tags/" <> ts <> "/wikis") <>
  parse (attoparsec items ".tags/{tags}/wikis: ")


--------------------------
-- Top Tags
--------------------------

-- $topAnswerTagsOnUsers
-- >>> checkLengthM $ askSE (topAnswerTagsOnUsers 1097181 <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/top-answer-tags-on-users>
topAnswerTagsOnUsers :: Int -> Request a "topAnswerTagsOnUsers" [SE TopTag]
topAnswerTagsOnUsers (toLazyText . decimal -> i) =
  path ("users/" <> i <> "/top-answer-tags") <>
  parse (attoparsec items ".users/{id}/top-answer-tags: ")


-- | <https://api.stackexchange.com/docs/me-top-answer-tags>
meTopAnswerTags :: Request RequireToken "meTopAnswerTags" [SE TopTag]
meTopAnswerTags = path "me/top-answer-tags" <> parse (attoparsec items ".me/top-answer-tags: ")


-- $topQuestionTagsOnUsers
-- >>> checkLengthM $ askSE (topQuestionTagsOnUsers 570689 <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/top-question-tags-on-users>
topQuestionTagsOnUsers :: Int -> Request a "topQuestionTagsOnUsers" [SE TopTag]
topQuestionTagsOnUsers (toLazyText . decimal -> i) =
  path ("users/" <> i <> "/top-question-tags") <>
  parse (attoparsec items ".users/{id}/top-question-tags: ")


-- | <https://api.stackexchange.com/docs/me-top-question-tags>
meTopQuestionTags :: Request RequireToken "meTopQuestionTags" [SE TopTag]
meTopQuestionTags = path "me/top-question-tags" <> parse (attoparsec items ".me/top-question-tags: ")


--------------------------
-- Users
--------------------------

-- $users
-- >>> checkLengthM $ askSE (users <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/users>
users :: Request a "users" [SE User]
users = path "users" <> parse (attoparsec items ".users: ")


-- $users
-- >>> length `fmap` askSE (usersByIds [1097181] <> s <> k <> q)
-- 1

-- | <https://api.stackexchange.com/docs/users-by-ids>
usersByIds :: [Int] -> Request a "usersByIds" [SE User]
usersByIds (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is) <> parse (attoparsec items ".users/{ids}: ")


-- | <https://api.stackexchange.com/docs/me>
me :: Request RequireToken "me" (SE User)
me = path "me" <> parse (head . attoparsec items ".me: ")


-- $moderators
-- >>> checkLengthM $ askSE (moderators <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/moderators>
moderators :: Request a "moderators" [SE User]
moderators =
  path "users/moderators" <> parse (attoparsec items ".users/moderators: ")


-- $electedModerators
-- >>> checkLengthM $ askSE (electedModerators <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/elected-moderators>
electedModerators :: Request a "electedModerators" [SE User]
electedModerators =
  path "users/moderators/elected" <>
  parse (attoparsec items ".users/moderators/elected: ")


--------------------------
-- User Timeline
--------------------------

-- $timelineOnUsers
-- >>> checkLengthM $ askSE (timelineOnUsers [1097181] <> s <> k <> q)
-- True

-- | <https://api.stackexchange.com/docs/timeline-on-users>
timelineOnUsers :: [Int] -> Request a "timelineOnUsers" [SE UserTimeline]
timelineOnUsers (T.intercalate ";" . map (toLazyText . decimal) -> is) =
  path ("users/" <> is <> "/timeline") <>
  parse (attoparsec items ".users/{ids}/timeline: ")


-- | <https://api.stackexchange.com/docs/me-timeline>
meTimeline :: Request RequireToken "meTimeline" [SE UserTimeline]
meTimeline = path "me/timeline" <> parse (attoparsec items ".me/timeline: ")


--------------------------
-- Write Permissions
--------------------------

-- $writePermissions
-- >>> length `fmap` askSE (writePermissions 1097181 <> s <> k <> q)
-- 1

-- | <https://api.stackexchange.com/docs/write-permissions>
writePermissions :: Int -> Request a "writePermissions" [SE WritePermission]
writePermissions (toLazyText . decimal -> i) =
  path ("users/" <> i <> "/write-permissions") <>
  parse (attoparsec items ".users/{id}/write-permissions: ")


-- | <https://api.stackexchange.com/docs/me-write-permissions>
meWritePermissions :: Request RequireToken "meWritePermissions" [SE WritePermission]
meWritePermissions = path "me/write-permissions" <> parse (attoparsec items ".me/write-permissions: ")


attoparsec :: (Maybe Value -> Maybe b) -> String -> ByteString -> b
attoparsec f msg request = case AP.eitherResult $ AP.parse A.json request of
  Right s -> case f (Just s) of
    Just b -> b
    Nothing -> throw $ SEException request ("libstackexchange" ++ msg ++ "incorrect JSON content")
  Left e -> throw $ SEException request ("libstackexchange" ++ msg ++ e)


items :: Maybe Value -> Maybe [SE a]
items s = fmap (map SE) . A.parseMaybe (\o -> A.parseJSON o >>= (.: "items")) =<< s

</pre>