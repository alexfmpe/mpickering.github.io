<a href="Internal.hs1710652610427350234.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Internal.hs1842378953296356978.out.html">next</a></br></br><pre>25d24
< InfixE ll pp (StringE lr) $++$ StringE r | pp == '(++) = ll $++$ StringE (lr ++ r)
26c25
< l $++$ r = InfixE l '(++) r
---
> InfixE ll pp (StringE lr) $++$ StringE r | pp == '++ = ll $++$ StringE (lr ++ r)
26a26
> l $++$ r = InfixE l '++ r
32d31
< l ++$ InfixE (StringE rl) pp rr | pp == '(++) = (l ++ rl) ++$ rr
33c32
< l ++$ r = InfixE (StringE l) '(++) r
---
> l ++$ InfixE (StringE rl) pp rr | pp == '++ = (l ++ rl) ++$ rr
33a33
> l ++$ r = InfixE (StringE l) '++ r
33a34
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE PatternSynonyms, TemplateHaskell #-}
module Database.PostgreSQL.Typed.Internal
  ( stringE
  , pattern StringE
  , ($++$)
  , (++$)
  ) where

import Data.String (IsString(..))
import qualified Language.Haskell.TH as TH

stringE :: String -> TH.Exp
stringE = TH.LitE . TH.StringL

pattern StringE s = TH.LitE (TH.StringL s)
pattern InfixE l o r = TH.InfixE (Just l) (TH.VarE o) (Just r)

instance IsString TH.Exp where
  fromString = stringE

($++$) :: TH.Exp -> TH.Exp -> TH.Exp
infixr 5 $++$
StringE s $++$ r = s ++$ r
l $++$ StringE "" = l
InfixE ll pp (StringE lr) $++$ StringE r | pp == '(++) = ll $++$ StringE (lr ++ r)
l $++$ r = InfixE l '(++) r

(++$) :: String -> TH.Exp -> TH.Exp
infixr 5 ++$
"" ++$ r = r
l ++$ StringE r = StringE (l ++ r)
l ++$ InfixE (StringE rl) pp rr | pp == '(++) = (l ++ rl) ++$ rr
l ++$ r = InfixE (StringE l) '(++) r
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE PatternSynonyms, TemplateHaskell #-}
module Database.PostgreSQL.Typed.Internal
  ( stringE
  , pattern StringE
  , ($++$)
  , (++$)
  ) where

import Data.String (IsString(..))
import qualified Language.Haskell.TH as TH

stringE :: String -> TH.Exp
stringE = TH.LitE . TH.StringL

pattern StringE s = TH.LitE (TH.StringL s)
pattern InfixE l o r = TH.InfixE (Just l) (TH.VarE o) (Just r)

instance IsString TH.Exp where
  fromString = stringE

($++$) :: TH.Exp -> TH.Exp -> TH.Exp
infixr 5 $++$
StringE s $++$ r = s ++$ r
l $++$ StringE "" = l
InfixE ll pp (StringE lr) $++$ StringE r | pp == '++ = ll $++$ StringE (lr ++ r)
l $++$ r = InfixE l '++ r

(++$) :: String -> TH.Exp -> TH.Exp
infixr 5 ++$
"" ++$ r = r
l ++$ StringE r = StringE (l ++ r)
l ++$ InfixE (StringE rl) pp rr | pp == '++ = (l ++ rl) ++$ rr
l ++$ r = InfixE (StringE l) '++ r

</pre>