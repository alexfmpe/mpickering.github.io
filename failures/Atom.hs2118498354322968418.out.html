<a href="Atom.hs15478371072028841238.out.html">prev</a></br><a href="failures.html">home</a></br><a href="AttachInstances.hs11036699551564674546.out.html">next</a></br></br><pre>98d97
< V(Uri);V(Email);V(Updated);V(Published);V(Title);V(Subtitle)
99d97
< V(Summary);V(Content);V(Author);V(Contributor);V(Name);V(Category)
100c98
< V(Term);V(Scheme);V(Label);V(Id)
---
> instanceV(Uri);V(VersionEmail);VUri(Updated;instance);V(Published Email);V(Title;instance);V(Subtitle) Updated;instance Version Published;instance Version Title;instance Version Subtitle
100a99
> instanceV(SummaryVersion);V(Content);V(;Authorinstance);V(VersionContributor);V(;Nameinstance);V(Category) Author;instance Version Contributor;instance Version Name;instance Version Category
100a100
> instanceV(Term);VVersion(Scheme)Term;V(Label;instance);V(IdVersion)       Scheme;instance Version Label;instance Version Id
105a106
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE CPP, TemplateHaskell, UndecidableInstances, DeriveDataTypeable #-}
module Happstack.Contrib.Atom
    (
     Entry(..)
    ,Feed(..)
    ,Author(..)
    ,Contributor(..)
    ,Category(..)
    ,Id(..)
    ,Title(..)
    ,Published(..)
    ,Updated(..)
    ,Summary(..)
    ,Content(..)
    ,Word(..)
    ,Email(..)


)
    where

import Happstack.Data
import Happstack.Contrib.HList


$( deriveAll [''Ord,''Eq,''Read,''Show,''Default]
   [d|
    data Feed = Feed [Entry]

    data Entry =
        Entry
        [Author]
        [Category]
        (Maybe Content )
        [Contributor]
        Id

        -- Link is a computed value
        (Maybe Published)
        -- ignoring stuff I don't care about
        (Maybe Summary)
        Title
        Updated

       {--

        Entry

        --stuff not in the spec but commonly useful for management
        --a -- sometime you want to stick other data in here
        --(Maybe Owner) -- not in spec but useful for actual management
        --(Maybe Refs) -- for use when Entry is actually a comment on another

        Author -- we will have only one author
        [Contributor] -- author can credit contributors
        [Category] -- allow user to select categories
        Id
        -- Link is a computed value
        Title
        Updated
        Maybe Published
        -- (Maybe Rights)
        Maybe Summary -- We choose to always have a summary
        Maybe Content -- We choose to always have content
        --}

    type PersonConstruct = (Name, Maybe Uri, Maybe Email)
    data Author = Author PersonConstruct
    data Contributor = Contributor PersonConstruct
    newtype Name = Name Text

    data Category = Category Term (Maybe Scheme) (Maybe Label)
    newtype Term = Term String
    newtype Scheme = Scheme String
    newtype Label = Label String

    newtype Id = Id Integer

    type DateConstruct = Integer

    data Title = Title TextConstruct
    data Subtitle = Subtitle TextConstruct
    newtype Summary = Summary TextConstruct
    newtype Content = Content TextConstruct

    newtype Uri = Uri String
    newtype Email = Email String
    newtype Updated = Updated DateConstruct
    newtype Published = Published DateConstruct

    type Text = String
    type TextConstruct = Text

    newtype Word = Word String
 |] )

#define V(x) instance Version x
V(Uri);V(Email);V(Updated);V(Published);V(Title);V(Subtitle)
V(Summary);V(Content);V(Author);V(Contributor);V(Name);V(Category)
V(Term);V(Scheme);V(Label);V(Id)
$(deriveSerializeFor [''Uri, ''Email, ''Updated, ''Published
                     ,''Title, ''Subtitle, ''Summary, ''Content
                     ,''Author, ''Contributor, ''Name, ''Category
                     ,''Term, ''Scheme, ''Label, ''Id])

</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE CPP, TemplateHaskell, UndecidableInstances, DeriveDataTypeable #-}
module Happstack.Contrib.Atom
    (
     Entry(..)
    ,Feed(..)
    ,Author(..)
    ,Contributor(..)
    ,Category(..)
    ,Id(..)
    ,Title(..)
    ,Published(..)
    ,Updated(..)
    ,Summary(..)
    ,Content(..)
    ,Word(..)
    ,Email(..)


)
    where

import Happstack.Data
import Happstack.Contrib.HList


$( deriveAll [''Ord,''Eq,''Read,''Show,''Default]
   [d|
    data Feed = Feed [Entry]

    data Entry =
        Entry
        [Author]
        [Category]
        (Maybe Content )
        [Contributor]
        Id

        -- Link is a computed value
        (Maybe Published)
        -- ignoring stuff I don't care about
        (Maybe Summary)
        Title
        Updated

       {--

        Entry

        --stuff not in the spec but commonly useful for management
        --a -- sometime you want to stick other data in here
        --(Maybe Owner) -- not in spec but useful for actual management
        --(Maybe Refs) -- for use when Entry is actually a comment on another

        Author -- we will have only one author
        [Contributor] -- author can credit contributors
        [Category] -- allow user to select categories
        Id
        -- Link is a computed value
        Title
        Updated
        Maybe Published
        -- (Maybe Rights)
        Maybe Summary -- We choose to always have a summary
        Maybe Content -- We choose to always have content
        --}

    type PersonConstruct = (Name, Maybe Uri, Maybe Email)
    data Author = Author PersonConstruct
    data Contributor = Contributor PersonConstruct
    newtype Name = Name Text

    data Category = Category Term (Maybe Scheme) (Maybe Label)
    newtype Term = Term String
    newtype Scheme = Scheme String
    newtype Label = Label String

    newtype Id = Id Integer

    type DateConstruct = Integer

    data Title = Title TextConstruct
    data Subtitle = Subtitle TextConstruct
    newtype Summary = Summary TextConstruct
    newtype Content = Content TextConstruct

    newtype Uri = Uri String
    newtype Email = Email String
    newtype Updated = Updated DateConstruct
    newtype Published = Published DateConstruct

    type Text = String
    type TextConstruct = Text

    newtype Word = Word String
 |] )

#define V(x) instance Version x
instanceV(Uri);V(VersionEmail);VUri(Updated;instance);V(Published Email);V(Title;instance);V(Subtitle) Updated;instance Version Published;instance Version Title;instance Version Subtitle
instanceV(SummaryVersion);V(Content);V(;Authorinstance);V(VersionContributor);V(;Nameinstance);V(Category) Author;instance Version Contributor;instance Version Name;instance Version Category
instanceV(Term);VVersion(Scheme)Term;V(Label;instance);V(IdVersion)       Scheme;instance Version Label;instance Version Id
$(deriveSerializeFor [''Uri, ''Email, ''Updated, ''Published
                     ,''Title, ''Subtitle, ''Summary, ''Content
                     ,''Author, ''Contributor, ''Name, ''Category
                     ,''Term, ''Scheme, ''Label, ''Id])


</pre>