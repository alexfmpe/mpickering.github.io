<a href="Interfaces.hs16216316011047353930.out.html">prev</a></br><a href="failures.html">home</a></br><a href="InterfacesRules.hs2101530698762899077.out.html">next</a></br></br><pre>5d4
< module InterfacesRules where
6d4
< {-# LINE 2 "src-ag/Interfaces.ag" #-}
7d4
< 
8c5
< import CommonTypes
---
> module InterfacesRules where CommonTypes
10d6
< {-# LINE 11 "dist/build/InterfacesRules.hs" #-}
12d7
< {-# LINE 10 "src-ag/InterfacesRules.lag" #-}
13a9
> 
13a10
> 
13a11
> 
13a12
> 
28c27
< {-# LINE 29 "dist/build/InterfacesRules.hs" #-}
---
> 
28a28
> 
28a29
> 
28a30
> 
31d32
< {-# LINE 53 "src-ag/InterfacesRules.lag" #-}
32a34
> 
32a35
> 
32a36
> 
32a37
> 
32a38
> 
32a39
> 
32a40
> 
32a41
> 
32a42
> 
32a43
> 
32a44
> 
32a45
> 
32a46
> 
32a47
> 
32a48
> 
32a49
> 
32a50
> 
32a51
> 
32a52
> 
32a53
> 
32a54
> 
32a55
> 
34d56
< {-# LINE 35 "dist/build/InterfacesRules.hs" #-}
36d57
< {-# LINE 88 "src-ag/InterfacesRules.lag" #-}
37a59
> 
37a60
> 
37a61
> 
37a62
> 
37a63
> 
37a64
> 
37a65
> 
37a66
> 
37a67
> 
37a68
> 
37a69
> 
37a70
> 
37a71
> 
37a72
> 
37a73
> 
37a74
> 
37a75
> 
37a76
> 
37a77
> 
37a78
> 
37a79
> 
37a80
> 
37a81
> 
37a82
> 
37a83
> 
37a84
> 
37a85
> 
37a86
> 
37a87
> 
37a88
> 
37a89
> 
37a90
> 
41d93
< {-# LINE 42 "dist/build/InterfacesRules.hs" #-}
43c95
< {-# LINE 129 "src-ag/InterfacesRules.lag" #-}
---
> -- IRoot -------------------------------------------------------
43a96
> -- wrapper
44a98
> 
44a99
> 
44a100
> 
44a101
> 
44a102
> 
44a103
> 
44a104
> 
44a105
> 
44a106
> 
44a107
> 
44a108
> 
44a109
> -- cata
44a110
> 
44a111
> 
44a112
> 
44a113
> 
44a114
> -- semantic domain
44a115
> 
44a116
> 
44a117
> 
44a118
> 
44a119
> 
44a120
> 
44a121
> 
44a122
> 
44a123
> 
44a124
> 
44a125
> 
44a126
> 
44a127
> 
44a128
> 
44a129
> 
44a130
> 
44a131
> 
52d138
< {-# LINE 53 "dist/build/InterfacesRules.hs" #-}
54d139
< {-# LINE 152 "src-ag/InterfacesRules.lag" #-}
55a141
> 
55a142
> 
55a143
> 
55a144
> 
55a145
> 
55a146
> 
55a147
> 
55a148
> 
55a149
> 
55a150
> 
55a151
> 
55a152
> 
55a153
> 
55a154
> 
58d156
< {-# LINE 59 "dist/build/InterfacesRules.hs" #-}
60d157
< {-# LINE 240 "src-ag/InterfacesRules.lag" #-}
61a159
> 
61a160
> 
61a161
> 
61a162
> 
61a163
> 
61a164
> 
61a165
> 
61a166
> 
61a167
> 
61a168
> 
61a169
> 
61a170
> 
61a171
> 
61a172
> 
61a173
> 
61a174
> 
61a175
> 
61a176
> 
61a177
> 
61a178
> 
61a179
> 
61a180
> 
61a181
> 
61a182
> 
61a183
> 
61a184
> 
61a185
> 
61a186
> 
61a187
> 
61a188
> 
61a189
> 
61a190
> 
61a191
> 
61a192
> 
61a193
> 
61a194
> 
61a195
> 
61a196
> 
61a197
> 
61a198
> 
61a199
> 
61a200
> 
61a201
> 
61a202
> 
61a203
> 
61a204
> 
61a205
> 
61a206
> 
61a207
> 
61a208
> 
61a209
> 
61a210
> 
61a211
> 
61a212
> 
61a213
> 
61a214
> 
61a215
> 
61a216
> 
61a217
> 
61a218
> 
61a219
> 
61a220
> 
61a221
> 
61a222
> 
61a223
> 
61a224
> 
61a225
> 
61a226
> -- Interface ---------------------------------------------------
61a227
> -- wrapper
61a228
> 
61a229
> 
61a230
> 
61a231
> 
61a232
> 
61a233
> 
61a234
> 
61a235
> 
61a236
> 
61a237
> 
61a238
> 
61a239
> 
61a240
> -- cata
61a241
> 
61a242
> 
64c245
< postorderF :: Forest a -> [a]
---
> postorderF-- semantic domain:: Forest a -> [a]
70d250
< {-# LINE 71 "dist/build/InterfacesRules.hs" #-}
72d251
< {-# LINE 323 "src-ag/InterfacesRules.lag" #-}
73a253
> 
73a254
> 
73a255
> 
73a256
> 
73a257
> 
73a258
> 
73a259
> 
73a260
> 
73a261
> 
73a262
> 
73a263
> 
73a264
> 
73a265
> 
73a266
> 
73a267
> 
73a268
> 
73a269
> 
73a270
> 
73a271
> 
73a272
> 
73a273
> 
73a274
> 
73a275
> 
73a276
> 
73a277
> 
73a278
> 
73a279
> 
73a280
> 
73a281
> 
73a282
> 
73a283
> 
73a284
> 
73a285
> 
73a286
> 
73a287
> 
73a288
> 
73a289
> 
73a290
> 
73a291
> 
73a292
> 
73a293
> 
73a294
> 
73a295
> 
73a296
> 
73a297
> 
73a298
> 
73a299
> 
73a300
> 
73a301
> 
73a302
> 
73a303
> 
73a304
> 
73a305
> 
73a306
> 
73a307
> 
73a308
> 
73a309
> 
73a310
> 
73a311
> 
73a312
> 
73a313
> 
73a314
> 
73a315
> 
73a316
> 
73a317
> 
73a318
> 
73a319
> 
73a320
> 
73a321
> 
73a322
> 
73a323
> 
73a324
> 
73a325
> 
75d326
< {-# LINE 76 "dist/build/InterfacesRules.hs" #-}
77d327
< {-# LINE 345 "src-ag/InterfacesRules.lag" #-}
78a329
> 
78a330
> 
78a331
> 
78a332
> 
78a333
> 
78a334
> 
78a335
> 
78a336
> 
78a337
> 
78a338
> 
78a339
> 
78a340
> 
78a341
> 
78a342
> 
78a343
> 
78a344
> 
78a345
> 
78a346
> 
78a347
> 
81d349
< {-# LINE 82 "dist/build/InterfacesRules.hs" #-}
83d350
< {-# LINE 420 "src-ag/InterfacesRules.lag" #-}
85c352
< ccv :: Identifier -> NontermIdent -> Int -> CInterfaceMap -> CRule
---
> 
85a353
> 
85a354
> 
85a355
> 
85a356
> 
85a357
> 
85a358
> 
85a359
> 
85a360
> 
85a361
> 
85a362
> 
85a363
> 
85a364
> 
85a365
> 
85a366
> 
85a367
> 
85a368
> 
85a369
> 
85a370
> 
85a371
> 
85a372
> 
85a373
> 
85a374
> 
85a375
> 
85a376
> 
85a377
> 
85a378
> 
85a379
> 
85a380
> 
85a381
> 
85a382
> 
85a383
> 
85a384
> 
85a385
> 
85a386
> 
85a387
> 
85a388
> 
85a389
> 
85a390
> 
85a391
> 
85a392
> 
85a393
> 
85a394
> 
85a395
> 
85a396
> 
85a397
> 
85a398
> 
85a399
> 
85a400
> 
85a401
> 
85a402
> 
85a403
> 
85a404
> 
85a405
> 
85a406
> 
85a407
> 
85a408
> 
85a409
> 
85a410
> 
85a411
> 
85a412
> 
85a413
> 
85a414
> 
85a415
> 
85a416
> 
85a417
> 
85a418
> 
85a419
> 
85a420
> 
85a421
> 
85a422
> -- Interfaces --------------------------------------------------
85a423
> ccv-- wrapper:: Identifier -> NontermIdent -> Int -> CInterfaceMap -> CRule
91d428
<             lst = null remain
92d428
< {-# LINE 93 "dist/build/InterfacesRules.hs" #-}
93d428
< -- IRoot -------------------------------------------------------
94d428
< -- wrapper
95c429
< data Inh_IRoot  = Inh_IRoot { dpr_Inh_IRoot :: !([Edge]), info_Inh_IRoot :: !(Info), tdp_Inh_IRoot :: !(Graph) }
---
>             lst = null remain Inh_IRoot  = Inh_IRoot { dpr_Inh_IRoot :: !([Edge]), info_Inh_IRoot :: !(Info), tdp_Inh_IRoot :: !(Graph) }
107c441
< -- cata
---
> 
112c446
< -- semantic domain
---
> 
152d485
<    {-# LINE 66 "src-ag/InterfacesRules.lag" #-}
153d485
<    rule0 = \ ((_intersInewedges) :: Seq Edge ) ->
154d485
<                             {-# LINE 66 "src-ag/InterfacesRules.lag" #-}
155d485
<                             toList _intersInewedges
156c486
<                             {-# LINE 157 "dist/build/InterfacesRules.hs"#-}
---
> 
156a487
> 
156a488
> 
156a489
> 
156a490
> 
158d491
<    {-# LINE 67 "src-ag/InterfacesRules.lag" #-}
159d491
<    rule1 = \ ((_intersIv) :: Vertex) ((_lhsItdp) :: Graph) _newedges ->
160d491
<                                  {-# LINE 67 "src-ag/InterfacesRules.lag" #-}
161d491
<                                  let graph = buildG (0,_intersIv-1) es
162d491
<                                      es = _newedges ++ edges _lhsItdp
163d491
<                                  in transposeG graph
164c492
<                                  {-# LINE 165 "dist/build/InterfacesRules.hs"#-}
---
> 
164a493
> 
164a494
> 
164a495
> 
164a496
> 
164a497
> 
164a498
> 
166d499
<    {-# LINE 80 "src-ag/InterfacesRules.lag" #-}
167d499
<    rule2 = \ ((_lhsItdp) :: Graph) ->
168d499
<                         {-# LINE 80 "src-ag/InterfacesRules.lag" #-}
169d499
<                         snd (bounds _lhsItdp) + 1
170c500
<                         {-# LINE 171 "dist/build/InterfacesRules.hs"#-}
---
> 
170a501
> 
170a502
> 
170a503
> 
170a504
> 
172d505
<    {-# LINE 122 "src-ag/InterfacesRules.lag" #-}
173d505
<    rule3 = \ _descr ->
174d505
<                                   {-# LINE 122 "src-ag/InterfacesRules.lag" #-}
175d505
<                                   Map.fromList _descr
176c506
<                                   {-# LINE 177 "dist/build/InterfacesRules.hs"#-}
---
> 
176a507
> 
176a508
> 
176a509
> 
176a510
> 
178d511
<    {-# LINE 142 "src-ag/InterfacesRules.lag" #-}
179d511
<    rule4 = \ ((_intersIdescr) :: Seq (Vertex,ChildVisit)) ->
180d511
<                          {-# LINE 142 "src-ag/InterfacesRules.lag" #-}
181d511
<                          toList _intersIdescr
182c512
<                          {-# LINE 183 "dist/build/InterfacesRules.hs"#-}
---
> 
182a513
> 
182a514
> 
182a515
> 
182a516
> 
184d517
<    {-# LINE 214 "src-ag/InterfacesRules.lag" #-}
185d517
<    rule5 = \ _visitssGraph ->
186d517
<                                {-# LINE 214 "src-ag/InterfacesRules.lag" #-}
187d517
<                                _visitssGraph
188c518
<                                {-# LINE 189 "dist/build/InterfacesRules.hs"#-}
---
> 
188a519
> 
188a520
> 
188a521
> 
188a522
> 
190d523
<    {-# LINE 260 "src-ag/InterfacesRules.lag" #-}
191d523
<    rule6 = \ ((_intersIfirstvisitvertices) :: [Vertex]) ((_lhsIinfo) :: Info) ->
192d523
<                             {-# LINE 260 "src-ag/InterfacesRules.lag" #-}
193d523
<                             let terminals = [ v | (v,cr) <- assocs (ruleTable _lhsIinfo), not (getHasCode cr), isLocal cr ]
194d523
<                             in _intersIfirstvisitvertices ++ terminals
195c524
<                             {-# LINE 196 "dist/build/InterfacesRules.hs"#-}
---
> 
195a525
> 
195a526
> 
195a527
> 
195a528
> 
195a529
> 
197d530
<    {-# LINE 343 "src-ag/InterfacesRules.lag" #-}
198d530
<    rule7 = \ ((_intersIv) :: Vertex) ((_lhsIdpr) :: [Edge]) _newedges ->
199d530
<                           {-# LINE 343 "src-ag/InterfacesRules.lag" #-}
200d530
<                           buildG (0,_intersIv-1) (map swap (_lhsIdpr ++ _newedges))
201c531
<                           {-# LINE 202 "dist/build/InterfacesRules.hs"#-}
---
> 
201a532
> 
201a533
> 
201a534
> 
201a535
> 
203d536
<    {-# LINE 381 "src-ag/InterfacesRules.lag" #-}
204d536
<    rule8 = \ ((_intersIinters) :: CInterfaceMap) ->
205d536
<                                  {-# LINE 381 "src-ag/InterfacesRules.lag" #-}
206d536
<                                  _intersIinters
207c537
<                                  {-# LINE 208 "dist/build/InterfacesRules.hs"#-}
---
> 
207a538
> 
207a539
> 
207a540
> 
207a541
> 
209d542
<    {-# LINE 443 "src-ag/InterfacesRules.lag" #-}
210d542
<    rule9 = \ ((_intersIedp) :: Seq Edge) ->
211d542
<                         {-# LINE 443 "src-ag/InterfacesRules.lag" #-}
212d542
<                         toList _intersIedp
213c543
<                         {-# LINE 214 "dist/build/InterfacesRules.hs"#-}
---
> 
213a544
> 
213a545
> 
213a546
> 
213a547
> 
222c556
<      _lhsIinfo
---
>      _lhsIinfo = \ ((_intersInewedges) :: Seq Edge ) -> _intersInewedges
222a557
>    rule1 = \ ((_intersIv) :: Vertex) ((_lhsItdp) :: Graph) _newedges -> graph = buildG (0,_intersIv-1) es
222a558
>                                                                         es = _newedges ++ edges _lhsItdp
222a559
>                                                                        in transposeG graph
224d560
< -- Interface ---------------------------------------------------
225d560
< -- wrapper
226c561
< data Inh_Interface  = Inh_Interface { allInters_Inh_Interface :: !(CInterfaceMap), ddp_Inh_Interface :: !(Graph), info_Inh_Interface :: !(Info), prev_Inh_Interface :: !([Vertex]), v_Inh_Interface :: !(Vertex), visitDescr_Inh_Interface :: !(Map Vertex ChildVisit), vssGraph_Inh_Interface :: !(Graph) }
---
> 
226a562
> 
226a563
> 
226a564
> 
226a565
> 
226a566
> 
226a567
> 
226a568
> 
226a569
> 
226a570
>    rule2 = \ ((_lhsItdp) :: Graph) -> (bounds _lhsItdp) + 1
226a571
> 
226a572
> 
226a573
> 
226a574
> 
226a575
> 
226a576
> 
226a577
> 
226a578
> 
226a579
> 
226a580
> 
226a581
> 
226a582
> 
226a583
> 
226a584
> 
226a585
> 
226a586
> 
226a587
> 
226a588
> 
226a589
> 
226a590
> 
226a591
> 
226a592
> 
226a593
> 
226a594
> 
226a595
> 
226a596
> 
226a597
> 
226a598
> 
226a599
> 
226a600
> 
226a601
> 
226a602
> 
226a603
> 
226a604
> 
226a605
> 
226a606
> 
226a607
> 
226a608
> 
226a609
> 
226a610
> 
226a611
> 
226a612
>    rule3 = \ _descr ->            Map.fromList _descr
226a613
> 
226a614
> 
226a615
> 
226a616
> 
226a617
> 
226a618
> 
226a619
> 
226a620
> 
226a621
> 
226a622
> 
226a623
> 
226a624
> 
226a625
> 
226a626
> 
226a627
> 
226a628
> 
226a629
> 
226a630
> 
226a631
> 
226a632
>    rule4 = \ ((_intersIdescr) :: Seq (Vertex,ChildVisit)) -> _intersIdescr
226a633
> 
226a634
> 
226a635
> 
226a636
> 
226a637
> 
226a638
> 
226a639
> 
226a640
> 
226a641
> 
226a642
> 
226a643
> 
226a644
> 
226a645
> 
226a646
> 
226a647
> 
226a648
> 
226a649
> 
226a650
> 
226a651
> 
226a652
> 
226a653
> 
226a654
> 
226a655
> 
226a656
> 
226a657
> 
226a658
> 
226a659
> 
226a660
> 
226a661
> 
226a662
> 
226a663
> 
226a664
> 
226a665
> 
226a666
> 
226a667
> 
226a668
> 
226a669
> 
226a670
> 
226a671
> 
226a672
> 
226a673
> 
226a674
> 
226a675
> 
226a676
> 
226a677
> 
226a678
> 
226a679
> 
226a680
> 
226a681
> 
226a682
> 
226a683
> 
226a684
> 
226a685
> 
226a686
> 
226a687
> 
226a688
> 
226a689
> 
226a690
> 
226a691
> 
226a692
> 
226a693
> 
226a694
> 
226a695
> 
226a696
> 
226a697
> 
226a698
> 
226a699
> 
226a700
> 
226a701
> 
226a702
> 
226a703
> 
226a704
>    rule5 = \ _visitssGraph ->  _visitssGraph
226a705
> 
226a706
> 
226a707
> 
226a708
> 
226a709
> 
226a710
> 
226a711
> 
226a712
> 
226a713
> 
226a714
> 
226a715
> 
226a716
> 
226a717
> 
226a718
> 
226a719
> 
226a720
> 
226a721
> 
226a722
> 
226a723
> 
226a724
> 
226a725
> 
226a726
> 
226a727
> 
226a728
> 
226a729
> 
226a730
> 
226a731
> 
226a732
> 
226a733
> 
226a734
> 
226a735
> 
226a736
> 
226a737
> 
226a738
> 
226a739
> 
226a740
> 
226a741
> 
226a742
> 
226a743
> 
226a744
> 
226a745
> 
226a746
> 
226a747
> 
226a748
> 
226a749
> 
226a750
>    rule6 = \ ((_intersIfirstvisitvertices) :: [Vertex]) ((_lhsIinfo) :: Info) -> terminals = [ v | (v,cr) <- assocs (ruleTable _lhsIinfo), not (getHasCode cr), isLocal cr ]
226a751
>                                                                                 in _intersIfirstvisitvertices ++ terminals
226a752
> 
226a753
> 
226a754
> 
226a755
> 
226a756
> 
226a757
> 
226a758
> 
226a759
> 
226a760
> 
226a761
> 
226a762
> 
226a763
> 
226a764
> 
226a765
> 
226a766
> 
226a767
> 
226a768
> 
226a769
> 
226a770
> 
226a771
> 
226a772
> 
226a773
> 
226a774
> 
226a775
> 
226a776
> 
226a777
> 
226a778
> 
226a779
> 
226a780
> 
226a781
> 
226a782
> 
226a783
> 
226a784
> 
226a785
> 
226a786
> 
226a787
> 
226a788
> 
226a789
> 
226a790
> 
226a791
> 
226a792
> 
226a793
> 
226a794
> 
226a795
> 
226a796
> 
226a797
> 
226a798
> 
226a799
> 
226a800
> 
226a801
> 
226a802
> 
226a803
> 
226a804
> 
226a805
> 
226a806
> 
226a807
> 
226a808
> 
226a809
> 
226a810
> 
226a811
> 
226a812
> 
226a813
> 
226a814
> 
226a815
> 
226a816
> 
226a817
> 
226a818
> 
226a819
> 
226a820
> 
226a821
> 
226a822
> 
226a823
> 
226a824
> 
226a825
> 
226a826
> 
226a827
> 
226a828
> 
226a829
> 
226a830
> 
226a831
> 
226a832
> 
226a833
>    rule7 = \ ((_intersIv) :: Vertex) ((_lhsIdpr) :: [Edge]) _newedges -> (0,_intersIv-1) (map swap (_lhsIdpr ++ _newedges))
226a834
> 
226a835
> 
226a836
> 
226a837
> 
226a838
> 
226a839
> 
226a840
> 
226a841
> 
226a842
> 
226a843
> 
226a844
> 
226a845
> 
226a846
> 
226a847
> 
226a848
> 
226a849
> 
226a850
> 
226a851
> 
226a852
> 
226a853
> 
226a854
> 
226a855
> 
226a856
> 
226a857
> 
226a858
> 
226a859
> 
226a860
> 
226a861
> 
226a862
> 
226a863
> 
226a864
> 
226a865
> 
226a866
> 
226a867
> 
226a868
> 
226a869
> 
226a870
> 
226a871
>    rule8 = \ ((_intersIinters) :: CInterfaceMap) ->
226a872
> 
226a873
> 
226a874
> 
226a875
> 
226a876
> 
226a877
> 
226a878
> 
226a879
> 
226a880
> 
226a881
> 
226a882
> 
226a883
> 
226a884
> 
226a885
> 
226a886
> 
226a887
> 
226a888
> 
226a889
> 
226a890
> 
226a891
> 
226a892
> 
226a893
> 
226a894
> 
226a895
> 
226a896
> 
226a897
> 
226a898
> 
226a899
> 
226a900
> 
226a901
> 
226a902
> 
226a903
> 
226a904
> 
226a905
> 
226a906
> 
226a907
> 
226a908
> 
226a909
> 
226a910
> 
226a911
> 
226a912
> 
226a913
> 
226a914
> 
226a915
> 
226a916
> 
226a917
> 
226a918
> 
226a919
> 
226a920
> 
226a921
> 
226a922
> 
226a923
> 
226a924
> -- cata
226a925
> 
226a926
> 
226a927
> 
226a928
> 
226a929
> -- semantic domain
226a930
> 
226a931
> 
226a932
> 
226a933
>    rule9 = \ ((_intersIedp) :: Seq Edge) -> _intersIedp Inh_Interface  = Inh_Interface { allInters_Inh_Interface :: !(CInterfaceMap), ddp_Inh_Interface :: !(Graph), info_Inh_Interface :: !(Info), prev_Inh_Interface :: !([Vertex]), v_Inh_Interface :: !(Vertex), visitDescr_Inh_Interface :: !(Map Vertex ChildVisit), vssGraph_Inh_Interface :: !(Graph) }
238c945
< -- cata
---
> 
243c950
< -- semantic domain
---
> 
300d1006
<    {-# LINE 183 "src-ag/InterfacesRules.lag" #-}
301d1006
<    rule13 = \ ((_lhsIv) :: Vertex) ->
302d1006
<                           {-# LINE 183 "src-ag/InterfacesRules.lag" #-}
303d1006
<                           _lhsIv
304c1007
<                           {-# LINE 305 "dist/build/InterfacesRules.hs"#-}
---
> 
304a1008
> 
304a1009
> 
304a1010
> 
304a1011
> 
306d1012
<    {-# LINE 184 "src-ag/InterfacesRules.lag" #-}
307d1012
<    rule14 = \ ((_segInewvertices) :: [Vertex]) ((_segIv) :: Vertex) ->
308d1012
<                           {-# LINE 184 "src-ag/InterfacesRules.lag" #-}
309d1012
<                           _segIv + length _segInewvertices
310c1013
<                           {-# LINE 311 "dist/build/InterfacesRules.hs"#-}
---
> 
310a1014
> 
310a1015
> 
310a1016
> 
310a1017
> 
312d1018
<    {-# LINE 185 "src-ag/InterfacesRules.lag" #-}
313d1018
<    rule15 = \ _v ->
314d1018
<                           {-# LINE 185 "src-ag/InterfacesRules.lag" #-}
315d1018
<                           _v
316c1019
<                           {-# LINE 317 "dist/build/InterfacesRules.hs"#-}
---
> 
316a1020
> 
316a1021
> 
316a1022
> 
316a1023
> 
318d1024
<    {-# LINE 186 "src-ag/InterfacesRules.lag" #-}
319d1024
<    rule16 = \ ((_segIv) :: Vertex) _v ->
320d1024
<                                            {-# LINE 186 "src-ag/InterfacesRules.lag" #-}
321d1024
<                                            [_segIv .. _v-1]
322c1025
<                                            {-# LINE 323 "dist/build/InterfacesRules.hs"#-}
---
> 
322a1026
> 
322a1027
> 
322a1028
> 
322a1029
> 
324d1030
<    {-# LINE 187 "src-ag/InterfacesRules.lag" #-}
325d1030
<    rule17 = \ _firstvisitvertices ((_segInewvertices) :: [Vertex]) ->
326d1030
<                                  {-# LINE 187 "src-ag/InterfacesRules.lag" #-}
327d1030
<                                  zip _firstvisitvertices _segInewvertices
328c1031
<                                  {-# LINE 329 "dist/build/InterfacesRules.hs"#-}
---
> 
328a1032
> 
328a1033
> 
328a1034
> 
328a1035
> 
330d1036
<    {-# LINE 188 "src-ag/InterfacesRules.lag" #-}
331d1036
<    rule18 = \ _newedges ((_segInewedges) :: Seq Edge ) ->
332d1036
<                                  {-# LINE 188 "src-ag/InterfacesRules.lag" #-}
333d1036
<                                  _segInewedges Seq.>< Seq.fromList _newedges
334c1037
<                                  {-# LINE 335 "dist/build/InterfacesRules.hs"#-}
---
> 
334a1038
> 
334a1039
> 
334a1040
> 
334a1041
> 
336d1042
<    {-# LINE 191 "src-ag/InterfacesRules.lag" #-}
337d1042
<    rule19 = \ ((_lhsIinfo) :: Info) ->
338d1042
<                              {-# LINE 191 "src-ag/InterfacesRules.lag" #-}
339d1042
<                              \a -> ruleTable _lhsIinfo ! a
340c1043
<                              {-# LINE 341 "dist/build/InterfacesRules.hs"#-}
---
> 
340a1044
> 
340a1045
> 
340a1046
> 
340a1047
> 
342d1048
<    {-# LINE 192 "src-ag/InterfacesRules.lag" #-}
343d1048
<    rule20 = \ _firstvisitvertices ((_look) :: Vertex -> CRule) ((_segIgroups) :: [([Vertex],[Vertex])]) ->
344d1048
<                               {-# LINE 192 "src-ag/InterfacesRules.lag" #-}
345d1048
<                               zipWith (cv _look (-1)) _firstvisitvertices _segIgroups
346c1049
<                               {-# LINE 347 "dist/build/InterfacesRules.hs"#-}
---
> 
346a1050
> 
346a1051
> 
346a1052
> 
346a1053
> 
348d1054
<    {-# LINE 193 "src-ag/InterfacesRules.lag" #-}
349d1054
<    rule21 = \ _descr ((_segIdescr) :: Seq (Vertex,ChildVisit)) ->
350d1054
<                               {-# LINE 193 "src-ag/InterfacesRules.lag" #-}
351d1054
<                               _segIdescr Seq.>< Seq.fromList _descr
352c1055
<                               {-# LINE 353 "dist/build/InterfacesRules.hs"#-}
---
> 
352a1056
> 
352a1057
> 
352a1058
> 
352a1059
> 
354d1060
<    {-# LINE 201 "src-ag/InterfacesRules.lag" #-}
355d1060
<    rule22 = \  (_ :: ()) ->
356d1060
<                          {-# LINE 201 "src-ag/InterfacesRules.lag" #-}
357d1060
<                          0
358c1061
<                          {-# LINE 359 "dist/build/InterfacesRules.hs"#-}
---
> 
358a1062
> 
358a1063
> 
358a1064
> 
358a1065
> 
360d1066
<    {-# LINE 233 "src-ag/InterfacesRules.lag" #-}
361d1066
<    rule23 = \ cons_ ->
362d1066
<                             {-# LINE 233 "src-ag/InterfacesRules.lag" #-}
363d1066
<                             cons_
364c1067
<                             {-# LINE 365 "dist/build/InterfacesRules.hs"#-}
---
> 
364a1068
> 
364a1069
> 
364a1070
> 
364a1071
> 
366d1072
<    {-# LINE 314 "src-ag/InterfacesRules.lag" #-}
367d1072
<    rule24 = \  (_ :: ()) ->
368d1072
<                                {-# LINE 314 "src-ag/InterfacesRules.lag" #-}
369d1072
<                                True
370c1073
<                                {-# LINE 371 "dist/build/InterfacesRules.hs"#-}
---
> 
370a1074
> 
370a1075
> 
370a1076
> 
370a1077
> 
372d1078
<    {-# LINE 352 "src-ag/InterfacesRules.lag" #-}
373d1078
<    rule25 = \ ((_lhsIprev) :: [Vertex]) ->
374d1078
<                                {-# LINE 352 "src-ag/InterfacesRules.lag" #-}
375d1078
<                                _lhsIprev
376c1079
<                                {-# LINE 377 "dist/build/InterfacesRules.hs"#-}
---
> 
376a1080
> 
376a1081
> 
376a1082
> 
376a1083
> 
378d1084
<    {-# LINE 392 "src-ag/InterfacesRules.lag" #-}
379d1084
<    rule26 = \ nt_ ->
380d1084
<                           {-# LINE 392 "src-ag/InterfacesRules.lag" #-}
381d1084
<                           nt_
382c1085
<                           {-# LINE 383 "dist/build/InterfacesRules.hs"#-}
---
> 
382a1086
> 
382a1087
> 
382a1088
> 
382a1089
> 
384d1090
<    {-# LINE 396 "src-ag/InterfacesRules.lag" #-}
385d1090
<    rule27 = \ ((_segIsegs) :: CSegments) ->
386d1090
<                               {-# LINE 396 "src-ag/InterfacesRules.lag" #-}
387d1090
<                               CInterface _segIsegs
388c1091
<                               {-# LINE 389 "dist/build/InterfacesRules.hs"#-}
---
> 
388a1092
> 
388a1093
> 
388a1094
> 
388a1095
> 
390d1096
<    {-# LINE 397 "src-ag/InterfacesRules.lag" #-}
391d1096
<    rule28 = \ ((_segIcvisits) :: [[CVisit]]) cons_ ->
392d1096
<                                {-# LINE 397 "src-ag/InterfacesRules.lag" #-}
393d1096
<                                Map.fromList (zip cons_ (transpose _segIcvisits))
394c1097
<                                {-# LINE 395 "dist/build/InterfacesRules.hs"#-}
---
> 
394a1098
> 
394a1099
> 
394a1100
> 
394a1101
> 
418c1125
<      _lhsIvssGraph
---
>      _lhsIvssGraph = \ ((_lhsIv) :: Vertex) ->
418a1126
>    rule14 = \ ((_segInewvertices) :: [Vertex]) ((_segIv) :: Vertex) -> + length _segInewvertices
418a1127
>    rule15 = \ _v ->       _v
418a1128
>    rule16 = \ ((_segIv) :: Vertex) _v ->   [_segIv .. _v-1]
418a1129
>    rule17 = \ _firstvisitvertices ((_segInewvertices) :: [Vertex]) -> _firstvisitvertices _segInewvertices
418a1130
>    rule18 = \ _newedges ((_segInewedges) :: Seq Edge ) -> Seq.>< Seq.fromList _newedges
420d1131
< -- Interfaces --------------------------------------------------
421c1132
< -- wrapper
---
> 
421a1133
>    rule19 = \ ((_lhsIinfo) :: Info) ->a -> ruleTable _lhsIinfo ! a
421a1134
>    rule20 = \ _firstvisitvertices ((_look) :: Vertex -> CRule) ((_segIgroups) :: [([Vertex],[Vertex])]) -> (cv _look (-1)) _firstvisitvertices _segIgroups
421a1135
>    rule21 = \ _descr ((_segIdescr) :: Seq (Vertex,ChildVisit)) -> Seq.>< Seq.fromList _descr
421a1136
> 
421a1137
> 
421a1138
> 
421a1139
> 
421a1140
> 
421a1141
> 
421a1142
> 
421a1143
>    rule22 = \  (_ :: ()) ->
421a1144
> 
421a1145
> 
421a1146
> 
421a1147
> 
421a1148
> 
421a1149
> 
421a1150
> 
421a1151
> 
421a1152
> 
421a1153
> 
421a1154
> 
421a1155
> 
421a1156
> 
421a1157
> 
421a1158
> 
421a1159
> 
421a1160
> 
421a1161
> 
421a1162
> 
421a1163
> 
421a1164
> 
421a1165
> 
421a1166
> 
421a1167
> 
421a1168
> 
421a1169
> 
421a1170
> 
421a1171
> 
421a1172
> 
421a1173
> 
421a1174
> 
421a1175
>    rule23 = \ cons_ ->      cons_
421a1176
> 
421a1177
> 
421a1178
> 
421a1179
> 
421a1180
> 
421a1181
> 
421a1182
> 
421a1183
> 
421a1184
> 
421a1185
> 
421a1186
> 
421a1187
> 
421a1188
> 
421a1189
> 
421a1190
> 
421a1191
> 
421a1192
> 
421a1193
> 
421a1194
> 
421a1195
> 
421a1196
> 
421a1197
> 
421a1198
> 
421a1199
> 
421a1200
> 
421a1201
> 
421a1202
> 
421a1203
> 
421a1204
> 
421a1205
> 
421a1206
> 
421a1207
> 
421a1208
> 
421a1209
> 
421a1210
> 
421a1211
> 
421a1212
> 
421a1213
> 
421a1214
> 
421a1215
> 
421a1216
> 
421a1217
> 
421a1218
> 
421a1219
> 
421a1220
> 
421a1221
> 
421a1222
> 
421a1223
> 
421a1224
> 
421a1225
> 
421a1226
> 
421a1227
> 
421a1228
> 
421a1229
> 
421a1230
> 
421a1231
> 
421a1232
> 
421a1233
> 
421a1234
> 
421a1235
> 
421a1236
> 
421a1237
> 
421a1238
> 
421a1239
> 
421a1240
> 
421a1241
> 
421a1242
> 
421a1243
> 
421a1244
> 
421a1245
> 
421a1246
> 
421a1247
> 
421a1248
> 
421a1249
> 
421a1250
> 
421a1251
> 
421a1252
> 
421a1253
> 
421a1254
> 
421a1255
> 
421a1256
>    rule24 = \  (_ :: ()) ->    True
421a1257
> 
421a1258
> 
421a1259
> 
421a1260
> 
421a1261
> 
421a1262
> 
421a1263
> 
421a1264
> 
421a1265
> 
421a1266
> 
421a1267
> 
421a1268
> 
421a1269
> 
421a1270
> 
421a1271
> 
421a1272
> 
421a1273
> 
421a1274
> 
421a1275
> 
421a1276
> 
421a1277
> 
421a1278
> 
421a1279
> 
421a1280
> 
421a1281
> 
421a1282
> 
421a1283
> 
421a1284
> 
421a1285
> 
421a1286
> 
421a1287
> 
421a1288
> 
421a1289
> 
421a1290
> 
421a1291
> 
421a1292
> 
421a1293
> 
421a1294
>    rule25 = \ ((_lhsIprev) :: [Vertex]) ->
421a1295
> 
421a1296
> 
421a1297
> 
421a1298
> 
421a1299
> 
421a1300
> 
421a1301
> 
421a1302
> 
421a1303
> 
421a1304
> 
421a1305
> 
421a1306
> 
421a1307
> 
421a1308
> 
421a1309
> 
421a1310
> 
421a1311
> 
421a1312
> 
421a1313
> 
421a1314
> 
421a1315
> 
421a1316
> 
421a1317
> 
421a1318
> 
421a1319
> 
421a1320
> 
421a1321
> 
421a1322
> 
421a1323
> 
421a1324
> 
421a1325
> 
421a1326
> 
421a1327
> 
421a1328
> 
421a1329
> 
421a1330
> 
421a1331
> 
421a1332
> 
421a1333
> 
421a1334
>    rule26 = \ nt_ ->      nt_
421a1335
> 
421a1336
> 
421a1337
> 
421a1338
>    rule27 = \ ((_segIsegs) :: CSegments) -> _segIsegs
421a1339
>    rule28 = \ ((_segIcvisits) :: [[CVisit]]) cons_ -> (zip cons_ (transpose _segIcvisits))
421a1340
> 
421a1341
> 
421a1342
> 
421a1343
> 
421a1344
> 
421a1345
> 
421a1346
> 
421a1347
> 
421a1348
> 
421a1349
> 
421a1350
> 
421a1351
> 
421a1352
> 
421a1353
> 
421a1354
> 
421a1355
> 
421a1356
> 
421a1357
> 
421a1358
> 
421a1359
> 
421a1360
> 
421a1361
> 
421a1362
> 
421a1363
> 
434c1376
< -- cata
---
> 
439c1381
< -- semantic domain
---
> 
493d1434
<    {-# LINE 386 "src-ag/InterfacesRules.lag" #-}
494d1434
<    rule37 = \ ((_hdIinter) :: CInterface) ((_hdInt) :: NontermIdent) ((_tlIinters) :: CInterfaceMap) ->
495d1434
<                           {-# LINE 386 "src-ag/InterfacesRules.lag" #-}
496d1434
<                           Map.insert _hdInt _hdIinter _tlIinters
497c1435
<                           {-# LINE 498 "dist/build/InterfacesRules.hs"#-}
---
> 
497a1436
> 
497a1437
> 
497a1438
> 
497a1439
> 
499d1440
<    {-# LINE 387 "src-ag/InterfacesRules.lag" #-}
500d1440
<    rule38 = \ ((_hdInt) :: NontermIdent) ((_hdIvisits) :: Map ConstructorIdent CVisits) ((_tlIvisits) :: CVisitsMap) ->
501d1440
<                           {-# LINE 387 "src-ag/InterfacesRules.lag" #-}
502d1440
<                           Map.insert _hdInt _hdIvisits _tlIvisits
503c1441
<                           {-# LINE 504 "dist/build/InterfacesRules.hs"#-}
---
> 
503a1442
> 
503a1443
> 
503a1444
> 
503a1445
> 
560c1502
<      _lhsIvssGraph
---
>      _lhsIvssGraph = \ ((_hdIinter) :: CInterface) ((_hdInt) :: NontermIdent) ((_tlIinters) :: CInterfaceMap) -> _hdInt _hdIinter _tlIinters
560a1503
>    rule38 = \ ((_hdInt) :: NontermIdent) ((_hdIvisits) :: Map ConstructorIdent CVisits) ((_tlIvisits) :: CVisitsMap) -> _hdInt _hdIvisits _tlIvisits
560a1504
> 
560a1505
> 
560a1506
> 
560a1507
> 
560a1508
> 
560a1509
> 
560a1510
> 
560a1511
> 
560a1512
> 
560a1513
> 
560a1514
> 
560a1515
> 
560a1516
> 
560a1517
> 
560a1518
> 
560a1519
> 
560a1520
> 
560a1521
> 
560a1522
> 
560a1523
> 
560a1524
> 
560a1525
> 
560a1526
> 
560a1527
> 
560a1528
> 
560a1529
> 
560a1530
> 
560a1531
> 
560a1532
> 
560a1533
> 
560a1534
> 
560a1535
> 
560a1536
> 
560a1537
> 
560a1538
> 
560a1539
> 
560a1540
> 
560a1541
> 
560a1542
> 
560a1543
> 
560a1544
> 
560a1545
> 
560a1546
> 
560a1547
> 
560a1548
> 
560a1549
> 
560a1550
> 
560a1551
> 
560a1552
> 
560a1553
> 
560a1554
> 
560a1555
> 
560a1556
> 
560a1557
> 
560a1558
> 
560a1559
> 
560a1560
> 
560a1561
> 
560a1562
> 
560a1563
> 
560a1564
> 
560a1565
> 
560a1566
> 
560a1567
> 
560a1568
> 
560a1569
> 
560a1570
> 
560a1571
> 
560a1572
> 
560a1573
> 
560a1574
> 
560a1575
> 
560a1576
> 
560a1577
> 
560a1578
> 
560a1579
> 
560a1580
> 
560a1581
> 
560a1582
> 
560a1583
> 
560a1584
> 
560a1585
> 
560a1586
> 
560a1587
> 
560a1588
> 
560a1589
> 
560a1590
> 
560a1591
> 
560a1592
> 
560a1593
> 
560a1594
> 
560a1595
> 
560a1596
> 
560a1597
> 
560a1598
> 
560a1599
> 
560a1600
> 
560a1601
> 
560a1602
> 
560a1603
> 
560a1604
> 
560a1605
> 
560a1606
> 
560a1607
> 
560a1608
> 
560a1609
> 
560a1610
> 
560a1611
> 
560a1612
> 
560a1613
> 
560a1614
> 
560a1615
> 
560a1616
> 
560a1617
> 
560a1618
> 
560a1619
> 
560a1620
> 
560a1621
> 
560a1622
> 
560a1623
> 
560a1624
> 
560a1625
> 
560a1626
> 
560a1627
> 
560a1628
> 
560a1629
> 
560a1630
> 
560a1631
> 
560a1632
> 
560a1633
> 
560a1634
> 
560a1635
> 
560a1636
> 
560a1637
> 
560a1638
> 
560a1639
> 
560a1640
> 
560a1641
> 
560a1642
> 
560a1643
> 
560a1644
> 
560a1645
> 
560a1646
> 
560a1647
> 
560a1648
> 
560a1649
> 
560a1650
> 
560a1651
> 
560a1652
> 
560a1653
> 
560a1654
> 
560a1655
> 
560a1656
> 
560a1657
> 
560a1658
> 
560a1659
> 
560a1660
> 
560a1661
> 
560a1662
> 
560a1663
> 
560a1664
> 
560a1665
> 
560a1666
> 
560a1667
> 
560a1668
> 
560a1669
> 
560a1670
> 
560a1671
> 
560a1672
> 
560a1673
> 
560a1674
> 
560a1675
> 
560a1676
> 
586d1701
<    {-# LINE 388 "src-ag/InterfacesRules.lag" #-}
587d1701
<    rule58 = \  (_ :: ()) ->
588d1701
<                           {-# LINE 388 "src-ag/InterfacesRules.lag" #-}
589d1701
<                           Map.empty
590c1702
<                           {-# LINE 591 "dist/build/InterfacesRules.hs"#-}
---
> 
590a1703
> 
590a1704
> 
590a1705
> 
590a1706
> 
592d1707
<    {-# LINE 389 "src-ag/InterfacesRules.lag" #-}
593d1707
<    rule59 = \  (_ :: ()) ->
594d1707
<                           {-# LINE 389 "src-ag/InterfacesRules.lag" #-}
595d1707
<                           Map.empty
596c1708
<                           {-# LINE 597 "dist/build/InterfacesRules.hs"#-}
---
> 
596a1709
> 
596a1710
> 
596a1711
> 
596a1712
> 
611c1727
<      _lhsIv
---
>      _lhsIv = \  (_ :: ()) ->
611a1728
>    rule59 = \  (_ :: ()) ->
612a1730
> 
612a1731
> 
612a1732
> 
612a1733
> 
612a1734
> 
612a1735
> 
612a1736
> 
612a1737
> 
612a1738
> 
612a1739
> 
612a1740
> 
612a1741
> 
612a1742
> 
612a1743
> 
612a1744
> 
612a1745
> 
612a1746
> 
612a1747
> 
612a1748
> 
612a1749
> 
612a1750
> 
612a1751
> 
612a1752
> 
612a1753
> 
612a1754
> 
612a1755
> 
612a1756
> 
612a1757
> 
612a1758
> 
612a1759
> 
612a1760
> 
612a1761
> 
612a1762
> 
612a1763
> 
612a1764
> 
612a1765
> 
612a1766
> 
612a1767
> 
612a1768
> 
612a1769
> 
612a1770
> 
612a1771
> 
612a1772
> 
612a1773
> 
612a1774
> 
612a1775
> 
612a1776
> 
612a1777
> 
612a1778
> 
612a1779
> 
612a1780
> 
612a1781
> 
612a1782
> 
612a1783
> 
612a1784
> 
612a1785
> 
612a1786
> 
612a1787
> 
612a1788
> 
612a1789
> 
612a1790
> 
612a1791
> 
612a1792
> 
612a1793
> 
612a1794
> 
612a1795
> 
612a1796
> 
612a1797
> 
612a1798
> 
612a1799
> 
612a1800
> 
612a1801
> 
612a1802
> 
612a1803
> 
612a1804
> 
612a1805
> 
612a1806
> 
612a1807
> 
612a1808
> 
612a1809
> 
612a1810
> 
612a1811
> 
612a1812
> 
612a1813
> 
612a1814
> 
612a1815
> 
612a1816
> 
612a1817
> 
612a1818
> 
612a1819
> 
612a1820
> 
612a1821
> 
612a1822
> 
612a1823
> 
612a1824
> 
612a1825
> 
612a1826
> 
612a1827
> 
612a1828
> 
612a1829
> 
612a1830
> 
612a1831
> 
612a1832
> 
612a1833
> 
612a1834
> 
612a1835
> 
612a1836
> 
612a1837
> 
612a1838
> 
612a1839
> 
612a1840
> 
612a1841
> 
612a1842
> 
612a1843
> 
612a1844
> 
612a1845
> 
612a1846
> 
612a1847
> 
612a1848
> 
612a1849
> 
612a1850
> 
612a1851
> 
612a1852
> 
612a1853
> 
612a1854
> 
612a1855
> 
612a1856
> 
612a1857
> 
612a1858
> 
612a1859
> 
612a1860
> 
612a1861
> 
612a1862
> 
612a1863
> 
612a1864
> 
612a1865
> 
612a1866
> 
612a1867
> 
612a1868
> 
612a1869
> 
612a1870
> 
612a1871
> 
612a1872
> 
612a1873
> 
612a1874
> 
612a1875
> 
612a1876
> 
612a1877
> 
612a1878
> 
612a1879
> 
612a1880
> 
612a1881
> 
612a1882
> 
612a1883
> 
612a1884
> 
612a1885
> 
612a1886
> 
612a1887
> 
612a1888
> 
612a1889
> 
612a1890
> 
612a1891
> 
612a1892
> 
612a1893
> 
612a1894
> 
612a1895
> 
612a1896
> 
612a1897
> 
612a1898
> 
612a1899
> 
612a1900
> 
612a1901
> 
612a1902
> 
612a1903
> 
612a1904
> 
612a1905
> 
612a1906
> 
612a1907
> 
612a1908
> 
612a1909
> 
612a1910
> 
612a1911
> 
612a1912
> 
612a1913
> 
612a1914
> 
612a1915
> 
612a1916
> 
612a1917
> 
612a1918
> 
612a1919
> 
612a1920
> 
612a1921
> 
612a1922
> 
612a1923
> 
612a1924
> 
612a1925
> 
612a1926
> 
612a1927
> 
612a1928
> 
612a1929
> 
612a1930
> 
612a1931
> 
612a1932
> 
612a1933
> 
612a1934
> 
612a1935
> 
612a1936
> 
612a1937
> 
612a1938
> 
612a1939
> 
612a1940
> 
612a1941
> 
612a1942
> 
612a1943
> 
612a1944
> 
612a1945
> 
612a1946
> 
612a1947
> 
612a1948
> 
612a1949
> 
612a1950
> 
612a1951
> 
702d2040
<    {-# LINE 101 "src-ag/InterfacesRules.lag" #-}
703d2040
<    rule65 = \ ((_lhsIinfo) :: Info) ->
704d2040
<                            {-# LINE 101 "src-ag/InterfacesRules.lag" #-}
705d2040
<                            \a -> ruleTable _lhsIinfo ! a
706c2041
<                            {-# LINE 707 "dist/build/InterfacesRules.hs"#-}
---
> 
706a2042
> 
706a2043
> 
706a2044
> 
706a2045
> 
708d2046
<    {-# LINE 104 "src-ag/InterfacesRules.lag" #-}
709d2046
<    rule66 = \ ((_lhsIinfo) :: Info) ((_look) :: Vertex -> CRule) ->
710d2046
<                               {-# LINE 104 "src-ag/InterfacesRules.lag" #-}
711d2046
<                               \p us -> [ a  |  u <- us
712d2046
<                                             ,  a <- tdsToTdp _lhsIinfo ! u
713d2046
<                                             ,  p (_look a)]
714c2047
<                               {-# LINE 715 "dist/build/InterfacesRules.hs"#-}
---
> 
714a2048
> 
714a2049
> 
714a2050
> 
714a2051
> 
714a2052
> 
714a2053
> 
716d2054
<    {-# LINE 108 "src-ag/InterfacesRules.lag" #-}
717d2054
<    rule67 = \ ((_lhsIinfo) :: Info) ((_look) :: Vertex -> CRule) ((_occurAs) :: (CRule -> Bool) -> [Vertex] -> [Vertex]) inh_ syn_ ->
718d2054
<                               {-# LINE 108 "src-ag/InterfacesRules.lag" #-}
719d2054
<                               let group as = gather _lhsIinfo (_occurAs isRhs as)
720d2054
<                               in map (partition (isInh . _look)) (group (inh_ ++ syn_))
721c2055
<                               {-# LINE 722 "dist/build/InterfacesRules.hs"#-}
---
> 
721a2056
> 
721a2057
> 
721a2058
> 
721a2059
> 
721a2060
> 
723d2061
<    {-# LINE 111 "src-ag/InterfacesRules.lag" #-}
724d2061
<    rule68 = \ ((_groups) :: [([Vertex],[Vertex])]) ((_lhsIv) :: Vertex) ->
725d2061
<                         {-# LINE 111 "src-ag/InterfacesRules.lag" #-}
726d2061
<                         _lhsIv + length _groups
727c2062
<                         {-# LINE 728 "dist/build/InterfacesRules.hs"#-}
---
> 
727a2063
> 
727a2064
> 
727a2065
> 
727a2066
> 
729d2067
<    {-# LINE 112 "src-ag/InterfacesRules.lag" #-}
730d2067
<    rule69 = \ ((_lhsIv) :: Vertex) ((_v) :: Int) ->
731d2067
<                                   {-# LINE 112 "src-ag/InterfacesRules.lag" #-}
732d2067
<                                   [_lhsIv .. _v    -1]
733c2068
<                                   {-# LINE 734 "dist/build/InterfacesRules.hs"#-}
---
> 
733a2069
> 
733a2070
> 
733a2071
> 
733a2072
> 
735d2073
<    {-# LINE 127 "src-ag/InterfacesRules.lag" #-}
736d2073
<    rule70 = \ ((_groups) :: [([Vertex],[Vertex])]) ((_lhsIn) :: Int) ((_look) :: Vertex -> CRule) _newvertices ->
737d2073
<                             {-# LINE 127 "src-ag/InterfacesRules.lag" #-}
738d2073
<                             Seq.fromList $ zipWith (cv _look _lhsIn) _newvertices _groups
739c2074
<                             {-# LINE 740 "dist/build/InterfacesRules.hs"#-}
---
> 
739a2075
> 
739a2076
> 
739a2077
> 
739a2078
> 
741d2079
<    {-# LINE 150 "src-ag/InterfacesRules.lag" #-}
742d2079
<    rule71 = \ ((_groups) :: [([Vertex],[Vertex])]) _newvertices ->
743d2079
<                                {-# LINE 150 "src-ag/InterfacesRules.lag" #-}
744d2079
<                                concat (zipWith ed _newvertices _groups)
745c2080
<                                {-# LINE 746 "dist/build/InterfacesRules.hs"#-}
---
> 
745a2081
> 
745a2082
> 
745a2083
> 
745a2084
> 
747d2085
<    {-# LINE 170 "src-ag/InterfacesRules.lag" #-}
748d2085
<    rule72 = \ ((_lhsInextNewvertices) :: [Vertex]) _newvertices ->
749d2085
<                                  {-# LINE 170 "src-ag/InterfacesRules.lag" #-}
750d2085
<                                  zip _newvertices _lhsInextNewvertices
751c2086
<                                  {-# LINE 752 "dist/build/InterfacesRules.hs"#-}
---
> 
751a2087
> 
751a2088
> 
751a2089
> 
751a2090
> 
753d2091
<    {-# LINE 171 "src-ag/InterfacesRules.lag" #-}
754d2091
<    rule73 = \ _attredges _visitedges ->
755d2091
<                                {-# LINE 171 "src-ag/InterfacesRules.lag" #-}
756d2091
<                                Seq.fromList _attredges Seq.>< Seq.fromList _visitedges
757c2092
<                                {-# LINE 758 "dist/build/InterfacesRules.hs"#-}
---
> 
757a2093
> 
757a2094
> 
757a2095
> 
757a2096
> 
759d2097
<    {-# LINE 225 "src-ag/InterfacesRules.lag" #-}
760d2097
<    rule74 = \ ((_lhsIinfo) :: Info) ((_occurAs) :: (CRule -> Bool) -> [Vertex] -> [Vertex]) syn_ ->
761d2097
<                                {-# LINE 225 "src-ag/InterfacesRules.lag" #-}
762d2097
<                                gather _lhsIinfo (_occurAs isLhs syn_)
763c2098
<                                {-# LINE 764 "dist/build/InterfacesRules.hs"#-}
---
> 
763a2099
> 
763a2100
> 
763a2101
> 
763a2102
> 
765d2103
<    {-# LINE 226 "src-ag/InterfacesRules.lag" #-}
766d2103
<    rule75 = \ ((_lhsIcons) :: [ConstructorIdent]) ((_lhsIinfo) :: Info) ((_lhsIvssGraph) :: Graph) _synOccur syn_ ->
767d2103
<                            {-# LINE 226 "src-ag/InterfacesRules.lag" #-}
768d2103
<                            let hasCode' v | inRange (bounds (ruleTable _lhsIinfo)) v =  getHasCode (ruleTable _lhsIinfo ! v)
769d2103
<                                           | otherwise = True
770d2103
<                            in if  null syn_
771d2103
<                                   then replicate (length _lhsIcons) []
772d2103
<                                   else map (filter hasCode' . topSort' _lhsIvssGraph) _synOccur
773c2104
<                            {-# LINE 774 "dist/build/InterfacesRules.hs"#-}
---
> 
773a2105
> 
773a2106
> 
773a2107
> 
773a2108
> 
773a2109
> 
773a2110
> 
773a2111
> 
773a2112
> 
775d2113
<    {-# LINE 270 "src-ag/InterfacesRules.lag" #-}
776d2113
<    rule76 = \ ((_lhsIprev) :: [Vertex]) _vss ->
777d2113
<                                {-# LINE 270 "src-ag/InterfacesRules.lag" #-}
778d2113
<                                map (\\ _lhsIprev) _vss
779c2114
<                                {-# LINE 780 "dist/build/InterfacesRules.hs"#-}
---
> 
779a2115
> 
779a2116
> 
779a2117
> 
779a2118
> 
781d2119
<    {-# LINE 271 "src-ag/InterfacesRules.lag" #-}
782d2119
<    rule77 = \ ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ((_visitss) :: [[Vertex]]) ->
783d2119
<                                {-# LINE 271 "src-ag/InterfacesRules.lag" #-}
784d2119
<                                let defines v = case Map.lookup v _lhsIvisitDescr of
785d2119
<                                                  Nothing -> [v]
786d2119
<                                                  Just (ChildVisit _ _ _ inh _) -> v:inh
787d2119
<                                in concatMap (concatMap defines) _visitss
788c2120
<                                {-# LINE 789 "dist/build/InterfacesRules.hs"#-}
---
> 
788a2121
> 
788a2122
> 
788a2123
> 
788a2124
> 
788a2125
> 
788a2126
> 
788a2127
> 
790d2128
<    {-# LINE 275 "src-ag/InterfacesRules.lag" #-}
791d2128
<    rule78 = \ _defined ((_lhsIprev) :: [Vertex]) ->
792d2128
<                            {-# LINE 275 "src-ag/InterfacesRules.lag" #-}
793d2128
<                            _lhsIprev ++ _defined
794c2129
<                            {-# LINE 795 "dist/build/InterfacesRules.hs"#-}
---
> 
794a2130
> 
794a2131
> 
794a2132
> 
794a2133
> 
796d2134
<    {-# LINE 284 "src-ag/InterfacesRules.lag" #-}
797d2134
<    rule79 = \ ((_lhsIinfo) :: Info) _visitss' ->
798d2134
<                               {-# LINE 284 "src-ag/InterfacesRules.lag" #-}
799d2134
<                               let  rem' :: [(Identifier,Identifier,Maybe Type)] -> [Vertex] -> [Vertex]
800d2134
<                                    rem' _ [] = []
801d2134
<                                    rem' prev (v:vs)
802d2134
<                                      | inRange (bounds table) v
803d2134
<                                          = let  cr = table ! v
804d2134
<                                                 addV = case findIndex cmp prev of
805d2134
<                                                          Just _ -> id
806d2134
<                                                          _      -> (v:)
807d2134
<                                                 cmp (fld,attr,tp) = getField cr == fld && getAttr cr == attr && sameNT (getType cr) tp
808d2134
<                                                 sameNT (Just (NT ntA _ _)) (Just (NT ntB _ _)) = ntA == ntB
809d2134
<                                                 sameNT _          _                            = False
810d2134
<                                                 def = Map.elems (getDefines cr)
811d2134
<                                            in addV (rem' (def ++ prev) vs)
812d2134
<                                      | otherwise = v:rem' prev vs
813d2134
<                                    table = ruleTable _lhsIinfo
814d2134
<                               in map (rem' []) _visitss'
815c2135
<                               {-# LINE 816 "dist/build/InterfacesRules.hs"#-}
---
> 
815a2136
> 
815a2137
> 
815a2138
> 
815a2139
> 
815a2140
> 
815a2141
> 
815a2142
> 
815a2143
> 
815a2144
> 
815a2145
> 
815a2146
> 
815a2147
> 
815a2148
> 
815a2149
> 
815a2150
> 
815a2151
> 
815a2152
> 
815a2153
> 
815a2154
> 
817d2155
<    {-# LINE 357 "src-ag/InterfacesRules.lag" #-}
818d2155
<    rule80 = \ ((_lhsIfromLhs) :: [Vertex]) ((_occurAs) :: (CRule -> Bool) -> [Vertex] -> [Vertex]) inh_ ->
819d2155
<                               {-# LINE 357 "src-ag/InterfacesRules.lag" #-}
820d2155
<                               _occurAs isLhs inh_ ++ _lhsIfromLhs
821c2156
<                               {-# LINE 822 "dist/build/InterfacesRules.hs"#-}
---
> 
821a2157
> 
821a2158
> 
821a2159
> 
821a2160
> 
823d2161
<    {-# LINE 358 "src-ag/InterfacesRules.lag" #-}
824d2161
<    rule81 = \ ((_lhsIinfo) :: Info) ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ((_visitss) :: [[Vertex]]) ->
825d2161
<                                 {-# LINE 358 "src-ag/InterfacesRules.lag" #-}
826d2161
<                                 let computes v = case Map.lookup v _lhsIvisitDescr of
827d2161
<                                                    Nothing -> Map.keys (getDefines (ruleTable _lhsIinfo ! v))
828d2161
<                                                    Just (ChildVisit _ _ _ _ syn) -> v:syn
829d2161
<                                 in concatMap (concatMap computes) _visitss
830c2162
<                                 {-# LINE 831 "dist/build/InterfacesRules.hs"#-}
---
> 
830a2163
> 
830a2164
> 
830a2165
> 
830a2166
> 
830a2167
> 
830a2168
> 
830a2169
> 
832d2170
<    {-# LINE 362 "src-ag/InterfacesRules.lag" #-}
833d2170
<    rule82 = \ _iv ((_lhsInextIntravisits) :: [IntraVisit]) ((_visitss) :: [[Vertex]]) ->
834d2170
<                                   {-# LINE 362 "src-ag/InterfacesRules.lag" #-}
835d2170
<                                   zipWith _iv _visitss _lhsInextIntravisits
836c2171
<                                   {-# LINE 837 "dist/build/InterfacesRules.hs"#-}
---
> 
836a2172
> 
836a2173
> 
836a2174
> 
836a2175
> 
838d2176
<    {-# LINE 363 "src-ag/InterfacesRules.lag" #-}
839d2176
<    rule83 = \ _computed _fromLhs ((_lhsIddp) :: Graph) ->
840d2176
<                           {-# LINE 363 "src-ag/InterfacesRules.lag" #-}
841d2176
<                           \vs next ->
842d2176
<                             let needed = concatMap (_lhsIddp !) vs
843d2176
<                             in nub (needed ++ next) \\ (_fromLhs ++ _computed)
844c2177
<                           {-# LINE 845 "dist/build/InterfacesRules.hs"#-}
---
> 
844a2178
> 
844a2179
> 
844a2180
> 
844a2181
> 
844a2182
> 
844a2183
> 
846d2184
<    {-# LINE 406 "src-ag/InterfacesRules.lag" #-}
847d2184
<    rule84 = \ ((_inhmap) :: Map Identifier Type) ((_lhsIprev) :: [Vertex]) ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ((_lhsIvssGraph) :: Graph) ((_synmap) :: Map Identifier Type) ->
848d2184
<                           {-# LINE 406 "src-ag/InterfacesRules.lag" #-}
849d2184
<                           if False then undefined _lhsIvssGraph _lhsIvisitDescr _lhsIprev else CSegment _inhmap _synmap
850c2185
<                           {-# LINE 851 "dist/build/InterfacesRules.hs"#-}
---
> 
850a2186
> 
850a2187
> 
850a2188
> 
850a2189
> 
852d2190
<    {-# LINE 410 "src-ag/InterfacesRules.lag" #-}
853d2190
<    rule85 = \ ((_lhsIinfo) :: Info) inh_ syn_ ->
854d2190
<                                       {-# LINE 410 "src-ag/InterfacesRules.lag" #-}
855d2190
<                                       let makemap = Map.fromList . map findType
856d2190
<                                           findType v = getNtaNameType (attrTable _lhsIinfo ! v)
857d2190
<                                       in (makemap inh_,makemap syn_)
858c2191
<                                       {-# LINE 859 "dist/build/InterfacesRules.hs"#-}
---
> 
858a2192
> 
858a2193
> 
858a2194
> 
858a2195
> 
858a2196
> 
858a2197
> 
860d2198
<    {-# LINE 413 "src-ag/InterfacesRules.lag" #-}
861d2198
<    rule86 = \ ((_inhmap) :: Map Identifier Type) _intravisits ((_lhsIallInters) :: CInterfaceMap) ((_lhsIinfo) :: Info) ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ((_synmap) :: Map Identifier Type) ((_visitss) :: [[Vertex]]) ->
862d2198
<                               {-# LINE 413 "src-ag/InterfacesRules.lag" #-}
863d2198
<                               let  mkVisit vss intra = CVisit _inhmap _synmap (mkSequence vss) (mkSequence intra) True
864d2198
<                                    mkSequence = map mkRule
865d2198
<                                    mkRule v = case Map.lookup v _lhsIvisitDescr of
866d2198
<                                                 Nothing -> ruleTable _lhsIinfo ! v
867d2198
<                                                 Just (ChildVisit name nt n _ _) -> ccv name nt n _lhsIallInters
868d2198
<                               in zipWith mkVisit _visitss _intravisits
869c2199
<                               {-# LINE 870 "dist/build/InterfacesRules.hs"#-}
---
> 
869a2200
> 
869a2201
> 
869a2202
> 
869a2203
> 
869a2204
> 
869a2205
> 
869a2206
> 
869a2207
> 
869a2208
> 
871d2209
<    {-# LINE 440 "src-ag/InterfacesRules.lag" #-}
872d2209
<    rule87 = \ ((_lhsInextInh) :: [Vertex]) inh_ syn_ ->
873d2209
<                           {-# LINE 440 "src-ag/InterfacesRules.lag" #-}
874d2209
<                           Seq.fromList [(i,s) | i <- inh_, s <- syn_]
875d2209
<                           Seq.>< Seq.fromList [(s,i) | s <- syn_, i <- _lhsInextInh ]
876c2210
<                           {-# LINE 877 "dist/build/InterfacesRules.hs"#-}
---
> 
876a2211
> 
876a2212
> 
876a2213
> 
876a2214
> 
876a2215
> 
878d2216
<    {-# LINE 445 "src-ag/InterfacesRules.lag" #-}
879d2216
<    rule88 = \ inh_ ->
880d2216
<                          {-# LINE 445 "src-ag/InterfacesRules.lag" #-}
881d2216
<                          inh_
882c2217
<                          {-# LINE 883 "dist/build/InterfacesRules.hs"#-}
---
> 
882a2218
> 
882a2219
> 
882a2220
> 
882a2221
> 
897c2236
<      _visitss
---
>      _visitss = \ ((_lhsIinfo) :: Info) ->a -> ruleTable _lhsIinfo ! a
898a2238
> 
898a2239
>    rule66 = \ ((_lhsIinfo) :: Info) ((_look) :: Vertex -> CRule) ->p us -> [ a  |  u <- us
898a2240
>                                                                                 ,  a <- tdsToTdp _lhsIinfo ! u
898a2241
>                                                                                 ,  p (_look a)]
898a2242
> 
898a2243
>    rule67 = \ ((_lhsIinfo) :: Info) ((_look) :: Vertex -> CRule) ((_occurAs) :: (CRule -> Bool) -> [Vertex] -> [Vertex]) inh_ syn_ -> group as = gather _lhsIinfo (_occurAs isRhs as)
898a2244
>                                                                                                                                      in map (partition (isInh . _look)) (group (inh_ ++ syn_))
898a2245
> 
898a2246
>    rule68 = \ ((_groups) :: [([Vertex],[Vertex])]) ((_lhsIv) :: Vertex) -> + length _groups
898a2247
>    rule69 = \ ((_lhsIv) :: Vertex) ((_v) :: Int) ->_lhsIv .. _v    -1]
898a2248
> 
898a2249
> 
898a2250
> 
898a2251
> 
898a2252
> 
898a2253
> 
898a2254
> 
898a2255
> 
898a2256
> 
898a2257
> 
898a2258
> 
898a2259
> 
898a2260
> 
898a2261
> 
898a2262
>    rule70 = \ ((_groups) :: [([Vertex],[Vertex])]) ((_lhsIn) :: Int) ((_look) :: Vertex -> CRule) _newvertices -> $ zipWith (cv _look _lhsIn) _newvertices _groups
898a2263
> 
898a2264
> 
898a2265
> 
898a2266
> 
898a2267
> 
898a2268
> 
898a2269
> 
898a2270
> 
898a2271
> 
898a2272
> 
898a2273
> 
898a2274
> 
898a2275
> 
898a2276
> 
898a2277
> 
898a2278
> 
898a2279
> 
898a2280
> 
898a2281
> 
898a2282
> 
898a2283
> 
898a2284
> 
898a2285
>    rule71 = \ ((_groups) :: [([Vertex],[Vertex])]) _newvertices -> (zipWith ed _newvertices _groups)
898a2286
> 
898a2287
> 
898a2288
> 
898a2289
> 
898a2290
> 
898a2291
> 
898a2292
> 
898a2293
> 
898a2294
> 
898a2295
> 
898a2296
> 
898a2297
> 
898a2298
> 
898a2299
> 
898a2300
> 
898a2301
> 
898a2302
> 
898a2303
> 
898a2304
> 
898a2305
>    rule72 = \ ((_lhsInextNewvertices) :: [Vertex]) _newvertices -> _newvertices _lhsInextNewvertices
898a2306
>    rule73 = \ _attredges _visitedges -> _attredges Seq.>< Seq.fromList _visitedges
898a2307
> 
898a2308
> 
898a2309
> 
898a2310
> 
898a2311
> 
898a2312
> 
898a2313
> 
898a2314
> 
898a2315
> 
898a2316
> 
898a2317
> 
898a2318
> 
898a2319
> 
898a2320
> 
898a2321
> 
898a2322
> 
898a2323
> 
898a2324
> 
898a2325
> 
898a2326
> 
898a2327
> 
898a2328
> 
898a2329
> 
898a2330
> 
898a2331
> 
898a2332
> 
898a2333
> 
898a2334
> 
898a2335
> 
898a2336
> 
898a2337
> 
898a2338
> 
898a2339
> 
898a2340
> 
898a2341
> 
898a2342
> 
898a2343
> 
898a2344
> 
898a2345
> 
898a2346
> 
898a2347
> 
898a2348
> 
898a2349
> 
898a2350
> 
898a2351
> 
898a2352
> 
898a2353
> 
898a2354
> 
898a2355
> 
898a2356
> 
898a2357
> 
898a2358
> 
898a2359
> 
898a2360
>    rule74 = \ ((_lhsIinfo) :: Info) ((_occurAs) :: (CRule -> Bool) -> [Vertex] -> [Vertex]) syn_ -> _lhsIinfo (_occurAs isLhs syn_)
898a2361
>    rule75 = \ ((_lhsIcons) :: [ConstructorIdent]) ((_lhsIinfo) :: Info) ((_lhsIvssGraph) :: Graph) _synOccur syn_ -> hasCode' v | inRange (bounds (ruleTable _lhsIinfo)) v =  getHasCode (ruleTable _lhsIinfo ! v)
898a2362
>                                                                                                                                 | otherwise = True
898a2363
>                                                                                                                     in if  null syn_
898a2364
>                                                                                                                            then replicate (length _lhsIcons) []
898a2365
>                                                                                                                            else map (filter hasCode' . topSort' _lhsIvssGraph) _synOccur
898a2366
> 
898a2367
> 
898a2368
> 
898a2369
> 
898a2370
> 
898a2371
> 
898a2372
> 
898a2373
> 
898a2374
> 
898a2375
> 
898a2376
> 
898a2377
> 
898a2378
> 
898a2379
> 
898a2380
> 
898a2381
> 
898a2382
> 
898a2383
> 
898a2384
> 
898a2385
> 
898a2386
> 
898a2387
> 
898a2388
> 
898a2389
> 
898a2390
> 
898a2391
> 
898a2392
> 
898a2393
> 
898a2394
> 
898a2395
> 
898a2396
> 
898a2397
> 
898a2398
> 
898a2399
> 
898a2400
> 
898a2401
> 
898a2402
> 
898a2403
> 
898a2404
> 
898a2405
>    rule76 = \ ((_lhsIprev) :: [Vertex]) _vss -> (\\ _lhsIprev) _vss
898a2406
>    rule77 = \ ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ((_visitss) :: [[Vertex]]) -> defines v = case Map.lookup v _lhsIvisitDescr of
898a2407
>                                                                                                        Nothing -> [v]
898a2408
>                                                                                                        Just (ChildVisit _ _ _ inh _) -> v:inh
898a2409
>                                                                                         in concatMap (concatMap defines) _visitss
898a2410
>    rule78 = \ _defined ((_lhsIprev) :: [Vertex]) -> ++ _defined
898a2411
> 
898a2412
> 
898a2413
> 
898a2414
> 
898a2415
> 
898a2416
> 
898a2417
> 
898a2418
> 
898a2419
>    rule79 = \ ((_lhsIinfo) :: Info) _visitss' ->  rem' :: [(Identifier,Identifier,Maybe Type)] -> [Vertex] -> [Vertex]
898a2420
>                                                   rem' _ [] = []
898a2421
>                                                   rem' prev (v:vs)
898a2422
>                                                     | inRange (bounds table) v
898a2423
>                                                         = let  cr = table ! v
898a2424
>                                                                addV = case findIndex cmp prev of
898a2425
>                                                                         Just _ -> id
898a2426
>                                                                         _      -> (v:)
898a2427
>                                                                cmp (fld,attr,tp) = getField cr == fld && getAttr cr == attr && sameNT (getType cr) tp
898a2428
>                                                                sameNT (Just (NT ntA _ _)) (Just (NT ntB _ _)) = ntA == ntB
898a2429
>                                                                sameNT _          _                            = False
898a2430
>                                                                def = Map.elems (getDefines cr)
898a2431
>                                                           in addV (rem' (def ++ prev) vs)
898a2432
>                                                     | otherwise = v:rem' prev vs
898a2433
>                                                   table = ruleTable _lhsIinfo
898a2434
>                                                 in map (rem' []) _visitss'
898a2435
> 
898a2436
> 
898a2437
> 
898a2438
> 
898a2439
> 
898a2440
> 
898a2441
> 
898a2442
> 
898a2443
> 
898a2444
> 
898a2445
> 
898a2446
> 
898a2447
> 
898a2448
> 
898a2449
> 
898a2450
> 
898a2451
> 
898a2452
> 
898a2453
> 
898a2454
> 
898a2455
> 
898a2456
> 
898a2457
> 
898a2458
> 
898a2459
> 
898a2460
> 
898a2461
> 
898a2462
> 
898a2463
> 
898a2464
> 
898a2465
> 
898a2466
> 
898a2467
> 
898a2468
> 
898a2469
> 
898a2470
> 
898a2471
> 
898a2472
> 
898a2473
> 
898a2474
> 
898a2475
> 
898a2476
> 
898a2477
> 
898a2478
> 
898a2479
> 
898a2480
> 
898a2481
> 
898a2482
> 
898a2483
> 
898a2484
> 
898a2485
> 
898a2486
> 
898a2487
> 
898a2488
> 
898a2489
> 
898a2490
> 
898a2491
> 
898a2492
>    rule80 = \ ((_lhsIfromLhs) :: [Vertex]) ((_occurAs) :: (CRule -> Bool) -> [Vertex] -> [Vertex]) inh_ -> isLhs inh_ ++ _lhsIfromLhs
898a2493
>    rule81 = \ ((_lhsIinfo) :: Info) ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ((_visitss) :: [[Vertex]]) -> computes v = case Map.lookup v _lhsIvisitDescr of
898a2494
>                                                                                                                               Nothing -> Map.keys (getDefines (ruleTable _lhsIinfo ! v))
898a2495
>                                                                                                                               Just (ChildVisit _ _ _ _ syn) -> v:syn
898a2496
>                                                                                                               in concatMap (concatMap computes) _visitss
898a2497
>    rule82 = \ _iv ((_lhsInextIntravisits) :: [IntraVisit]) ((_visitss) :: [[Vertex]]) -> _iv _visitss _lhsInextIntravisits
898a2498
>    rule83 = \ _computed _fromLhs ((_lhsIddp) :: Graph) ->vs next ->
898a2499
>                                                           let needed = concatMap (_lhsIddp !) vs
898a2500
>                                                           in nub (needed ++ next) \\ (_fromLhs ++ _computed)
898a2501
> 
898a2502
> 
898a2503
> 
898a2504
> 
898a2505
> 
898a2506
> 
898a2507
> 
898a2508
> 
898a2509
> 
898a2510
> 
898a2511
> 
898a2512
> 
898a2513
> 
898a2514
> 
898a2515
> 
898a2516
> 
898a2517
> 
898a2518
> 
898a2519
> 
898a2520
> 
898a2521
> 
898a2522
> 
898a2523
> 
898a2524
> 
898a2525
> 
898a2526
> 
898a2527
> 
898a2528
> 
898a2529
> 
898a2530
> 
898a2531
> 
898a2532
> 
898a2533
> 
898a2534
> 
898a2535
> 
898a2536
> 
898a2537
> 
898a2538
> 
898a2539
> 
898a2540
> 
898a2541
>    rule84 = \ ((_inhmap) :: Map Identifier Type) ((_lhsIprev) :: [Vertex]) ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ((_lhsIvssGraph) :: Graph) ((_synmap) :: Map Identifier Type) -> False then undefined _lhsIvssGraph _lhsIvisitDescr _lhsIprev else CSegment _inhmap _synmap
898a2542
> 
898a2543
> 
898a2544
> 
898a2545
>    rule85 = \ ((_lhsIinfo) :: Info) inh_ syn_ -> makemap = Map.fromList . map findType
898a2546
>                                                  findType v = getNtaNameType (attrTable _lhsIinfo ! v)
898a2547
>                                                 in (makemap inh_,makemap syn_)
898a2548
>    rule86 = \ ((_inhmap) :: Map Identifier Type) _intravisits ((_lhsIallInters) :: CInterfaceMap) ((_lhsIinfo) :: Info) ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ((_synmap) :: Map Identifier Type) ((_visitss) :: [[Vertex]]) ->  mkVisit vss intra = CVisit _inhmap _synmap (mkSequence vss) (mkSequence intra) True
898a2549
>                                                                                                                                                                                                                                        mkSequence = map mkRule
898a2550
>                                                                                                                                                                                                                                        mkRule v = case Map.lookup v _lhsIvisitDescr of
898a2551
>                                                                                                                                                                                                                                                     Nothing -> ruleTable _lhsIinfo ! v
898a2552
>                                                                                                                                                                                                                                                     Just (ChildVisit name nt n _ _) -> ccv name nt n _lhsIallInters
898a2553
>                                                                                                                                                                                                                                      in zipWith mkVisit _visitss _intravisits
898a2554
> 
898a2555
> 
898a2556
> 
898a2557
> 
898a2558
> 
898a2559
> 
898a2560
> 
898a2561
> 
898a2562
> 
898a2563
> 
898a2564
> 
898a2565
> 
898a2566
> 
898a2567
> 
898a2568
> 
898a2569
> 
898a2570
> 
898a2571
> 
898a2572
> 
898a2573
> 
898a2574
> 
898a2575
>    rule87 = \ ((_lhsInextInh) :: [Vertex]) inh_ syn_ -> [(i,s) | i <- inh_, s <- syn_]
898a2576
>                           Seq.>< Seq.fromList [(s,i) | s <- syn_, i <- _lhsInextInh ]
898a2577
> 
898a2578
> 
898a2579
> 
898a2580
>    rule88 = \ inh_ ->    inh_
898a2581
> 
898a2582
> 
898a2583
> 
898a2584
> 
898a2585
> 
898a2586
> 
898a2587
> 
898a2588
> 
898a2589
> 
898a2590
> 
898a2591
> 
898a2592
> 
898a2593
> 
898a2594
> 
898a2595
> 
898a2596
> 
898a2597
> 
898a2598
> 
898a2599
> 
898a2600
> 
898a2601
> 
898a2602
> 
898a2603
> 
898a2604
> 
898a2605
> 
898a2606
> 
898a2607
> 
898a2608
> 
898a2609
> 
898a2610
> 
898a2611
> 
898a2612
> 
898a2613
> 
898a2614
> 
898a2615
> 
898a2616
> 
898a2617
> 
898a2618
> 
898a2619
> 
898a2620
> 
898a2621
> 
898a2622
> 
898a2623
> 
898a2624
> 
898a2625
> 
898a2626
> 
898a2627
> 
898a2628
> 
898a2629
> 
898a2630
> 
898a2631
> 
898a2632
> 
898a2633
> 
898a2634
> 
898a2635
> 
898a2636
> 
898a2637
> 
898a2638
> 
898a2639
> 
898a2640
> 
898a2641
> 
898a2642
> 
898a2643
> 
898a2644
> 
898a2645
> 
898a2646
> 
898a2647
> 
898a2648
> 
898a2649
> 
898a2650
> 
898a2651
> 
898a2652
> 
898a2653
> 
898a2654
> 
898a2655
> 
898a2656
> 
898a2657
> 
898a2658
> 
898a2659
> 
898a2660
> 
898a2661
> 
898a2662
> 
898a2663
> 
898a2664
> 
898a2665
> 
898a2666
> 
898a2667
> 
898a2668
> 
898a2669
> 
898a2670
> 
898a2671
> 
898a2672
> 
898a2673
> 
898a2674
> 
898a2675
> 
898a2676
> 
898a2677
> 
898a2678
> 
898a2679
> 
898a2680
> 
898a2681
> 
898a2682
> 
898a2683
> 
898a2684
> 
898a2685
> 
898a2686
> 
898a2687
> 
898a2688
> 
898a2689
> 
898a2690
> 
898a2691
> 
898a2692
> 
898a2693
> 
898a2694
> 
898a2695
> 
898a2696
> 
898a2697
> 
898a2698
> 
898a2699
> 
898a2700
> 
898a2701
> 
898a2702
> 
898a2703
> 
898a2704
> 
898a2705
> 
898a2706
> 
898a2707
> 
898a2708
> 
898a2709
> 
898a2710
> 
898a2711
> 
898a2712
> 
898a2713
> 
898a2714
> 
898a2715
> 
898a2716
> 
898a2717
> 
898a2718
> 
898a2719
> 
898a2720
> 
898a2721
> 
898a2722
> 
898a2723
> 
898a2724
> 
898a2725
> 
898a2726
> 
898a2727
> 
898a2728
> 
898a2729
> 
898a2730
> 
898a2731
> 
898a2732
> 
898a2733
> 
898a2734
> 
898a2735
> 
898a2736
> 
898a2737
> 
898a2738
> 
898a2739
> 
898a2740
> 
898a2741
> 
898a2742
> 
898a2743
> 
898a2744
> 
898a2745
> 
898a2746
> 
898a2747
> 
898a2748
> 
898a2749
> 
898a2750
> 
898a2751
> 
898a2752
> 
898a2753
> 
898a2754
> 
898a2755
> 
898a2756
> 
898a2757
> 
898a2758
> 
898a2759
> 
898a2760
> 
898a2761
> 
898a2762
> 
898a2763
> 
898a2764
> 
898a2765
> 
898a2766
> 
898a2767
> 
898a2768
> 
898a2769
> 
898a2770
> 
898a2771
> 
898a2772
> 
898a2773
> 
898a2774
> 
898a2775
> 
898a2776
> 
898a2777
> 
898a2778
> 
898a2779
> 
898a2780
> 
898a2781
> 
898a2782
> 
898a2783
> 
898a2784
> 
898a2785
> 
898a2786
> 
898a2787
> 
898a2788
> 
898a2789
> 
898a2790
> 
898a2791
> 
898a2792
> 
898a2793
> 
898a2794
> 
898a2795
> 
898a2796
> 
898a2797
> 
898a2798
> 
898a2799
> 
898a2800
> 
898a2801
> 
898a2802
> 
898a2803
> 
898a2804
> 
898a2805
> 
898a2806
> 
898a2807
> 
898a2808
> 
898a2809
> 
898a2810
> 
898a2811
> 
898a2812
> 
898a2813
> 
898a2814
> 
898a2815
> 
898a2816
> 
898a2817
> 
898a2818
> 
898a2819
> 
898a2820
> 
898a2821
> 
898a2822
> 
898a2823
> 
898a2824
> 
898a2825
> 
898a2826
> 
898a2827
> 
898a2828
> 
898a2829
> 
898a2830
> 
898a2831
> 
898a2832
> 
898a2833
> 
898a2834
> 
898a2835
> 
898a2836
> 
898a2837
> 
898a2838
> 
898a2839
> 
898a2840
> 
898a2841
> 
898a2842
> 
898a2843
> 
898a2844
> 
898a2845
> 
898a2846
> 
898a2847
> 
898a2848
> 
898a2849
> 
898a2850
> 
898a2851
> 
898a2852
> 
898a2853
> 
898a2854
> 
898a2855
> 
898a2856
> 
898a2857
> 
898a2858
> 
898a2859
> 
898a2860
> 
898a2861
> 
898a2862
> 
898a2863
> 
898a2864
> 
898a2865
> 
898a2866
> 
898a2867
> 
898a2868
> 
898a2869
> 
898a2870
> 
898a2871
> 
898a2872
> 
898a2873
> 
898a2874
> 
898a2875
> 
898a2876
> 
898a2877
> 
898a2878
> 
898a2879
> 
898a2880
> 
898a2881
> 
898a2882
> 
898a2883
> 
898a2884
> 
898a2885
> 
898a2886
> 
898a2887
> 
898a2888
> 
898a2889
> 
898a2890
> 
898a2891
> 
898a2892
> 
898a2893
> 
898a2894
> 
898a2895
> 
898a2896
> 
898a2897
> 
898a2898
> 
898a2899
> 
898a2900
> 
898a2901
> 
898a2902
> 
898a2903
> 
898a2904
> 
898a2905
> 
898a2906
> 
898a2907
> 
898a2908
> 
898a2909
> 
898a2910
> 
898a2911
> 
898a2912
> 
898a2913
> 
898a2914
> 
898a2915
> 
898a2916
> 
898a2917
> 
898a2918
> 
898a2919
> 
898a2920
> 
898a2921
> 
898a2922
> 
898a2923
> 
898a2924
> 
898a2925
> 
898a2926
> 
898a2927
> 
898a2928
> 
898a2929
> 
898a2930
> 
898a2931
> 
898a2932
> 
898a2933
> 
898a2934
> 
898a2935
> 
898a2936
> 
898a2937
> 
898a2938
> 
898a2939
> 
898a2940
> 
898a2941
> 
898a2942
> 
898a2943
> 
898a2944
> 
898a2945
> 
898a2946
> 
898a2947
> 
898a2948
> 
898a2949
> 
898a2950
> 
898a2951
> 
898a2952
> 
898a2953
> 
898a2954
> 
898a2955
> 
898a2956
> 
898a2957
> 
898a2958
> 
898a2959
> 
898a2960
> 
898a2961
> 
898a2962
> 
898a2963
> 
898a2964
> 
898a2965
> 
898a2966
> 
898a2967
> 
898a2968
> 
898a2969
> 
898a2970
> 
898a2971
> 
898a2972
> 
898a2973
> 
898a2974
> 
898a2975
> 
898a2976
> 
898a2977
> 
898a2978
> 
898a2979
> 
898a2980
> 
898a2981
> 
898a2982
> 
898a2983
> 
898a2984
> 
898a2985
> 
898a2986
> 
898a2987
> 
898a2988
> 
898a2989
> 
898a2990
> 
898a2991
> 
898a2992
> 
898a2993
> 
898a2994
> 
898a2995
> 
898a2996
> 
898a2997
> 
898a2998
> 
898a2999
> 
898a3000
> 
898a3001
> 
898a3002
> 
898a3003
> 
898a3004
> 
898a3005
> 
898a3006
> 
898a3007
> 
898a3008
> 
898a3009
> 
898a3010
> 
898a3011
> 
898a3012
> 
898a3013
> 
898a3014
> 
898a3015
> 
898a3016
> 
898a3017
> 
898a3018
> 
898a3019
> 
898a3020
> 
898a3021
> 
898a3022
> 
898a3023
> 
898a3024
> 
898a3025
> 
898a3026
> 
898a3027
> 
898a3028
> 
898a3029
> 
898a3030
> 
898a3031
> 
898a3032
> 
898a3033
> 
991d3125
<    {-# LINE 165 "src-ag/InterfacesRules.lag" #-}
992d3125
<    rule94 = \ ((_tlInewvertices) :: [Vertex]) ->
993d3125
<                                   {-# LINE 165 "src-ag/InterfacesRules.lag" #-}
994d3125
<                                   _tlInewvertices
995c3126
<                                   {-# LINE 996 "dist/build/InterfacesRules.hs"#-}
---
> 
995a3127
> 
995a3128
> 
995a3129
> 
995a3130
> 
997d3131
<    {-# LINE 166 "src-ag/InterfacesRules.lag" #-}
998d3131
<    rule95 = \ ((_hdInewvertices) :: [Vertex]) ->
999d3131
<                                {-# LINE 166 "src-ag/InterfacesRules.lag" #-}
1000d3131
<                                _hdInewvertices
1001c3132
<                                {-# LINE 1002 "dist/build/InterfacesRules.hs"#-}
---
> 
1001a3133
> 
1001a3134
> 
1001a3135
> 
1001a3136
> 
1003d3137
<    {-# LINE 180 "src-ag/InterfacesRules.lag" #-}
1004d3137
<    rule96 = \ ((_hdIgroups) :: [([Vertex],[Vertex])]) ->
1005d3137
<                          {-# LINE 180 "src-ag/InterfacesRules.lag" #-}
1006d3137
<                          _hdIgroups
1007c3138
<                          {-# LINE 1008 "dist/build/InterfacesRules.hs"#-}
---
> 
1007a3139
> 
1007a3140
> 
1007a3141
> 
1007a3142
> 
1009d3143
<    {-# LINE 203 "src-ag/InterfacesRules.lag" #-}
1010d3143
<    rule97 = \ ((_lhsIn) :: Int) ->
1011d3143
<                    {-# LINE 203 "src-ag/InterfacesRules.lag" #-}
1012d3143
<                    _lhsIn + 1
1013c3144
<                    {-# LINE 1014 "dist/build/InterfacesRules.hs"#-}
---
> 
1013a3145
> 
1013a3146
> 
1013a3147
> 
1013a3148
> 
1015d3149
<    {-# LINE 316 "src-ag/InterfacesRules.lag" #-}
1016d3149
<    rule98 = \  (_ :: ()) ->
1017d3149
<                          {-# LINE 316 "src-ag/InterfacesRules.lag" #-}
1018d3149
<                          False
1019c3150
<                          {-# LINE 1020 "dist/build/InterfacesRules.hs"#-}
---
> 
1019a3151
> 
1019a3152
> 
1019a3153
> 
1019a3154
> 
1021d3155
<    {-# LINE 329 "src-ag/InterfacesRules.lag" #-}
1022d3155
<    rule99 = \ ((_tlIhdIntravisits) :: [IntraVisit]) ->
1023d3155
<                                   {-# LINE 329 "src-ag/InterfacesRules.lag" #-}
1024d3155
<                                   _tlIhdIntravisits
1025c3156
<                                   {-# LINE 1026 "dist/build/InterfacesRules.hs"#-}
---
> 
1025a3157
> 
1025a3158
> 
1025a3159
> 
1025a3160
> 
1027d3161
<    {-# LINE 330 "src-ag/InterfacesRules.lag" #-}
1028d3161
<    rule100 = \ ((_hdIintravisits) :: [IntraVisit]) ->
1029d3161
<                                  {-# LINE 330 "src-ag/InterfacesRules.lag" #-}
1030d3161
<                                  _hdIintravisits
1031c3162
<                                  {-# LINE 1032 "dist/build/InterfacesRules.hs"#-}
---
> 
1031a3163
> 
1031a3164
> 
1031a3165
> 
1031a3166
> 
1033d3167
<    {-# LINE 354 "src-ag/InterfacesRules.lag" #-}
1034d3167
<    rule101 = \ ((_lhsIfromLhs) :: [Vertex]) ->
1035d3167
<                           {-# LINE 354 "src-ag/InterfacesRules.lag" #-}
1036d3167
<                           _lhsIfromLhs
1037c3168
<                           {-# LINE 1038 "dist/build/InterfacesRules.hs"#-}
---
> 
1037a3169
> 
1037a3170
> 
1037a3171
> 
1037a3172
> 
1039d3173
<    {-# LINE 355 "src-ag/InterfacesRules.lag" #-}
1040d3173
<    rule102 = \  (_ :: ()) ->
1041d3173
<                           {-# LINE 355 "src-ag/InterfacesRules.lag" #-}
1042d3173
<                           []
1043c3174
<                           {-# LINE 1044 "dist/build/InterfacesRules.hs"#-}
---
> 
1043a3175
> 
1043a3176
> 
1043a3177
> 
1043a3178
> 
1045d3179
<    {-# LINE 401 "src-ag/InterfacesRules.lag" #-}
1046d3179
<    rule103 = \ ((_hdIseg) :: CSegment) ((_tlIsegs) :: CSegments) ->
1047d3179
<                         {-# LINE 401 "src-ag/InterfacesRules.lag" #-}
1048d3179
<                         _hdIseg : _tlIsegs
1049c3180
<                         {-# LINE 1050 "dist/build/InterfacesRules.hs"#-}
---
> 
1049a3181
> 
1049a3182
> 
1049a3183
> 
1049a3184
> 
1051d3185
<    {-# LINE 447 "src-ag/InterfacesRules.lag" #-}
1052d3185
<    rule104 = \ ((_tlIfirstInh) :: [Vertex]) ->
1053d3185
<                           {-# LINE 447 "src-ag/InterfacesRules.lag" #-}
1054d3185
<                           _tlIfirstInh
1055c3186
<                           {-# LINE 1056 "dist/build/InterfacesRules.hs"#-}
---
> 
1055a3187
> 
1055a3188
> 
1055a3189
> 
1055a3190
> 
1057d3191
<    {-# LINE 448 "src-ag/InterfacesRules.lag" #-}
1058d3191
<    rule105 = \ ((_hdIinh) :: [Vertex]) ->
1059d3191
<                             {-# LINE 448 "src-ag/InterfacesRules.lag" #-}
1060d3191
<                             _hdIinh
1061c3192
<                             {-# LINE 1062 "dist/build/InterfacesRules.hs"#-}
---
> 
1061a3193
> 
1061a3194
> 
1061a3195
> 
1061a3196
> 
1133c3268
<      _lhsIvssGraph
---
>      _lhsIvssGraph = \ ((_tlInewvertices) :: [Vertex]) ->
1133a3269
>    rule95 = \ ((_hdInewvertices) :: [Vertex]) ->
1133a3270
> 
1133a3271
> 
1133a3272
> 
1133a3273
> 
1133a3274
> 
1133a3275
> 
1133a3276
> 
1133a3277
> 
1133a3278
> 
1133a3279
> 
1133a3280
> 
1133a3281
> 
1133a3282
> 
1133a3283
>    rule96 = \ ((_hdIgroups) :: [([Vertex],[Vertex])]) ->
1133a3284
> 
1133a3285
> 
1133a3286
> 
1133a3287
> 
1133a3288
> 
1133a3289
> 
1133a3290
> 
1133a3291
> 
1133a3292
> 
1133a3293
> 
1133a3294
> 
1133a3295
> 
1133a3296
> 
1133a3297
> 
1133a3298
> 
1133a3299
> 
1133a3300
> 
1133a3301
> 
1133a3302
> 
1133a3303
> 
1133a3304
> 
1133a3305
> 
1133a3306
>    rule97 = \ ((_lhsIn) :: Int) -> + 1
1133a3307
> 
1133a3308
> 
1133a3309
> 
1133a3310
> 
1133a3311
> 
1133a3312
> 
1133a3313
> 
1133a3314
> 
1133a3315
> 
1133a3316
> 
1133a3317
> 
1133a3318
> 
1133a3319
> 
1133a3320
> 
1133a3321
> 
1133a3322
> 
1133a3323
> 
1133a3324
> 
1133a3325
> 
1133a3326
> 
1133a3327
> 
1133a3328
> 
1133a3329
> 
1133a3330
> 
1133a3331
> 
1133a3332
> 
1133a3333
> 
1133a3334
> 
1133a3335
> 
1133a3336
> 
1133a3337
> 
1133a3338
> 
1133a3339
> 
1133a3340
> 
1133a3341
> 
1133a3342
> 
1133a3343
> 
1133a3344
> 
1133a3345
> 
1133a3346
> 
1133a3347
> 
1133a3348
> 
1133a3349
> 
1133a3350
> 
1133a3351
> 
1133a3352
> 
1133a3353
> 
1133a3354
> 
1133a3355
> 
1133a3356
> 
1133a3357
> 
1133a3358
> 
1133a3359
> 
1133a3360
> 
1133a3361
> 
1133a3362
> 
1133a3363
> 
1133a3364
> 
1133a3365
> 
1133a3366
> 
1133a3367
> 
1133a3368
> 
1133a3369
> 
1133a3370
> 
1133a3371
> 
1133a3372
> 
1133a3373
> 
1133a3374
> 
1133a3375
> 
1133a3376
> 
1133a3377
> 
1133a3378
> 
1133a3379
> 
1133a3380
> 
1133a3381
> 
1133a3382
> 
1133a3383
> 
1133a3384
> 
1133a3385
> 
1133a3386
> 
1133a3387
> 
1133a3388
> 
1133a3389
> 
1133a3390
> 
1133a3391
> 
1133a3392
> 
1133a3393
> 
1133a3394
> 
1133a3395
> 
1133a3396
> 
1133a3397
> 
1133a3398
> 
1133a3399
> 
1133a3400
> 
1133a3401
> 
1133a3402
> 
1133a3403
> 
1133a3404
> 
1133a3405
> 
1133a3406
> 
1133a3407
> 
1133a3408
> 
1133a3409
> 
1133a3410
> 
1133a3411
> 
1133a3412
> 
1133a3413
> 
1133a3414
> 
1133a3415
> 
1133a3416
> 
1133a3417
> 
1133a3418
> 
1133a3419
>    rule98 = \  (_ :: ()) ->
1133a3420
> 
1133a3421
> 
1133a3422
> 
1133a3423
> 
1133a3424
> 
1133a3425
> 
1133a3426
> 
1133a3427
> 
1133a3428
> 
1133a3429
> 
1133a3430
> 
1133a3431
> 
1133a3432
>    rule99 = \ ((_tlIhdIntravisits) :: [IntraVisit]) ->
1133a3433
>    rule100 = \ ((_hdIintravisits) :: [IntraVisit]) ->
1133a3434
> 
1133a3435
> 
1133a3436
> 
1133a3437
> 
1133a3438
> 
1133a3439
> 
1133a3440
> 
1133a3441
> 
1133a3442
> 
1133a3443
> 
1133a3444
> 
1133a3445
> 
1133a3446
> 
1133a3447
> 
1133a3448
> 
1133a3449
> 
1133a3450
> 
1133a3451
> 
1133a3452
> 
1133a3453
> 
1133a3454
> 
1133a3455
> 
1133a3456
> 
1133a3457
>    rule101 = \ ((_lhsIfromLhs) :: [Vertex]) ->
1133a3458
>    rule102 = \  (_ :: ()) ->]
1133a3459
> 
1133a3460
> 
1133a3461
> 
1133a3462
> 
1133a3463
> 
1133a3464
> 
1133a3465
> 
1133a3466
> 
1133a3467
> 
1133a3468
> 
1133a3469
> 
1133a3470
> 
1133a3471
> 
1133a3472
> 
1133a3473
> 
1133a3474
> 
1133a3475
> 
1133a3476
> 
1133a3477
> 
1133a3478
> 
1133a3479
> 
1133a3480
> 
1133a3481
> 
1133a3482
> 
1133a3483
> 
1133a3484
> 
1133a3485
> 
1133a3486
> 
1133a3487
> 
1133a3488
> 
1133a3489
> 
1133a3490
> 
1133a3491
> 
1133a3492
> 
1133a3493
> 
1133a3494
> 
1133a3495
> 
1133a3496
> 
1133a3497
> 
1133a3498
> 
1133a3499
> 
1133a3500
> 
1133a3501
> 
1133a3502
> 
1133a3503
> 
1133a3504
>    rule103 = \ ((_hdIseg) :: CSegment) ((_tlIsegs) :: CSegments) -> : _tlIsegs
1133a3505
> 
1133a3506
> 
1133a3507
> 
1133a3508
> 
1133a3509
> 
1133a3510
> 
1133a3511
> 
1133a3512
> 
1133a3513
> 
1133a3514
> 
1133a3515
> 
1133a3516
> 
1133a3517
> 
1133a3518
> 
1133a3519
> 
1133a3520
> 
1133a3521
> 
1133a3522
> 
1133a3523
> 
1133a3524
> 
1133a3525
> 
1133a3526
> 
1133a3527
> 
1133a3528
> 
1133a3529
> 
1133a3530
> 
1133a3531
> 
1133a3532
> 
1133a3533
> 
1133a3534
> 
1133a3535
> 
1133a3536
> 
1133a3537
> 
1133a3538
> 
1133a3539
> 
1133a3540
> 
1133a3541
> 
1133a3542
> 
1133a3543
> 
1133a3544
> 
1133a3545
> 
1133a3546
> 
1133a3547
> 
1133a3548
> 
1133a3549
> 
1133a3550
>    rule104 = \ ((_tlIfirstInh) :: [Vertex]) ->
1133a3551
>    rule105 = \ ((_hdIinh) :: [Vertex]) ->
1133a3552
> 
1133a3553
> 
1133a3554
> 
1133a3555
> 
1133a3556
> 
1133a3557
> 
1133a3558
> 
1133a3559
> 
1133a3560
> 
1133a3561
> 
1133a3562
> 
1133a3563
> 
1133a3564
> 
1133a3565
> 
1133a3566
> 
1133a3567
> 
1133a3568
> 
1133a3569
> 
1133a3570
> 
1133a3571
> 
1133a3572
> 
1133a3573
> 
1133a3574
> 
1133a3575
> 
1133a3576
> 
1133a3577
> 
1133a3578
> 
1133a3579
> 
1133a3580
> 
1133a3581
> 
1133a3582
> 
1133a3583
> 
1133a3584
> 
1133a3585
> 
1133a3586
> 
1133a3587
> 
1133a3588
> 
1133a3589
> 
1133a3590
> 
1133a3591
> 
1133a3592
> 
1133a3593
> 
1133a3594
> 
1133a3595
> 
1133a3596
> 
1133a3597
> 
1133a3598
> 
1133a3599
> 
1133a3600
> 
1133a3601
> 
1133a3602
> 
1133a3603
> 
1133a3604
> 
1133a3605
> 
1133a3606
> 
1133a3607
> 
1133a3608
> 
1133a3609
> 
1133a3610
> 
1133a3611
> 
1133a3612
> 
1133a3613
> 
1133a3614
> 
1133a3615
> 
1133a3616
> 
1133a3617
> 
1133a3618
> 
1133a3619
> 
1133a3620
> 
1133a3621
> 
1133a3622
> 
1133a3623
> 
1133a3624
> 
1133a3625
> 
1133a3626
> 
1133a3627
> 
1133a3628
> 
1133a3629
> 
1133a3630
> 
1133a3631
> 
1133a3632
> 
1133a3633
> 
1133a3634
> 
1133a3635
> 
1133a3636
> 
1133a3637
> 
1133a3638
> 
1133a3639
> 
1133a3640
> 
1133a3641
> 
1133a3642
> 
1133a3643
> 
1133a3644
> 
1133a3645
> 
1133a3646
> 
1133a3647
> 
1133a3648
> 
1133a3649
> 
1133a3650
> 
1133a3651
> 
1133a3652
> 
1133a3653
> 
1133a3654
> 
1133a3655
> 
1133a3656
> 
1133a3657
> 
1133a3658
> 
1133a3659
> 
1133a3660
> 
1133a3661
> 
1133a3662
> 
1133a3663
> 
1133a3664
> 
1133a3665
> 
1133a3666
> 
1133a3667
> 
1133a3668
> 
1133a3669
> 
1133a3670
> 
1133a3671
> 
1133a3672
> 
1133a3673
> 
1133a3674
> 
1133a3675
> 
1133a3676
> 
1133a3677
> 
1133a3678
> 
1133a3679
> 
1133a3680
> 
1133a3681
> 
1133a3682
> 
1133a3683
> 
1133a3684
> 
1133a3685
> 
1133a3686
> 
1133a3687
> 
1133a3688
> 
1133a3689
> 
1133a3690
> 
1133a3691
> 
1133a3692
> 
1133a3693
> 
1133a3694
> 
1133a3695
> 
1133a3696
> 
1133a3697
> 
1133a3698
> 
1133a3699
> 
1133a3700
> 
1133a3701
> 
1133a3702
> 
1133a3703
> 
1133a3704
> 
1133a3705
> 
1133a3706
> 
1133a3707
> 
1133a3708
> 
1133a3709
> 
1133a3710
> 
1133a3711
> 
1133a3712
> 
1133a3713
> 
1133a3714
> 
1133a3715
> 
1133a3716
> 
1133a3717
> 
1133a3718
> 
1133a3719
> 
1133a3720
> 
1133a3721
> 
1133a3722
> 
1133a3723
> 
1133a3724
> 
1133a3725
> 
1133a3726
> 
1133a3727
> 
1133a3728
> 
1133a3729
> 
1133a3730
> 
1133a3731
> 
1133a3732
> 
1133a3733
> 
1133a3734
> 
1133a3735
> 
1133a3736
> 
1133a3737
> 
1133a3738
> 
1133a3739
> 
1133a3740
> 
1133a3741
> 
1133a3742
> 
1133a3743
> 
1133a3744
> 
1133a3745
> 
1133a3746
> 
1133a3747
> 
1133a3748
> 
1133a3749
> 
1133a3750
> 
1133a3751
> 
1133a3752
> 
1133a3753
> 
1133a3754
> 
1133a3755
> 
1133a3756
> 
1133a3757
> 
1133a3758
> 
1133a3759
> 
1133a3760
> 
1133a3761
> 
1133a3762
> 
1133a3763
> 
1133a3764
> 
1133a3765
> 
1133a3766
> 
1133a3767
> 
1133a3768
> 
1133a3769
> 
1133a3770
> 
1133a3771
> 
1133a3772
> 
1133a3773
> 
1133a3774
> 
1133a3775
> 
1133a3776
> 
1133a3777
> 
1133a3778
> 
1133a3779
> 
1133a3780
> 
1133a3781
> 
1133a3782
> 
1133a3783
> 
1133a3784
> 
1133a3785
> 
1133a3786
> 
1133a3787
> 
1133a3788
> 
1133a3789
> 
1133a3790
> 
1133a3791
> 
1133a3792
> 
1133a3793
> 
1133a3794
> 
1133a3795
> 
1133a3796
> 
1133a3797
> 
1133a3798
> 
1133a3799
> 
1133a3800
> 
1133a3801
> 
1133a3802
> 
1133a3803
> 
1133a3804
> 
1133a3805
> 
1133a3806
> 
1133a3807
> 
1133a3808
> 
1133a3809
> 
1133a3810
> 
1133a3811
> 
1133a3812
> 
1133a3813
> 
1133a3814
> 
1133a3815
> 
1133a3816
> 
1133a3817
> 
1133a3818
> 
1133a3819
> 
1133a3820
> 
1133a3821
> 
1133a3822
> 
1133a3823
> 
1133a3824
> 
1133a3825
> 
1133a3826
> 
1133a3827
> 
1133a3828
> 
1133a3829
> 
1133a3830
> 
1133a3831
> 
1133a3832
> 
1133a3833
> 
1133a3834
> 
1133a3835
> 
1133a3836
> 
1133a3837
> 
1133a3838
> 
1133a3839
> 
1133a3840
> 
1133a3841
> 
1133a3842
> 
1133a3843
> 
1133a3844
> 
1133a3845
> 
1133a3846
> 
1133a3847
> 
1133a3848
> 
1133a3849
> 
1133a3850
> 
1133a3851
> 
1133a3852
> 
1133a3853
> 
1133a3854
> 
1133a3855
> 
1133a3856
> 
1133a3857
> 
1133a3858
> 
1133a3859
> 
1133a3860
> 
1133a3861
> 
1133a3862
> 
1133a3863
> 
1133a3864
> 
1133a3865
> 
1133a3866
> 
1133a3867
> 
1133a3868
> 
1133a3869
> 
1133a3870
> 
1133a3871
> 
1133a3872
> 
1133a3873
> 
1133a3874
> 
1133a3875
> 
1133a3876
> 
1133a3877
> 
1133a3878
> 
1133a3879
> 
1133a3880
> 
1133a3881
> 
1133a3882
> 
1133a3883
> 
1133a3884
> 
1133a3885
> 
1133a3886
> 
1133a3887
> 
1133a3888
> 
1133a3889
> 
1133a3890
> 
1133a3891
> 
1133a3892
> 
1133a3893
> 
1133a3894
> 
1133a3895
> 
1133a3896
> 
1133a3897
> 
1133a3898
> 
1133a3899
> 
1133a3900
> 
1133a3901
> 
1133a3902
> 
1133a3903
> 
1133a3904
> 
1133a3905
> 
1133a3906
> 
1133a3907
> 
1133a3908
> 
1133a3909
> 
1133a3910
> 
1133a3911
> 
1133a3912
> 
1133a3913
> 
1133a3914
> 
1133a3915
> 
1133a3916
> 
1133a3917
> 
1133a3918
> 
1133a3919
> 
1133a3920
> 
1133a3921
> 
1133a3922
> 
1133a3923
> 
1133a3924
> 
1133a3925
> 
1133a3926
> 
1133a3927
> 
1133a3928
> 
1133a3929
> 
1133a3930
> 
1133a3931
> 
1133a3932
> 
1133a3933
> 
1133a3934
> 
1133a3935
> 
1133a3936
> 
1133a3937
> 
1133a3938
> 
1133a3939
> 
1133a3940
> 
1133a3941
> 
1133a3942
> 
1133a3943
> 
1133a3944
> 
1133a3945
> 
1133a3946
> 
1133a3947
> 
1133a3948
> 
1133a3949
> 
1133a3950
> 
1133a3951
> 
1133a3952
> 
1133a3953
> 
1133a3954
> 
1133a3955
> 
1133a3956
> 
1133a3957
> 
1133a3958
> 
1133a3959
> 
1133a3960
> 
1133a3961
> 
1133a3962
> 
1133a3963
> 
1133a3964
> 
1133a3965
> 
1133a3966
> 
1133a3967
> 
1133a3968
> 
1133a3969
> 
1133a3970
> 
1133a3971
> 
1133a3972
> 
1133a3973
> 
1133a3974
> 
1133a3975
> 
1133a3976
> 
1133a3977
> 
1133a3978
> 
1133a3979
> 
1133a3980
> 
1133a3981
> 
1133a3982
> 
1133a3983
> 
1133a3984
> 
1133a3985
> 
1133a3986
> 
1133a3987
> 
1133a3988
> 
1133a3989
> 
1133a3990
> 
1133a3991
> 
1133a3992
> 
1133a3993
> 
1133a3994
> 
1133a3995
> 
1133a3996
> 
1133a3997
> 
1133a3998
> 
1133a3999
> 
1133a4000
> 
1133a4001
> 
1133a4002
> 
1133a4003
> 
1133a4004
> 
1133a4005
> 
1133a4006
> 
1133a4007
> 
1133a4008
> 
1133a4009
> 
1133a4010
> 
1133a4011
> 
1133a4012
> 
1133a4013
> 
1133a4014
> 
1133a4015
> 
1133a4016
> 
1133a4017
> 
1133a4018
> 
1133a4019
> 
1133a4020
> 
1133a4021
> 
1133a4022
> 
1133a4023
> 
1133a4024
> 
1133a4025
> 
1133a4026
> 
1133a4027
> 
1133a4028
> 
1133a4029
> 
1133a4030
> 
1133a4031
> 
1133a4032
> 
1133a4033
> 
1133a4034
> 
1133a4035
> 
1133a4036
> 
1133a4037
> 
1133a4038
> 
1133a4039
> 
1133a4040
> 
1133a4041
> 
1133a4042
> 
1133a4043
> 
1133a4044
> 
1133a4045
> 
1133a4046
> 
1133a4047
> 
1133a4048
> 
1133a4049
> 
1133a4050
> 
1133a4051
> 
1133a4052
> 
1133a4053
> 
1133a4054
> 
1133a4055
> 
1133a4056
> 
1133a4057
> 
1133a4058
> 
1133a4059
> 
1133a4060
> 
1133a4061
> 
1133a4062
> 
1133a4063
> 
1133a4064
> 
1133a4065
> 
1133a4066
> 
1133a4067
> 
1133a4068
> 
1133a4069
> 
1133a4070
> 
1133a4071
> 
1133a4072
> 
1133a4073
> 
1133a4074
> 
1133a4075
> 
1133a4076
> 
1133a4077
> 
1133a4078
> 
1133a4079
> 
1133a4080
> 
1133a4081
> 
1133a4082
> 
1133a4083
> 
1133a4084
> 
1133a4085
> 
1133a4086
> 
1133a4087
> 
1133a4088
> 
1133a4089
> 
1133a4090
> 
1133a4091
> 
1133a4092
> 
1133a4093
> 
1133a4094
> 
1133a4095
> 
1133a4096
> 
1133a4097
> 
1133a4098
> 
1133a4099
> 
1133a4100
> 
1133a4101
> 
1133a4102
> 
1133a4103
> 
1133a4104
> 
1133a4105
> 
1133a4106
> 
1133a4107
> 
1133a4108
> 
1133a4109
> 
1133a4110
> 
1133a4111
> 
1133a4112
> 
1133a4113
> 
1133a4114
> 
1133a4115
> 
1133a4116
> 
1133a4117
> 
1133a4118
> 
1133a4119
> 
1133a4120
> 
1133a4121
> 
1133a4122
> 
1133a4123
> 
1133a4124
> 
1133a4125
> 
1133a4126
> 
1133a4127
> 
1133a4128
> 
1133a4129
> 
1133a4130
> 
1133a4131
> 
1133a4132
> 
1133a4133
> 
1133a4134
> 
1133a4135
> 
1133a4136
> 
1133a4137
> 
1133a4138
> 
1133a4139
> 
1133a4140
> 
1133a4141
> 
1133a4142
> 
1133a4143
> 
1133a4144
> 
1133a4145
> 
1133a4146
> 
1133a4147
> 
1133a4148
> 
1133a4149
> 
1133a4150
> 
1133a4151
> 
1133a4152
> 
1133a4153
> 
1133a4154
> 
1133a4155
> 
1133a4156
> 
1133a4157
> 
1133a4158
> 
1133a4159
> 
1133a4160
> 
1133a4161
> 
1133a4162
> 
1133a4163
> 
1133a4164
> 
1133a4165
> 
1133a4166
> 
1133a4167
> 
1133a4168
> 
1133a4169
> 
1133a4170
> 
1133a4171
> 
1133a4172
> 
1133a4173
> 
1133a4174
> 
1133a4175
> 
1133a4176
> 
1133a4177
> 
1133a4178
> 
1133a4179
> 
1133a4180
> 
1133a4181
> 
1133a4182
> 
1133a4183
> 
1133a4184
> 
1133a4185
> 
1133a4186
> 
1133a4187
> 
1133a4188
> 
1133a4189
> 
1133a4190
> 
1133a4191
> 
1133a4192
> 
1133a4193
> 
1133a4194
> 
1133a4195
> 
1133a4196
> 
1133a4197
> 
1133a4198
> 
1133a4199
> 
1133a4200
> 
1133a4201
> 
1133a4202
> 
1133a4203
> 
1133a4204
> 
1133a4205
> 
1133a4206
> 
1133a4207
> 
1133a4208
> 
1133a4209
> 
1133a4210
> 
1133a4211
> 
1133a4212
> 
1133a4213
> 
1133a4214
> 
1133a4215
> 
1133a4216
> 
1133a4217
> 
1133a4218
> 
1133a4219
> 
1133a4220
> 
1133a4221
> 
1133a4222
> 
1133a4223
> 
1133a4224
> 
1133a4225
> 
1133a4226
> 
1133a4227
> 
1133a4228
> 
1133a4229
> 
1133a4230
> 
1133a4231
> 
1133a4232
> 
1133a4233
> 
1133a4234
> 
1133a4235
> 
1133a4236
> 
1167d4269
<    {-# LINE 167 "src-ag/InterfacesRules.lag" #-}
1168d4269
<    rule130 = \  (_ :: ()) ->
1169d4269
<                                {-# LINE 167 "src-ag/InterfacesRules.lag" #-}
1170d4269
<                                []
1171c4270
<                                {-# LINE 1172 "dist/build/InterfacesRules.hs"#-}
---
> 
1171a4271
> 
1171a4272
> 
1171a4273
> 
1171a4274
> 
1173d4275
<    {-# LINE 181 "src-ag/InterfacesRules.lag" #-}
1174d4275
<    rule131 = \  (_ :: ()) ->
1175d4275
<                          {-# LINE 181 "src-ag/InterfacesRules.lag" #-}
1176d4275
<                          []
1177c4276
<                          {-# LINE 1178 "dist/build/InterfacesRules.hs"#-}
---
> 
1177a4277
> 
1177a4278
> 
1177a4279
> 
1177a4280
> 
1179d4281
<    {-# LINE 331 "src-ag/InterfacesRules.lag" #-}
1180d4281
<    rule132 = \  (_ :: ()) ->
1181d4281
<                                {-# LINE 331 "src-ag/InterfacesRules.lag" #-}
1182d4281
<                                repeat []
1183c4282
<                                {-# LINE 1184 "dist/build/InterfacesRules.hs"#-}
---
> 
1183a4283
> 
1183a4284
> 
1183a4285
> 
1183a4286
> 
1185d4287
<    {-# LINE 402 "src-ag/InterfacesRules.lag" #-}
1186d4287
<    rule133 = \  (_ :: ()) ->
1187d4287
<                         {-# LINE 402 "src-ag/InterfacesRules.lag" #-}
1188d4287
<                         []
1189c4288
<                         {-# LINE 1190 "dist/build/InterfacesRules.hs"#-}
---
> 
1189a4289
> 
1189a4290
> 
1189a4291
> 
1189a4292
> 
1191d4293
<    {-# LINE 449 "src-ag/InterfacesRules.lag" #-}
1192d4293
<    rule134 = \  (_ :: ()) ->
1193d4293
<                            {-# LINE 449 "src-ag/InterfacesRules.lag" #-}
1194d4293
<                            []
1195c4294
<                            {-# LINE 1196 "dist/build/InterfacesRules.hs"#-}
---
> 
1195a4295
> 
1195a4296
> 
1195a4297
> 
1195a4298
> 
1213c4316
<      _lhsIv
---
>      _lhsIv = \  (_ :: ()) ->   []
1213a4317
> 
1213a4318
> 
1213a4319
> 
1213a4320
> 
1213a4321
> 
1213a4322
> 
1213a4323
> 
1213a4324
> 
1213a4325
> 
1213a4326
> 
1213a4327
> 
1213a4328
> 
1213a4329
> 
1213a4330
>    rule131 = \  (_ :: ()) ->]
1213a4331
> 
1213a4332
> 
1213a4333
> 
1213a4334
> 
1213a4335
> 
1213a4336
> 
1213a4337
> 
1213a4338
> 
1213a4339
> 
1213a4340
> 
1213a4341
> 
1213a4342
> 
1213a4343
> 
1213a4344
> 
1213a4345
> 
1213a4346
> 
1213a4347
> 
1213a4348
> 
1213a4349
> 
1213a4350
> 
1213a4351
> 
1213a4352
> 
1213a4353
> 
1213a4354
> 
1213a4355
> 
1213a4356
> 
1213a4357
> 
1213a4358
> 
1213a4359
> 
1213a4360
> 
1213a4361
> 
1213a4362
> 
1213a4363
> 
1213a4364
> 
1213a4365
> 
1213a4366
> 
1213a4367
> 
1213a4368
> 
1213a4369
> 
1213a4370
> 
1213a4371
> 
1213a4372
> 
1213a4373
> 
1213a4374
> 
1213a4375
> 
1213a4376
> 
1213a4377
> 
1213a4378
> 
1213a4379
> 
1213a4380
> 
1213a4381
> 
1213a4382
> 
1213a4383
> 
1213a4384
> 
1213a4385
> 
1213a4386
> 
1213a4387
> 
1213a4388
> 
1213a4389
> 
1213a4390
> 
1213a4391
> 
1213a4392
> 
1213a4393
> 
1213a4394
> 
1213a4395
> 
1213a4396
> 
1213a4397
> 
1213a4398
> 
1213a4399
> 
1213a4400
> 
1213a4401
> 
1213a4402
> 
1213a4403
> 
1213a4404
> 
1213a4405
> 
1213a4406
> 
1213a4407
> 
1213a4408
> 
1213a4409
> 
1213a4410
> 
1213a4411
> 
1213a4412
> 
1213a4413
> 
1213a4414
> 
1213a4415
> 
1213a4416
> 
1213a4417
> 
1213a4418
> 
1213a4419
> 
1213a4420
> 
1213a4421
> 
1213a4422
> 
1213a4423
> 
1213a4424
> 
1213a4425
> 
1213a4426
> 
1213a4427
> 
1213a4428
> 
1213a4429
> 
1213a4430
> 
1213a4431
> 
1213a4432
> 
1213a4433
> 
1213a4434
> 
1213a4435
> 
1213a4436
> 
1213a4437
> 
1213a4438
> 
1213a4439
> 
1213a4440
> 
1213a4441
> 
1213a4442
> 
1213a4443
> 
1213a4444
> 
1213a4445
> 
1213a4446
> 
1213a4447
> 
1213a4448
> 
1213a4449
> 
1213a4450
> 
1213a4451
> 
1213a4452
> 
1213a4453
> 
1213a4454
> 
1213a4455
> 
1213a4456
> 
1213a4457
> 
1213a4458
> 
1213a4459
> 
1213a4460
> 
1213a4461
> 
1213a4462
> 
1213a4463
> 
1213a4464
> 
1213a4465
> 
1213a4466
> 
1213a4467
> 
1213a4468
> 
1213a4469
> 
1213a4470
> 
1213a4471
> 
1213a4472
> 
1213a4473
> 
1213a4474
> 
1213a4475
> 
1213a4476
> 
1213a4477
> 
1213a4478
> 
1213a4479
> 
1213a4480
>    rule132 = \  (_ :: ()) ->   repeat []
1213a4481
> 
1213a4482
> 
1213a4483
> 
1213a4484
> 
1213a4485
> 
1213a4486
> 
1213a4487
> 
1213a4488
> 
1213a4489
> 
1213a4490
> 
1213a4491
> 
1213a4492
> 
1213a4493
> 
1213a4494
> 
1213a4495
> 
1213a4496
> 
1213a4497
> 
1213a4498
> 
1213a4499
> 
1213a4500
> 
1213a4501
> 
1213a4502
> 
1213a4503
> 
1213a4504
> 
1213a4505
> 
1213a4506
> 
1213a4507
> 
1213a4508
> 
1213a4509
> 
1213a4510
> 
1213a4511
> 
1213a4512
> 
1213a4513
> 
1213a4514
> 
1213a4515
> 
1213a4516
> 
1213a4517
> 
1213a4518
> 
1213a4519
> 
1213a4520
> 
1213a4521
> 
1213a4522
> 
1213a4523
> 
1213a4524
> 
1213a4525
> 
1213a4526
> 
1213a4527
> 
1213a4528
> 
1213a4529
> 
1213a4530
> 
1213a4531
> 
1213a4532
> 
1213a4533
> 
1213a4534
> 
1213a4535
> 
1213a4536
> 
1213a4537
> 
1213a4538
> 
1213a4539
> 
1213a4540
> 
1213a4541
> 
1213a4542
> 
1213a4543
> 
1213a4544
> 
1213a4545
> 
1213a4546
> 
1213a4547
> 
1213a4548
> 
1213a4549
> 
1213a4550
> 
1213a4551
>    rule133 = \  (_ :: ()) ->]
1213a4552
> 
1213a4553
> 
1213a4554
> 
1213a4555
> 
1213a4556
> 
1213a4557
> 
1213a4558
> 
1213a4559
> 
1213a4560
> 
1213a4561
> 
1213a4562
> 
1213a4563
> 
1213a4564
> 
1213a4565
> 
1213a4566
> 
1213a4567
> 
1213a4568
> 
1213a4569
> 
1213a4570
> 
1213a4571
> 
1213a4572
> 
1213a4573
> 
1213a4574
> 
1213a4575
> 
1213a4576
> 
1213a4577
> 
1213a4578
> 
1213a4579
> 
1213a4580
> 
1213a4581
> 
1213a4582
> 
1213a4583
> 
1213a4584
> 
1213a4585
> 
1213a4586
> 
1213a4587
> 
1213a4588
> 
1213a4589
> 
1213a4590
> 
1213a4591
> 
1213a4592
> 
1213a4593
> 
1213a4594
> 
1213a4595
> 
1213a4596
> 
1213a4597
> 
1213a4598
>    rule134 = \  (_ :: ()) ->]
1213a4599
> 
1213a4600
> 
1213a4601
> 
1213a4602
> 
1213a4603
> 
1213a4604
> 
1213a4605
> 
1213a4606
> 
1213a4607
> 
1213a4608
> 
1213a4609
> 
1213a4610
> 
1213a4611
> 
1213a4612
> 
1213a4613
> 
1213a4614
> 
1213a4615
> 
1213a4616
> 
1213a4617
> 
1213a4618
> 
1213a4619
> 
1213a4620
> 
1213a4621
> 
1213a4622
> 
1213a4623
> 
1213a4624
> 
1213a4625
> 
1213a4626
> 
1213a4627
> 
1213a4628
> 
1213a4629
> 
1213a4630
> 
1213a4631
> 
1213a4632
> 
1213a4633
> 
1213a4634
> 
1213a4635
> 
1213a4636
> 
1213a4637
> 
1213a4638
> 
1213a4639
> 
1213a4640
> 
1213a4641
> 
1213a4642
> 
1213a4643
> 
1213a4644
> 
1213a4645
> 
1213a4646
> 
1213a4647
> 
1213a4648
> 
1213a4649
> 
1213a4650
> 
1213a4651
> 
1213a4652
> 
1213a4653
> 
1213a4654
> 
1213a4655
> 
1213a4656
> 
1213a4657
> 
1213a4658
> 
1213a4659
> 
1213a4660
> 
1213a4661
> 
1213a4662
> 
1213a4663
> 
1213a4664
> 
1213a4665
> 
1213a4666
> 
1213a4667
> 
1213a4668
> 
1213a4669
> 
1213a4670
> 
1213a4671
> 
1213a4672
> 
1213a4673
> 
1213a4674
> 
1213a4675
> 
1213a4676
> 
1213a4677
> 
1213a4678
> 
1213a4679
> 
1213a4680
> 
1213a4681
> 
1213a4682
> 
1213a4683
> 
1213a4684
> 
1213a4685
> 
1213a4686
> 
1213a4687
> 
1213a4688
> 
1213a4689
> 
1213a4690
> 
1213a4691
> 
1213a4692
> 
1213a4693
> 
1213a4694
> 
1213a4695
> 
1213a4696
> 
1213a4697
> 
1213a4698
> 
1213a4699
> 
1213a4700
> 
1213a4701
> 
1213a4702
> 
1213a4703
> 
1213a4704
> 
1213a4705
> 
1213a4706
> 
1213a4707
> 
1213a4708
> 
1213a4709
> 
1213a4710
> 
1213a4711
> 
1213a4712
> 
1213a4713
> 
1213a4714
> 
1213a4715
> 
1213a4716
> 
1213a4717
> 
1213a4718
> 
1213a4719
> 
1213a4720
> 
1213a4721
> 
1213a4722
> 
1213a4723
> 
1213a4724
> 
1213a4725
> 
1213a4726
> 
1213a4727
> 
1213a4728
> 
1213a4729
> 
1213a4730
> 
1213a4731
> 
1213a4732
> 
1213a4733
> 
1213a4734
> 
1213a4735
> 
1213a4736
> 
1213a4737
> 
1213a4738
> 
1213a4739
> 
1213a4740
> 
1213a4741
> 
1213a4742
> 
1213a4743
> 
1213a4744
> 
1213a4745
> 
1213a4746
> 
1213a4747
> 
1213a4748
> 
1213a4749
> 
1213a4750
> 
1213a4751
> 
1213a4752
> 
1213a4753
> 
1213a4754
> 
1213a4755
> 
1213a4756
> 
1213a4757
> 
1213a4758
> 
1213a4759
> 
1213a4760
> 
1213a4761
> 
1213a4762
> 
1213a4763
> 
1213a4764
> 
1213a4765
> 
1213a4766
> 
1213a4767
> 
1213a4768
> 
1213a4769
> 
1213a4770
> 
1213a4771
> 
1213a4772
> 
1213a4773
> 
1213a4774
> 
1213a4775
> 
1213a4776
> 
1213a4777
> 
1213a4778
> 
1213a4779
> 
1213a4780
> 
1213a4781
> 
1213a4782
> 
1213a4783
> 
1213a4784
> 
1213a4785
> 
1213a4786
> 
1213a4787
> 
1213a4788
> 
1213a4789
> 
1213a4790
> 
1213a4791
> 
1213a4792
> 
1213a4793
> 
1213a4794
> 
1213a4795
> 
1213a4796
> 
1213a4797
> 
1213a4798
> 
1213a4799
> 
1213a4800
> 
1213a4801
> 
1213a4802
> 
1213a4803
> 
1213a4804
> 
1213a4805
> 
1213a4806
> 
1213a4807
> 
1213a4808
> 
1213a4809
> 
1213a4810
> 
1213a4811
> 
1213a4812
> 
1213a4813
> 
1213a4814
> 
1213a4815
> 
1213a4816
> 
1213a4817
> 
1213a4818
> 
1213a4819
> 
1213a4820
> 
1213a4821
> 
1213a4822
> 
1213a4823
> 
1213a4824
> 
1213a4825
> 
1213a4826
> 
1213a4827
> 
1213a4828
> 
1213a4829
> 
1213a4830
> 
1213a4831
> 
1213a4832
> 
1213a4833
> 
1213a4834
> 
1213a4835
> 
1213a4836
> 
1213a4837
> 
1213a4838
> 
1213a4839
> 
1213a4840
> 
1213a4841
> 
1213a4842
> 
1213a4843
> 
1213a4844
> 
1213a4845
> 
1213a4846
> 
1213a4847
> 
1213a4848
> 
1213a4849
> 
1213a4850
> 
1213a4851
> 
1213a4852
> 
1213a4853
> 
1213a4854
> 
1213a4855
> 
1213a4856
> 
1213a4857
> 
1213a4858
> 
1213a4859
> 
1213a4860
> 
1213a4861
> 
1213a4862
> 
1213a4863
> 
1213a4864
> 
1213a4865
> 
1213a4866
> 
1213a4867
> 
1213a4868
> 
1213a4869
> 
1213a4870
> 
1213a4871
> 
1213a4872
> 
1213a4873
> 
1213a4874
> 
1213a4875
> 
1213a4876
> 
1213a4877
> 
1213a4878
> 
1213a4879
> 
1213a4880
> 
1213a4881
> 
1213a4882
> 
1213a4883
> 
1213a4884
> 
1213a4885
> 
1213a4886
> 
1213a4887
> 
1213a4888
> 
1213a4889
> 
1213a4890
> 
1213a4891
> 
1213a4892
> 
1213a4893
> 
1213a4894
> 
1213a4895
> 
1213a4896
> 
1213a4897
> 
1213a4898
> 
1213a4899
> 
1213a4900
> 
1213a4901
> 
1213a4902
> 
1213a4903
> 
1213a4904
> 
1213a4905
> 
1213a4906
> 
1213a4907
> 
1213a4908
> 
1213a4909
> 
1213a4910
> 
1213a4911
> 
1213a4912
> 
1213a4913
> 
1213a4914
> 
1213a4915
> 
1213a4916
> 
1213a4917
> 
1213a4918
> 
1213a4919
> 
1213a4920
> 
1213a4921
> 
1213a4922
> 
1213a4923
> 
1213a4924
> 
1213a4925
> 
1213a4926
> 
1213a4927
> 
1213a4928
> 
1213a4929
> 
1213a4930
> 
1213a4931
> 
1213a4932
> 
1213a4933
> 
1213a4934
> 
1213a4935
> 
1213a4936
> 
1213a4937
> 
1213a4938
> 
1213a4939
> 
1213a4940
> 
1213a4941
> 
1213a4942
> 
1213a4943
> 
1213a4944
> 
1213a4945
> 
1213a4946
> 
1213a4947
> 
1213a4948
> 
1213a4949
> 
1213a4950
> 
1213a4951
> 
1213a4952
> 
1213a4953
> 
1213a4954
> 
1213a4955
> 
1213a4956
> 
1213a4957
> 
1213a4958
> 
1213a4959
> 
1213a4960
> 
1213a4961
> 
1213a4962
> 
1213a4963
> 
1213a4964
> 
1213a4965
> 
1213a4966
> 
1213a4967
> 
1213a4968
> 
1213a4969
> 
1213a4970
> 
1213a4971
> 
1213a4972
> 
1213a4973
> 
1213a4974
> 
1213a4975
> 
1213a4976
> 
1213a4977
> 
1213a4978
> 
1213a4979
> 
1213a4980
> 
1213a4981
> 
1213a4982
> 
1213a4983
> 
1213a4984
> 
1213a4985
> 
1213a4986
> 
1213a4987
> 
1213a4988
> 
1213a4989
> 
1213a4990
> 
1213a4991
> 
1213a4992
> 
1213a4993
> 
1213a4994
> 
1213a4995
> 
1213a4996
> 
1213a4997
> 
1213a4998
> 
1213a4999
> 
1213a5000
> 
1213a5001
> 
1213a5002
> 
1213a5003
> 
1213a5004
> 
1213a5005
> 
1213a5006
> 
1213a5007
> 
1213a5008
> 
1213a5009
> 
1213a5010
> 
1213a5011
> 
1213a5012
> 
1213a5013
> 
1213a5014
> 
1213a5015
> 
1213a5016
> 
1213a5017
> 
1213a5018
> 
1213a5019
> 
1213a5020
> 
1213a5021
> 
1213a5022
> 
1213a5023
> 
1213a5024
> 
1213a5025
> 
1213a5026
> 
1213a5027
> 
1213a5028
> 
1213a5029
> 
1213a5030
> 
1213a5031
> 
1213a5032
> 
1213a5033
> 
1213a5034
> 
1213a5035
> 
1213a5036
> 
1213a5037
> 
1213a5038
> 
1213a5039
> 
1213a5040
> 
1213a5041
> 
1213a5042
> 
1213a5043
> 
1213a5044
> 
1213a5045
> 
1213a5046
> 
1213a5047
> 
1213a5048
> 
1213a5049
> 
1213a5050
> 
1213a5051
> 
1213a5052
> 
1213a5053
> 
1213a5054
> 
1213a5055
> 
1213a5056
> 
1213a5057
> 
1213a5058
> 
1213a5059
> 
1213a5060
> 
1213a5061
> 
1213a5062
> 
1213a5063
> 
1213a5064
> 
1213a5065
> 
1213a5066
> 
1213a5067
> 
1213a5068
> 
1213a5069
> 
1213a5070
> 
1213a5071
> 
1213a5072
> 
1213a5073
> 
1213a5074
> 
1213a5075
> 
1213a5076
> 
1213a5077
> 
1213a5078
> 
1213a5079
> 
1213a5080
> 
1213a5081
> 
1213a5082
> 
1213a5083
> 
1213a5084
> 
1213a5085
> 
1213a5086
> 
1213a5087
> 
1213a5088
> 
1213a5089
> 
1213a5090
> 
1213a5091
> 
1213a5092
> 
1213a5093
> 
1213a5094
> 
1213a5095
> 
1213a5096
> 
1213a5097
> 
1213a5098
> 
1213a5099
> 
1213a5100
> 
1213a5101
> 
1213a5102
> 
1213a5103
> 
1213a5104
> 
1213a5105
> 
1213a5106
> 
1213a5107
> 
1213a5108
> 
1213a5109
> 
1213a5110
> 
1213a5111
> 
1213a5112
> 
1213a5113
> 
1213a5114
> 
1213a5115
> 
1213a5116
> 
1213a5117
> 
1213a5118
> 
1213a5119
> 
1213a5120
> 
1213a5121
> 
1213a5122
> 
1213a5123
> 
1213a5124
> 
1213a5125
> 
1213a5126
> 
1213a5127
> 
1213a5128
> 
1213a5129
> 
1213a5130
> 
1213a5131
> 
1213a5132
> 
1213a5133
> 
1213a5134
> 
1213a5135
> 
1213a5136
> 
1213a5137
> 
1213a5138
> 
1213a5139
> 
1213a5140
> 
1213a5141
> 
1213a5142
> 
1213a5143
> 
1213a5144
> 
1213a5145
> 
1213a5146
> 
1213a5147
> 
1213a5148
> 
1213a5149
> 
1213a5150
> 
1213a5151
> 
1213a5152
> 
1213a5153
> 
1213a5154
> 
1213a5155
> 
1213a5156
> 
1213a5157
> 
1213a5158
> 
1213a5159
> 
1213a5160
> 
1213a5161
> 
1213a5162
> 
1213a5163
> 
1213a5164
> 
1213a5165
> 
1213a5166
> 
1213a5167
> 
1213a5168
> 
1213a5169
> 
1213a5170
> 
1213a5171
> 
1213a5172
> 
1213a5173
> 
1213a5174
> 
1213a5175
> 
1213a5176
> 
1213a5177
> 
1213a5178
> 
1213a5179
> 
1213a5180
> 
1213a5181
> 
1213a5182
> 
1213a5183
> 
1213a5184
> 
1213a5185
> 
1213a5186
> 
1213a5187
> 
1213a5188
> 
1213a5189
> 
1213a5190
> 
1213a5191
> 
1213a5192
> 
1213a5193
> 
1213a5194
> 
1213a5195
> 
1213a5196
> 
1213a5197
> 
1213a5198
> 
1213a5199
> 
1213a5200
> 
1213a5201
> 
1213a5202
> 
1213a5203
> 
1213a5204
> 
1213a5205
> 
1213a5206
> 
1213a5207
> 
1213a5208
> 
1213a5209
> 
1213a5210
> 
1213a5211
> 
1213a5212
> 
1213a5213
> 
1213a5214
> 
1213a5215
> 
1213a5216
> 
1213a5217
> 
1213a5218
> 
1213a5219
> 
1213a5220
> 
1213a5221
> 
1213a5222
> 
1213a5223
> 
1213a5224
> 
1213a5225
> 
1213a5226
> 
1213a5227
> 
1213a5228
> 
1213a5229
> 
1213a5230
> 
1213a5231
> 
1213a5232
> 
1213a5233
> 
1213a5234
> 
1213a5235
> 
1213a5236
> 
1213a5237
> 
1213a5238
> 
1213a5239
> 
1213a5240
> 
1213a5241
> 
1213a5242
> 
1213a5243
> 
1213a5244
> 
1213a5245
> 
1213a5246
> 
1213a5247
> 
1213a5248
> 
1213a5249
> 
1213a5250
> 
1213a5251
> 
1213a5252
> 
1213a5253
> 
1213a5254
> 
1213a5255
> 
1213a5256
> 
1213a5257
> 
1213a5258
> 
1213a5259
> 
1213a5260
> 
1213a5261
> 
1213a5262
> 
1213a5263
> 
1213a5264
> 
1213a5265
> 
1213a5266
> 
1213a5267
> 
1213a5268
> 
1213a5269
> 
1213a5270
> 
1213a5271
> 
1213a5272
> 
1213a5273
> 
1213a5274
> 
1213a5275
> 
1213a5276
> 
1213a5277
> 
1213a5278
> 
1213a5279
> 
1213a5280
> 
1213a5281
> 
1213a5282
> 
1213a5283
> 
1213a5284
> 
1213a5285
> 
1213a5286
> 
1213a5287
> 
1213a5288
> 
1213a5289
> 
1213a5290
> 
1213a5291
> 
1213a5292
> 
1213a5293
> 
1213a5294
> 
1213a5295
> 
1213a5296
> 
1213a5297
> 
1213a5298
> 
1213a5299
> 
1213a5300
> 
1213a5301
> 
1213a5302
> 
1213a5303
> 
1213a5304
> 
1213a5305
> 
1213a5306
> 
1213a5307
> 
1213a5308
> 
1213a5309
> 
1213a5310
> 
1213a5311
> 
1213a5312
> 
1213a5313
> 
1213a5314
> 
1213a5315
> 
1213a5316
> 
1213a5317
> 
1213a5318
> 
1213a5319
> 
1213a5320
> 
1213a5321
> 
1213a5322
> 
1213a5323
> 
1213a5324
> 
1213a5325
> 
1213a5326
> 
1213a5327
> 
1213a5328
> 
1213a5329
> 
1213a5330
> 
1213a5331
> 
1213a5332
> 
1213a5333
> 
1213a5334
> 
1213a5335
> 
1213a5336
> 
1213a5337
> 
1213a5338
> 
1213a5339
> 
1213a5340
> 
1213a5341
> 
1213a5342
> 
1213a5343
> 
1213a5344
> 
1213a5345
> 
1213a5346
> 
1213a5347
> 
1213a5348
> 
1213a5349
> 
1213a5350
> 
1213a5351
> 
1213a5352
> 
1213a5353
> 
1213a5354
> 
1213a5355
> 
1213a5356
> 
1213a5357
> 
1213a5358
> 
1213a5359
> 
1213a5360
> 
1213a5361
> 
1213a5362
> 
1213a5363
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE Rank2Types, GADTs #-}
{-# LANGUAGE BangPatterns #-}
{-# LANGUAGE ScopedTypeVariables #-}

module InterfacesRules where
{-# LINE 2 "src-ag/Interfaces.ag" #-}

import CommonTypes
import SequentialTypes
{-# LINE 11 "dist/build/InterfacesRules.hs" #-}

{-# LINE 10 "src-ag/InterfacesRules.lag" #-}

import Interfaces
import CodeSyntax
import GrammarInfo

import qualified Data.Sequence as Seq
import Data.Sequence(Seq)
import qualified Data.Map as Map
import Data.Map(Map)
import Data.Tree(Tree(Node), Forest)
import Data.Graph(Graph, dfs, edges, buildG, transposeG)
import Data.Maybe (fromJust)
import Data.List (partition,transpose,(\\),nub,findIndex)
import Data.Array ((!),inRange,bounds,assocs)
import Data.Foldable(toList)
{-# LINE 29 "dist/build/InterfacesRules.hs" #-}
import Control.Monad.Identity (Identity)
import qualified Control.Monad.Identity
{-# LINE 53 "src-ag/InterfacesRules.lag" #-}

type VisitSS = [Vertex]
{-# LINE 35 "dist/build/InterfacesRules.hs" #-}

{-# LINE 88 "src-ag/InterfacesRules.lag" #-}

gather :: Info -> [Vertex] -> [[Vertex]]
gather info =  eqClasses comp
               where comp a b = isEqualField (ruleTable info ! a) (ruleTable info ! b)
{-# LINE 42 "dist/build/InterfacesRules.hs" #-}

{-# LINE 129 "src-ag/InterfacesRules.lag" #-}

-- Only non-empty syn will ever be forced, because visits with empty syn are never performed
-- Right hand side synthesized attributes always have a field
cv :: (Vertex -> CRule) -> Int -> Vertex -> ([Vertex],[Vertex]) -> (Vertex,ChildVisit)
cv look n v (inh,syn) =  let  fld = getField (look (head syn))
                              rnt = fromJust (getRhsNt (look (head syn)))
                              d = ChildVisit fld rnt n inh syn
                         in (v,d)
{-# LINE 53 "dist/build/InterfacesRules.hs" #-}

{-# LINE 152 "src-ag/InterfacesRules.lag" #-}

ed :: Vertex -> ([Vertex], [Vertex]) -> [(Vertex, Vertex)]
ed v (inh,syn) = map (\i -> (i,v)) inh ++ map (\s -> (v,s)) syn
{-# LINE 59 "dist/build/InterfacesRules.hs" #-}

{-# LINE 240 "src-ag/InterfacesRules.lag" #-}

postorder :: Tree a -> [a]
postorder (Node a ts) = postorderF ts ++ [a]
postorderF :: Forest a -> [a]
postorderF = concatMap postorder
postOrd :: Graph -> [Vertex] -> [Vertex]
postOrd g = postorderF . dfs g
topSort' :: Graph -> [Vertex] -> [Vertex]
topSort' g = postOrd g
{-# LINE 71 "dist/build/InterfacesRules.hs" #-}

{-# LINE 323 "src-ag/InterfacesRules.lag" #-}

type IntraVisit = [Vertex]
{-# LINE 76 "dist/build/InterfacesRules.hs" #-}

{-# LINE 345 "src-ag/InterfacesRules.lag" #-}

swap :: (a,b) -> (b,a)
swap (a,b) = (b,a)
{-# LINE 82 "dist/build/InterfacesRules.hs" #-}

{-# LINE 420 "src-ag/InterfacesRules.lag" #-}

ccv :: Identifier -> NontermIdent -> Int -> CInterfaceMap -> CRule
ccv name nt n table
  =  CChildVisit name nt n inh syn lst
     where  CInterface segs = Map.findWithDefault (error ("InterfacesRules::ccv::interfaces not in table for nt: " ++ show nt)) nt table
            (seg:remain) = drop n segs
            CSegment inh syn = seg
            lst = null remain
{-# LINE 93 "dist/build/InterfacesRules.hs" #-}
-- IRoot -------------------------------------------------------
-- wrapper
data Inh_IRoot  = Inh_IRoot { dpr_Inh_IRoot :: !([Edge]), info_Inh_IRoot :: !(Info), tdp_Inh_IRoot :: !(Graph) }
data Syn_IRoot  = Syn_IRoot { edp_Syn_IRoot :: !([Edge]), inters_Syn_IRoot :: !(CInterfaceMap), visits_Syn_IRoot :: !(CVisitsMap) }
{-# INLINABLE wrap_IRoot #-}
wrap_IRoot :: T_IRoot  -> Inh_IRoot  -> (Syn_IRoot )
wrap_IRoot !(T_IRoot act) !(Inh_IRoot _lhsIdpr _lhsIinfo _lhsItdp) =
   Control.Monad.Identity.runIdentity (
     do !sem <- act
        let arg1 = T_IRoot_vIn1 _lhsIdpr _lhsIinfo _lhsItdp
        !(T_IRoot_vOut1 _lhsOedp _lhsOinters _lhsOvisits) <- return (inv_IRoot_s2 sem arg1)
        return (Syn_IRoot _lhsOedp _lhsOinters _lhsOvisits)
   )

-- cata
{-# INLINE sem_IRoot #-}
sem_IRoot :: IRoot  -> T_IRoot
sem_IRoot ( IRoot inters_ ) = sem_IRoot_IRoot ( sem_Interfaces inters_ )

-- semantic domain
newtype T_IRoot  = T_IRoot {
                           attach_T_IRoot :: Identity (T_IRoot_s2 )
                           }
newtype T_IRoot_s2  = C_IRoot_s2 {
                                 inv_IRoot_s2 :: (T_IRoot_v1 )
                                 }
data T_IRoot_s3  = C_IRoot_s3
type T_IRoot_v1  = (T_IRoot_vIn1 ) -> (T_IRoot_vOut1 )
data T_IRoot_vIn1  = T_IRoot_vIn1 ([Edge]) (Info) (Graph)
data T_IRoot_vOut1  = T_IRoot_vOut1 ([Edge]) (CInterfaceMap) (CVisitsMap)
{-# NOINLINE sem_IRoot_IRoot #-}
sem_IRoot_IRoot :: T_Interfaces  -> T_IRoot
sem_IRoot_IRoot arg_inters_ = T_IRoot (return st2) where
   {-# NOINLINE st2 #-}
   !st2 = let
      v1 :: T_IRoot_v1
      v1 = \ !(T_IRoot_vIn1 _lhsIdpr _lhsIinfo _lhsItdp) -> ( let
         _intersX8 = Control.Monad.Identity.runIdentity (attach_T_Interfaces (arg_inters_))
         (T_Interfaces_vOut7 _intersIdescr _intersIedp _intersIfirstvisitvertices _intersIinters _intersInewedges _intersIv _intersIvisits) = inv_Interfaces_s8 _intersX8 (T_Interfaces_vIn7 _intersOallInters _intersOddp _intersOinfo _intersOprev _intersOv _intersOvisitDescr _intersOvssGraph)
         _newedges = rule0 _intersInewedges
         _visitssGraph = rule1 _intersIv _lhsItdp _newedges
         _intersOv = rule2 _lhsItdp
         _intersOvisitDescr = rule3 _descr
         _descr = rule4 _intersIdescr
         _intersOvssGraph = rule5 _visitssGraph
         _intersOprev = rule6 _intersIfirstvisitvertices _lhsIinfo
         _intersOddp = rule7 _intersIv _lhsIdpr _newedges
         _intersOallInters = rule8 _intersIinters
         _lhsOedp :: [Edge]
         _lhsOedp = rule9 _intersIedp
         _lhsOinters :: CInterfaceMap
         _lhsOinters = rule10 _intersIinters
         _lhsOvisits :: CVisitsMap
         _lhsOvisits = rule11 _intersIvisits
         _intersOinfo = rule12 _lhsIinfo
         !__result_ = T_IRoot_vOut1 _lhsOedp _lhsOinters _lhsOvisits
         in __result_ )
     in C_IRoot_s2 v1
   {-# INLINE rule0 #-}
   {-# LINE 66 "src-ag/InterfacesRules.lag" #-}
   rule0 = \ ((_intersInewedges) :: Seq Edge ) ->
                            {-# LINE 66 "src-ag/InterfacesRules.lag" #-}
                            toList _intersInewedges
                            {-# LINE 157 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule1 #-}
   {-# LINE 67 "src-ag/InterfacesRules.lag" #-}
   rule1 = \ ((_intersIv) :: Vertex) ((_lhsItdp) :: Graph) _newedges ->
                                 {-# LINE 67 "src-ag/InterfacesRules.lag" #-}
                                 let graph = buildG (0,_intersIv-1) es
                                     es = _newedges ++ edges _lhsItdp
                                 in transposeG graph
                                 {-# LINE 165 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule2 #-}
   {-# LINE 80 "src-ag/InterfacesRules.lag" #-}
   rule2 = \ ((_lhsItdp) :: Graph) ->
                        {-# LINE 80 "src-ag/InterfacesRules.lag" #-}
                        snd (bounds _lhsItdp) + 1
                        {-# LINE 171 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule3 #-}
   {-# LINE 122 "src-ag/InterfacesRules.lag" #-}
   rule3 = \ _descr ->
                                  {-# LINE 122 "src-ag/InterfacesRules.lag" #-}
                                  Map.fromList _descr
                                  {-# LINE 177 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule4 #-}
   {-# LINE 142 "src-ag/InterfacesRules.lag" #-}
   rule4 = \ ((_intersIdescr) :: Seq (Vertex,ChildVisit)) ->
                         {-# LINE 142 "src-ag/InterfacesRules.lag" #-}
                         toList _intersIdescr
                         {-# LINE 183 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule5 #-}
   {-# LINE 214 "src-ag/InterfacesRules.lag" #-}
   rule5 = \ _visitssGraph ->
                               {-# LINE 214 "src-ag/InterfacesRules.lag" #-}
                               _visitssGraph
                               {-# LINE 189 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule6 #-}
   {-# LINE 260 "src-ag/InterfacesRules.lag" #-}
   rule6 = \ ((_intersIfirstvisitvertices) :: [Vertex]) ((_lhsIinfo) :: Info) ->
                            {-# LINE 260 "src-ag/InterfacesRules.lag" #-}
                            let terminals = [ v | (v,cr) <- assocs (ruleTable _lhsIinfo), not (getHasCode cr), isLocal cr ]
                            in _intersIfirstvisitvertices ++ terminals
                            {-# LINE 196 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule7 #-}
   {-# LINE 343 "src-ag/InterfacesRules.lag" #-}
   rule7 = \ ((_intersIv) :: Vertex) ((_lhsIdpr) :: [Edge]) _newedges ->
                          {-# LINE 343 "src-ag/InterfacesRules.lag" #-}
                          buildG (0,_intersIv-1) (map swap (_lhsIdpr ++ _newedges))
                          {-# LINE 202 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule8 #-}
   {-# LINE 381 "src-ag/InterfacesRules.lag" #-}
   rule8 = \ ((_intersIinters) :: CInterfaceMap) ->
                                 {-# LINE 381 "src-ag/InterfacesRules.lag" #-}
                                 _intersIinters
                                 {-# LINE 208 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule9 #-}
   {-# LINE 443 "src-ag/InterfacesRules.lag" #-}
   rule9 = \ ((_intersIedp) :: Seq Edge) ->
                        {-# LINE 443 "src-ag/InterfacesRules.lag" #-}
                        toList _intersIedp
                        {-# LINE 214 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule10 #-}
   rule10 = \ ((_intersIinters) :: CInterfaceMap) ->
     _intersIinters
   {-# INLINE rule11 #-}
   rule11 = \ ((_intersIvisits) :: CVisitsMap) ->
     _intersIvisits
   {-# INLINE rule12 #-}
   rule12 = \ ((_lhsIinfo) :: Info) ->
     _lhsIinfo

-- Interface ---------------------------------------------------
-- wrapper
data Inh_Interface  = Inh_Interface { allInters_Inh_Interface :: !(CInterfaceMap), ddp_Inh_Interface :: !(Graph), info_Inh_Interface :: !(Info), prev_Inh_Interface :: !([Vertex]), v_Inh_Interface :: !(Vertex), visitDescr_Inh_Interface :: !(Map Vertex ChildVisit), vssGraph_Inh_Interface :: !(Graph) }
data Syn_Interface  = Syn_Interface { descr_Syn_Interface :: !(Seq (Vertex,ChildVisit)), edp_Syn_Interface :: !(Seq Edge), firstvisitvertices_Syn_Interface :: !([Vertex]), inter_Syn_Interface :: !(CInterface), newedges_Syn_Interface :: !(Seq Edge ), nt_Syn_Interface :: !(NontermIdent), v_Syn_Interface :: !(Vertex), visits_Syn_Interface :: !(Map ConstructorIdent CVisits) }
{-# INLINABLE wrap_Interface #-}
wrap_Interface :: T_Interface  -> Inh_Interface  -> (Syn_Interface )
wrap_Interface !(T_Interface act) !(Inh_Interface _lhsIallInters _lhsIddp _lhsIinfo _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) =
   Control.Monad.Identity.runIdentity (
     do !sem <- act
        let arg4 = T_Interface_vIn4 _lhsIallInters _lhsIddp _lhsIinfo _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph
        !(T_Interface_vOut4 _lhsOdescr _lhsOedp _lhsOfirstvisitvertices _lhsOinter _lhsOnewedges _lhsOnt _lhsOv _lhsOvisits) <- return (inv_Interface_s5 sem arg4)
        return (Syn_Interface _lhsOdescr _lhsOedp _lhsOfirstvisitvertices _lhsOinter _lhsOnewedges _lhsOnt _lhsOv _lhsOvisits)
   )

-- cata
{-# INLINE sem_Interface #-}
sem_Interface :: Interface  -> T_Interface
sem_Interface ( Interface !nt_ !cons_ seg_ ) = sem_Interface_Interface nt_ cons_ ( sem_Segments seg_ )

-- semantic domain
newtype T_Interface  = T_Interface {
                                   attach_T_Interface :: Identity (T_Interface_s5 )
                                   }
newtype T_Interface_s5  = C_Interface_s5 {
                                         inv_Interface_s5 :: (T_Interface_v4 )
                                         }
data T_Interface_s6  = C_Interface_s6
type T_Interface_v4  = (T_Interface_vIn4 ) -> (T_Interface_vOut4 )
data T_Interface_vIn4  = T_Interface_vIn4 (CInterfaceMap) (Graph) (Info) ([Vertex]) (Vertex) (Map Vertex ChildVisit) (Graph)
data T_Interface_vOut4  = T_Interface_vOut4 (Seq (Vertex,ChildVisit)) (Seq Edge) ([Vertex]) (CInterface) (Seq Edge ) (NontermIdent) (Vertex) (Map ConstructorIdent CVisits)
{-# NOINLINE sem_Interface_Interface #-}
sem_Interface_Interface :: (NontermIdent) -> ([ConstructorIdent]) -> T_Segments  -> T_Interface
sem_Interface_Interface !arg_nt_ !arg_cons_ arg_seg_ = T_Interface (return st5) where
   {-# NOINLINE st5 #-}
   !st5 = let
      v4 :: T_Interface_v4
      v4 = \ !(T_Interface_vIn4 _lhsIallInters _lhsIddp _lhsIinfo _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) -> ( let
         _segX14 = Control.Monad.Identity.runIdentity (attach_T_Segments (arg_seg_))
         (T_Segments_vOut13 _segIcvisits _segIdescr _segIedp _segIfirstInh _segIgroups _segIhdIntravisits _segInewedges _segInewvertices _segIprev _segIsegs _segIv) = inv_Segments_s14 _segX14 (T_Segments_vIn13 _segOallInters _segOcons _segOddp _segOfromLhs _segOinfo _segOisFirst _segOn _segOprev _segOv _segOvisitDescr _segOvssGraph)
         _segOv = rule13 _lhsIv
         _v = rule14 _segInewvertices _segIv
         _lhsOv :: Vertex
         _lhsOv = rule15 _v
         _firstvisitvertices = rule16 _segIv _v
         _newedges = rule17 _firstvisitvertices _segInewvertices
         _lhsOnewedges :: Seq Edge
         _lhsOnewedges = rule18 _newedges _segInewedges
         _look :: Vertex -> CRule
         _look = rule19 _lhsIinfo
         _descr = rule20 _firstvisitvertices _look _segIgroups
         _lhsOdescr :: Seq (Vertex,ChildVisit)
         _lhsOdescr = rule21 _descr _segIdescr
         _segOn = rule22  ()
         _segOcons = rule23 arg_cons_
         _segOisFirst = rule24  ()
         _segOfromLhs = rule25 _lhsIprev
         _lhsOnt :: NontermIdent
         _lhsOnt = rule26 arg_nt_
         _lhsOinter :: CInterface
         _lhsOinter = rule27 _segIsegs
         _lhsOvisits :: Map ConstructorIdent CVisits
         _lhsOvisits = rule28 _segIcvisits arg_cons_
         _lhsOedp :: Seq Edge
         _lhsOedp = rule29 _segIedp
         _lhsOfirstvisitvertices :: [Vertex]
         _lhsOfirstvisitvertices = rule30 _firstvisitvertices
         _segOallInters = rule31 _lhsIallInters
         _segOddp = rule32 _lhsIddp
         _segOinfo = rule33 _lhsIinfo
         _segOprev = rule34 _lhsIprev
         _segOvisitDescr = rule35 _lhsIvisitDescr
         _segOvssGraph = rule36 _lhsIvssGraph
         !__result_ = T_Interface_vOut4 _lhsOdescr _lhsOedp _lhsOfirstvisitvertices _lhsOinter _lhsOnewedges _lhsOnt _lhsOv _lhsOvisits
         in __result_ )
     in C_Interface_s5 v4
   {-# INLINE rule13 #-}
   {-# LINE 183 "src-ag/InterfacesRules.lag" #-}
   rule13 = \ ((_lhsIv) :: Vertex) ->
                          {-# LINE 183 "src-ag/InterfacesRules.lag" #-}
                          _lhsIv
                          {-# LINE 305 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule14 #-}
   {-# LINE 184 "src-ag/InterfacesRules.lag" #-}
   rule14 = \ ((_segInewvertices) :: [Vertex]) ((_segIv) :: Vertex) ->
                          {-# LINE 184 "src-ag/InterfacesRules.lag" #-}
                          _segIv + length _segInewvertices
                          {-# LINE 311 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule15 #-}
   {-# LINE 185 "src-ag/InterfacesRules.lag" #-}
   rule15 = \ _v ->
                          {-# LINE 185 "src-ag/InterfacesRules.lag" #-}
                          _v
                          {-# LINE 317 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule16 #-}
   {-# LINE 186 "src-ag/InterfacesRules.lag" #-}
   rule16 = \ ((_segIv) :: Vertex) _v ->
                                           {-# LINE 186 "src-ag/InterfacesRules.lag" #-}
                                           [_segIv .. _v-1]
                                           {-# LINE 323 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule17 #-}
   {-# LINE 187 "src-ag/InterfacesRules.lag" #-}
   rule17 = \ _firstvisitvertices ((_segInewvertices) :: [Vertex]) ->
                                 {-# LINE 187 "src-ag/InterfacesRules.lag" #-}
                                 zip _firstvisitvertices _segInewvertices
                                 {-# LINE 329 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule18 #-}
   {-# LINE 188 "src-ag/InterfacesRules.lag" #-}
   rule18 = \ _newedges ((_segInewedges) :: Seq Edge ) ->
                                 {-# LINE 188 "src-ag/InterfacesRules.lag" #-}
                                 _segInewedges Seq.>< Seq.fromList _newedges
                                 {-# LINE 335 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule19 #-}
   {-# LINE 191 "src-ag/InterfacesRules.lag" #-}
   rule19 = \ ((_lhsIinfo) :: Info) ->
                             {-# LINE 191 "src-ag/InterfacesRules.lag" #-}
                             \a -> ruleTable _lhsIinfo ! a
                             {-# LINE 341 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule20 #-}
   {-# LINE 192 "src-ag/InterfacesRules.lag" #-}
   rule20 = \ _firstvisitvertices ((_look) :: Vertex -> CRule) ((_segIgroups) :: [([Vertex],[Vertex])]) ->
                              {-# LINE 192 "src-ag/InterfacesRules.lag" #-}
                              zipWith (cv _look (-1)) _firstvisitvertices _segIgroups
                              {-# LINE 347 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule21 #-}
   {-# LINE 193 "src-ag/InterfacesRules.lag" #-}
   rule21 = \ _descr ((_segIdescr) :: Seq (Vertex,ChildVisit)) ->
                              {-# LINE 193 "src-ag/InterfacesRules.lag" #-}
                              _segIdescr Seq.>< Seq.fromList _descr
                              {-# LINE 353 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule22 #-}
   {-# LINE 201 "src-ag/InterfacesRules.lag" #-}
   rule22 = \  (_ :: ()) ->
                         {-# LINE 201 "src-ag/InterfacesRules.lag" #-}
                         0
                         {-# LINE 359 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule23 #-}
   {-# LINE 233 "src-ag/InterfacesRules.lag" #-}
   rule23 = \ cons_ ->
                            {-# LINE 233 "src-ag/InterfacesRules.lag" #-}
                            cons_
                            {-# LINE 365 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule24 #-}
   {-# LINE 314 "src-ag/InterfacesRules.lag" #-}
   rule24 = \  (_ :: ()) ->
                               {-# LINE 314 "src-ag/InterfacesRules.lag" #-}
                               True
                               {-# LINE 371 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule25 #-}
   {-# LINE 352 "src-ag/InterfacesRules.lag" #-}
   rule25 = \ ((_lhsIprev) :: [Vertex]) ->
                               {-# LINE 352 "src-ag/InterfacesRules.lag" #-}
                               _lhsIprev
                               {-# LINE 377 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule26 #-}
   {-# LINE 392 "src-ag/InterfacesRules.lag" #-}
   rule26 = \ nt_ ->
                          {-# LINE 392 "src-ag/InterfacesRules.lag" #-}
                          nt_
                          {-# LINE 383 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule27 #-}
   {-# LINE 396 "src-ag/InterfacesRules.lag" #-}
   rule27 = \ ((_segIsegs) :: CSegments) ->
                              {-# LINE 396 "src-ag/InterfacesRules.lag" #-}
                              CInterface _segIsegs
                              {-# LINE 389 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule28 #-}
   {-# LINE 397 "src-ag/InterfacesRules.lag" #-}
   rule28 = \ ((_segIcvisits) :: [[CVisit]]) cons_ ->
                               {-# LINE 397 "src-ag/InterfacesRules.lag" #-}
                               Map.fromList (zip cons_ (transpose _segIcvisits))
                               {-# LINE 395 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule29 #-}
   rule29 = \ ((_segIedp) :: Seq Edge) ->
     _segIedp
   {-# INLINE rule30 #-}
   rule30 = \ _firstvisitvertices ->
     _firstvisitvertices
   {-# INLINE rule31 #-}
   rule31 = \ ((_lhsIallInters) :: CInterfaceMap) ->
     _lhsIallInters
   {-# INLINE rule32 #-}
   rule32 = \ ((_lhsIddp) :: Graph) ->
     _lhsIddp
   {-# INLINE rule33 #-}
   rule33 = \ ((_lhsIinfo) :: Info) ->
     _lhsIinfo
   {-# INLINE rule34 #-}
   rule34 = \ ((_lhsIprev) :: [Vertex]) ->
     _lhsIprev
   {-# INLINE rule35 #-}
   rule35 = \ ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ->
     _lhsIvisitDescr
   {-# INLINE rule36 #-}
   rule36 = \ ((_lhsIvssGraph) :: Graph) ->
     _lhsIvssGraph

-- Interfaces --------------------------------------------------
-- wrapper
data Inh_Interfaces  = Inh_Interfaces { allInters_Inh_Interfaces :: !(CInterfaceMap), ddp_Inh_Interfaces :: !(Graph), info_Inh_Interfaces :: !(Info), prev_Inh_Interfaces :: !([Vertex]), v_Inh_Interfaces :: !(Vertex), visitDescr_Inh_Interfaces :: !(Map Vertex ChildVisit), vssGraph_Inh_Interfaces :: !(Graph) }
data Syn_Interfaces  = Syn_Interfaces { descr_Syn_Interfaces :: !(Seq (Vertex,ChildVisit)), edp_Syn_Interfaces :: !(Seq Edge), firstvisitvertices_Syn_Interfaces :: !([Vertex]), inters_Syn_Interfaces :: !(CInterfaceMap), newedges_Syn_Interfaces :: !(Seq Edge ), v_Syn_Interfaces :: !(Vertex), visits_Syn_Interfaces :: !(CVisitsMap) }
{-# INLINABLE wrap_Interfaces #-}
wrap_Interfaces :: T_Interfaces  -> Inh_Interfaces  -> (Syn_Interfaces )
wrap_Interfaces !(T_Interfaces act) !(Inh_Interfaces _lhsIallInters _lhsIddp _lhsIinfo _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) =
   Control.Monad.Identity.runIdentity (
     do !sem <- act
        let arg7 = T_Interfaces_vIn7 _lhsIallInters _lhsIddp _lhsIinfo _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph
        !(T_Interfaces_vOut7 _lhsOdescr _lhsOedp _lhsOfirstvisitvertices _lhsOinters _lhsOnewedges _lhsOv _lhsOvisits) <- return (inv_Interfaces_s8 sem arg7)
        return (Syn_Interfaces _lhsOdescr _lhsOedp _lhsOfirstvisitvertices _lhsOinters _lhsOnewedges _lhsOv _lhsOvisits)
   )

-- cata
{-# NOINLINE sem_Interfaces #-}
sem_Interfaces :: Interfaces  -> T_Interfaces
sem_Interfaces list = Prelude.foldr sem_Interfaces_Cons sem_Interfaces_Nil (Prelude.map sem_Interface list)

-- semantic domain
newtype T_Interfaces  = T_Interfaces {
                                     attach_T_Interfaces :: Identity (T_Interfaces_s8 )
                                     }
newtype T_Interfaces_s8  = C_Interfaces_s8 {
                                           inv_Interfaces_s8 :: (T_Interfaces_v7 )
                                           }
data T_Interfaces_s9  = C_Interfaces_s9
type T_Interfaces_v7  = (T_Interfaces_vIn7 ) -> (T_Interfaces_vOut7 )
data T_Interfaces_vIn7  = T_Interfaces_vIn7 (CInterfaceMap) (Graph) (Info) ([Vertex]) (Vertex) (Map Vertex ChildVisit) (Graph)
data T_Interfaces_vOut7  = T_Interfaces_vOut7 (Seq (Vertex,ChildVisit)) (Seq Edge) ([Vertex]) (CInterfaceMap) (Seq Edge ) (Vertex) (CVisitsMap)
{-# NOINLINE sem_Interfaces_Cons #-}
sem_Interfaces_Cons :: T_Interface  -> T_Interfaces  -> T_Interfaces
sem_Interfaces_Cons arg_hd_ arg_tl_ = T_Interfaces (return st8) where
   {-# NOINLINE st8 #-}
   !st8 = let
      v7 :: T_Interfaces_v7
      v7 = \ !(T_Interfaces_vIn7 _lhsIallInters _lhsIddp _lhsIinfo _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) -> ( let
         _hdX5 = Control.Monad.Identity.runIdentity (attach_T_Interface (arg_hd_))
         _tlX8 = Control.Monad.Identity.runIdentity (attach_T_Interfaces (arg_tl_))
         (T_Interface_vOut4 _hdIdescr _hdIedp _hdIfirstvisitvertices _hdIinter _hdInewedges _hdInt _hdIv _hdIvisits) = inv_Interface_s5 _hdX5 (T_Interface_vIn4 _hdOallInters _hdOddp _hdOinfo _hdOprev _hdOv _hdOvisitDescr _hdOvssGraph)
         (T_Interfaces_vOut7 _tlIdescr _tlIedp _tlIfirstvisitvertices _tlIinters _tlInewedges _tlIv _tlIvisits) = inv_Interfaces_s8 _tlX8 (T_Interfaces_vIn7 _tlOallInters _tlOddp _tlOinfo _tlOprev _tlOv _tlOvisitDescr _tlOvssGraph)
         _lhsOinters :: CInterfaceMap
         _lhsOinters = rule37 _hdIinter _hdInt _tlIinters
         _lhsOvisits :: CVisitsMap
         _lhsOvisits = rule38 _hdInt _hdIvisits _tlIvisits
         _lhsOdescr :: Seq (Vertex,ChildVisit)
         _lhsOdescr = rule39 _hdIdescr _tlIdescr
         _lhsOedp :: Seq Edge
         _lhsOedp = rule40 _hdIedp _tlIedp
         _lhsOfirstvisitvertices :: [Vertex]
         _lhsOfirstvisitvertices = rule41 _hdIfirstvisitvertices _tlIfirstvisitvertices
         _lhsOnewedges :: Seq Edge
         _lhsOnewedges = rule42 _hdInewedges _tlInewedges
         _lhsOv :: Vertex
         _lhsOv = rule43 _tlIv
         _hdOallInters = rule44 _lhsIallInters
         _hdOddp = rule45 _lhsIddp
         _hdOinfo = rule46 _lhsIinfo
         _hdOprev = rule47 _lhsIprev
         _hdOv = rule48 _lhsIv
         _hdOvisitDescr = rule49 _lhsIvisitDescr
         _hdOvssGraph = rule50 _lhsIvssGraph
         _tlOallInters = rule51 _lhsIallInters
         _tlOddp = rule52 _lhsIddp
         _tlOinfo = rule53 _lhsIinfo
         _tlOprev = rule54 _lhsIprev
         _tlOv = rule55 _hdIv
         _tlOvisitDescr = rule56 _lhsIvisitDescr
         _tlOvssGraph = rule57 _lhsIvssGraph
         !__result_ = T_Interfaces_vOut7 _lhsOdescr _lhsOedp _lhsOfirstvisitvertices _lhsOinters _lhsOnewedges _lhsOv _lhsOvisits
         in __result_ )
     in C_Interfaces_s8 v7
   {-# INLINE rule37 #-}
   {-# LINE 386 "src-ag/InterfacesRules.lag" #-}
   rule37 = \ ((_hdIinter) :: CInterface) ((_hdInt) :: NontermIdent) ((_tlIinters) :: CInterfaceMap) ->
                          {-# LINE 386 "src-ag/InterfacesRules.lag" #-}
                          Map.insert _hdInt _hdIinter _tlIinters
                          {-# LINE 498 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule38 #-}
   {-# LINE 387 "src-ag/InterfacesRules.lag" #-}
   rule38 = \ ((_hdInt) :: NontermIdent) ((_hdIvisits) :: Map ConstructorIdent CVisits) ((_tlIvisits) :: CVisitsMap) ->
                          {-# LINE 387 "src-ag/InterfacesRules.lag" #-}
                          Map.insert _hdInt _hdIvisits _tlIvisits
                          {-# LINE 504 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule39 #-}
   rule39 = \ ((_hdIdescr) :: Seq (Vertex,ChildVisit)) ((_tlIdescr) :: Seq (Vertex,ChildVisit)) ->
     _hdIdescr Seq.>< _tlIdescr
   {-# INLINE rule40 #-}
   rule40 = \ ((_hdIedp) :: Seq Edge) ((_tlIedp) :: Seq Edge) ->
     _hdIedp Seq.>< _tlIedp
   {-# INLINE rule41 #-}
   rule41 = \ ((_hdIfirstvisitvertices) :: [Vertex]) ((_tlIfirstvisitvertices) :: [Vertex]) ->
     _hdIfirstvisitvertices ++ _tlIfirstvisitvertices
   {-# INLINE rule42 #-}
   rule42 = \ ((_hdInewedges) :: Seq Edge ) ((_tlInewedges) :: Seq Edge ) ->
     _hdInewedges Seq.>< _tlInewedges
   {-# INLINE rule43 #-}
   rule43 = \ ((_tlIv) :: Vertex) ->
     _tlIv
   {-# INLINE rule44 #-}
   rule44 = \ ((_lhsIallInters) :: CInterfaceMap) ->
     _lhsIallInters
   {-# INLINE rule45 #-}
   rule45 = \ ((_lhsIddp) :: Graph) ->
     _lhsIddp
   {-# INLINE rule46 #-}
   rule46 = \ ((_lhsIinfo) :: Info) ->
     _lhsIinfo
   {-# INLINE rule47 #-}
   rule47 = \ ((_lhsIprev) :: [Vertex]) ->
     _lhsIprev
   {-# INLINE rule48 #-}
   rule48 = \ ((_lhsIv) :: Vertex) ->
     _lhsIv
   {-# INLINE rule49 #-}
   rule49 = \ ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ->
     _lhsIvisitDescr
   {-# INLINE rule50 #-}
   rule50 = \ ((_lhsIvssGraph) :: Graph) ->
     _lhsIvssGraph
   {-# INLINE rule51 #-}
   rule51 = \ ((_lhsIallInters) :: CInterfaceMap) ->
     _lhsIallInters
   {-# INLINE rule52 #-}
   rule52 = \ ((_lhsIddp) :: Graph) ->
     _lhsIddp
   {-# INLINE rule53 #-}
   rule53 = \ ((_lhsIinfo) :: Info) ->
     _lhsIinfo
   {-# INLINE rule54 #-}
   rule54 = \ ((_lhsIprev) :: [Vertex]) ->
     _lhsIprev
   {-# INLINE rule55 #-}
   rule55 = \ ((_hdIv) :: Vertex) ->
     _hdIv
   {-# INLINE rule56 #-}
   rule56 = \ ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ->
     _lhsIvisitDescr
   {-# INLINE rule57 #-}
   rule57 = \ ((_lhsIvssGraph) :: Graph) ->
     _lhsIvssGraph
{-# NOINLINE sem_Interfaces_Nil #-}
sem_Interfaces_Nil ::  T_Interfaces
sem_Interfaces_Nil  = T_Interfaces (return st8) where
   {-# NOINLINE st8 #-}
   !st8 = let
      v7 :: T_Interfaces_v7
      v7 = \ !(T_Interfaces_vIn7 _lhsIallInters _lhsIddp _lhsIinfo _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) -> ( let
         _lhsOinters :: CInterfaceMap
         _lhsOinters = rule58  ()
         _lhsOvisits :: CVisitsMap
         _lhsOvisits = rule59  ()
         _lhsOdescr :: Seq (Vertex,ChildVisit)
         _lhsOdescr = rule60  ()
         _lhsOedp :: Seq Edge
         _lhsOedp = rule61  ()
         _lhsOfirstvisitvertices :: [Vertex]
         _lhsOfirstvisitvertices = rule62  ()
         _lhsOnewedges :: Seq Edge
         _lhsOnewedges = rule63  ()
         _lhsOv :: Vertex
         _lhsOv = rule64 _lhsIv
         !__result_ = T_Interfaces_vOut7 _lhsOdescr _lhsOedp _lhsOfirstvisitvertices _lhsOinters _lhsOnewedges _lhsOv _lhsOvisits
         in __result_ )
     in C_Interfaces_s8 v7
   {-# INLINE rule58 #-}
   {-# LINE 388 "src-ag/InterfacesRules.lag" #-}
   rule58 = \  (_ :: ()) ->
                          {-# LINE 388 "src-ag/InterfacesRules.lag" #-}
                          Map.empty
                          {-# LINE 591 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule59 #-}
   {-# LINE 389 "src-ag/InterfacesRules.lag" #-}
   rule59 = \  (_ :: ()) ->
                          {-# LINE 389 "src-ag/InterfacesRules.lag" #-}
                          Map.empty
                          {-# LINE 597 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule60 #-}
   rule60 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule61 #-}
   rule61 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule62 #-}
   rule62 = \  (_ :: ()) ->
     []
   {-# INLINE rule63 #-}
   rule63 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule64 #-}
   rule64 = \ ((_lhsIv) :: Vertex) ->
     _lhsIv

-- Segment -----------------------------------------------------
-- wrapper
data Inh_Segment  = Inh_Segment { allInters_Inh_Segment :: !(CInterfaceMap), cons_Inh_Segment :: !([ConstructorIdent]), ddp_Inh_Segment :: !(Graph), fromLhs_Inh_Segment :: !([Vertex]), info_Inh_Segment :: !(Info), isFirst_Inh_Segment :: !(Bool), n_Inh_Segment :: !(Int), nextInh_Inh_Segment :: !([Vertex]), nextIntravisits_Inh_Segment :: !([IntraVisit]), nextNewvertices_Inh_Segment :: !([Vertex]), prev_Inh_Segment :: !([Vertex]), v_Inh_Segment :: !(Vertex), visitDescr_Inh_Segment :: !(Map Vertex ChildVisit), vssGraph_Inh_Segment :: !(Graph) }
data Syn_Segment  = Syn_Segment { cvisits_Syn_Segment :: !([CVisit]), descr_Syn_Segment :: !(Seq (Vertex,ChildVisit)), edp_Syn_Segment :: !(Seq Edge), groups_Syn_Segment :: !([([Vertex],[Vertex])]), inh_Syn_Segment :: !([Vertex]), intravisits_Syn_Segment :: !([IntraVisit]), newedges_Syn_Segment :: !(Seq Edge ), newvertices_Syn_Segment :: !([Vertex]), prev_Syn_Segment :: !([Vertex]), seg_Syn_Segment :: !(CSegment), v_Syn_Segment :: !(Vertex), visitss_Syn_Segment :: !([VisitSS]) }
{-# INLINABLE wrap_Segment #-}
wrap_Segment :: T_Segment  -> Inh_Segment  -> (Syn_Segment )
wrap_Segment !(T_Segment act) !(Inh_Segment _lhsIallInters _lhsIcons _lhsIddp _lhsIfromLhs _lhsIinfo _lhsIisFirst _lhsIn _lhsInextInh _lhsInextIntravisits _lhsInextNewvertices _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) =
   Control.Monad.Identity.runIdentity (
     do !sem <- act
        let arg10 = T_Segment_vIn10 _lhsIallInters _lhsIcons _lhsIddp _lhsIfromLhs _lhsIinfo _lhsIisFirst _lhsIn _lhsInextInh _lhsInextIntravisits _lhsInextNewvertices _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph
        !(T_Segment_vOut10 _lhsOcvisits _lhsOdescr _lhsOedp _lhsOgroups _lhsOinh _lhsOintravisits _lhsOnewedges _lhsOnewvertices _lhsOprev _lhsOseg _lhsOv _lhsOvisitss) <- return (inv_Segment_s11 sem arg10)
        return (Syn_Segment _lhsOcvisits _lhsOdescr _lhsOedp _lhsOgroups _lhsOinh _lhsOintravisits _lhsOnewedges _lhsOnewvertices _lhsOprev _lhsOseg _lhsOv _lhsOvisitss)
   )

-- cata
{-# INLINE sem_Segment #-}
sem_Segment :: Segment  -> T_Segment
sem_Segment ( Segment !inh_ !syn_ ) = sem_Segment_Segment inh_ syn_

-- semantic domain
newtype T_Segment  = T_Segment {
                               attach_T_Segment :: Identity (T_Segment_s11 )
                               }
newtype T_Segment_s11  = C_Segment_s11 {
                                       inv_Segment_s11 :: (T_Segment_v10 )
                                       }
data T_Segment_s12  = C_Segment_s12
type T_Segment_v10  = (T_Segment_vIn10 ) -> (T_Segment_vOut10 )
data T_Segment_vIn10  = T_Segment_vIn10 (CInterfaceMap) ([ConstructorIdent]) (Graph) ([Vertex]) (Info) (Bool) (Int) ([Vertex]) ([IntraVisit]) ([Vertex]) ([Vertex]) (Vertex) (Map Vertex ChildVisit) (Graph)
data T_Segment_vOut10  = T_Segment_vOut10 ([CVisit]) (Seq (Vertex,ChildVisit)) (Seq Edge) ([([Vertex],[Vertex])]) ([Vertex]) ([IntraVisit]) (Seq Edge ) ([Vertex]) ([Vertex]) (CSegment) (Vertex) ([VisitSS])
{-# NOINLINE sem_Segment_Segment #-}
sem_Segment_Segment :: ([Vertex]) -> ([Vertex]) -> T_Segment
sem_Segment_Segment !arg_inh_ !arg_syn_ = T_Segment (return st11) where
   {-# NOINLINE st11 #-}
   !st11 = let
      v10 :: T_Segment_v10
      v10 = \ !(T_Segment_vIn10 _lhsIallInters _lhsIcons _lhsIddp _lhsIfromLhs _lhsIinfo _lhsIisFirst _lhsIn _lhsInextInh _lhsInextIntravisits _lhsInextNewvertices _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) -> ( let
         _look :: Vertex -> CRule
         _look = rule65 _lhsIinfo
         _occurAs :: (CRule -> Bool) -> [Vertex] -> [Vertex]
         _occurAs = rule66 _lhsIinfo _look
         _groups :: [([Vertex],[Vertex])]
         _groups = rule67 _lhsIinfo _look _occurAs arg_inh_ arg_syn_
         _v :: Int
         _v = rule68 _groups _lhsIv
         _newvertices = rule69 _lhsIv _v
         _lhsOdescr :: Seq (Vertex,ChildVisit)
         _lhsOdescr = rule70 _groups _lhsIn _look _newvertices
         _attredges = rule71 _groups _newvertices
         _visitedges = rule72 _lhsInextNewvertices _newvertices
         _lhsOnewedges :: Seq Edge
         _lhsOnewedges = rule73 _attredges _visitedges
         _synOccur = rule74 _lhsIinfo _occurAs arg_syn_
         _vss = rule75 _lhsIcons _lhsIinfo _lhsIvssGraph _synOccur arg_syn_
         _visitss' = rule76 _lhsIprev _vss
         _defined = rule77 _lhsIvisitDescr _visitss
         _lhsOprev :: [Vertex]
         _lhsOprev = rule78 _defined _lhsIprev
         _visitss :: [[Vertex]]
         _visitss = rule79 _lhsIinfo _visitss'
         _fromLhs = rule80 _lhsIfromLhs _occurAs arg_inh_
         _computed = rule81 _lhsIinfo _lhsIvisitDescr _visitss
         _intravisits = rule82 _iv _lhsInextIntravisits _visitss
         _iv = rule83 _computed _fromLhs _lhsIddp
         _lhsOseg :: CSegment
         _lhsOseg = rule84 _inhmap _lhsIprev _lhsIvisitDescr _lhsIvssGraph _synmap
         _inhmap :: Map Identifier Type
         _synmap :: Map Identifier Type
         (_inhmap,_synmap) = rule85 _lhsIinfo arg_inh_ arg_syn_
         _lhsOcvisits :: [CVisit]
         _lhsOcvisits = rule86 _inhmap _intravisits _lhsIallInters _lhsIinfo _lhsIvisitDescr _synmap _visitss
         _lhsOedp :: Seq Edge
         _lhsOedp = rule87 _lhsInextInh arg_inh_ arg_syn_
         _lhsOinh :: [Vertex]
         _lhsOinh = rule88 arg_inh_
         _lhsOgroups :: [([Vertex],[Vertex])]
         _lhsOgroups = rule89 _groups
         _lhsOintravisits :: [IntraVisit]
         _lhsOintravisits = rule90 _intravisits
         _lhsOnewvertices :: [Vertex]
         _lhsOnewvertices = rule91 _newvertices
         _lhsOv :: Vertex
         _lhsOv = rule92 _v
         _lhsOvisitss :: [VisitSS]
         _lhsOvisitss = rule93 _visitss
         !__result_ = T_Segment_vOut10 _lhsOcvisits _lhsOdescr _lhsOedp _lhsOgroups _lhsOinh _lhsOintravisits _lhsOnewedges _lhsOnewvertices _lhsOprev _lhsOseg _lhsOv _lhsOvisitss
         in __result_ )
     in C_Segment_s11 v10
   {-# INLINE rule65 #-}
   {-# LINE 101 "src-ag/InterfacesRules.lag" #-}
   rule65 = \ ((_lhsIinfo) :: Info) ->
                           {-# LINE 101 "src-ag/InterfacesRules.lag" #-}
                           \a -> ruleTable _lhsIinfo ! a
                           {-# LINE 707 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule66 #-}
   {-# LINE 104 "src-ag/InterfacesRules.lag" #-}
   rule66 = \ ((_lhsIinfo) :: Info) ((_look) :: Vertex -> CRule) ->
                              {-# LINE 104 "src-ag/InterfacesRules.lag" #-}
                              \p us -> [ a  |  u <- us
                                            ,  a <- tdsToTdp _lhsIinfo ! u
                                            ,  p (_look a)]
                              {-# LINE 715 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule67 #-}
   {-# LINE 108 "src-ag/InterfacesRules.lag" #-}
   rule67 = \ ((_lhsIinfo) :: Info) ((_look) :: Vertex -> CRule) ((_occurAs) :: (CRule -> Bool) -> [Vertex] -> [Vertex]) inh_ syn_ ->
                              {-# LINE 108 "src-ag/InterfacesRules.lag" #-}
                              let group as = gather _lhsIinfo (_occurAs isRhs as)
                              in map (partition (isInh . _look)) (group (inh_ ++ syn_))
                              {-# LINE 722 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule68 #-}
   {-# LINE 111 "src-ag/InterfacesRules.lag" #-}
   rule68 = \ ((_groups) :: [([Vertex],[Vertex])]) ((_lhsIv) :: Vertex) ->
                        {-# LINE 111 "src-ag/InterfacesRules.lag" #-}
                        _lhsIv + length _groups
                        {-# LINE 728 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule69 #-}
   {-# LINE 112 "src-ag/InterfacesRules.lag" #-}
   rule69 = \ ((_lhsIv) :: Vertex) ((_v) :: Int) ->
                                  {-# LINE 112 "src-ag/InterfacesRules.lag" #-}
                                  [_lhsIv .. _v    -1]
                                  {-# LINE 734 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule70 #-}
   {-# LINE 127 "src-ag/InterfacesRules.lag" #-}
   rule70 = \ ((_groups) :: [([Vertex],[Vertex])]) ((_lhsIn) :: Int) ((_look) :: Vertex -> CRule) _newvertices ->
                            {-# LINE 127 "src-ag/InterfacesRules.lag" #-}
                            Seq.fromList $ zipWith (cv _look _lhsIn) _newvertices _groups
                            {-# LINE 740 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule71 #-}
   {-# LINE 150 "src-ag/InterfacesRules.lag" #-}
   rule71 = \ ((_groups) :: [([Vertex],[Vertex])]) _newvertices ->
                               {-# LINE 150 "src-ag/InterfacesRules.lag" #-}
                               concat (zipWith ed _newvertices _groups)
                               {-# LINE 746 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule72 #-}
   {-# LINE 170 "src-ag/InterfacesRules.lag" #-}
   rule72 = \ ((_lhsInextNewvertices) :: [Vertex]) _newvertices ->
                                 {-# LINE 170 "src-ag/InterfacesRules.lag" #-}
                                 zip _newvertices _lhsInextNewvertices
                                 {-# LINE 752 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule73 #-}
   {-# LINE 171 "src-ag/InterfacesRules.lag" #-}
   rule73 = \ _attredges _visitedges ->
                               {-# LINE 171 "src-ag/InterfacesRules.lag" #-}
                               Seq.fromList _attredges Seq.>< Seq.fromList _visitedges
                               {-# LINE 758 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule74 #-}
   {-# LINE 225 "src-ag/InterfacesRules.lag" #-}
   rule74 = \ ((_lhsIinfo) :: Info) ((_occurAs) :: (CRule -> Bool) -> [Vertex] -> [Vertex]) syn_ ->
                               {-# LINE 225 "src-ag/InterfacesRules.lag" #-}
                               gather _lhsIinfo (_occurAs isLhs syn_)
                               {-# LINE 764 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule75 #-}
   {-# LINE 226 "src-ag/InterfacesRules.lag" #-}
   rule75 = \ ((_lhsIcons) :: [ConstructorIdent]) ((_lhsIinfo) :: Info) ((_lhsIvssGraph) :: Graph) _synOccur syn_ ->
                           {-# LINE 226 "src-ag/InterfacesRules.lag" #-}
                           let hasCode' v | inRange (bounds (ruleTable _lhsIinfo)) v =  getHasCode (ruleTable _lhsIinfo ! v)
                                          | otherwise = True
                           in if  null syn_
                                  then replicate (length _lhsIcons) []
                                  else map (filter hasCode' . topSort' _lhsIvssGraph) _synOccur
                           {-# LINE 774 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule76 #-}
   {-# LINE 270 "src-ag/InterfacesRules.lag" #-}
   rule76 = \ ((_lhsIprev) :: [Vertex]) _vss ->
                               {-# LINE 270 "src-ag/InterfacesRules.lag" #-}
                               map (\\ _lhsIprev) _vss
                               {-# LINE 780 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule77 #-}
   {-# LINE 271 "src-ag/InterfacesRules.lag" #-}
   rule77 = \ ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ((_visitss) :: [[Vertex]]) ->
                               {-# LINE 271 "src-ag/InterfacesRules.lag" #-}
                               let defines v = case Map.lookup v _lhsIvisitDescr of
                                                 Nothing -> [v]
                                                 Just (ChildVisit _ _ _ inh _) -> v:inh
                               in concatMap (concatMap defines) _visitss
                               {-# LINE 789 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule78 #-}
   {-# LINE 275 "src-ag/InterfacesRules.lag" #-}
   rule78 = \ _defined ((_lhsIprev) :: [Vertex]) ->
                           {-# LINE 275 "src-ag/InterfacesRules.lag" #-}
                           _lhsIprev ++ _defined
                           {-# LINE 795 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule79 #-}
   {-# LINE 284 "src-ag/InterfacesRules.lag" #-}
   rule79 = \ ((_lhsIinfo) :: Info) _visitss' ->
                              {-# LINE 284 "src-ag/InterfacesRules.lag" #-}
                              let  rem' :: [(Identifier,Identifier,Maybe Type)] -> [Vertex] -> [Vertex]
                                   rem' _ [] = []
                                   rem' prev (v:vs)
                                     | inRange (bounds table) v
                                         = let  cr = table ! v
                                                addV = case findIndex cmp prev of
                                                         Just _ -> id
                                                         _      -> (v:)
                                                cmp (fld,attr,tp) = getField cr == fld && getAttr cr == attr && sameNT (getType cr) tp
                                                sameNT (Just (NT ntA _ _)) (Just (NT ntB _ _)) = ntA == ntB
                                                sameNT _          _                            = False
                                                def = Map.elems (getDefines cr)
                                           in addV (rem' (def ++ prev) vs)
                                     | otherwise = v:rem' prev vs
                                   table = ruleTable _lhsIinfo
                              in map (rem' []) _visitss'
                              {-# LINE 816 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule80 #-}
   {-# LINE 357 "src-ag/InterfacesRules.lag" #-}
   rule80 = \ ((_lhsIfromLhs) :: [Vertex]) ((_occurAs) :: (CRule -> Bool) -> [Vertex] -> [Vertex]) inh_ ->
                              {-# LINE 357 "src-ag/InterfacesRules.lag" #-}
                              _occurAs isLhs inh_ ++ _lhsIfromLhs
                              {-# LINE 822 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule81 #-}
   {-# LINE 358 "src-ag/InterfacesRules.lag" #-}
   rule81 = \ ((_lhsIinfo) :: Info) ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ((_visitss) :: [[Vertex]]) ->
                                {-# LINE 358 "src-ag/InterfacesRules.lag" #-}
                                let computes v = case Map.lookup v _lhsIvisitDescr of
                                                   Nothing -> Map.keys (getDefines (ruleTable _lhsIinfo ! v))
                                                   Just (ChildVisit _ _ _ _ syn) -> v:syn
                                in concatMap (concatMap computes) _visitss
                                {-# LINE 831 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule82 #-}
   {-# LINE 362 "src-ag/InterfacesRules.lag" #-}
   rule82 = \ _iv ((_lhsInextIntravisits) :: [IntraVisit]) ((_visitss) :: [[Vertex]]) ->
                                  {-# LINE 362 "src-ag/InterfacesRules.lag" #-}
                                  zipWith _iv _visitss _lhsInextIntravisits
                                  {-# LINE 837 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule83 #-}
   {-# LINE 363 "src-ag/InterfacesRules.lag" #-}
   rule83 = \ _computed _fromLhs ((_lhsIddp) :: Graph) ->
                          {-# LINE 363 "src-ag/InterfacesRules.lag" #-}
                          \vs next ->
                            let needed = concatMap (_lhsIddp !) vs
                            in nub (needed ++ next) \\ (_fromLhs ++ _computed)
                          {-# LINE 845 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule84 #-}
   {-# LINE 406 "src-ag/InterfacesRules.lag" #-}
   rule84 = \ ((_inhmap) :: Map Identifier Type) ((_lhsIprev) :: [Vertex]) ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ((_lhsIvssGraph) :: Graph) ((_synmap) :: Map Identifier Type) ->
                          {-# LINE 406 "src-ag/InterfacesRules.lag" #-}
                          if False then undefined _lhsIvssGraph _lhsIvisitDescr _lhsIprev else CSegment _inhmap _synmap
                          {-# LINE 851 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule85 #-}
   {-# LINE 410 "src-ag/InterfacesRules.lag" #-}
   rule85 = \ ((_lhsIinfo) :: Info) inh_ syn_ ->
                                      {-# LINE 410 "src-ag/InterfacesRules.lag" #-}
                                      let makemap = Map.fromList . map findType
                                          findType v = getNtaNameType (attrTable _lhsIinfo ! v)
                                      in (makemap inh_,makemap syn_)
                                      {-# LINE 859 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule86 #-}
   {-# LINE 413 "src-ag/InterfacesRules.lag" #-}
   rule86 = \ ((_inhmap) :: Map Identifier Type) _intravisits ((_lhsIallInters) :: CInterfaceMap) ((_lhsIinfo) :: Info) ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ((_synmap) :: Map Identifier Type) ((_visitss) :: [[Vertex]]) ->
                              {-# LINE 413 "src-ag/InterfacesRules.lag" #-}
                              let  mkVisit vss intra = CVisit _inhmap _synmap (mkSequence vss) (mkSequence intra) True
                                   mkSequence = map mkRule
                                   mkRule v = case Map.lookup v _lhsIvisitDescr of
                                                Nothing -> ruleTable _lhsIinfo ! v
                                                Just (ChildVisit name nt n _ _) -> ccv name nt n _lhsIallInters
                              in zipWith mkVisit _visitss _intravisits
                              {-# LINE 870 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule87 #-}
   {-# LINE 440 "src-ag/InterfacesRules.lag" #-}
   rule87 = \ ((_lhsInextInh) :: [Vertex]) inh_ syn_ ->
                          {-# LINE 440 "src-ag/InterfacesRules.lag" #-}
                          Seq.fromList [(i,s) | i <- inh_, s <- syn_]
                          Seq.>< Seq.fromList [(s,i) | s <- syn_, i <- _lhsInextInh ]
                          {-# LINE 877 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule88 #-}
   {-# LINE 445 "src-ag/InterfacesRules.lag" #-}
   rule88 = \ inh_ ->
                         {-# LINE 445 "src-ag/InterfacesRules.lag" #-}
                         inh_
                         {-# LINE 883 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule89 #-}
   rule89 = \ ((_groups) :: [([Vertex],[Vertex])]) ->
     _groups
   {-# INLINE rule90 #-}
   rule90 = \ _intravisits ->
     _intravisits
   {-# INLINE rule91 #-}
   rule91 = \ _newvertices ->
     _newvertices
   {-# INLINE rule92 #-}
   rule92 = \ ((_v) :: Int) ->
     _v
   {-# INLINE rule93 #-}
   rule93 = \ ((_visitss) :: [[Vertex]]) ->
     _visitss

-- Segments ----------------------------------------------------
-- wrapper
data Inh_Segments  = Inh_Segments { allInters_Inh_Segments :: !(CInterfaceMap), cons_Inh_Segments :: !([ConstructorIdent]), ddp_Inh_Segments :: !(Graph), fromLhs_Inh_Segments :: !([Vertex]), info_Inh_Segments :: !(Info), isFirst_Inh_Segments :: !(Bool), n_Inh_Segments :: !(Int), prev_Inh_Segments :: !([Vertex]), v_Inh_Segments :: !(Vertex), visitDescr_Inh_Segments :: !(Map Vertex ChildVisit), vssGraph_Inh_Segments :: !(Graph) }
data Syn_Segments  = Syn_Segments { cvisits_Syn_Segments :: !([[CVisit]]), descr_Syn_Segments :: !(Seq (Vertex,ChildVisit)), edp_Syn_Segments :: !(Seq Edge), firstInh_Syn_Segments :: !([Vertex]), groups_Syn_Segments :: !([([Vertex],[Vertex])]), hdIntravisits_Syn_Segments :: !([IntraVisit]), newedges_Syn_Segments :: !(Seq Edge ), newvertices_Syn_Segments :: !([Vertex]), prev_Syn_Segments :: !([Vertex]), segs_Syn_Segments :: !(CSegments), v_Syn_Segments :: !(Vertex) }
{-# INLINABLE wrap_Segments #-}
wrap_Segments :: T_Segments  -> Inh_Segments  -> (Syn_Segments )
wrap_Segments !(T_Segments act) !(Inh_Segments _lhsIallInters _lhsIcons _lhsIddp _lhsIfromLhs _lhsIinfo _lhsIisFirst _lhsIn _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) =
   Control.Monad.Identity.runIdentity (
     do !sem <- act
        let arg13 = T_Segments_vIn13 _lhsIallInters _lhsIcons _lhsIddp _lhsIfromLhs _lhsIinfo _lhsIisFirst _lhsIn _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph
        !(T_Segments_vOut13 _lhsOcvisits _lhsOdescr _lhsOedp _lhsOfirstInh _lhsOgroups _lhsOhdIntravisits _lhsOnewedges _lhsOnewvertices _lhsOprev _lhsOsegs _lhsOv) <- return (inv_Segments_s14 sem arg13)
        return (Syn_Segments _lhsOcvisits _lhsOdescr _lhsOedp _lhsOfirstInh _lhsOgroups _lhsOhdIntravisits _lhsOnewedges _lhsOnewvertices _lhsOprev _lhsOsegs _lhsOv)
   )

-- cata
{-# NOINLINE sem_Segments #-}
sem_Segments :: Segments  -> T_Segments
sem_Segments list = Prelude.foldr sem_Segments_Cons sem_Segments_Nil (Prelude.map sem_Segment list)

-- semantic domain
newtype T_Segments  = T_Segments {
                                 attach_T_Segments :: Identity (T_Segments_s14 )
                                 }
newtype T_Segments_s14  = C_Segments_s14 {
                                         inv_Segments_s14 :: (T_Segments_v13 )
                                         }
data T_Segments_s15  = C_Segments_s15
type T_Segments_v13  = (T_Segments_vIn13 ) -> (T_Segments_vOut13 )
data T_Segments_vIn13  = T_Segments_vIn13 (CInterfaceMap) ([ConstructorIdent]) (Graph) ([Vertex]) (Info) (Bool) (Int) ([Vertex]) (Vertex) (Map Vertex ChildVisit) (Graph)
data T_Segments_vOut13  = T_Segments_vOut13 ([[CVisit]]) (Seq (Vertex,ChildVisit)) (Seq Edge) ([Vertex]) ([([Vertex],[Vertex])]) ([IntraVisit]) (Seq Edge ) ([Vertex]) ([Vertex]) (CSegments) (Vertex)
{-# NOINLINE sem_Segments_Cons #-}
sem_Segments_Cons :: T_Segment  -> T_Segments  -> T_Segments
sem_Segments_Cons arg_hd_ arg_tl_ = T_Segments (return st14) where
   {-# NOINLINE st14 #-}
   !st14 = let
      v13 :: T_Segments_v13
      v13 = \ !(T_Segments_vIn13 _lhsIallInters _lhsIcons _lhsIddp _lhsIfromLhs _lhsIinfo _lhsIisFirst _lhsIn _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) -> ( let
         _hdX11 = Control.Monad.Identity.runIdentity (attach_T_Segment (arg_hd_))
         _tlX14 = Control.Monad.Identity.runIdentity (attach_T_Segments (arg_tl_))
         (T_Segment_vOut10 _hdIcvisits _hdIdescr _hdIedp _hdIgroups _hdIinh _hdIintravisits _hdInewedges _hdInewvertices _hdIprev _hdIseg _hdIv _hdIvisitss) = inv_Segment_s11 _hdX11 (T_Segment_vIn10 _hdOallInters _hdOcons _hdOddp _hdOfromLhs _hdOinfo _hdOisFirst _hdOn _hdOnextInh _hdOnextIntravisits _hdOnextNewvertices _hdOprev _hdOv _hdOvisitDescr _hdOvssGraph)
         (T_Segments_vOut13 _tlIcvisits _tlIdescr _tlIedp _tlIfirstInh _tlIgroups _tlIhdIntravisits _tlInewedges _tlInewvertices _tlIprev _tlIsegs _tlIv) = inv_Segments_s14 _tlX14 (T_Segments_vIn13 _tlOallInters _tlOcons _tlOddp _tlOfromLhs _tlOinfo _tlOisFirst _tlOn _tlOprev _tlOv _tlOvisitDescr _tlOvssGraph)
         _hdOnextNewvertices = rule94 _tlInewvertices
         _lhsOnewvertices :: [Vertex]
         _lhsOnewvertices = rule95 _hdInewvertices
         _lhsOgroups :: [([Vertex],[Vertex])]
         _lhsOgroups = rule96 _hdIgroups
         _tlOn = rule97 _lhsIn
         _tlOisFirst = rule98  ()
         _hdOnextIntravisits = rule99 _tlIhdIntravisits
         _lhsOhdIntravisits :: [IntraVisit]
         _lhsOhdIntravisits = rule100 _hdIintravisits
         _hdOfromLhs = rule101 _lhsIfromLhs
         _tlOfromLhs = rule102  ()
         _lhsOsegs :: CSegments
         _lhsOsegs = rule103 _hdIseg _tlIsegs
         _hdOnextInh = rule104 _tlIfirstInh
         _lhsOfirstInh :: [Vertex]
         _lhsOfirstInh = rule105 _hdIinh
         _lhsOcvisits :: [[CVisit]]
         _lhsOcvisits = rule106 _hdIcvisits _tlIcvisits
         _lhsOdescr :: Seq (Vertex,ChildVisit)
         _lhsOdescr = rule107 _hdIdescr _tlIdescr
         _lhsOedp :: Seq Edge
         _lhsOedp = rule108 _hdIedp _tlIedp
         _lhsOnewedges :: Seq Edge
         _lhsOnewedges = rule109 _hdInewedges _tlInewedges
         _lhsOprev :: [Vertex]
         _lhsOprev = rule110 _tlIprev
         _lhsOv :: Vertex
         _lhsOv = rule111 _tlIv
         _hdOallInters = rule112 _lhsIallInters
         _hdOcons = rule113 _lhsIcons
         _hdOddp = rule114 _lhsIddp
         _hdOinfo = rule115 _lhsIinfo
         _hdOisFirst = rule116 _lhsIisFirst
         _hdOn = rule117 _lhsIn
         _hdOprev = rule118 _lhsIprev
         _hdOv = rule119 _lhsIv
         _hdOvisitDescr = rule120 _lhsIvisitDescr
         _hdOvssGraph = rule121 _lhsIvssGraph
         _tlOallInters = rule122 _lhsIallInters
         _tlOcons = rule123 _lhsIcons
         _tlOddp = rule124 _lhsIddp
         _tlOinfo = rule125 _lhsIinfo
         _tlOprev = rule126 _hdIprev
         _tlOv = rule127 _hdIv
         _tlOvisitDescr = rule128 _lhsIvisitDescr
         _tlOvssGraph = rule129 _lhsIvssGraph
         !__result_ = T_Segments_vOut13 _lhsOcvisits _lhsOdescr _lhsOedp _lhsOfirstInh _lhsOgroups _lhsOhdIntravisits _lhsOnewedges _lhsOnewvertices _lhsOprev _lhsOsegs _lhsOv
         in __result_ )
     in C_Segments_s14 v13
   {-# INLINE rule94 #-}
   {-# LINE 165 "src-ag/InterfacesRules.lag" #-}
   rule94 = \ ((_tlInewvertices) :: [Vertex]) ->
                                  {-# LINE 165 "src-ag/InterfacesRules.lag" #-}
                                  _tlInewvertices
                                  {-# LINE 996 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule95 #-}
   {-# LINE 166 "src-ag/InterfacesRules.lag" #-}
   rule95 = \ ((_hdInewvertices) :: [Vertex]) ->
                               {-# LINE 166 "src-ag/InterfacesRules.lag" #-}
                               _hdInewvertices
                               {-# LINE 1002 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule96 #-}
   {-# LINE 180 "src-ag/InterfacesRules.lag" #-}
   rule96 = \ ((_hdIgroups) :: [([Vertex],[Vertex])]) ->
                         {-# LINE 180 "src-ag/InterfacesRules.lag" #-}
                         _hdIgroups
                         {-# LINE 1008 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule97 #-}
   {-# LINE 203 "src-ag/InterfacesRules.lag" #-}
   rule97 = \ ((_lhsIn) :: Int) ->
                   {-# LINE 203 "src-ag/InterfacesRules.lag" #-}
                   _lhsIn + 1
                   {-# LINE 1014 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule98 #-}
   {-# LINE 316 "src-ag/InterfacesRules.lag" #-}
   rule98 = \  (_ :: ()) ->
                         {-# LINE 316 "src-ag/InterfacesRules.lag" #-}
                         False
                         {-# LINE 1020 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule99 #-}
   {-# LINE 329 "src-ag/InterfacesRules.lag" #-}
   rule99 = \ ((_tlIhdIntravisits) :: [IntraVisit]) ->
                                  {-# LINE 329 "src-ag/InterfacesRules.lag" #-}
                                  _tlIhdIntravisits
                                  {-# LINE 1026 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule100 #-}
   {-# LINE 330 "src-ag/InterfacesRules.lag" #-}
   rule100 = \ ((_hdIintravisits) :: [IntraVisit]) ->
                                 {-# LINE 330 "src-ag/InterfacesRules.lag" #-}
                                 _hdIintravisits
                                 {-# LINE 1032 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule101 #-}
   {-# LINE 354 "src-ag/InterfacesRules.lag" #-}
   rule101 = \ ((_lhsIfromLhs) :: [Vertex]) ->
                          {-# LINE 354 "src-ag/InterfacesRules.lag" #-}
                          _lhsIfromLhs
                          {-# LINE 1038 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule102 #-}
   {-# LINE 355 "src-ag/InterfacesRules.lag" #-}
   rule102 = \  (_ :: ()) ->
                          {-# LINE 355 "src-ag/InterfacesRules.lag" #-}
                          []
                          {-# LINE 1044 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule103 #-}
   {-# LINE 401 "src-ag/InterfacesRules.lag" #-}
   rule103 = \ ((_hdIseg) :: CSegment) ((_tlIsegs) :: CSegments) ->
                        {-# LINE 401 "src-ag/InterfacesRules.lag" #-}
                        _hdIseg : _tlIsegs
                        {-# LINE 1050 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule104 #-}
   {-# LINE 447 "src-ag/InterfacesRules.lag" #-}
   rule104 = \ ((_tlIfirstInh) :: [Vertex]) ->
                          {-# LINE 447 "src-ag/InterfacesRules.lag" #-}
                          _tlIfirstInh
                          {-# LINE 1056 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule105 #-}
   {-# LINE 448 "src-ag/InterfacesRules.lag" #-}
   rule105 = \ ((_hdIinh) :: [Vertex]) ->
                            {-# LINE 448 "src-ag/InterfacesRules.lag" #-}
                            _hdIinh
                            {-# LINE 1062 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule106 #-}
   rule106 = \ ((_hdIcvisits) :: [CVisit]) ((_tlIcvisits) :: [[CVisit]]) ->
     _hdIcvisits : _tlIcvisits
   {-# INLINE rule107 #-}
   rule107 = \ ((_hdIdescr) :: Seq (Vertex,ChildVisit)) ((_tlIdescr) :: Seq (Vertex,ChildVisit)) ->
     _hdIdescr Seq.>< _tlIdescr
   {-# INLINE rule108 #-}
   rule108 = \ ((_hdIedp) :: Seq Edge) ((_tlIedp) :: Seq Edge) ->
     _hdIedp Seq.>< _tlIedp
   {-# INLINE rule109 #-}
   rule109 = \ ((_hdInewedges) :: Seq Edge ) ((_tlInewedges) :: Seq Edge ) ->
     _hdInewedges Seq.>< _tlInewedges
   {-# INLINE rule110 #-}
   rule110 = \ ((_tlIprev) :: [Vertex]) ->
     _tlIprev
   {-# INLINE rule111 #-}
   rule111 = \ ((_tlIv) :: Vertex) ->
     _tlIv
   {-# INLINE rule112 #-}
   rule112 = \ ((_lhsIallInters) :: CInterfaceMap) ->
     _lhsIallInters
   {-# INLINE rule113 #-}
   rule113 = \ ((_lhsIcons) :: [ConstructorIdent]) ->
     _lhsIcons
   {-# INLINE rule114 #-}
   rule114 = \ ((_lhsIddp) :: Graph) ->
     _lhsIddp
   {-# INLINE rule115 #-}
   rule115 = \ ((_lhsIinfo) :: Info) ->
     _lhsIinfo
   {-# INLINE rule116 #-}
   rule116 = \ ((_lhsIisFirst) :: Bool) ->
     _lhsIisFirst
   {-# INLINE rule117 #-}
   rule117 = \ ((_lhsIn) :: Int) ->
     _lhsIn
   {-# INLINE rule118 #-}
   rule118 = \ ((_lhsIprev) :: [Vertex]) ->
     _lhsIprev
   {-# INLINE rule119 #-}
   rule119 = \ ((_lhsIv) :: Vertex) ->
     _lhsIv
   {-# INLINE rule120 #-}
   rule120 = \ ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ->
     _lhsIvisitDescr
   {-# INLINE rule121 #-}
   rule121 = \ ((_lhsIvssGraph) :: Graph) ->
     _lhsIvssGraph
   {-# INLINE rule122 #-}
   rule122 = \ ((_lhsIallInters) :: CInterfaceMap) ->
     _lhsIallInters
   {-# INLINE rule123 #-}
   rule123 = \ ((_lhsIcons) :: [ConstructorIdent]) ->
     _lhsIcons
   {-# INLINE rule124 #-}
   rule124 = \ ((_lhsIddp) :: Graph) ->
     _lhsIddp
   {-# INLINE rule125 #-}
   rule125 = \ ((_lhsIinfo) :: Info) ->
     _lhsIinfo
   {-# INLINE rule126 #-}
   rule126 = \ ((_hdIprev) :: [Vertex]) ->
     _hdIprev
   {-# INLINE rule127 #-}
   rule127 = \ ((_hdIv) :: Vertex) ->
     _hdIv
   {-# INLINE rule128 #-}
   rule128 = \ ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ->
     _lhsIvisitDescr
   {-# INLINE rule129 #-}
   rule129 = \ ((_lhsIvssGraph) :: Graph) ->
     _lhsIvssGraph
{-# NOINLINE sem_Segments_Nil #-}
sem_Segments_Nil ::  T_Segments
sem_Segments_Nil  = T_Segments (return st14) where
   {-# NOINLINE st14 #-}
   !st14 = let
      v13 :: T_Segments_v13
      v13 = \ !(T_Segments_vIn13 _lhsIallInters _lhsIcons _lhsIddp _lhsIfromLhs _lhsIinfo _lhsIisFirst _lhsIn _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) -> ( let
         _lhsOnewvertices :: [Vertex]
         _lhsOnewvertices = rule130  ()
         _lhsOgroups :: [([Vertex],[Vertex])]
         _lhsOgroups = rule131  ()
         _lhsOhdIntravisits :: [IntraVisit]
         _lhsOhdIntravisits = rule132  ()
         _lhsOsegs :: CSegments
         _lhsOsegs = rule133  ()
         _lhsOfirstInh :: [Vertex]
         _lhsOfirstInh = rule134  ()
         _lhsOcvisits :: [[CVisit]]
         _lhsOcvisits = rule135  ()
         _lhsOdescr :: Seq (Vertex,ChildVisit)
         _lhsOdescr = rule136  ()
         _lhsOedp :: Seq Edge
         _lhsOedp = rule137  ()
         _lhsOnewedges :: Seq Edge
         _lhsOnewedges = rule138  ()
         _lhsOprev :: [Vertex]
         _lhsOprev = rule139 _lhsIprev
         _lhsOv :: Vertex
         _lhsOv = rule140 _lhsIv
         !__result_ = T_Segments_vOut13 _lhsOcvisits _lhsOdescr _lhsOedp _lhsOfirstInh _lhsOgroups _lhsOhdIntravisits _lhsOnewedges _lhsOnewvertices _lhsOprev _lhsOsegs _lhsOv
         in __result_ )
     in C_Segments_s14 v13
   {-# INLINE rule130 #-}
   {-# LINE 167 "src-ag/InterfacesRules.lag" #-}
   rule130 = \  (_ :: ()) ->
                               {-# LINE 167 "src-ag/InterfacesRules.lag" #-}
                               []
                               {-# LINE 1172 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule131 #-}
   {-# LINE 181 "src-ag/InterfacesRules.lag" #-}
   rule131 = \  (_ :: ()) ->
                         {-# LINE 181 "src-ag/InterfacesRules.lag" #-}
                         []
                         {-# LINE 1178 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule132 #-}
   {-# LINE 331 "src-ag/InterfacesRules.lag" #-}
   rule132 = \  (_ :: ()) ->
                               {-# LINE 331 "src-ag/InterfacesRules.lag" #-}
                               repeat []
                               {-# LINE 1184 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule133 #-}
   {-# LINE 402 "src-ag/InterfacesRules.lag" #-}
   rule133 = \  (_ :: ()) ->
                        {-# LINE 402 "src-ag/InterfacesRules.lag" #-}
                        []
                        {-# LINE 1190 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule134 #-}
   {-# LINE 449 "src-ag/InterfacesRules.lag" #-}
   rule134 = \  (_ :: ()) ->
                           {-# LINE 449 "src-ag/InterfacesRules.lag" #-}
                           []
                           {-# LINE 1196 "dist/build/InterfacesRules.hs"#-}
   {-# INLINE rule135 #-}
   rule135 = \  (_ :: ()) ->
     []
   {-# INLINE rule136 #-}
   rule136 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule137 #-}
   rule137 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule138 #-}
   rule138 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule139 #-}
   rule139 = \ ((_lhsIprev) :: [Vertex]) ->
     _lhsIprev
   {-# INLINE rule140 #-}
   rule140 = \ ((_lhsIv) :: Vertex) ->
     _lhsIv
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE Rank2Types, GADTs #-}
{-# LANGUAGE BangPatterns #-}
{-# LANGUAGE ScopedTypeVariables #-}

module InterfacesRules where CommonTypes
import SequentialTypes






import Interfaces
import CodeSyntax
import GrammarInfo

import qualified Data.Sequence as Seq
import Data.Sequence(Seq)
import qualified Data.Map as Map
import Data.Map(Map)
import Data.Tree(Tree(Node), Forest)
import Data.Graph(Graph, dfs, edges, buildG, transposeG)
import Data.Maybe (fromJust)
import Data.List (partition,transpose,(\\),nub,findIndex)
import Data.Array ((!),inRange,bounds,assocs)
import Data.Foldable(toList)




import Control.Monad.Identity (Identity)
import qualified Control.Monad.Identity























type VisitSS = [Vertex]


































gather :: Info -> [Vertex] -> [[Vertex]]
gather info =  eqClasses comp
               where comp a b = isEqualField (ruleTable info ! a) (ruleTable info ! b)

-- IRoot -------------------------------------------------------
-- wrapper












-- cata




-- semantic domain

















-- Only non-empty syn will ever be forced, because visits with empty syn are never performed
-- Right hand side synthesized attributes always have a field
cv :: (Vertex -> CRule) -> Int -> Vertex -> ([Vertex],[Vertex]) -> (Vertex,ChildVisit)
cv look n v (inh,syn) =  let  fld = getField (look (head syn))
                              rnt = fromJust (getRhsNt (look (head syn)))
                              d = ChildVisit fld rnt n inh syn
                         in (v,d)
















ed :: Vertex -> ([Vertex], [Vertex]) -> [(Vertex, Vertex)]
ed v (inh,syn) = map (\i -> (i,v)) inh ++ map (\s -> (v,s)) syn





































































-- Interface ---------------------------------------------------
-- wrapper












-- cata


postorder :: Tree a -> [a]
postorder (Node a ts) = postorderF ts ++ [a]
postorderF-- semantic domain:: Forest a -> [a]
postorderF = concatMap postorder
postOrd :: Graph -> [Vertex] -> [Vertex]
postOrd g = postorderF . dfs g
topSort' :: Graph -> [Vertex] -> [Vertex]
topSort' g = postOrd g











































































type IntraVisit = [Vertex]





















swap :: (a,b) -> (b,a)
swap (a,b) = (b,a)








































































-- Interfaces --------------------------------------------------
ccv-- wrapper:: Identifier -> NontermIdent -> Int -> CInterfaceMap -> CRule
ccv name nt n table
  =  CChildVisit name nt n inh syn lst
     where  CInterface segs = Map.findWithDefault (error ("InterfacesRules::ccv::interfaces not in table for nt: " ++ show nt)) nt table
            (seg:remain) = drop n segs
            CSegment inh syn = seg
            lst = null remain Inh_IRoot  = Inh_IRoot { dpr_Inh_IRoot :: !([Edge]), info_Inh_IRoot :: !(Info), tdp_Inh_IRoot :: !(Graph) }
data Syn_IRoot  = Syn_IRoot { edp_Syn_IRoot :: !([Edge]), inters_Syn_IRoot :: !(CInterfaceMap), visits_Syn_IRoot :: !(CVisitsMap) }
{-# INLINABLE wrap_IRoot #-}
wrap_IRoot :: T_IRoot  -> Inh_IRoot  -> (Syn_IRoot )
wrap_IRoot !(T_IRoot act) !(Inh_IRoot _lhsIdpr _lhsIinfo _lhsItdp) =
   Control.Monad.Identity.runIdentity (
     do !sem <- act
        let arg1 = T_IRoot_vIn1 _lhsIdpr _lhsIinfo _lhsItdp
        !(T_IRoot_vOut1 _lhsOedp _lhsOinters _lhsOvisits) <- return (inv_IRoot_s2 sem arg1)
        return (Syn_IRoot _lhsOedp _lhsOinters _lhsOvisits)
   )


{-# INLINE sem_IRoot #-}
sem_IRoot :: IRoot  -> T_IRoot
sem_IRoot ( IRoot inters_ ) = sem_IRoot_IRoot ( sem_Interfaces inters_ )


newtype T_IRoot  = T_IRoot {
                           attach_T_IRoot :: Identity (T_IRoot_s2 )
                           }
newtype T_IRoot_s2  = C_IRoot_s2 {
                                 inv_IRoot_s2 :: (T_IRoot_v1 )
                                 }
data T_IRoot_s3  = C_IRoot_s3
type T_IRoot_v1  = (T_IRoot_vIn1 ) -> (T_IRoot_vOut1 )
data T_IRoot_vIn1  = T_IRoot_vIn1 ([Edge]) (Info) (Graph)
data T_IRoot_vOut1  = T_IRoot_vOut1 ([Edge]) (CInterfaceMap) (CVisitsMap)
{-# NOINLINE sem_IRoot_IRoot #-}
sem_IRoot_IRoot :: T_Interfaces  -> T_IRoot
sem_IRoot_IRoot arg_inters_ = T_IRoot (return st2) where
   {-# NOINLINE st2 #-}
   !st2 = let
      v1 :: T_IRoot_v1
      v1 = \ !(T_IRoot_vIn1 _lhsIdpr _lhsIinfo _lhsItdp) -> ( let
         _intersX8 = Control.Monad.Identity.runIdentity (attach_T_Interfaces (arg_inters_))
         (T_Interfaces_vOut7 _intersIdescr _intersIedp _intersIfirstvisitvertices _intersIinters _intersInewedges _intersIv _intersIvisits) = inv_Interfaces_s8 _intersX8 (T_Interfaces_vIn7 _intersOallInters _intersOddp _intersOinfo _intersOprev _intersOv _intersOvisitDescr _intersOvssGraph)
         _newedges = rule0 _intersInewedges
         _visitssGraph = rule1 _intersIv _lhsItdp _newedges
         _intersOv = rule2 _lhsItdp
         _intersOvisitDescr = rule3 _descr
         _descr = rule4 _intersIdescr
         _intersOvssGraph = rule5 _visitssGraph
         _intersOprev = rule6 _intersIfirstvisitvertices _lhsIinfo
         _intersOddp = rule7 _intersIv _lhsIdpr _newedges
         _intersOallInters = rule8 _intersIinters
         _lhsOedp :: [Edge]
         _lhsOedp = rule9 _intersIedp
         _lhsOinters :: CInterfaceMap
         _lhsOinters = rule10 _intersIinters
         _lhsOvisits :: CVisitsMap
         _lhsOvisits = rule11 _intersIvisits
         _intersOinfo = rule12 _lhsIinfo
         !__result_ = T_IRoot_vOut1 _lhsOedp _lhsOinters _lhsOvisits
         in __result_ )
     in C_IRoot_s2 v1
   {-# INLINE rule0 #-}





   {-# INLINE rule1 #-}







   {-# INLINE rule2 #-}





   {-# INLINE rule3 #-}





   {-# INLINE rule4 #-}





   {-# INLINE rule5 #-}





   {-# INLINE rule6 #-}






   {-# INLINE rule7 #-}





   {-# INLINE rule8 #-}





   {-# INLINE rule9 #-}





   {-# INLINE rule10 #-}
   rule10 = \ ((_intersIinters) :: CInterfaceMap) ->
     _intersIinters
   {-# INLINE rule11 #-}
   rule11 = \ ((_intersIvisits) :: CVisitsMap) ->
     _intersIvisits
   {-# INLINE rule12 #-}
   rule12 = \ ((_lhsIinfo) :: Info) ->
     _lhsIinfo = \ ((_intersInewedges) :: Seq Edge ) -> _intersInewedges
   rule1 = \ ((_intersIv) :: Vertex) ((_lhsItdp) :: Graph) _newedges -> graph = buildG (0,_intersIv-1) es
                                                                        es = _newedges ++ edges _lhsItdp
                                                                       in transposeG graph










   rule2 = \ ((_lhsItdp) :: Graph) -> (bounds _lhsItdp) + 1









































   rule3 = \ _descr ->            Map.fromList _descr



















   rule4 = \ ((_intersIdescr) :: Seq (Vertex,ChildVisit)) -> _intersIdescr







































































   rule5 = \ _visitssGraph ->  _visitssGraph













































   rule6 = \ ((_intersIfirstvisitvertices) :: [Vertex]) ((_lhsIinfo) :: Info) -> terminals = [ v | (v,cr) <- assocs (ruleTable _lhsIinfo), not (getHasCode cr), isLocal cr ]
                                                                                in _intersIfirstvisitvertices ++ terminals

















































































   rule7 = \ ((_intersIv) :: Vertex) ((_lhsIdpr) :: [Edge]) _newedges -> (0,_intersIv-1) (map swap (_lhsIdpr ++ _newedges))





































   rule8 = \ ((_intersIinters) :: CInterfaceMap) ->




















































-- cata




-- semantic domain



   rule9 = \ ((_intersIedp) :: Seq Edge) -> _intersIedp Inh_Interface  = Inh_Interface { allInters_Inh_Interface :: !(CInterfaceMap), ddp_Inh_Interface :: !(Graph), info_Inh_Interface :: !(Info), prev_Inh_Interface :: !([Vertex]), v_Inh_Interface :: !(Vertex), visitDescr_Inh_Interface :: !(Map Vertex ChildVisit), vssGraph_Inh_Interface :: !(Graph) }
data Syn_Interface  = Syn_Interface { descr_Syn_Interface :: !(Seq (Vertex,ChildVisit)), edp_Syn_Interface :: !(Seq Edge), firstvisitvertices_Syn_Interface :: !([Vertex]), inter_Syn_Interface :: !(CInterface), newedges_Syn_Interface :: !(Seq Edge ), nt_Syn_Interface :: !(NontermIdent), v_Syn_Interface :: !(Vertex), visits_Syn_Interface :: !(Map ConstructorIdent CVisits) }
{-# INLINABLE wrap_Interface #-}
wrap_Interface :: T_Interface  -> Inh_Interface  -> (Syn_Interface )
wrap_Interface !(T_Interface act) !(Inh_Interface _lhsIallInters _lhsIddp _lhsIinfo _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) =
   Control.Monad.Identity.runIdentity (
     do !sem <- act
        let arg4 = T_Interface_vIn4 _lhsIallInters _lhsIddp _lhsIinfo _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph
        !(T_Interface_vOut4 _lhsOdescr _lhsOedp _lhsOfirstvisitvertices _lhsOinter _lhsOnewedges _lhsOnt _lhsOv _lhsOvisits) <- return (inv_Interface_s5 sem arg4)
        return (Syn_Interface _lhsOdescr _lhsOedp _lhsOfirstvisitvertices _lhsOinter _lhsOnewedges _lhsOnt _lhsOv _lhsOvisits)
   )


{-# INLINE sem_Interface #-}
sem_Interface :: Interface  -> T_Interface
sem_Interface ( Interface !nt_ !cons_ seg_ ) = sem_Interface_Interface nt_ cons_ ( sem_Segments seg_ )


newtype T_Interface  = T_Interface {
                                   attach_T_Interface :: Identity (T_Interface_s5 )
                                   }
newtype T_Interface_s5  = C_Interface_s5 {
                                         inv_Interface_s5 :: (T_Interface_v4 )
                                         }
data T_Interface_s6  = C_Interface_s6
type T_Interface_v4  = (T_Interface_vIn4 ) -> (T_Interface_vOut4 )
data T_Interface_vIn4  = T_Interface_vIn4 (CInterfaceMap) (Graph) (Info) ([Vertex]) (Vertex) (Map Vertex ChildVisit) (Graph)
data T_Interface_vOut4  = T_Interface_vOut4 (Seq (Vertex,ChildVisit)) (Seq Edge) ([Vertex]) (CInterface) (Seq Edge ) (NontermIdent) (Vertex) (Map ConstructorIdent CVisits)
{-# NOINLINE sem_Interface_Interface #-}
sem_Interface_Interface :: (NontermIdent) -> ([ConstructorIdent]) -> T_Segments  -> T_Interface
sem_Interface_Interface !arg_nt_ !arg_cons_ arg_seg_ = T_Interface (return st5) where
   {-# NOINLINE st5 #-}
   !st5 = let
      v4 :: T_Interface_v4
      v4 = \ !(T_Interface_vIn4 _lhsIallInters _lhsIddp _lhsIinfo _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) -> ( let
         _segX14 = Control.Monad.Identity.runIdentity (attach_T_Segments (arg_seg_))
         (T_Segments_vOut13 _segIcvisits _segIdescr _segIedp _segIfirstInh _segIgroups _segIhdIntravisits _segInewedges _segInewvertices _segIprev _segIsegs _segIv) = inv_Segments_s14 _segX14 (T_Segments_vIn13 _segOallInters _segOcons _segOddp _segOfromLhs _segOinfo _segOisFirst _segOn _segOprev _segOv _segOvisitDescr _segOvssGraph)
         _segOv = rule13 _lhsIv
         _v = rule14 _segInewvertices _segIv
         _lhsOv :: Vertex
         _lhsOv = rule15 _v
         _firstvisitvertices = rule16 _segIv _v
         _newedges = rule17 _firstvisitvertices _segInewvertices
         _lhsOnewedges :: Seq Edge
         _lhsOnewedges = rule18 _newedges _segInewedges
         _look :: Vertex -> CRule
         _look = rule19 _lhsIinfo
         _descr = rule20 _firstvisitvertices _look _segIgroups
         _lhsOdescr :: Seq (Vertex,ChildVisit)
         _lhsOdescr = rule21 _descr _segIdescr
         _segOn = rule22  ()
         _segOcons = rule23 arg_cons_
         _segOisFirst = rule24  ()
         _segOfromLhs = rule25 _lhsIprev
         _lhsOnt :: NontermIdent
         _lhsOnt = rule26 arg_nt_
         _lhsOinter :: CInterface
         _lhsOinter = rule27 _segIsegs
         _lhsOvisits :: Map ConstructorIdent CVisits
         _lhsOvisits = rule28 _segIcvisits arg_cons_
         _lhsOedp :: Seq Edge
         _lhsOedp = rule29 _segIedp
         _lhsOfirstvisitvertices :: [Vertex]
         _lhsOfirstvisitvertices = rule30 _firstvisitvertices
         _segOallInters = rule31 _lhsIallInters
         _segOddp = rule32 _lhsIddp
         _segOinfo = rule33 _lhsIinfo
         _segOprev = rule34 _lhsIprev
         _segOvisitDescr = rule35 _lhsIvisitDescr
         _segOvssGraph = rule36 _lhsIvssGraph
         !__result_ = T_Interface_vOut4 _lhsOdescr _lhsOedp _lhsOfirstvisitvertices _lhsOinter _lhsOnewedges _lhsOnt _lhsOv _lhsOvisits
         in __result_ )
     in C_Interface_s5 v4
   {-# INLINE rule13 #-}





   {-# INLINE rule14 #-}





   {-# INLINE rule15 #-}





   {-# INLINE rule16 #-}





   {-# INLINE rule17 #-}





   {-# INLINE rule18 #-}





   {-# INLINE rule19 #-}





   {-# INLINE rule20 #-}





   {-# INLINE rule21 #-}





   {-# INLINE rule22 #-}





   {-# INLINE rule23 #-}





   {-# INLINE rule24 #-}





   {-# INLINE rule25 #-}





   {-# INLINE rule26 #-}





   {-# INLINE rule27 #-}





   {-# INLINE rule28 #-}





   {-# INLINE rule29 #-}
   rule29 = \ ((_segIedp) :: Seq Edge) ->
     _segIedp
   {-# INLINE rule30 #-}
   rule30 = \ _firstvisitvertices ->
     _firstvisitvertices
   {-# INLINE rule31 #-}
   rule31 = \ ((_lhsIallInters) :: CInterfaceMap) ->
     _lhsIallInters
   {-# INLINE rule32 #-}
   rule32 = \ ((_lhsIddp) :: Graph) ->
     _lhsIddp
   {-# INLINE rule33 #-}
   rule33 = \ ((_lhsIinfo) :: Info) ->
     _lhsIinfo
   {-# INLINE rule34 #-}
   rule34 = \ ((_lhsIprev) :: [Vertex]) ->
     _lhsIprev
   {-# INLINE rule35 #-}
   rule35 = \ ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ->
     _lhsIvisitDescr
   {-# INLINE rule36 #-}
   rule36 = \ ((_lhsIvssGraph) :: Graph) ->
     _lhsIvssGraph = \ ((_lhsIv) :: Vertex) ->
   rule14 = \ ((_segInewvertices) :: [Vertex]) ((_segIv) :: Vertex) -> + length _segInewvertices
   rule15 = \ _v ->       _v
   rule16 = \ ((_segIv) :: Vertex) _v ->   [_segIv .. _v-1]
   rule17 = \ _firstvisitvertices ((_segInewvertices) :: [Vertex]) -> _firstvisitvertices _segInewvertices
   rule18 = \ _newedges ((_segInewedges) :: Seq Edge ) -> Seq.>< Seq.fromList _newedges


   rule19 = \ ((_lhsIinfo) :: Info) ->a -> ruleTable _lhsIinfo ! a
   rule20 = \ _firstvisitvertices ((_look) :: Vertex -> CRule) ((_segIgroups) :: [([Vertex],[Vertex])]) -> (cv _look (-1)) _firstvisitvertices _segIgroups
   rule21 = \ _descr ((_segIdescr) :: Seq (Vertex,ChildVisit)) -> Seq.>< Seq.fromList _descr







   rule22 = \  (_ :: ()) ->































   rule23 = \ cons_ ->      cons_
















































































   rule24 = \  (_ :: ()) ->    True





































   rule25 = \ ((_lhsIprev) :: [Vertex]) ->







































   rule26 = \ nt_ ->      nt_



   rule27 = \ ((_segIsegs) :: CSegments) -> _segIsegs
   rule28 = \ ((_segIcvisits) :: [[CVisit]]) cons_ -> (zip cons_ (transpose _segIcvisits))
























data Inh_Interfaces  = Inh_Interfaces { allInters_Inh_Interfaces :: !(CInterfaceMap), ddp_Inh_Interfaces :: !(Graph), info_Inh_Interfaces :: !(Info), prev_Inh_Interfaces :: !([Vertex]), v_Inh_Interfaces :: !(Vertex), visitDescr_Inh_Interfaces :: !(Map Vertex ChildVisit), vssGraph_Inh_Interfaces :: !(Graph) }
data Syn_Interfaces  = Syn_Interfaces { descr_Syn_Interfaces :: !(Seq (Vertex,ChildVisit)), edp_Syn_Interfaces :: !(Seq Edge), firstvisitvertices_Syn_Interfaces :: !([Vertex]), inters_Syn_Interfaces :: !(CInterfaceMap), newedges_Syn_Interfaces :: !(Seq Edge ), v_Syn_Interfaces :: !(Vertex), visits_Syn_Interfaces :: !(CVisitsMap) }
{-# INLINABLE wrap_Interfaces #-}
wrap_Interfaces :: T_Interfaces  -> Inh_Interfaces  -> (Syn_Interfaces )
wrap_Interfaces !(T_Interfaces act) !(Inh_Interfaces _lhsIallInters _lhsIddp _lhsIinfo _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) =
   Control.Monad.Identity.runIdentity (
     do !sem <- act
        let arg7 = T_Interfaces_vIn7 _lhsIallInters _lhsIddp _lhsIinfo _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph
        !(T_Interfaces_vOut7 _lhsOdescr _lhsOedp _lhsOfirstvisitvertices _lhsOinters _lhsOnewedges _lhsOv _lhsOvisits) <- return (inv_Interfaces_s8 sem arg7)
        return (Syn_Interfaces _lhsOdescr _lhsOedp _lhsOfirstvisitvertices _lhsOinters _lhsOnewedges _lhsOv _lhsOvisits)
   )


{-# NOINLINE sem_Interfaces #-}
sem_Interfaces :: Interfaces  -> T_Interfaces
sem_Interfaces list = Prelude.foldr sem_Interfaces_Cons sem_Interfaces_Nil (Prelude.map sem_Interface list)


newtype T_Interfaces  = T_Interfaces {
                                     attach_T_Interfaces :: Identity (T_Interfaces_s8 )
                                     }
newtype T_Interfaces_s8  = C_Interfaces_s8 {
                                           inv_Interfaces_s8 :: (T_Interfaces_v7 )
                                           }
data T_Interfaces_s9  = C_Interfaces_s9
type T_Interfaces_v7  = (T_Interfaces_vIn7 ) -> (T_Interfaces_vOut7 )
data T_Interfaces_vIn7  = T_Interfaces_vIn7 (CInterfaceMap) (Graph) (Info) ([Vertex]) (Vertex) (Map Vertex ChildVisit) (Graph)
data T_Interfaces_vOut7  = T_Interfaces_vOut7 (Seq (Vertex,ChildVisit)) (Seq Edge) ([Vertex]) (CInterfaceMap) (Seq Edge ) (Vertex) (CVisitsMap)
{-# NOINLINE sem_Interfaces_Cons #-}
sem_Interfaces_Cons :: T_Interface  -> T_Interfaces  -> T_Interfaces
sem_Interfaces_Cons arg_hd_ arg_tl_ = T_Interfaces (return st8) where
   {-# NOINLINE st8 #-}
   !st8 = let
      v7 :: T_Interfaces_v7
      v7 = \ !(T_Interfaces_vIn7 _lhsIallInters _lhsIddp _lhsIinfo _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) -> ( let
         _hdX5 = Control.Monad.Identity.runIdentity (attach_T_Interface (arg_hd_))
         _tlX8 = Control.Monad.Identity.runIdentity (attach_T_Interfaces (arg_tl_))
         (T_Interface_vOut4 _hdIdescr _hdIedp _hdIfirstvisitvertices _hdIinter _hdInewedges _hdInt _hdIv _hdIvisits) = inv_Interface_s5 _hdX5 (T_Interface_vIn4 _hdOallInters _hdOddp _hdOinfo _hdOprev _hdOv _hdOvisitDescr _hdOvssGraph)
         (T_Interfaces_vOut7 _tlIdescr _tlIedp _tlIfirstvisitvertices _tlIinters _tlInewedges _tlIv _tlIvisits) = inv_Interfaces_s8 _tlX8 (T_Interfaces_vIn7 _tlOallInters _tlOddp _tlOinfo _tlOprev _tlOv _tlOvisitDescr _tlOvssGraph)
         _lhsOinters :: CInterfaceMap
         _lhsOinters = rule37 _hdIinter _hdInt _tlIinters
         _lhsOvisits :: CVisitsMap
         _lhsOvisits = rule38 _hdInt _hdIvisits _tlIvisits
         _lhsOdescr :: Seq (Vertex,ChildVisit)
         _lhsOdescr = rule39 _hdIdescr _tlIdescr
         _lhsOedp :: Seq Edge
         _lhsOedp = rule40 _hdIedp _tlIedp
         _lhsOfirstvisitvertices :: [Vertex]
         _lhsOfirstvisitvertices = rule41 _hdIfirstvisitvertices _tlIfirstvisitvertices
         _lhsOnewedges :: Seq Edge
         _lhsOnewedges = rule42 _hdInewedges _tlInewedges
         _lhsOv :: Vertex
         _lhsOv = rule43 _tlIv
         _hdOallInters = rule44 _lhsIallInters
         _hdOddp = rule45 _lhsIddp
         _hdOinfo = rule46 _lhsIinfo
         _hdOprev = rule47 _lhsIprev
         _hdOv = rule48 _lhsIv
         _hdOvisitDescr = rule49 _lhsIvisitDescr
         _hdOvssGraph = rule50 _lhsIvssGraph
         _tlOallInters = rule51 _lhsIallInters
         _tlOddp = rule52 _lhsIddp
         _tlOinfo = rule53 _lhsIinfo
         _tlOprev = rule54 _lhsIprev
         _tlOv = rule55 _hdIv
         _tlOvisitDescr = rule56 _lhsIvisitDescr
         _tlOvssGraph = rule57 _lhsIvssGraph
         !__result_ = T_Interfaces_vOut7 _lhsOdescr _lhsOedp _lhsOfirstvisitvertices _lhsOinters _lhsOnewedges _lhsOv _lhsOvisits
         in __result_ )
     in C_Interfaces_s8 v7
   {-# INLINE rule37 #-}





   {-# INLINE rule38 #-}





   {-# INLINE rule39 #-}
   rule39 = \ ((_hdIdescr) :: Seq (Vertex,ChildVisit)) ((_tlIdescr) :: Seq (Vertex,ChildVisit)) ->
     _hdIdescr Seq.>< _tlIdescr
   {-# INLINE rule40 #-}
   rule40 = \ ((_hdIedp) :: Seq Edge) ((_tlIedp) :: Seq Edge) ->
     _hdIedp Seq.>< _tlIedp
   {-# INLINE rule41 #-}
   rule41 = \ ((_hdIfirstvisitvertices) :: [Vertex]) ((_tlIfirstvisitvertices) :: [Vertex]) ->
     _hdIfirstvisitvertices ++ _tlIfirstvisitvertices
   {-# INLINE rule42 #-}
   rule42 = \ ((_hdInewedges) :: Seq Edge ) ((_tlInewedges) :: Seq Edge ) ->
     _hdInewedges Seq.>< _tlInewedges
   {-# INLINE rule43 #-}
   rule43 = \ ((_tlIv) :: Vertex) ->
     _tlIv
   {-# INLINE rule44 #-}
   rule44 = \ ((_lhsIallInters) :: CInterfaceMap) ->
     _lhsIallInters
   {-# INLINE rule45 #-}
   rule45 = \ ((_lhsIddp) :: Graph) ->
     _lhsIddp
   {-# INLINE rule46 #-}
   rule46 = \ ((_lhsIinfo) :: Info) ->
     _lhsIinfo
   {-# INLINE rule47 #-}
   rule47 = \ ((_lhsIprev) :: [Vertex]) ->
     _lhsIprev
   {-# INLINE rule48 #-}
   rule48 = \ ((_lhsIv) :: Vertex) ->
     _lhsIv
   {-# INLINE rule49 #-}
   rule49 = \ ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ->
     _lhsIvisitDescr
   {-# INLINE rule50 #-}
   rule50 = \ ((_lhsIvssGraph) :: Graph) ->
     _lhsIvssGraph
   {-# INLINE rule51 #-}
   rule51 = \ ((_lhsIallInters) :: CInterfaceMap) ->
     _lhsIallInters
   {-# INLINE rule52 #-}
   rule52 = \ ((_lhsIddp) :: Graph) ->
     _lhsIddp
   {-# INLINE rule53 #-}
   rule53 = \ ((_lhsIinfo) :: Info) ->
     _lhsIinfo
   {-# INLINE rule54 #-}
   rule54 = \ ((_lhsIprev) :: [Vertex]) ->
     _lhsIprev
   {-# INLINE rule55 #-}
   rule55 = \ ((_hdIv) :: Vertex) ->
     _hdIv
   {-# INLINE rule56 #-}
   rule56 = \ ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ->
     _lhsIvisitDescr
   {-# INLINE rule57 #-}
   rule57 = \ ((_lhsIvssGraph) :: Graph) ->
     _lhsIvssGraph = \ ((_hdIinter) :: CInterface) ((_hdInt) :: NontermIdent) ((_tlIinters) :: CInterfaceMap) -> _hdInt _hdIinter _tlIinters
   rule38 = \ ((_hdInt) :: NontermIdent) ((_hdIvisits) :: Map ConstructorIdent CVisits) ((_tlIvisits) :: CVisitsMap) -> _hdInt _hdIvisits _tlIvisits













































































































































































{-# NOINLINE sem_Interfaces_Nil #-}
sem_Interfaces_Nil ::  T_Interfaces
sem_Interfaces_Nil  = T_Interfaces (return st8) where
   {-# NOINLINE st8 #-}
   !st8 = let
      v7 :: T_Interfaces_v7
      v7 = \ !(T_Interfaces_vIn7 _lhsIallInters _lhsIddp _lhsIinfo _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) -> ( let
         _lhsOinters :: CInterfaceMap
         _lhsOinters = rule58  ()
         _lhsOvisits :: CVisitsMap
         _lhsOvisits = rule59  ()
         _lhsOdescr :: Seq (Vertex,ChildVisit)
         _lhsOdescr = rule60  ()
         _lhsOedp :: Seq Edge
         _lhsOedp = rule61  ()
         _lhsOfirstvisitvertices :: [Vertex]
         _lhsOfirstvisitvertices = rule62  ()
         _lhsOnewedges :: Seq Edge
         _lhsOnewedges = rule63  ()
         _lhsOv :: Vertex
         _lhsOv = rule64 _lhsIv
         !__result_ = T_Interfaces_vOut7 _lhsOdescr _lhsOedp _lhsOfirstvisitvertices _lhsOinters _lhsOnewedges _lhsOv _lhsOvisits
         in __result_ )
     in C_Interfaces_s8 v7
   {-# INLINE rule58 #-}





   {-# INLINE rule59 #-}





   {-# INLINE rule60 #-}
   rule60 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule61 #-}
   rule61 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule62 #-}
   rule62 = \  (_ :: ()) ->
     []
   {-# INLINE rule63 #-}
   rule63 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule64 #-}
   rule64 = \ ((_lhsIv) :: Vertex) ->
     _lhsIv = \  (_ :: ()) ->
   rule59 = \  (_ :: ()) ->































































































































































































































-- Segment -----------------------------------------------------
-- wrapper
data Inh_Segment  = Inh_Segment { allInters_Inh_Segment :: !(CInterfaceMap), cons_Inh_Segment :: !([ConstructorIdent]), ddp_Inh_Segment :: !(Graph), fromLhs_Inh_Segment :: !([Vertex]), info_Inh_Segment :: !(Info), isFirst_Inh_Segment :: !(Bool), n_Inh_Segment :: !(Int), nextInh_Inh_Segment :: !([Vertex]), nextIntravisits_Inh_Segment :: !([IntraVisit]), nextNewvertices_Inh_Segment :: !([Vertex]), prev_Inh_Segment :: !([Vertex]), v_Inh_Segment :: !(Vertex), visitDescr_Inh_Segment :: !(Map Vertex ChildVisit), vssGraph_Inh_Segment :: !(Graph) }
data Syn_Segment  = Syn_Segment { cvisits_Syn_Segment :: !([CVisit]), descr_Syn_Segment :: !(Seq (Vertex,ChildVisit)), edp_Syn_Segment :: !(Seq Edge), groups_Syn_Segment :: !([([Vertex],[Vertex])]), inh_Syn_Segment :: !([Vertex]), intravisits_Syn_Segment :: !([IntraVisit]), newedges_Syn_Segment :: !(Seq Edge ), newvertices_Syn_Segment :: !([Vertex]), prev_Syn_Segment :: !([Vertex]), seg_Syn_Segment :: !(CSegment), v_Syn_Segment :: !(Vertex), visitss_Syn_Segment :: !([VisitSS]) }
{-# INLINABLE wrap_Segment #-}
wrap_Segment :: T_Segment  -> Inh_Segment  -> (Syn_Segment )
wrap_Segment !(T_Segment act) !(Inh_Segment _lhsIallInters _lhsIcons _lhsIddp _lhsIfromLhs _lhsIinfo _lhsIisFirst _lhsIn _lhsInextInh _lhsInextIntravisits _lhsInextNewvertices _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) =
   Control.Monad.Identity.runIdentity (
     do !sem <- act
        let arg10 = T_Segment_vIn10 _lhsIallInters _lhsIcons _lhsIddp _lhsIfromLhs _lhsIinfo _lhsIisFirst _lhsIn _lhsInextInh _lhsInextIntravisits _lhsInextNewvertices _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph
        !(T_Segment_vOut10 _lhsOcvisits _lhsOdescr _lhsOedp _lhsOgroups _lhsOinh _lhsOintravisits _lhsOnewedges _lhsOnewvertices _lhsOprev _lhsOseg _lhsOv _lhsOvisitss) <- return (inv_Segment_s11 sem arg10)
        return (Syn_Segment _lhsOcvisits _lhsOdescr _lhsOedp _lhsOgroups _lhsOinh _lhsOintravisits _lhsOnewedges _lhsOnewvertices _lhsOprev _lhsOseg _lhsOv _lhsOvisitss)
   )

-- cata
{-# INLINE sem_Segment #-}
sem_Segment :: Segment  -> T_Segment
sem_Segment ( Segment !inh_ !syn_ ) = sem_Segment_Segment inh_ syn_

-- semantic domain
newtype T_Segment  = T_Segment {
                               attach_T_Segment :: Identity (T_Segment_s11 )
                               }
newtype T_Segment_s11  = C_Segment_s11 {
                                       inv_Segment_s11 :: (T_Segment_v10 )
                                       }
data T_Segment_s12  = C_Segment_s12
type T_Segment_v10  = (T_Segment_vIn10 ) -> (T_Segment_vOut10 )
data T_Segment_vIn10  = T_Segment_vIn10 (CInterfaceMap) ([ConstructorIdent]) (Graph) ([Vertex]) (Info) (Bool) (Int) ([Vertex]) ([IntraVisit]) ([Vertex]) ([Vertex]) (Vertex) (Map Vertex ChildVisit) (Graph)
data T_Segment_vOut10  = T_Segment_vOut10 ([CVisit]) (Seq (Vertex,ChildVisit)) (Seq Edge) ([([Vertex],[Vertex])]) ([Vertex]) ([IntraVisit]) (Seq Edge ) ([Vertex]) ([Vertex]) (CSegment) (Vertex) ([VisitSS])
{-# NOINLINE sem_Segment_Segment #-}
sem_Segment_Segment :: ([Vertex]) -> ([Vertex]) -> T_Segment
sem_Segment_Segment !arg_inh_ !arg_syn_ = T_Segment (return st11) where
   {-# NOINLINE st11 #-}
   !st11 = let
      v10 :: T_Segment_v10
      v10 = \ !(T_Segment_vIn10 _lhsIallInters _lhsIcons _lhsIddp _lhsIfromLhs _lhsIinfo _lhsIisFirst _lhsIn _lhsInextInh _lhsInextIntravisits _lhsInextNewvertices _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) -> ( let
         _look :: Vertex -> CRule
         _look = rule65 _lhsIinfo
         _occurAs :: (CRule -> Bool) -> [Vertex] -> [Vertex]
         _occurAs = rule66 _lhsIinfo _look
         _groups :: [([Vertex],[Vertex])]
         _groups = rule67 _lhsIinfo _look _occurAs arg_inh_ arg_syn_
         _v :: Int
         _v = rule68 _groups _lhsIv
         _newvertices = rule69 _lhsIv _v
         _lhsOdescr :: Seq (Vertex,ChildVisit)
         _lhsOdescr = rule70 _groups _lhsIn _look _newvertices
         _attredges = rule71 _groups _newvertices
         _visitedges = rule72 _lhsInextNewvertices _newvertices
         _lhsOnewedges :: Seq Edge
         _lhsOnewedges = rule73 _attredges _visitedges
         _synOccur = rule74 _lhsIinfo _occurAs arg_syn_
         _vss = rule75 _lhsIcons _lhsIinfo _lhsIvssGraph _synOccur arg_syn_
         _visitss' = rule76 _lhsIprev _vss
         _defined = rule77 _lhsIvisitDescr _visitss
         _lhsOprev :: [Vertex]
         _lhsOprev = rule78 _defined _lhsIprev
         _visitss :: [[Vertex]]
         _visitss = rule79 _lhsIinfo _visitss'
         _fromLhs = rule80 _lhsIfromLhs _occurAs arg_inh_
         _computed = rule81 _lhsIinfo _lhsIvisitDescr _visitss
         _intravisits = rule82 _iv _lhsInextIntravisits _visitss
         _iv = rule83 _computed _fromLhs _lhsIddp
         _lhsOseg :: CSegment
         _lhsOseg = rule84 _inhmap _lhsIprev _lhsIvisitDescr _lhsIvssGraph _synmap
         _inhmap :: Map Identifier Type
         _synmap :: Map Identifier Type
         (_inhmap,_synmap) = rule85 _lhsIinfo arg_inh_ arg_syn_
         _lhsOcvisits :: [CVisit]
         _lhsOcvisits = rule86 _inhmap _intravisits _lhsIallInters _lhsIinfo _lhsIvisitDescr _synmap _visitss
         _lhsOedp :: Seq Edge
         _lhsOedp = rule87 _lhsInextInh arg_inh_ arg_syn_
         _lhsOinh :: [Vertex]
         _lhsOinh = rule88 arg_inh_
         _lhsOgroups :: [([Vertex],[Vertex])]
         _lhsOgroups = rule89 _groups
         _lhsOintravisits :: [IntraVisit]
         _lhsOintravisits = rule90 _intravisits
         _lhsOnewvertices :: [Vertex]
         _lhsOnewvertices = rule91 _newvertices
         _lhsOv :: Vertex
         _lhsOv = rule92 _v
         _lhsOvisitss :: [VisitSS]
         _lhsOvisitss = rule93 _visitss
         !__result_ = T_Segment_vOut10 _lhsOcvisits _lhsOdescr _lhsOedp _lhsOgroups _lhsOinh _lhsOintravisits _lhsOnewedges _lhsOnewvertices _lhsOprev _lhsOseg _lhsOv _lhsOvisitss
         in __result_ )
     in C_Segment_s11 v10
   {-# INLINE rule65 #-}





   {-# INLINE rule66 #-}







   {-# INLINE rule67 #-}






   {-# INLINE rule68 #-}





   {-# INLINE rule69 #-}





   {-# INLINE rule70 #-}





   {-# INLINE rule71 #-}





   {-# INLINE rule72 #-}





   {-# INLINE rule73 #-}





   {-# INLINE rule74 #-}





   {-# INLINE rule75 #-}









   {-# INLINE rule76 #-}





   {-# INLINE rule77 #-}








   {-# INLINE rule78 #-}





   {-# INLINE rule79 #-}




















   {-# INLINE rule80 #-}





   {-# INLINE rule81 #-}








   {-# INLINE rule82 #-}





   {-# INLINE rule83 #-}







   {-# INLINE rule84 #-}





   {-# INLINE rule85 #-}







   {-# INLINE rule86 #-}










   {-# INLINE rule87 #-}






   {-# INLINE rule88 #-}





   {-# INLINE rule89 #-}
   rule89 = \ ((_groups) :: [([Vertex],[Vertex])]) ->
     _groups
   {-# INLINE rule90 #-}
   rule90 = \ _intravisits ->
     _intravisits
   {-# INLINE rule91 #-}
   rule91 = \ _newvertices ->
     _newvertices
   {-# INLINE rule92 #-}
   rule92 = \ ((_v) :: Int) ->
     _v
   {-# INLINE rule93 #-}
   rule93 = \ ((_visitss) :: [[Vertex]]) ->
     _visitss = \ ((_lhsIinfo) :: Info) ->a -> ruleTable _lhsIinfo ! a


   rule66 = \ ((_lhsIinfo) :: Info) ((_look) :: Vertex -> CRule) ->p us -> [ a  |  u <- us
                                                                                ,  a <- tdsToTdp _lhsIinfo ! u
                                                                                ,  p (_look a)]

   rule67 = \ ((_lhsIinfo) :: Info) ((_look) :: Vertex -> CRule) ((_occurAs) :: (CRule -> Bool) -> [Vertex] -> [Vertex]) inh_ syn_ -> group as = gather _lhsIinfo (_occurAs isRhs as)
                                                                                                                                     in map (partition (isInh . _look)) (group (inh_ ++ syn_))

   rule68 = \ ((_groups) :: [([Vertex],[Vertex])]) ((_lhsIv) :: Vertex) -> + length _groups
   rule69 = \ ((_lhsIv) :: Vertex) ((_v) :: Int) ->_lhsIv .. _v    -1]














   rule70 = \ ((_groups) :: [([Vertex],[Vertex])]) ((_lhsIn) :: Int) ((_look) :: Vertex -> CRule) _newvertices -> $ zipWith (cv _look _lhsIn) _newvertices _groups






















   rule71 = \ ((_groups) :: [([Vertex],[Vertex])]) _newvertices -> (zipWith ed _newvertices _groups)



















   rule72 = \ ((_lhsInextNewvertices) :: [Vertex]) _newvertices -> _newvertices _lhsInextNewvertices
   rule73 = \ _attredges _visitedges -> _attredges Seq.>< Seq.fromList _visitedges





















































   rule74 = \ ((_lhsIinfo) :: Info) ((_occurAs) :: (CRule -> Bool) -> [Vertex] -> [Vertex]) syn_ -> _lhsIinfo (_occurAs isLhs syn_)
   rule75 = \ ((_lhsIcons) :: [ConstructorIdent]) ((_lhsIinfo) :: Info) ((_lhsIvssGraph) :: Graph) _synOccur syn_ -> hasCode' v | inRange (bounds (ruleTable _lhsIinfo)) v =  getHasCode (ruleTable _lhsIinfo ! v)
                                                                                                                                | otherwise = True
                                                                                                                    in if  null syn_
                                                                                                                           then replicate (length _lhsIcons) []
                                                                                                                           else map (filter hasCode' . topSort' _lhsIvssGraph) _synOccur







































   rule76 = \ ((_lhsIprev) :: [Vertex]) _vss -> (\\ _lhsIprev) _vss
   rule77 = \ ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ((_visitss) :: [[Vertex]]) -> defines v = case Map.lookup v _lhsIvisitDescr of
                                                                                                       Nothing -> [v]
                                                                                                       Just (ChildVisit _ _ _ inh _) -> v:inh
                                                                                        in concatMap (concatMap defines) _visitss
   rule78 = \ _defined ((_lhsIprev) :: [Vertex]) -> ++ _defined








   rule79 = \ ((_lhsIinfo) :: Info) _visitss' ->  rem' :: [(Identifier,Identifier,Maybe Type)] -> [Vertex] -> [Vertex]
                                                  rem' _ [] = []
                                                  rem' prev (v:vs)
                                                    | inRange (bounds table) v
                                                        = let  cr = table ! v
                                                               addV = case findIndex cmp prev of
                                                                        Just _ -> id
                                                                        _      -> (v:)
                                                               cmp (fld,attr,tp) = getField cr == fld && getAttr cr == attr && sameNT (getType cr) tp
                                                               sameNT (Just (NT ntA _ _)) (Just (NT ntB _ _)) = ntA == ntB
                                                               sameNT _          _                            = False
                                                               def = Map.elems (getDefines cr)
                                                          in addV (rem' (def ++ prev) vs)
                                                    | otherwise = v:rem' prev vs
                                                  table = ruleTable _lhsIinfo
                                                in map (rem' []) _visitss'

























































   rule80 = \ ((_lhsIfromLhs) :: [Vertex]) ((_occurAs) :: (CRule -> Bool) -> [Vertex] -> [Vertex]) inh_ -> isLhs inh_ ++ _lhsIfromLhs
   rule81 = \ ((_lhsIinfo) :: Info) ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ((_visitss) :: [[Vertex]]) -> computes v = case Map.lookup v _lhsIvisitDescr of
                                                                                                                              Nothing -> Map.keys (getDefines (ruleTable _lhsIinfo ! v))
                                                                                                                              Just (ChildVisit _ _ _ _ syn) -> v:syn
                                                                                                              in concatMap (concatMap computes) _visitss
   rule82 = \ _iv ((_lhsInextIntravisits) :: [IntraVisit]) ((_visitss) :: [[Vertex]]) -> _iv _visitss _lhsInextIntravisits
   rule83 = \ _computed _fromLhs ((_lhsIddp) :: Graph) ->vs next ->
                                                          let needed = concatMap (_lhsIddp !) vs
                                                          in nub (needed ++ next) \\ (_fromLhs ++ _computed)








































   rule84 = \ ((_inhmap) :: Map Identifier Type) ((_lhsIprev) :: [Vertex]) ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ((_lhsIvssGraph) :: Graph) ((_synmap) :: Map Identifier Type) -> False then undefined _lhsIvssGraph _lhsIvisitDescr _lhsIprev else CSegment _inhmap _synmap



   rule85 = \ ((_lhsIinfo) :: Info) inh_ syn_ -> makemap = Map.fromList . map findType
                                                 findType v = getNtaNameType (attrTable _lhsIinfo ! v)
                                                in (makemap inh_,makemap syn_)
   rule86 = \ ((_inhmap) :: Map Identifier Type) _intravisits ((_lhsIallInters) :: CInterfaceMap) ((_lhsIinfo) :: Info) ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ((_synmap) :: Map Identifier Type) ((_visitss) :: [[Vertex]]) ->  mkVisit vss intra = CVisit _inhmap _synmap (mkSequence vss) (mkSequence intra) True
                                                                                                                                                                                                                                       mkSequence = map mkRule
                                                                                                                                                                                                                                       mkRule v = case Map.lookup v _lhsIvisitDescr of
                                                                                                                                                                                                                                                    Nothing -> ruleTable _lhsIinfo ! v
                                                                                                                                                                                                                                                    Just (ChildVisit name nt n _ _) -> ccv name nt n _lhsIallInters
                                                                                                                                                                                                                                     in zipWith mkVisit _visitss _intravisits





















   rule87 = \ ((_lhsInextInh) :: [Vertex]) inh_ syn_ -> [(i,s) | i <- inh_, s <- syn_]
                          Seq.>< Seq.fromList [(s,i) | s <- syn_, i <- _lhsInextInh ]



   rule88 = \ inh_ ->    inh_





































































































































































































































































































































































































































































-- Segments ----------------------------------------------------
-- wrapper
data Inh_Segments  = Inh_Segments { allInters_Inh_Segments :: !(CInterfaceMap), cons_Inh_Segments :: !([ConstructorIdent]), ddp_Inh_Segments :: !(Graph), fromLhs_Inh_Segments :: !([Vertex]), info_Inh_Segments :: !(Info), isFirst_Inh_Segments :: !(Bool), n_Inh_Segments :: !(Int), prev_Inh_Segments :: !([Vertex]), v_Inh_Segments :: !(Vertex), visitDescr_Inh_Segments :: !(Map Vertex ChildVisit), vssGraph_Inh_Segments :: !(Graph) }
data Syn_Segments  = Syn_Segments { cvisits_Syn_Segments :: !([[CVisit]]), descr_Syn_Segments :: !(Seq (Vertex,ChildVisit)), edp_Syn_Segments :: !(Seq Edge), firstInh_Syn_Segments :: !([Vertex]), groups_Syn_Segments :: !([([Vertex],[Vertex])]), hdIntravisits_Syn_Segments :: !([IntraVisit]), newedges_Syn_Segments :: !(Seq Edge ), newvertices_Syn_Segments :: !([Vertex]), prev_Syn_Segments :: !([Vertex]), segs_Syn_Segments :: !(CSegments), v_Syn_Segments :: !(Vertex) }
{-# INLINABLE wrap_Segments #-}
wrap_Segments :: T_Segments  -> Inh_Segments  -> (Syn_Segments )
wrap_Segments !(T_Segments act) !(Inh_Segments _lhsIallInters _lhsIcons _lhsIddp _lhsIfromLhs _lhsIinfo _lhsIisFirst _lhsIn _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) =
   Control.Monad.Identity.runIdentity (
     do !sem <- act
        let arg13 = T_Segments_vIn13 _lhsIallInters _lhsIcons _lhsIddp _lhsIfromLhs _lhsIinfo _lhsIisFirst _lhsIn _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph
        !(T_Segments_vOut13 _lhsOcvisits _lhsOdescr _lhsOedp _lhsOfirstInh _lhsOgroups _lhsOhdIntravisits _lhsOnewedges _lhsOnewvertices _lhsOprev _lhsOsegs _lhsOv) <- return (inv_Segments_s14 sem arg13)
        return (Syn_Segments _lhsOcvisits _lhsOdescr _lhsOedp _lhsOfirstInh _lhsOgroups _lhsOhdIntravisits _lhsOnewedges _lhsOnewvertices _lhsOprev _lhsOsegs _lhsOv)
   )

-- cata
{-# NOINLINE sem_Segments #-}
sem_Segments :: Segments  -> T_Segments
sem_Segments list = Prelude.foldr sem_Segments_Cons sem_Segments_Nil (Prelude.map sem_Segment list)

-- semantic domain
newtype T_Segments  = T_Segments {
                                 attach_T_Segments :: Identity (T_Segments_s14 )
                                 }
newtype T_Segments_s14  = C_Segments_s14 {
                                         inv_Segments_s14 :: (T_Segments_v13 )
                                         }
data T_Segments_s15  = C_Segments_s15
type T_Segments_v13  = (T_Segments_vIn13 ) -> (T_Segments_vOut13 )
data T_Segments_vIn13  = T_Segments_vIn13 (CInterfaceMap) ([ConstructorIdent]) (Graph) ([Vertex]) (Info) (Bool) (Int) ([Vertex]) (Vertex) (Map Vertex ChildVisit) (Graph)
data T_Segments_vOut13  = T_Segments_vOut13 ([[CVisit]]) (Seq (Vertex,ChildVisit)) (Seq Edge) ([Vertex]) ([([Vertex],[Vertex])]) ([IntraVisit]) (Seq Edge ) ([Vertex]) ([Vertex]) (CSegments) (Vertex)
{-# NOINLINE sem_Segments_Cons #-}
sem_Segments_Cons :: T_Segment  -> T_Segments  -> T_Segments
sem_Segments_Cons arg_hd_ arg_tl_ = T_Segments (return st14) where
   {-# NOINLINE st14 #-}
   !st14 = let
      v13 :: T_Segments_v13
      v13 = \ !(T_Segments_vIn13 _lhsIallInters _lhsIcons _lhsIddp _lhsIfromLhs _lhsIinfo _lhsIisFirst _lhsIn _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) -> ( let
         _hdX11 = Control.Monad.Identity.runIdentity (attach_T_Segment (arg_hd_))
         _tlX14 = Control.Monad.Identity.runIdentity (attach_T_Segments (arg_tl_))
         (T_Segment_vOut10 _hdIcvisits _hdIdescr _hdIedp _hdIgroups _hdIinh _hdIintravisits _hdInewedges _hdInewvertices _hdIprev _hdIseg _hdIv _hdIvisitss) = inv_Segment_s11 _hdX11 (T_Segment_vIn10 _hdOallInters _hdOcons _hdOddp _hdOfromLhs _hdOinfo _hdOisFirst _hdOn _hdOnextInh _hdOnextIntravisits _hdOnextNewvertices _hdOprev _hdOv _hdOvisitDescr _hdOvssGraph)
         (T_Segments_vOut13 _tlIcvisits _tlIdescr _tlIedp _tlIfirstInh _tlIgroups _tlIhdIntravisits _tlInewedges _tlInewvertices _tlIprev _tlIsegs _tlIv) = inv_Segments_s14 _tlX14 (T_Segments_vIn13 _tlOallInters _tlOcons _tlOddp _tlOfromLhs _tlOinfo _tlOisFirst _tlOn _tlOprev _tlOv _tlOvisitDescr _tlOvssGraph)
         _hdOnextNewvertices = rule94 _tlInewvertices
         _lhsOnewvertices :: [Vertex]
         _lhsOnewvertices = rule95 _hdInewvertices
         _lhsOgroups :: [([Vertex],[Vertex])]
         _lhsOgroups = rule96 _hdIgroups
         _tlOn = rule97 _lhsIn
         _tlOisFirst = rule98  ()
         _hdOnextIntravisits = rule99 _tlIhdIntravisits
         _lhsOhdIntravisits :: [IntraVisit]
         _lhsOhdIntravisits = rule100 _hdIintravisits
         _hdOfromLhs = rule101 _lhsIfromLhs
         _tlOfromLhs = rule102  ()
         _lhsOsegs :: CSegments
         _lhsOsegs = rule103 _hdIseg _tlIsegs
         _hdOnextInh = rule104 _tlIfirstInh
         _lhsOfirstInh :: [Vertex]
         _lhsOfirstInh = rule105 _hdIinh
         _lhsOcvisits :: [[CVisit]]
         _lhsOcvisits = rule106 _hdIcvisits _tlIcvisits
         _lhsOdescr :: Seq (Vertex,ChildVisit)
         _lhsOdescr = rule107 _hdIdescr _tlIdescr
         _lhsOedp :: Seq Edge
         _lhsOedp = rule108 _hdIedp _tlIedp
         _lhsOnewedges :: Seq Edge
         _lhsOnewedges = rule109 _hdInewedges _tlInewedges
         _lhsOprev :: [Vertex]
         _lhsOprev = rule110 _tlIprev
         _lhsOv :: Vertex
         _lhsOv = rule111 _tlIv
         _hdOallInters = rule112 _lhsIallInters
         _hdOcons = rule113 _lhsIcons
         _hdOddp = rule114 _lhsIddp
         _hdOinfo = rule115 _lhsIinfo
         _hdOisFirst = rule116 _lhsIisFirst
         _hdOn = rule117 _lhsIn
         _hdOprev = rule118 _lhsIprev
         _hdOv = rule119 _lhsIv
         _hdOvisitDescr = rule120 _lhsIvisitDescr
         _hdOvssGraph = rule121 _lhsIvssGraph
         _tlOallInters = rule122 _lhsIallInters
         _tlOcons = rule123 _lhsIcons
         _tlOddp = rule124 _lhsIddp
         _tlOinfo = rule125 _lhsIinfo
         _tlOprev = rule126 _hdIprev
         _tlOv = rule127 _hdIv
         _tlOvisitDescr = rule128 _lhsIvisitDescr
         _tlOvssGraph = rule129 _lhsIvssGraph
         !__result_ = T_Segments_vOut13 _lhsOcvisits _lhsOdescr _lhsOedp _lhsOfirstInh _lhsOgroups _lhsOhdIntravisits _lhsOnewedges _lhsOnewvertices _lhsOprev _lhsOsegs _lhsOv
         in __result_ )
     in C_Segments_s14 v13
   {-# INLINE rule94 #-}





   {-# INLINE rule95 #-}





   {-# INLINE rule96 #-}





   {-# INLINE rule97 #-}





   {-# INLINE rule98 #-}





   {-# INLINE rule99 #-}





   {-# INLINE rule100 #-}





   {-# INLINE rule101 #-}





   {-# INLINE rule102 #-}





   {-# INLINE rule103 #-}





   {-# INLINE rule104 #-}





   {-# INLINE rule105 #-}





   {-# INLINE rule106 #-}
   rule106 = \ ((_hdIcvisits) :: [CVisit]) ((_tlIcvisits) :: [[CVisit]]) ->
     _hdIcvisits : _tlIcvisits
   {-# INLINE rule107 #-}
   rule107 = \ ((_hdIdescr) :: Seq (Vertex,ChildVisit)) ((_tlIdescr) :: Seq (Vertex,ChildVisit)) ->
     _hdIdescr Seq.>< _tlIdescr
   {-# INLINE rule108 #-}
   rule108 = \ ((_hdIedp) :: Seq Edge) ((_tlIedp) :: Seq Edge) ->
     _hdIedp Seq.>< _tlIedp
   {-# INLINE rule109 #-}
   rule109 = \ ((_hdInewedges) :: Seq Edge ) ((_tlInewedges) :: Seq Edge ) ->
     _hdInewedges Seq.>< _tlInewedges
   {-# INLINE rule110 #-}
   rule110 = \ ((_tlIprev) :: [Vertex]) ->
     _tlIprev
   {-# INLINE rule111 #-}
   rule111 = \ ((_tlIv) :: Vertex) ->
     _tlIv
   {-# INLINE rule112 #-}
   rule112 = \ ((_lhsIallInters) :: CInterfaceMap) ->
     _lhsIallInters
   {-# INLINE rule113 #-}
   rule113 = \ ((_lhsIcons) :: [ConstructorIdent]) ->
     _lhsIcons
   {-# INLINE rule114 #-}
   rule114 = \ ((_lhsIddp) :: Graph) ->
     _lhsIddp
   {-# INLINE rule115 #-}
   rule115 = \ ((_lhsIinfo) :: Info) ->
     _lhsIinfo
   {-# INLINE rule116 #-}
   rule116 = \ ((_lhsIisFirst) :: Bool) ->
     _lhsIisFirst
   {-# INLINE rule117 #-}
   rule117 = \ ((_lhsIn) :: Int) ->
     _lhsIn
   {-# INLINE rule118 #-}
   rule118 = \ ((_lhsIprev) :: [Vertex]) ->
     _lhsIprev
   {-# INLINE rule119 #-}
   rule119 = \ ((_lhsIv) :: Vertex) ->
     _lhsIv
   {-# INLINE rule120 #-}
   rule120 = \ ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ->
     _lhsIvisitDescr
   {-# INLINE rule121 #-}
   rule121 = \ ((_lhsIvssGraph) :: Graph) ->
     _lhsIvssGraph
   {-# INLINE rule122 #-}
   rule122 = \ ((_lhsIallInters) :: CInterfaceMap) ->
     _lhsIallInters
   {-# INLINE rule123 #-}
   rule123 = \ ((_lhsIcons) :: [ConstructorIdent]) ->
     _lhsIcons
   {-# INLINE rule124 #-}
   rule124 = \ ((_lhsIddp) :: Graph) ->
     _lhsIddp
   {-# INLINE rule125 #-}
   rule125 = \ ((_lhsIinfo) :: Info) ->
     _lhsIinfo
   {-# INLINE rule126 #-}
   rule126 = \ ((_hdIprev) :: [Vertex]) ->
     _hdIprev
   {-# INLINE rule127 #-}
   rule127 = \ ((_hdIv) :: Vertex) ->
     _hdIv
   {-# INLINE rule128 #-}
   rule128 = \ ((_lhsIvisitDescr) :: Map Vertex ChildVisit) ->
     _lhsIvisitDescr
   {-# INLINE rule129 #-}
   rule129 = \ ((_lhsIvssGraph) :: Graph) ->
     _lhsIvssGraph = \ ((_tlInewvertices) :: [Vertex]) ->
   rule95 = \ ((_hdInewvertices) :: [Vertex]) ->













   rule96 = \ ((_hdIgroups) :: [([Vertex],[Vertex])]) ->






















   rule97 = \ ((_lhsIn) :: Int) -> + 1
















































































































   rule98 = \  (_ :: ()) ->












   rule99 = \ ((_tlIhdIntravisits) :: [IntraVisit]) ->
   rule100 = \ ((_hdIintravisits) :: [IntraVisit]) ->























   rule101 = \ ((_lhsIfromLhs) :: [Vertex]) ->
   rule102 = \  (_ :: ()) ->]













































   rule103 = \ ((_hdIseg) :: CSegment) ((_tlIsegs) :: CSegments) -> : _tlIsegs













































   rule104 = \ ((_tlIfirstInh) :: [Vertex]) ->
   rule105 = \ ((_hdIinh) :: [Vertex]) ->













































































































































































































































































































































































































































































































































































































































































































{-# NOINLINE sem_Segments_Nil #-}
sem_Segments_Nil ::  T_Segments
sem_Segments_Nil  = T_Segments (return st14) where
   {-# NOINLINE st14 #-}
   !st14 = let
      v13 :: T_Segments_v13
      v13 = \ !(T_Segments_vIn13 _lhsIallInters _lhsIcons _lhsIddp _lhsIfromLhs _lhsIinfo _lhsIisFirst _lhsIn _lhsIprev _lhsIv _lhsIvisitDescr _lhsIvssGraph) -> ( let
         _lhsOnewvertices :: [Vertex]
         _lhsOnewvertices = rule130  ()
         _lhsOgroups :: [([Vertex],[Vertex])]
         _lhsOgroups = rule131  ()
         _lhsOhdIntravisits :: [IntraVisit]
         _lhsOhdIntravisits = rule132  ()
         _lhsOsegs :: CSegments
         _lhsOsegs = rule133  ()
         _lhsOfirstInh :: [Vertex]
         _lhsOfirstInh = rule134  ()
         _lhsOcvisits :: [[CVisit]]
         _lhsOcvisits = rule135  ()
         _lhsOdescr :: Seq (Vertex,ChildVisit)
         _lhsOdescr = rule136  ()
         _lhsOedp :: Seq Edge
         _lhsOedp = rule137  ()
         _lhsOnewedges :: Seq Edge
         _lhsOnewedges = rule138  ()
         _lhsOprev :: [Vertex]
         _lhsOprev = rule139 _lhsIprev
         _lhsOv :: Vertex
         _lhsOv = rule140 _lhsIv
         !__result_ = T_Segments_vOut13 _lhsOcvisits _lhsOdescr _lhsOedp _lhsOfirstInh _lhsOgroups _lhsOhdIntravisits _lhsOnewedges _lhsOnewvertices _lhsOprev _lhsOsegs _lhsOv
         in __result_ )
     in C_Segments_s14 v13
   {-# INLINE rule130 #-}





   {-# INLINE rule131 #-}





   {-# INLINE rule132 #-}





   {-# INLINE rule133 #-}





   {-# INLINE rule134 #-}





   {-# INLINE rule135 #-}
   rule135 = \  (_ :: ()) ->
     []
   {-# INLINE rule136 #-}
   rule136 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule137 #-}
   rule137 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule138 #-}
   rule138 = \  (_ :: ()) ->
     Seq.empty
   {-# INLINE rule139 #-}
   rule139 = \ ((_lhsIprev) :: [Vertex]) ->
     _lhsIprev
   {-# INLINE rule140 #-}
   rule140 = \ ((_lhsIv) :: Vertex) ->
     _lhsIv = \  (_ :: ()) ->   []













   rule131 = \  (_ :: ()) ->]





















































































































































   rule132 = \  (_ :: ()) ->   repeat []






































































   rule133 = \  (_ :: ()) ->]














































   rule134 = \  (_ :: ()) ->]





























































































































































































































































































































































































































































































































































































































































































































































































</pre>