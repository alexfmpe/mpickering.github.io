<a href="CreateVpc.hs2721122891398556760.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Data.hs2035308228158374933.out.html">next</a></br></br><pre>16c16
< mkConfig "configParser" [config|
---
> $ "configParser" [config|
39a40
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE TemplateHaskell, QuasiQuotes #-}
module AWS.Credential
    ( Credential(..)
    , AccessKey
    , SecretAccessKey
    , loadCredential
    , loadCredentialFromFile
    , newCredential
    ) where

import Data.ByteString (ByteString)
import qualified Data.ByteString as BS
import Text.Config
import Text.Parsec

mkConfig "configParser" [config|
Credential
    accessKey       ByteString
    secretAccessKey ByteString
|]

type AccessKey = ByteString
type SecretAccessKey = ByteString

-- | Load credential from \"./aws.config\".
loadCredential :: IO Credential
loadCredential = loadCredentialFromFile "aws.config"

-- | Create new credential.
newCredential :: AccessKey -> SecretAccessKey -> Credential
newCredential key secret = Credential key secret

-- | Load credential from file.
loadCredentialFromFile :: FilePath -> IO Credential
loadCredentialFromFile path = do
    str <- BS.readFile path
    case parse configParser "" str of
        Left err   -> fail $ show err
        Right conf -> return conf
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE TemplateHaskell, QuasiQuotes #-}
module AWS.Credential
    ( Credential(..)
    , AccessKey
    , SecretAccessKey
    , loadCredential
    , loadCredentialFromFile
    , newCredential
    ) where

import Data.ByteString (ByteString)
import qualified Data.ByteString as BS
import Text.Config
import Text.Parsec

$ "configParser" [config|
Credential
    accessKey       ByteString
    secretAccessKey ByteString
|]

type AccessKey = ByteString
type SecretAccessKey = ByteString

-- | Load credential from \"./aws.config\".
loadCredential :: IO Credential
loadCredential = loadCredentialFromFile "aws.config"

-- | Create new credential.
newCredential :: AccessKey -> SecretAccessKey -> Credential
newCredential key secret = Credential key secret

-- | Load credential from file.
loadCredentialFromFile :: FilePath -> IO Credential
loadCredentialFromFile path = do
    str <- BS.readFile path
    case parse configParser "" str of
        Left err   -> fail $ show err
        Right conf -> return conf

</pre>