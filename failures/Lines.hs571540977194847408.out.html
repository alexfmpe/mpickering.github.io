<a href="LinearAlgebra.hs1168120094298918984.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Link.hs19427277221083454666.out.html">next</a></br></br><pre>14c14
< toLineStyle ∷ LineOption → LineStyle
---
> toLineStyle :: LineOption -> LineStyle
18d17
<         1 → []
19d17
<         2 → [5,5]
20d17
<         3 → [2,4]
21d17
<         4 → [5,3,2,3]
22d17
<         5 → [8,3]
23d17
<         6 → [8,3,3,3]
24c18
<         _ → [])
---
>         1 -> []
24a19
>         2 -> [5,5]
24a20
>         3 -> [2,4]
24a21
>         4 -> [5,3,2,3]
24a22
>         5 -> [8,3]
24a23
>         6 -> [8,3,3,3]
24a24
>         _ -> [])
27c27
< line ∷ F.Foldable f ⇒ LineOption → (Maybe (f Double), f Double) → EitherPlot
---
> line :: F.Foldable f => LineOption -> (Maybe (f Double), f Double) -> EitherPlot
34a35
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE OverloadedStrings, UnicodeSyntax #-}
{-# LANGUAGE FlexibleContexts #-}

module Graphics.Rendering.HPlot.Lines where

import qualified Data.Foldable as F
import Graphics.Rendering.Chart
import Control.Lens
import Data.Default
import Graphics.Rendering.HPlot.Types
import Graphics.Rendering.HPlot.Utils
import Data.Maybe

toLineStyle ∷ LineOption → LineStyle
toLineStyle opt = line_width .~ opt^.lwd
    $ line_color .~ mkColor (opt^.col) (opt^.opacity)
    $ line_dashes .~ (case opt^.lty of
        1 → []
        2 → [5,5]
        3 → [2,4]
        4 → [5,3,2,3]
        5 → [8,3]
        6 → [8,3,3,3]
        _ → [])
    $ def

line ∷ F.Foldable f ⇒ LineOption → (Maybe (f Double), f Double) → EitherPlot
line opt (x,y) | isNothing x = Left $ mkPlot $ addIndexes y'
               | otherwise = Right $ mkPlot $ zip (F.toList $ fromJust x) y'
    where
        y' = F.toList y
        mkPlot x_y = toPlot $ plot_lines_values .~ [x_y]
            $ plot_lines_style .~ toLineStyle opt
            $ def
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE OverloadedStrings, UnicodeSyntax #-}
{-# LANGUAGE FlexibleContexts #-}

module Graphics.Rendering.HPlot.Lines where

import qualified Data.Foldable as F
import Graphics.Rendering.Chart
import Control.Lens
import Data.Default
import Graphics.Rendering.HPlot.Types
import Graphics.Rendering.HPlot.Utils
import Data.Maybe

toLineStyle :: LineOption -> LineStyle
toLineStyle opt = line_width .~ opt^.lwd
    $ line_color .~ mkColor (opt^.col) (opt^.opacity)
    $ line_dashes .~ (case opt^.lty of
        1 -> []
        2 -> [5,5]
        3 -> [2,4]
        4 -> [5,3,2,3]
        5 -> [8,3]
        6 -> [8,3,3,3]
        _ -> [])
    $ def

line :: F.Foldable f => LineOption -> (Maybe (f Double), f Double) -> EitherPlot
line opt (x,y) | isNothing x = Left $ mkPlot $ addIndexes y'
               | otherwise = Right $ mkPlot $ zip (F.toList $ fromJust x) y'
    where
        y' = F.toList y
        mkPlot x_y = toPlot $ plot_lines_values .~ [x_y]
            $ plot_lines_style .~ toLineStyle opt
            $ def

</pre>