<a href="GL.hs270649095428975319.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Global.hs13539632491323602331.out.html">next</a></br></br><pre>12d11
<         Initiator  {} → [sd s]
13d11
<         Applicator {} → [sd n, sd s, sd e]
14d11
<         Abstractor {} → [sd n, sd s, sd e]
15d11
<         Primitive  {} → [sd n]
16d11
<         Eraser     {} → [sd n]
17c12
<         Duplicator {} → [sd n, (sw, s), (se, s)]
---
>         Initiator  {} -> [sd s]
17a13
>         Applicator {} -> [sd n, sd s, sd e]
17a14
>         Abstractor {} -> [sd n, sd s, sd e]
17a15
>         Primitive  {} -> [sd n]
17a16
>         Eraser     {} -> [sd n]
17a17
>         Duplicator {} -> [sd n, (sw, s), (se, s)]
29d28
<     Initiator  {} → drawNode "I"
30d28
<     Applicator {} → drawNode "@"
31d28
<     Abstractor {} → drawNode (name node)
32d28
<     Primitive  {} → drawNode (name node)
33d28
<     Eraser     {} → drawNode ""
34c29
<     Duplicator {} → do
---
>     Initiator  {} -> drawNode "I"
34a30
>     Applicator {} -> drawNode "@"
34a31
>     Abstractor {} -> drawNode (name node)
34a32
>     Primitive  {} -> drawNode (name node)
34a33
>     Eraser     {} -> drawNode ""
34a34
>     Duplicator {} -> do
41c41
< drawPorts ∷ NodeWW -> IO ()
---
> drawPorts :: NodeWW -> IO ()
55a56
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE UnicodeSyntax #-}
module GL () where

import Graph
import GraphRewriting.Layout.PortSpec
import qualified Graphics.UI.GLUT as GL
import GraphRewriting.GL.Render


instance PortSpec NodeWW where
    portSpec node = let sd = sameDir in case node of
        Initiator  {} → [sd s]
        Applicator {} → [sd n, sd s, sd e]
        Abstractor {} → [sd n, sd s, sd e]
        Primitive  {} → [sd n]
        Eraser     {} → [sd n]
        Duplicator {} → [sd n, (sw, s), (se, s)]
        where
            n = Vector2 0 1
            w = Vector2 (-1) 0
            e = Vector2 1 0
            s = Vector2 0 (-1)
            sw = Vector2 (-1) (-1)
            se = Vector2 1 (-1)

instance Render NodeWW where render = renderNode

renderNode node = drawPorts node >> case node of
    Initiator  {} → drawNode "I"
    Applicator {} → drawNode "@"
    Abstractor {} → drawNode (name node)
    Primitive  {} → drawNode (name node)
    Eraser     {} → drawNode ""
    Duplicator {} → do
        GL.preservingMatrix $ GL.renderPrimitive GL.LineLoop $ do
            vertex2 (0,1)
            vertex2 (-1,-1)
            vertex2 (1,-1)
        renderString $ if active node then "*" else ""

drawPorts ∷ NodeWW -> IO ()
drawPorts = mapM_ drawPort . relPortPos

circle r1 r2 step = mapM_ vertex2 vs where
    is = take (truncate step + 1) [0, i' .. ]
    i' = 2 * pi / step
    vs = [ (r1 * cos i, r2 * sin i) | i <- is ]

drawPort pos = GL.preservingMatrix $ do
    GL.translate $ vector pos
    GL.renderPrimitive GL.Polygon (circle 0.15 0.15 10)

drawNode label = do
    GL.renderPrimitive GL.LineLoop (circle 1 1 20)
    renderString label
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE UnicodeSyntax #-}
module GL () where

import Graph
import GraphRewriting.Layout.PortSpec
import qualified Graphics.UI.GLUT as GL
import GraphRewriting.GL.Render


instance PortSpec NodeWW where
    portSpec node = let sd = sameDir in case node of
        Initiator  {} -> [sd s]
        Applicator {} -> [sd n, sd s, sd e]
        Abstractor {} -> [sd n, sd s, sd e]
        Primitive  {} -> [sd n]
        Eraser     {} -> [sd n]
        Duplicator {} -> [sd n, (sw, s), (se, s)]
        where
            n = Vector2 0 1
            w = Vector2 (-1) 0
            e = Vector2 1 0
            s = Vector2 0 (-1)
            sw = Vector2 (-1) (-1)
            se = Vector2 1 (-1)

instance Render NodeWW where render = renderNode

renderNode node = drawPorts node >> case node of
    Initiator  {} -> drawNode "I"
    Applicator {} -> drawNode "@"
    Abstractor {} -> drawNode (name node)
    Primitive  {} -> drawNode (name node)
    Eraser     {} -> drawNode ""
    Duplicator {} -> do
        GL.preservingMatrix $ GL.renderPrimitive GL.LineLoop $ do
            vertex2 (0,1)
            vertex2 (-1,-1)
            vertex2 (1,-1)
        renderString $ if active node then "*" else ""

drawPorts :: NodeWW -> IO ()
drawPorts = mapM_ drawPort . relPortPos

circle r1 r2 step = mapM_ vertex2 vs where
    is = take (truncate step + 1) [0, i' .. ]
    i' = 2 * pi / step
    vs = [ (r1 * cos i, r2 * sin i) | i <- is ]

drawPort pos = GL.preservingMatrix $ do
    GL.translate $ vector pos
    GL.renderPrimitive GL.Polygon (circle 0.15 0.15 10)

drawNode label = do
    GL.renderPrimitive GL.LineLoop (circle 1 1 20)
    renderString label

</pre>