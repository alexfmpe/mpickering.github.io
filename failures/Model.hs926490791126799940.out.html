<a href="mkrr.hs7180441561457517399.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Module.hs466138615371358049.out.html">next</a></br></br><pre>61d60
< ok                       :: Status = (200, "OK")
62d60
< badRequest               :: Status = (400, "Bad Request")
63d60
< unauthorized             :: Status = (401, "Unauthorized")
64d60
< forbidden                :: Status = (403, "Forbidden")
65d60
< notFound                 :: Status = (404, "Not Found")
66d60
< methodNotAllowed         :: Status = (405, "Method Not Allowed")
67d60
< requestTimeOut           :: Status = (408, "Request Time-out")
68d60
< entityTooLarge           :: Status = (413, "Entity Too Large")
69d60
< requestURITooLarge       :: Status = (414, "Request-URI Too Large")
70d60
< notImplemented           :: Status = (501, "Not Implemented")
71d60
< serviceUnavailable       :: Status = (503, "Service Unavailable")
72c61
< httpVersionNotSupported  :: Status = (505, "HTTP Version not supported")
---
> ok                          Status = (200, "OK")
72a62
> badRequest                  Status = (400, "Bad Request")
72a63
> unauthorized                Status = (401, "Unauthorized")
72a64
> forbidden                   Status = (403, "Forbidden")
72a65
> notFound                    Status = (404, "Not Found")
72a66
> methodNotAllowed            Status = (405, "Method Not Allowed")
72a67
> requestTimeOut              Status = (408, "Request Time-out")
72a68
> entityTooLarge              Status = (413, "Entity Too Large")
72a69
> requestURITooLarge          Status = (414, "Request-URI Too Large")
72a70
> notImplemented              Status = (501, "Not Implemented")
72a71
> serviceUnavailable          Status = (503, "Service Unavailable")
72a72
> httpVersionNotSupported     Status = (505, "HTTP Version not supported")
110a111
> 
</pre></br><h2>original</h2></br><pre>module Wobsurv.Util.HTTP.Model where

import BasePrelude
import qualified Data.ByteString as ByteString


type BS =
  ByteString.ByteString

type Version =
  (Word, Word)

-- * Headers
-------------------------

data Header =
  ConnectionHeader ConnectionHeader |
  ContentLengthHeader ContentLengthHeader |
  ContentTypeHeader ContentTypeHeader |
  KeepAliveHeader KeepAliveHeader
  deriving (Show, Read, Eq, Ord, Typeable, Generic)

-- | Specifies whether to keep the connection alive.
type ConnectionHeader =
  Bool

-- | A length of the content in octets.
type ContentLengthHeader =
  Word

-- | A MIME type of content and possibly a charset
type ContentTypeHeader =
  (BS, Maybe Charset)

-- | A timeout in seconds and possibly a maximum amount of requests.
type KeepAliveHeader =
  (Word, Maybe Word)

data Charset =
  UTF8
  deriving (Show, Read, Eq, Ord, Enum, Bounded, Typeable, Generic)


-- * Methods
-------------------------

data StandardMethod =
  Options | Get | Head | Post | Put | Delete | Trace | Connect
  deriving (Show, Read, Eq, Ord, Enum, Bounded, Typeable, Generic)

type Method =
  Either StandardMethod BS


-- * Statuses
-------------------------

type Status =
  (Word, BS)

ok                       :: Status = (200, "OK")
badRequest               :: Status = (400, "Bad Request")
unauthorized             :: Status = (401, "Unauthorized")
forbidden                :: Status = (403, "Forbidden")
notFound                 :: Status = (404, "Not Found")
methodNotAllowed         :: Status = (405, "Method Not Allowed")
requestTimeOut           :: Status = (408, "Request Time-out")
entityTooLarge           :: Status = (413, "Entity Too Large")
requestURITooLarge       :: Status = (414, "Request-URI Too Large")
notImplemented           :: Status = (501, "Not Implemented")
serviceUnavailable       :: Status = (503, "Service Unavailable")
httpVersionNotSupported  :: Status = (505, "HTTP Version not supported")


-- * URI
-------------------------

data URI =
  AbsoluteURI !Scheme !Authority !(Maybe Port) !RelativeURI |
  SchemeRelativeURI !Authority !(Maybe Port) !RelativeURI |
  RelativeURI !RelativeURI
  deriving (Show, Read, Eq, Ord, Typeable, Generic)

type RelativeURI =
  (Maybe RelativePath, Maybe Query, Maybe Fragment)

type Authority =
  Either Domain IP

data Scheme =
  HTTP | HTTPS
  deriving (Show, Read, Eq, Ord, Enum, Bounded, Typeable, Generic)

type Domain =
  BS

type IP =
  BS

type Port =
  Int

type RelativePath =
  BS

type Query =
  BS

type Fragment =
  BS
</pre></br><h2>printed</h2></br><pre>module Wobsurv.Util.HTTP.Model where

import BasePrelude
import qualified Data.ByteString as ByteString


type BS =
  ByteString.ByteString

type Version =
  (Word, Word)

-- * Headers
-------------------------

data Header =
  ConnectionHeader ConnectionHeader |
  ContentLengthHeader ContentLengthHeader |
  ContentTypeHeader ContentTypeHeader |
  KeepAliveHeader KeepAliveHeader
  deriving (Show, Read, Eq, Ord, Typeable, Generic)

-- | Specifies whether to keep the connection alive.
type ConnectionHeader =
  Bool

-- | A length of the content in octets.
type ContentLengthHeader =
  Word

-- | A MIME type of content and possibly a charset
type ContentTypeHeader =
  (BS, Maybe Charset)

-- | A timeout in seconds and possibly a maximum amount of requests.
type KeepAliveHeader =
  (Word, Maybe Word)

data Charset =
  UTF8
  deriving (Show, Read, Eq, Ord, Enum, Bounded, Typeable, Generic)


-- * Methods
-------------------------

data StandardMethod =
  Options | Get | Head | Post | Put | Delete | Trace | Connect
  deriving (Show, Read, Eq, Ord, Enum, Bounded, Typeable, Generic)

type Method =
  Either StandardMethod BS


-- * Statuses
-------------------------

type Status =
  (Word, BS)

ok                          Status = (200, "OK")
badRequest                  Status = (400, "Bad Request")
unauthorized                Status = (401, "Unauthorized")
forbidden                   Status = (403, "Forbidden")
notFound                    Status = (404, "Not Found")
methodNotAllowed            Status = (405, "Method Not Allowed")
requestTimeOut              Status = (408, "Request Time-out")
entityTooLarge              Status = (413, "Entity Too Large")
requestURITooLarge          Status = (414, "Request-URI Too Large")
notImplemented              Status = (501, "Not Implemented")
serviceUnavailable          Status = (503, "Service Unavailable")
httpVersionNotSupported     Status = (505, "HTTP Version not supported")


-- * URI
-------------------------

data URI =
  AbsoluteURI !Scheme !Authority !(Maybe Port) !RelativeURI |
  SchemeRelativeURI !Authority !(Maybe Port) !RelativeURI |
  RelativeURI !RelativeURI
  deriving (Show, Read, Eq, Ord, Typeable, Generic)

type RelativeURI =
  (Maybe RelativePath, Maybe Query, Maybe Fragment)

type Authority =
  Either Domain IP

data Scheme =
  HTTP | HTTPS
  deriving (Show, Read, Eq, Ord, Enum, Bounded, Typeable, Generic)

type Domain =
  BS

type IP =
  BS

type Port =
  Int

type RelativePath =
  BS

type Query =
  BS

type Fragment =
  BS

</pre>