<a href="test.hs2817252261901915394.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Test.hs543436550290145159.out.html">next</a></br></br><pre>15d14
< import "base" Control.Monad      ( (=<<), when )
16d14
< import "base" Data.Bool          ( Bool(True) )
17d14
< import "base" Data.Function      ( ($), on )
18d14
< import "base" Data.List          ( filter, groupBy, head, intercalate, length, map, sortBy )
19d14
< import "base" Data.Maybe         ( Maybe(Just), fromMaybe )
20d14
< import "base" Data.Ord           ( (<), (>), compare )
21d14
< import "base" Data.Tuple         ( fst, snd )
22d14
< import "base" Prelude            ( (+), (-), String )
23d14
< import "base" System.Environment ( getArgs )
24d14
< import "base" System.IO          ( IO )
25d14
< import "base" Text.Printf        ( printf )
26d14
< import "base" Text.Show          ( Show, show )
27d14
< import "base-unicode-symbols" Data.Eq.Unicode       ( (≡), (≢) )
28d14
< import "base-unicode-symbols" Data.Function.Unicode ( (∘) )
29d14
< import "base-unicode-symbols" Prelude.Unicode       ( ℤ, (⋅) )
30d14
< import "HUnit" Test.HUnit ( Assertion, assertFailure, assertBool )
31d14
< import           "numerals" Text.Numeral.Grammar
32d14
< import qualified "numerals" Text.Numeral.Grammar.Reified as GR
33d14
< import           "numerals" Text.Numeral.Misc ( dec, intLog )
34c15
< import "QuickCheck" Test.QuickCheck.Modifiers
---
> import  Control.Monad      ( (=<<), when )
34a16
> import  Data.Bool          ( Bool(True) )
34a17
> import  Data.Function      ( ($), on )
34a18
> import  Data.List          ( filter, groupBy, head, intercalate, length, map, sortBy )
34a19
> import  Data.Maybe         ( Maybe(Just), fromMaybe )
34a20
> import  Data.Ord           ( (<), (>), compare )
34a21
> import  Data.Tuple         ( fst, snd )
34a22
> import  Prelude            ( (+), (-), String )
34a23
> import  System.Environment ( getArgs )
34a24
> import  System.IO          ( IO )
34a25
> import  Text.Printf        ( printf )
34a26
> import  Text.Show          ( Show, show )
34a27
> import  Data.Eq.Unicode       ( (≡), (≢) )
34a28
> import  Data.Function.Unicode ( (∘) )
34a29
> import  Prelude.Unicode       ( ℤ, (⋅) )
34a30
> import  Test.HUnit ( Assertion, assertFailure, assertBool )
34a31
> import            Text.Numeral.Grammar
34a32
> import qualified  Text.Numeral.Grammar.Reified as GR
34a33
> import            Text.Numeral.Misc ( dec, intLog )
34a34
> import  Test.QuickCheck.Modifiers
36c36
< import "test-framework" Test.Framework ( defaultMainWithOpts
---
> import  Test.Framework ( defaultMainWithOpts
41d40
< import "test-framework-hunit" Test.Framework.Providers.HUnit ( testCase )
42d40
< import "test-framework-quickcheck2" Test.Framework.Providers.QuickCheck2 ( testProperty )
43d40
< import           "this" Text.Numeral.Test ( TestData )
44d40
< import "text" Data.Text ( Text )
45c41
< import qualified "text" Data.Text as T ( unpack )
---
> import  Test.Framework.Providers.HUnit ( testCase )
45a42
> import  Test.Framework.Providers.QuickCheck2 ( testProperty )
45a43
> import            Text.Numeral.Test ( TestData )
45a44
> import  Data.Text ( Text )
45a45
> import qualified  Data.Text as T ( unpack )
47d46
< import qualified "numerals" Text.Numeral.Language.AF  as AF
48d46
< import qualified "numerals" Text.Numeral.Language.AMP as AMP
49d46
< import qualified "numerals" Text.Numeral.Language.BG  as BG
50d46
< import qualified "numerals" Text.Numeral.Language.CHN as CHN
51d46
< import qualified "numerals" Text.Numeral.Language.CHR as CHR
52d46
< import qualified "numerals" Text.Numeral.Language.CLM as CLM
53d46
< import qualified "numerals" Text.Numeral.Language.CS  as CS
54d46
< import qualified "numerals" Text.Numeral.Language.DE  as DE
55d46
< import qualified "numerals" Text.Numeral.Language.EN  as EN
56d46
< import qualified "numerals" Text.Numeral.Language.EO  as EO
57d46
< import qualified "numerals" Text.Numeral.Language.ES  as ES
58d46
< import qualified "numerals" Text.Numeral.Language.FI  as FI
59d46
< import qualified "numerals" Text.Numeral.Language.FR  as FR
60d46
< import qualified "numerals" Text.Numeral.Language.FUR as FUR
61d46
< import qualified "numerals" Text.Numeral.Language.GSW as GSW
62d46
< import qualified "numerals" Text.Numeral.Language.GV  as GV
63d46
< import qualified "numerals" Text.Numeral.Language.HE  as HE
64d46
< import qualified "numerals" Text.Numeral.Language.HOP as HOP
65d46
< import qualified "numerals" Text.Numeral.Language.IT  as IT
66d46
< import qualified "numerals" Text.Numeral.Language.JA  as JA
67d46
< import qualified "numerals" Text.Numeral.Language.LA  as LA
68d46
< import qualified "numerals" Text.Numeral.Language.LLD as LLD
69d46
< import qualified "numerals" Text.Numeral.Language.MG  as MG
70d46
< import qualified "numerals" Text.Numeral.Language.NL  as NL
71d46
< import qualified "numerals" Text.Numeral.Language.NO  as NO
72d46
< import qualified "numerals" Text.Numeral.Language.NQM as NQM
73d46
< import qualified "numerals" Text.Numeral.Language.OJ  as OJ
74d46
< import qualified "numerals" Text.Numeral.Language.PDC as PDC
75d46
< import qualified "numerals" Text.Numeral.Language.PL  as PL
76d46
< import qualified "numerals" Text.Numeral.Language.PT  as PT
77d46
< import qualified "numerals" Text.Numeral.Language.RU  as RU
78d46
< import qualified "numerals" Text.Numeral.Language.SCO as SCO
79d46
< import qualified "numerals" Text.Numeral.Language.SV  as SV
80d46
< import qualified "numerals" Text.Numeral.Language.TR  as TR
81d46
< import qualified "numerals" Text.Numeral.Language.WO  as WO
82d46
< import qualified "numerals" Text.Numeral.Language.YOR as YOR
83c47
< import qualified "numerals" Text.Numeral.Language.ZH  as ZH
---
> import qualified  Text.Numeral.Language.AF  as AF
83a48
> import qualified  Text.Numeral.Language.AMP as AMP
83a49
> import qualified  Text.Numeral.Language.BG  as BG
83a50
> import qualified  Text.Numeral.Language.CHN as CHN
83a51
> import qualified  Text.Numeral.Language.CHR as CHR
83a52
> import qualified  Text.Numeral.Language.CLM as CLM
83a53
> import qualified  Text.Numeral.Language.CS  as CS
83a54
> import qualified  Text.Numeral.Language.DE  as DE
83a55
> import qualified  Text.Numeral.Language.EN  as EN
83a56
> import qualified  Text.Numeral.Language.EO  as EO
83a57
> import qualified  Text.Numeral.Language.ES  as ES
83a58
> import qualified  Text.Numeral.Language.FI  as FI
83a59
> import qualified  Text.Numeral.Language.FR  as FR
83a60
> import qualified  Text.Numeral.Language.FUR as FUR
83a61
> import qualified  Text.Numeral.Language.GSW as GSW
83a62
> import qualified  Text.Numeral.Language.GV  as GV
83a63
> import qualified  Text.Numeral.Language.HE  as HE
83a64
> import qualified  Text.Numeral.Language.HOP as HOP
83a65
> import qualified  Text.Numeral.Language.IT  as IT
83a66
> import qualified  Text.Numeral.Language.JA  as JA
83a67
> import qualified  Text.Numeral.Language.LA  as LA
83a68
> import qualified  Text.Numeral.Language.LLD as LLD
83a69
> import qualified  Text.Numeral.Language.MG  as MG
83a70
> import qualified  Text.Numeral.Language.NL  as NL
83a71
> import qualified  Text.Numeral.Language.NO  as NO
83a72
> import qualified  Text.Numeral.Language.NQM as NQM
83a73
> import qualified  Text.Numeral.Language.OJ  as OJ
83a74
> import qualified  Text.Numeral.Language.PDC as PDC
83a75
> import qualified  Text.Numeral.Language.PL  as PL
83a76
> import qualified  Text.Numeral.Language.PT  as PT
83a77
> import qualified  Text.Numeral.Language.RU  as RU
83a78
> import qualified  Text.Numeral.Language.SCO as SCO
83a79
> import qualified  Text.Numeral.Language.SV  as SV
83a80
> import qualified  Text.Numeral.Language.TR  as TR
83a81
> import qualified  Text.Numeral.Language.WO  as WO
83a82
> import qualified  Text.Numeral.Language.YOR as YOR
83a83
> import qualified  Text.Numeral.Language.ZH  as ZH
85d84
< import qualified "this" Text.Numeral.Language.ACH.TestData as ACH
86d84
< import qualified "this" Text.Numeral.Language.ADY.TestData as ADY
87d84
< import qualified "this" Text.Numeral.Language.AF.TestData  as AF
88d84
< import qualified "this" Text.Numeral.Language.AMP.TestData as AMP
89d84
< import qualified "this" Text.Numeral.Language.ARI.TestData as ARI
90d84
< import qualified "this" Text.Numeral.Language.AST.TestData as AST
91d84
< import qualified "this" Text.Numeral.Language.AZ.TestData  as AZ
92d84
< import qualified "this" Text.Numeral.Language.BA.TestData  as BA
93d84
< import qualified "this" Text.Numeral.Language.BG.TestData  as BG
94d84
< import qualified "this" Text.Numeral.Language.BM.TestData  as BM
95d84
< import qualified "this" Text.Numeral.Language.CA.TestData  as CA
96d84
< import qualified "this" Text.Numeral.Language.CAF.TestData as CAF
97d84
< import qualified "this" Text.Numeral.Language.CBK.TestData as CBK
98d84
< import qualified "this" Text.Numeral.Language.CHN.TestData as CHN
99d84
< import qualified "this" Text.Numeral.Language.CHR.TestData as CHR
100d84
< import qualified "this" Text.Numeral.Language.CLM.TestData as CLM
101d84
< import qualified "this" Text.Numeral.Language.CO.TestData  as CO
102d84
< import qualified "this" Text.Numeral.Language.COD.TestData as COD
103d84
< import qualified "this" Text.Numeral.Language.COO.TestData as COO
104d84
< import qualified "this" Text.Numeral.Language.CS.TestData  as CS
105d84
< import qualified "this" Text.Numeral.Language.CY.TestData  as CY
106d84
< import qualified "this" Text.Numeral.Language.DE.TestData  as DE
107d84
< import qualified "this" Text.Numeral.Language.DJK.TestData as DJK
108d84
< import qualified "this" Text.Numeral.Language.EN.TestData  as EN
109d84
< import qualified "this" Text.Numeral.Language.EO.TestData  as EO
110d84
< import qualified "this" Text.Numeral.Language.ES.TestData  as ES
111d84
< import qualified "this" Text.Numeral.Language.ET.TestData  as ET
112d84
< import qualified "this" Text.Numeral.Language.FI.TestData  as FI
113d84
< import qualified "this" Text.Numeral.Language.FO.TestData  as FO
114d84
< import qualified "this" Text.Numeral.Language.FR.TestData  as FR
115d84
< import qualified "this" Text.Numeral.Language.FUR.TestData as FUR
116d84
< import qualified "this" Text.Numeral.Language.GCF_MTQ.TestData as GCF_MTQ
117d84
< import qualified "this" Text.Numeral.Language.GIL.TestData as GIL
118d84
< import qualified "this" Text.Numeral.Language.GL.TestData  as GL
119d84
< import qualified "this" Text.Numeral.Language.GSW.TestData as GSW
120d84
< import qualified "this" Text.Numeral.Language.GV.TestData  as GV
121d84
< import qualified "this" Text.Numeral.Language.HAI.TestData as HAI
122d84
< import qualified "this" Text.Numeral.Language.HE.TestData  as HE
123d84
< import qualified "this" Text.Numeral.Language.HOP.TestData as HOP
124d84
< import qualified "this" Text.Numeral.Language.HR.TestData  as HR
125d84
< import qualified "this" Text.Numeral.Language.HU.TestData  as HU
126d84
< import qualified "this" Text.Numeral.Language.HY.TestData  as HY
127d84
< import qualified "this" Text.Numeral.Language.IT.TestData  as IT
128d84
< import qualified "this" Text.Numeral.Language.JA.TestData  as JA
129d84
< import qualified "this" Text.Numeral.Language.KAP.TestData as KAP
130d84
< import qualified "this" Text.Numeral.Language.KEA.TestData as KEA
131d84
< import qualified "this" Text.Numeral.Language.LA.TestData  as LA
132d84
< import qualified "this" Text.Numeral.Language.LLD.TestData as LLD
133d84
< import qualified "this" Text.Numeral.Language.MG.TestData  as MG
134d84
< import qualified "this" Text.Numeral.Language.MOH.TestData as MOH
135d84
< import qualified "this" Text.Numeral.Language.NL.TestData  as NL
136d84
< import qualified "this" Text.Numeral.Language.NO.TestData  as NO
137d84
< import qualified "this" Text.Numeral.Language.NQM.TestData as NQM
138d84
< import qualified "this" Text.Numeral.Language.OJ.TestData  as OJ
139d84
< import qualified "this" Text.Numeral.Language.PAA.TestData as PAA
140d84
< import qualified "this" Text.Numeral.Language.PDC.TestData as PDC
141d84
< import qualified "this" Text.Numeral.Language.PL.TestData  as PL
142d84
< import qualified "this" Text.Numeral.Language.PT.TestData  as PT
143d84
< import qualified "this" Text.Numeral.Language.RMN_DZA.TestData as RMN_DZA
144d84
< import qualified "this" Text.Numeral.Language.RO.TestData  as RO
145d84
< import qualified "this" Text.Numeral.Language.RU.TestData  as RU
146d84
< import qualified "this" Text.Numeral.Language.SCO.TestData as SCO
147d84
< import qualified "this" Text.Numeral.Language.SV.TestData  as SV
148d84
< import qualified "this" Text.Numeral.Language.TAR.TestData as TAR
149d84
< import qualified "this" Text.Numeral.Language.TR.TestData  as TR
150d84
< import qualified "this" Text.Numeral.Language.WO.TestData  as WO
151d84
< import qualified "this" Text.Numeral.Language.YOR.TestData as YOR
152d84
< import qualified "this" Text.Numeral.Language.ZAQ.TestData as ZAQ
153d84
< import qualified "this" Text.Numeral.Language.ZH.TestData  as ZH
154c85
< import qualified "this" Text.Numeral.Language.ZPC.TestData as ZPC
---
> import qualified  Text.Numeral.Language.ACH.TestData as ACH
154a86
> import qualified  Text.Numeral.Language.ADY.TestData as ADY
154a87
> import qualified  Text.Numeral.Language.AF.TestData  as AF
154a88
> import qualified  Text.Numeral.Language.AMP.TestData as AMP
154a89
> import qualified  Text.Numeral.Language.ARI.TestData as ARI
154a90
> import qualified  Text.Numeral.Language.AST.TestData as AST
154a91
> import qualified  Text.Numeral.Language.AZ.TestData  as AZ
154a92
> import qualified  Text.Numeral.Language.BA.TestData  as BA
154a93
> import qualified  Text.Numeral.Language.BG.TestData  as BG
154a94
> import qualified  Text.Numeral.Language.BM.TestData  as BM
154a95
> import qualified  Text.Numeral.Language.CA.TestData  as CA
154a96
> import qualified  Text.Numeral.Language.CAF.TestData as CAF
154a97
> import qualified  Text.Numeral.Language.CBK.TestData as CBK
154a98
> import qualified  Text.Numeral.Language.CHN.TestData as CHN
154a99
> import qualified  Text.Numeral.Language.CHR.TestData as CHR
154a100
> import qualified  Text.Numeral.Language.CLM.TestData as CLM
154a101
> import qualified  Text.Numeral.Language.CO.TestData  as CO
154a102
> import qualified  Text.Numeral.Language.COD.TestData as COD
154a103
> import qualified  Text.Numeral.Language.COO.TestData as COO
154a104
> import qualified  Text.Numeral.Language.CS.TestData  as CS
154a105
> import qualified  Text.Numeral.Language.CY.TestData  as CY
154a106
> import qualified  Text.Numeral.Language.DE.TestData  as DE
154a107
> import qualified  Text.Numeral.Language.DJK.TestData as DJK
154a108
> import qualified  Text.Numeral.Language.EN.TestData  as EN
154a109
> import qualified  Text.Numeral.Language.EO.TestData  as EO
154a110
> import qualified  Text.Numeral.Language.ES.TestData  as ES
154a111
> import qualified  Text.Numeral.Language.ET.TestData  as ET
154a112
> import qualified  Text.Numeral.Language.FI.TestData  as FI
154a113
> import qualified  Text.Numeral.Language.FO.TestData  as FO
154a114
> import qualified  Text.Numeral.Language.FR.TestData  as FR
154a115
> import qualified  Text.Numeral.Language.FUR.TestData as FUR
154a116
> import qualified  Text.Numeral.Language.GCF_MTQ.TestData as GCF_MTQ
154a117
> import qualified  Text.Numeral.Language.GIL.TestData as GIL
154a118
> import qualified  Text.Numeral.Language.GL.TestData  as GL
154a119
> import qualified  Text.Numeral.Language.GSW.TestData as GSW
154a120
> import qualified  Text.Numeral.Language.GV.TestData  as GV
154a121
> import qualified  Text.Numeral.Language.HAI.TestData as HAI
154a122
> import qualified  Text.Numeral.Language.HE.TestData  as HE
154a123
> import qualified  Text.Numeral.Language.HOP.TestData as HOP
154a124
> import qualified  Text.Numeral.Language.HR.TestData  as HR
154a125
> import qualified  Text.Numeral.Language.HU.TestData  as HU
154a126
> import qualified  Text.Numeral.Language.HY.TestData  as HY
154a127
> import qualified  Text.Numeral.Language.IT.TestData  as IT
154a128
> import qualified  Text.Numeral.Language.JA.TestData  as JA
154a129
> import qualified  Text.Numeral.Language.KAP.TestData as KAP
154a130
> import qualified  Text.Numeral.Language.KEA.TestData as KEA
154a131
> import qualified  Text.Numeral.Language.LA.TestData  as LA
154a132
> import qualified  Text.Numeral.Language.LLD.TestData as LLD
154a133
> import qualified  Text.Numeral.Language.MG.TestData  as MG
154a134
> import qualified  Text.Numeral.Language.MOH.TestData as MOH
154a135
> import qualified  Text.Numeral.Language.NL.TestData  as NL
154a136
> import qualified  Text.Numeral.Language.NO.TestData  as NO
154a137
> import qualified  Text.Numeral.Language.NQM.TestData as NQM
154a138
> import qualified  Text.Numeral.Language.OJ.TestData  as OJ
154a139
> import qualified  Text.Numeral.Language.PAA.TestData as PAA
154a140
> import qualified  Text.Numeral.Language.PDC.TestData as PDC
154a141
> import qualified  Text.Numeral.Language.PL.TestData  as PL
154a142
> import qualified  Text.Numeral.Language.PT.TestData  as PT
154a143
> import qualified  Text.Numeral.Language.RMN_DZA.TestData as RMN_DZA
154a144
> import qualified  Text.Numeral.Language.RO.TestData  as RO
154a145
> import qualified  Text.Numeral.Language.RU.TestData  as RU
154a146
> import qualified  Text.Numeral.Language.SCO.TestData as SCO
154a147
> import qualified  Text.Numeral.Language.SV.TestData  as SV
154a148
> import qualified  Text.Numeral.Language.TAR.TestData as TAR
154a149
> import qualified  Text.Numeral.Language.TR.TestData  as TR
154a150
> import qualified  Text.Numeral.Language.WO.TestData  as WO
154a151
> import qualified  Text.Numeral.Language.YOR.TestData as YOR
154a152
> import qualified  Text.Numeral.Language.ZAQ.TestData as ZAQ
154a153
> import qualified  Text.Numeral.Language.ZH.TestData  as ZH
154a154
> import qualified  Text.Numeral.Language.ZPC.TestData as ZPC
161d160
< main ∷ IO ()
162c161
< main = do opts ← interpretArgsOrExit =<< getArgs
---
> main :: IO ()
162a162
> main = do opts <- interpretArgsOrExit =<< getArgs
165c165
< tests ∷ [Test]
---
> tests :: [Test]
203c203
<       [testUnique "cardinal" (ACH.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (ACH.cardinals :: TestData ℤ)]
207c207
<       [testUnique "cardinal" (ADY.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (ADY.cardinals :: TestData ℤ)]
211d210
<       [ testUnique "cardinal" (AF.cardinals ∷ TestData ℤ)
212c211
<       , testUnique "ordinal"  (AF.ordinals  ∷ TestData ℤ)
---
>       [ testUnique "cardinal" (AF.cardinals :: TestData ℤ)
212a212
>       , testUnique "ordinal"  (AF.ordinals  :: TestData ℤ)
214d213
<     , mkTests "cardinal" AF.cardinal (AF.cardinals ∷ TestData ℤ)
215c214
<     , mkTests "ordinal"  AF.ordinal  (AF.ordinals  ∷ TestData ℤ)
---
>     , mkTests "cardinal" AF.cardinal (AF.cardinals :: TestData ℤ)
215a215
>     , mkTests "ordinal"  AF.ordinal  (AF.ordinals  :: TestData ℤ)
219d218
<       [testUnique "cardinal" (AMP.cardinals ∷ TestData ℤ)]
220c219
<     , mkTests "cardinal" AMP.cardinal (AMP.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (AMP.cardinals :: TestData ℤ)]
220a220
>     , mkTests "cardinal" AMP.cardinal (AMP.cardinals :: TestData ℤ)
224c224
<       [testUnique "cardinal" (ARI.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (ARI.cardinals :: TestData ℤ)]
228c228
<       [testUnique "cardinal" (AST.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (AST.cardinals :: TestData ℤ)]
232c232
<       [testUnique "cardinal" (AZ.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (AZ.cardinals :: TestData ℤ)]
236c236
<       [testUnique "cardinal" (BA.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (BA.cardinals :: TestData ℤ)]
240d239
<       [testUnique "cardinal" (BG.cardinals ∷ TestData ℤ)]
241c240
<     , mkTests "cardinal" BG.cardinal (BG.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (BG.cardinals :: TestData ℤ)]
241a241
>     , mkTests "cardinal" BG.cardinal (BG.cardinals :: TestData ℤ)
245c245
<       [testUnique "cardinal" (BM.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (BM.cardinals :: TestData ℤ)]
249c249
<       [testUnique "cardinal" (CA.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (CA.cardinals :: TestData ℤ)]
253d252
<       [ testUnique "cardinal" (CAF.cardinals ∷ TestData ℤ)
254c253
<       , testUnique "cardinal (syllabic)" (CAF.syllabic_cardinals ∷ TestData ℤ)
---
>       [ testUnique "cardinal" (CAF.cardinals :: TestData ℤ)
254a254
>       , testUnique "cardinal (syllabic)" (CAF.syllabic_cardinals :: TestData ℤ)
259c259
<       [testUnique "cardinal" (CBK.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (CBK.cardinals :: TestData ℤ)]
263d262
<       [testUnique "cardinal" (CHN.cardinals ∷ TestData ℤ)]
264c263
<     , mkTests "cardinal" CHN.cardinal (CHN.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (CHN.cardinals :: TestData ℤ)]
264a264
>     , mkTests "cardinal" CHN.cardinal (CHN.cardinals :: TestData ℤ)
268d267
<       [testUnique "cardinal" (CHR.cardinals ∷ TestData ℤ)]
269c268
<     , mkTests "cardinal" CHR.cardinal (CHR.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (CHR.cardinals :: TestData ℤ)]
269a269
>     , mkTests "cardinal" CHR.cardinal (CHR.cardinals :: TestData ℤ)
273d272
<       [testUnique "cardinal" (CLM.cardinals ∷ TestData ℤ)]
274c273
<     , mkTests "cardinal" CLM.cardinal (CLM.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (CLM.cardinals :: TestData ℤ)]
274a274
>     , mkTests "cardinal" CLM.cardinal (CLM.cardinals :: TestData ℤ)
278c278
<       [testUnique "cardinal" (CO.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (CO.cardinals :: TestData ℤ)]
282c282
<       [testUnique "cardinal" (COD.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (COD.cardinals :: TestData ℤ)]
286c286
<       [testUnique "cardinal" (COO.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (COO.cardinals :: TestData ℤ)]
290d289
<       [testUnique "cardinal" (CS.cardinals ∷ TestData ℤ)]
291c290
<     , mkTests "cardinal" CS.cardinal (CS.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (CS.cardinals :: TestData ℤ)]
291a291
>     , mkTests "cardinal" CS.cardinal (CS.cardinals :: TestData ℤ)
295c295
<       [testUnique "cardinal" (CY.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (CY.cardinals :: TestData ℤ)]
299d298
<       [ testUnique "cardinal" (DE.cardinals ∷ TestData ℤ)
300c299
<       , testUnique "ordinal"  (DE.ordinals  ∷ TestData ℤ)
---
>       [ testUnique "cardinal" (DE.cardinals :: TestData ℤ)
300a300
>       , testUnique "ordinal"  (DE.ordinals  :: TestData ℤ)
302d301
<     , mkTests "cardinal" DE.cardinal (DE.cardinals ∷ TestData ℤ)
303c302
<     , mkTests "ordinal"  DE.ordinal  (DE.ordinals  ∷ TestData ℤ)
---
>     , mkTests "cardinal" DE.cardinal (DE.cardinals :: TestData ℤ)
303a303
>     , mkTests "ordinal"  DE.ordinal  (DE.ordinals  :: TestData ℤ)
307c307
<       [testUnique "cardinal" (DJK.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (DJK.cardinals :: TestData ℤ)]
312d311
<         [ testUnique "cardinal" (EN.gb_cardinals ∷ TestData ℤ)
313c312
<         , testUnique "ordinal"  (EN.gb_ordinals  ∷ TestData ℤ)
---
>         [ testUnique "cardinal" (EN.gb_cardinals :: TestData ℤ)
313a313
>         , testUnique "ordinal"  (EN.gb_ordinals  :: TestData ℤ)
315d314
<       , mkTests "cardinal" EN.gb_cardinal (EN.gb_cardinals ∷ TestData ℤ)
316c315
<       , mkTests "ordinal"  EN.gb_ordinal  (EN.gb_ordinals  ∷ TestData ℤ)
---
>       , mkTests "cardinal" EN.gb_cardinal (EN.gb_cardinals :: TestData ℤ)
316a316
>       , mkTests "ordinal"  EN.gb_ordinal  (EN.gb_ordinals  :: TestData ℤ)
320d319
<         [ testUnique "cardinal" (EN.us_cardinals ∷ TestData ℤ)
321c320
<         , testUnique "ordinal"  (EN.us_ordinals  ∷ TestData ℤ)
---
>         [ testUnique "cardinal" (EN.us_cardinals :: TestData ℤ)
321a321
>         , testUnique "ordinal"  (EN.us_ordinals  :: TestData ℤ)
323d322
<       , mkTests "cardinal" EN.us_cardinal (EN.us_cardinals ∷ TestData ℤ)
324c323
<       , mkTests "ordinal"  EN.us_ordinal  (EN.us_ordinals  ∷ TestData ℤ)
---
>       , mkTests "cardinal" EN.us_cardinal (EN.us_cardinals :: TestData ℤ)
324a324
>       , mkTests "ordinal"  EN.us_ordinal  (EN.us_ordinals  :: TestData ℤ)
329d328
<       [testUnique "cardinal" (EO.cardinals ∷ TestData ℤ)]
330c329
<     , mkTests "cardinal" EO.cardinal (EO.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (EO.cardinals :: TestData ℤ)]
330a330
>     , mkTests "cardinal" EO.cardinal (EO.cardinals :: TestData ℤ)
334d333
<       [testUnique "cardinal" (ES.cardinals ∷ TestData ℤ)]
335c334
<     , mkTests "cardinal" ES.cardinal (ES.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (ES.cardinals :: TestData ℤ)]
335a335
>     , mkTests "cardinal" ES.cardinal (ES.cardinals :: TestData ℤ)
339c339
<       [testUnique "cardinal" (ET.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (ET.cardinals :: TestData ℤ)]
343d342
<       [ testUnique "cardinal" (FI.cardinals ∷ TestData ℤ)
344c343
<       , testUnique "ordinal"  (FI.ordinals  ∷ TestData ℤ)
---
>       [ testUnique "cardinal" (FI.cardinals :: TestData ℤ)
344a344
>       , testUnique "ordinal"  (FI.ordinals  :: TestData ℤ)
346d345
<     , mkTests "cardinal" FI.cardinal (FI.cardinals ∷ TestData ℤ)
347c346
<     , mkTests "ordinal"  FI.ordinal  (FI.ordinals ∷ TestData ℤ)
---
>     , mkTests "cardinal" FI.cardinal (FI.cardinals :: TestData ℤ)
347a347
>     , mkTests "ordinal"  FI.ordinal  (FI.ordinals :: TestData ℤ)
351c351
<       [testUnique "cardinal" (FO.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (FO.cardinals :: TestData ℤ)]
355d354
<       [ testUnique "cardinal" (FR.cardinals ∷ TestData ℤ)
356c355
<       , testUnique "ordinal"  (FR.ordinals  ∷ TestData ℤ)
---
>       [ testUnique "cardinal" (FR.cardinals :: TestData ℤ)
356a356
>       , testUnique "ordinal"  (FR.ordinals  :: TestData ℤ)
358d357
<     , mkTests "cardinal" FR.cardinal (FR.cardinals ∷ TestData ℤ)
359c358
<     , mkTests "ordinal"  FR.ordinal  (FR.ordinals  ∷ TestData ℤ)
---
>     , mkTests "cardinal" FR.cardinal (FR.cardinals :: TestData ℤ)
359a359
>     , mkTests "ordinal"  FR.ordinal  (FR.ordinals  :: TestData ℤ)
363d362
<       [testUnique "cardinal" (FUR.cardinals ∷ TestData ℤ)]
364c363
<     , mkTests "cardinal" FUR.cardinal (FUR.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (FUR.cardinals :: TestData ℤ)]
364a364
>     , mkTests "cardinal" FUR.cardinal (FUR.cardinals :: TestData ℤ)
368c368
<       [testUnique "cardinal" (GCF_MTQ.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (GCF_MTQ.cardinals :: TestData ℤ)]
372c372
<       [testUnique "cardinal" (GIL.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (GIL.cardinals :: TestData ℤ)]
376c376
<       [testUnique "cardinal" (GL.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (GL.cardinals :: TestData ℤ)]
380d379
<       [testUnique "cardinal" (GSW.cardinals ∷ TestData ℤ)]
381c380
<     , mkTests "cardinal" GSW.cardinal (GSW.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (GSW.cardinals :: TestData ℤ)]
381a381
>     , mkTests "cardinal" GSW.cardinal (GSW.cardinals :: TestData ℤ)
385d384
<       [testUnique "cardinal" (GV.cardinals ∷ TestData ℤ)]
386c385
<     , mkTests "cardinal" GV.cardinal  (GV.cardinals  ∷ TestData ℤ)
---
>       [testUnique "cardinal" (GV.cardinals :: TestData ℤ)]
386a386
>     , mkTests "cardinal" GV.cardinal  (GV.cardinals  :: TestData ℤ)
390c390
<       [testUnique "cardinal" (HAI.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (HAI.cardinals :: TestData ℤ)]
394d393
<       [testUnique "cardinal" (HE.cardinals ∷ TestData ℤ)]
395c394
<     , mkTests "cardinal" HE.cardinal  (HE.cardinals  ∷ TestData ℤ)
---
>       [testUnique "cardinal" (HE.cardinals :: TestData ℤ)]
395a395
>     , mkTests "cardinal" HE.cardinal  (HE.cardinals  :: TestData ℤ)
399d398
<       [testUnique "cardinal" (HOP.cardinals ∷ TestData ℤ)]
400c399
<     , mkTests "cardinal" HOP.cardinal (HOP.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (HOP.cardinals :: TestData ℤ)]
400a400
>     , mkTests "cardinal" HOP.cardinal (HOP.cardinals :: TestData ℤ)
404c404
<       [testUnique "cardinal" (HR.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (HR.cardinals :: TestData ℤ)]
408c408
<       [testUnique "cardinal" (HU.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (HU.cardinals :: TestData ℤ)]
412c412
<       [testUnique "cardinal" (HY.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (HY.cardinals :: TestData ℤ)]
416d415
<       [testUnique "cardinal" (IT.cardinals ∷ TestData ℤ)]
417d415
<     , mkTests "cardinal" IT.cardinal (IT.cardinals ∷ TestData ℤ)
418c416
<     , mkTests "ordinal"  IT.ordinal  (IT.ordinals  ∷ TestData ℤ)
---
>       [testUnique "cardinal" (IT.cardinals :: TestData ℤ)]
418a417
>     , mkTests "cardinal" IT.cardinal (IT.cardinals :: TestData ℤ)
418a418
>     , mkTests "ordinal"  IT.ordinal  (IT.ordinals  :: TestData ℤ)
423c423
<         [testUnique "cardinal" (JA.preferred_cardinals ∷ TestData ℤ)]
---
>         [testUnique "cardinal" (JA.preferred_cardinals :: TestData ℤ)]
425c425
<                           (JA.preferred_cardinals ∷ TestData ℤ)
---
>                           (JA.preferred_cardinals :: TestData ℤ)
429d428
<         [testUnique "cardinal" (JA.kanji_cardinals ∷ TestData ℤ)]
430c429
<       , mkTests "cardinal" JA.kanji_cardinal (JA.kanji_cardinals ∷ TestData ℤ)
---
>         [testUnique "cardinal" (JA.kanji_cardinals :: TestData ℤ)]
430a430
>       , mkTests "cardinal" JA.kanji_cardinal (JA.kanji_cardinals :: TestData ℤ)
434d433
<         [testUnique "cardinal" (JA.daiji_cardinals ∷ TestData ℤ)]
435c434
<       , mkTests "cardinal" JA.daiji_cardinal (JA.daiji_cardinals ∷ TestData ℤ)
---
>         [testUnique "cardinal" (JA.daiji_cardinals :: TestData ℤ)]
435a435
>       , mkTests "cardinal" JA.daiji_cardinal (JA.daiji_cardinals :: TestData ℤ)
440c440
<       [testUnique "cardinal" (KAP.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (KAP.cardinals :: TestData ℤ)]
444c444
<       [testUnique "cardinal" (KEA.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (KEA.cardinals :: TestData ℤ)]
448d447
<       [testUnique "cardinal" (LA.cardinals ∷ TestData ℤ)]
449c448
<     , mkTests "cardinal" LA.cardinal (LA.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (LA.cardinals :: TestData ℤ)]
449a449
>     , mkTests "cardinal" LA.cardinal (LA.cardinals :: TestData ℤ)
453d452
<       [testUnique "cardinal" (LLD.cardinals ∷ TestData ℤ)]
454c453
<     , mkTests "cardinal" LLD.cardinal (LLD.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (LLD.cardinals :: TestData ℤ)]
454a454
>     , mkTests "cardinal" LLD.cardinal (LLD.cardinals :: TestData ℤ)
458d457
<       [testUnique "cardinal" (MG.cardinals ∷ TestData ℤ)]
459c458
<     , mkTests "cardinal" MG.cardinal (MG.cardinals  ∷ TestData ℤ)
---
>       [testUnique "cardinal" (MG.cardinals :: TestData ℤ)]
459a459
>     , mkTests "cardinal" MG.cardinal (MG.cardinals  :: TestData ℤ)
463c463
<       [testUnique "cardinal" (MOH.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (MOH.cardinals :: TestData ℤ)]
467d466
<       [ testUnique "cardinal"       (NL.cardinals       ∷ TestData ℤ)
468d466
<       , testUnique "ordinal"        (NL.ordinals        ∷ TestData ℤ)
469d466
<       , testUnique "partitive"      (NL.partitives      ∷ TestData (ℤ, ℤ))
470c467
<       , testUnique "multiplicative" (NL.multiplicatives ∷ TestData ℤ)
---
>       [ testUnique "cardinal"       (NL.cardinals       :: TestData ℤ)
470a468
>       , testUnique "ordinal"        (NL.ordinals        :: TestData ℤ)
470a469
>       , testUnique "partitive"      (NL.partitives      :: TestData (ℤ, ℤ))
470a470
>       , testUnique "multiplicative" (NL.multiplicatives :: TestData ℤ)
472d471
<     , mkTests "cardinal"       NL.cardinal  (NL.cardinals  ∷ TestData ℤ)
473d471
<     , mkTests "ordinal"        NL.ordinal   (NL.ordinals   ∷ TestData ℤ)
474d471
<     , mkTests "partitive"      NL.partitive (NL.partitives ∷ TestData (ℤ, ℤ))
475c472
<     , mkTests "multiplicative" NL.multiplicative (NL.multiplicatives ∷ TestData ℤ)
---
>     , mkTests "cardinal"       NL.cardinal  (NL.cardinals  :: TestData ℤ)
475a473
>     , mkTests "ordinal"        NL.ordinal   (NL.ordinals   :: TestData ℤ)
475a474
>     , mkTests "partitive"      NL.partitive (NL.partitives :: TestData (ℤ, ℤ))
475a475
>     , mkTests "multiplicative" NL.multiplicative (NL.multiplicatives :: TestData ℤ)
479d478
<       [testUnique "cardinal" (NO.cardinals ∷ TestData ℤ)]
480c479
<     , mkTests "cardinal" NO.cardinal  (NO.cardinals  ∷ TestData ℤ)
---
>       [testUnique "cardinal" (NO.cardinals :: TestData ℤ)]
480a480
>     , mkTests "cardinal" NO.cardinal  (NO.cardinals  :: TestData ℤ)
484d483
<       [testUnique "cardinal" (NQM.cardinals ∷ TestData ℤ)]
485c484
<     , mkTests "cardinal" NQM.cardinal (NQM.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (NQM.cardinals :: TestData ℤ)]
485a485
>     , mkTests "cardinal" NQM.cardinal (NQM.cardinals :: TestData ℤ)
489d488
<       [testUnique "cardinal" (OJ.cardinals ∷ TestData ℤ)]
490c489
<     , mkTests "cardinal" OJ.cardinal  (OJ.cardinals  ∷ TestData ℤ)
---
>       [testUnique "cardinal" (OJ.cardinals :: TestData ℤ)]
490a490
>     , mkTests "cardinal" OJ.cardinal  (OJ.cardinals  :: TestData ℤ)
494c494
<       [testUnique "cardinal" (PAA.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (PAA.cardinals :: TestData ℤ)]
498d497
<       [testUnique "cardinal" (PDC.cardinals ∷ TestData ℤ)]
499c498
<     , mkTests "cardinal" PDC.cardinal (PDC.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (PDC.cardinals :: TestData ℤ)]
499a499
>     , mkTests "cardinal" PDC.cardinal (PDC.cardinals :: TestData ℤ)
503d502
<       [testUnique "cardinal" (PL.cardinals ∷ TestData ℤ)]
504c503
<     , mkTests "cardinal" PL.cardinal  (PL.cardinals  ∷ TestData ℤ)
---
>       [testUnique "cardinal" (PL.cardinals :: TestData ℤ)]
504a504
>     , mkTests "cardinal" PL.cardinal  (PL.cardinals  :: TestData ℤ)
508d507
<       [testUnique "cardinal" (PT.cardinals ∷ TestData ℤ)]
509d507
<     , mkTests "cardinal" PT.cardinal (PT.cardinals  ∷ TestData ℤ)
510c508
<     , mkTests "ordinal"  PT.ordinal  (PT.ordinals   ∷ TestData ℤ)
---
>       [testUnique "cardinal" (PT.cardinals :: TestData ℤ)]
510a509
>     , mkTests "cardinal" PT.cardinal (PT.cardinals  :: TestData ℤ)
510a510
>     , mkTests "ordinal"  PT.ordinal  (PT.ordinals   :: TestData ℤ)
514c514
<       [testUnique "cardinal" (RMN_DZA.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (RMN_DZA.cardinals :: TestData ℤ)]
518c518
<       [testUnique "cardinal" (RO.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (RO.cardinals :: TestData ℤ)]
522d521
<       [testUnique "cardinal" (RU.cardinals ∷ TestData ℤ)]
523c522
<     , mkTests "cardinal" RU.cardinal  (RU.cardinals  ∷ TestData ℤ)
---
>       [testUnique "cardinal" (RU.cardinals :: TestData ℤ)]
523a523
>     , mkTests "cardinal" RU.cardinal  (RU.cardinals  :: TestData ℤ)
527d526
<       [testUnique "cardinal" (SCO.cardinals ∷ TestData ℤ)]
528c527
<     , mkTests "cardinal" SCO.cardinal (SCO.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (SCO.cardinals :: TestData ℤ)]
528a528
>     , mkTests "cardinal" SCO.cardinal (SCO.cardinals :: TestData ℤ)
532d531
<       [ testUnique "cardinal" (SV.cardinals ∷ TestData ℤ)
533c532
<       , testUnique "ordinal"  (SV.ordinals  ∷ TestData ℤ)
---
>       [ testUnique "cardinal" (SV.cardinals :: TestData ℤ)
533a533
>       , testUnique "ordinal"  (SV.ordinals  :: TestData ℤ)
535d534
<     , mkTests "cardinal" SV.cardinal (SV.cardinals ∷ TestData ℤ)
536c535
<     , mkTests "ordinal"  SV.ordinal  (SV.ordinals  ∷ TestData ℤ)
---
>     , mkTests "cardinal" SV.cardinal (SV.cardinals :: TestData ℤ)
536a536
>     , mkTests "ordinal"  SV.ordinal  (SV.ordinals  :: TestData ℤ)
540c540
<       [testUnique "cardinal" (TAR.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (TAR.cardinals :: TestData ℤ)]
544d543
<       [testUnique "cardinal" (TR.cardinals ∷ TestData ℤ)]
545c544
<     , mkTests "cardinal" TR.cardinal (TR.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (TR.cardinals :: TestData ℤ)]
545a545
>     , mkTests "cardinal" TR.cardinal (TR.cardinals :: TestData ℤ)
549d548
<       [testUnique "cardinal" (WO.cardinals ∷ TestData ℤ)]
550c549
<     , mkTests "cardinal" WO.cardinal (WO.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (WO.cardinals :: TestData ℤ)]
550a550
>     , mkTests "cardinal" WO.cardinal (WO.cardinals :: TestData ℤ)
554d553
<       [testUnique "cardinal" (YOR.cardinals ∷ TestData ℤ)]
555c554
<     , mkTests "cardinal" YOR.cardinal (YOR.cardinals ∷ TestData ℤ)
---
>       [testUnique "cardinal" (YOR.cardinals :: TestData ℤ)]
555a555
>     , mkTests "cardinal" YOR.cardinal (YOR.cardinals :: TestData ℤ)
559c559
<       [testUnique "cardinal" (ZAQ.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (ZAQ.cardinals :: TestData ℤ)]
564d563
<         [testUnique "cardinal" (ZH.trad_cardinals ∷ TestData ℤ)]
565c564
<       , mkTests "cardinal" ZH.trad_cardinal (ZH.trad_cardinals ∷ TestData ℤ)
---
>         [testUnique "cardinal" (ZH.trad_cardinals :: TestData ℤ)]
565a565
>       , mkTests "cardinal" ZH.trad_cardinal (ZH.trad_cardinals :: TestData ℤ)
569d568
<         [testUnique "cardinal" (ZH.simpl_cardinals ∷ TestData ℤ)]
570c569
<       , mkTests "cardinal" ZH.simpl_cardinal (ZH.simpl_cardinals ∷ TestData ℤ)
---
>         [testUnique "cardinal" (ZH.simpl_cardinals :: TestData ℤ)]
570a570
>       , mkTests "cardinal" ZH.simpl_cardinal (ZH.simpl_cardinals :: TestData ℤ)
574d573
<         [testUnique "cardinal" (ZH.finance_trad_cardinals ∷ TestData ℤ)]
575c574
<       , mkTests "cardinal" ZH.finance_trad_cardinal (ZH.finance_trad_cardinals ∷ TestData ℤ)
---
>         [testUnique "cardinal" (ZH.finance_trad_cardinals :: TestData ℤ)]
575a575
>       , mkTests "cardinal" ZH.finance_trad_cardinal (ZH.finance_trad_cardinals :: TestData ℤ)
579d578
<         [testUnique "cardinal" (ZH.finance_simpl_cardinals ∷ TestData ℤ)]
580c579
<       , mkTests "cardinal" ZH.finance_simpl_cardinal (ZH.finance_simpl_cardinals ∷ TestData ℤ)
---
>         [testUnique "cardinal" (ZH.finance_simpl_cardinals :: TestData ℤ)]
580a580
>       , mkTests "cardinal" ZH.finance_simpl_cardinal (ZH.finance_simpl_cardinals :: TestData ℤ)
584d583
<         [testUnique "cardinal" (ZH.pinyin_cardinals ∷ TestData ℤ)]
585c584
<       , mkTests "cardinal" ZH.pinyin_cardinal (ZH.pinyin_cardinals ∷ TestData ℤ)
---
>         [testUnique "cardinal" (ZH.pinyin_cardinals :: TestData ℤ)]
585a585
>       , mkTests "cardinal" ZH.pinyin_cardinal (ZH.pinyin_cardinals :: TestData ℤ)
589c589
<       [testUnique "cardinal" (ZPC.cardinals ∷ TestData ℤ)]
---
>       [testUnique "cardinal" (ZPC.cardinals :: TestData ℤ)]
613c613
< testInf ∷ (GR.Inflection → GR.Inflection) → (GR.Inflection → Bool) → Assertion
---
> testInf :: (GR.Inflection -> GR.Inflection) -> (GR.Inflection -> Bool) -> Assertion
616c616
< intLog_pow10 ∷ Positive ℤ → Bool
---
> intLog_pow10 :: Positive ℤ -> Bool
619c619
< intLog_pow10m1 ∷ NonNegative ℤ → Bool
---
> intLog_pow10m1 :: NonNegative ℤ -> Bool
622c622
< intLog_mul ∷ Positive ℤ → Positive ℤ → Bool
---
> intLog_mul :: Positive ℤ -> Positive ℤ -> Bool
625d624
< mkTests ∷ ∀ α. (Show α)
626d624
<         ⇒ String
627d624
<         → (GR.Inflection → α → Maybe Text)
628d624
<         → TestData α
629c625
<         → Test
---
> mkTests :: forall α. (Show α)
629a626
>         => String
629a627
>         -> (GR.Inflection -> α -> Maybe Text)
629a628
>         -> TestData α
629a629
>         -> Test
632c632
<     perInflection ∷ (String, GR.Inflection, [(α, Text)]) → Test
---
>     perInflection :: (String, GR.Inflection, [(α, Text)]) -> Test
635c635
<     perValue ∷ GR.Inflection → (α, Text) → Test
---
>     perValue :: GR.Inflection -> (α, Text) -> Test
640c640
< testUnique ∷ ∀ α. (Show α) ⇒ String → TestData α → Test
---
> testUnique :: forall α. (Show α) => String -> TestData α -> Test
643c643
<     perInflection ∷ (String, inf, [(α, Text)]) → Test
---
>     perInflection :: (String, inf, [(α, Text)]) -> Test
646c646
<     unique ∷ [(α, Text)] → Assertion
---
>     unique :: [(α, Text)] -> Assertion
651c651
<         ys ∷ [[(α, Text)]]
---
>         ys :: [[(α, Text)]]
656c656
<     msg ∷ [(α, Text)] → String
---
>     msg :: [(α, Text)] -> String
662d661
< testConversion ∷ (Show α)
663d661
<                ⇒ (GR.Inflection → α → Maybe Text)
664d661
<                → GR.Inflection
665d661
<                → α
666d661
<                → Text
667c662
<                → Assertion
---
> testConversion :: (Show α)
667a663
>                => (GR.Inflection -> α -> Maybe Text)
667a664
>                -> GR.Inflection
667a665
>                -> α
667a666
>                -> Text
667a667
>                -> Assertion
675a676
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE NoImplicitPrelude   #-}
{-# LANGUAGE OverloadedStrings   #-}
{-# LANGUAGE PackageImports      #-}
{-# LANGUAGE ScopedTypeVariables #-}
{-# LANGUAGE UnicodeSyntax       #-}


module Main where


--------------------------------------------------------------------------------
-- Imports
--------------------------------------------------------------------------------

import "base" Control.Monad      ( (=<<), when )
import "base" Data.Bool          ( Bool(True) )
import "base" Data.Function      ( ($), on )
import "base" Data.List          ( filter, groupBy, head, intercalate, length, map, sortBy )
import "base" Data.Maybe         ( Maybe(Just), fromMaybe )
import "base" Data.Ord           ( (<), (>), compare )
import "base" Data.Tuple         ( fst, snd )
import "base" Prelude            ( (+), (-), String )
import "base" System.Environment ( getArgs )
import "base" System.IO          ( IO )
import "base" Text.Printf        ( printf )
import "base" Text.Show          ( Show, show )
import "base-unicode-symbols" Data.Eq.Unicode       ( (≡), (≢) )
import "base-unicode-symbols" Data.Function.Unicode ( (∘) )
import "base-unicode-symbols" Prelude.Unicode       ( ℤ, (⋅) )
import "HUnit" Test.HUnit ( Assertion, assertFailure, assertBool )
import           "numerals" Text.Numeral.Grammar
import qualified "numerals" Text.Numeral.Grammar.Reified as GR
import           "numerals" Text.Numeral.Misc ( dec, intLog )
import "QuickCheck" Test.QuickCheck.Modifiers
    ( Positive(Positive), NonNegative(NonNegative) )
import "test-framework" Test.Framework ( defaultMainWithOpts
                                       , interpretArgsOrExit
                                       , ropt_hide_successes
                                       , Test, testGroup
                                       )
import "test-framework-hunit" Test.Framework.Providers.HUnit ( testCase )
import "test-framework-quickcheck2" Test.Framework.Providers.QuickCheck2 ( testProperty )
import           "this" Text.Numeral.Test ( TestData )
import "text" Data.Text ( Text )
import qualified "text" Data.Text as T ( unpack )

import qualified "numerals" Text.Numeral.Language.AF  as AF
import qualified "numerals" Text.Numeral.Language.AMP as AMP
import qualified "numerals" Text.Numeral.Language.BG  as BG
import qualified "numerals" Text.Numeral.Language.CHN as CHN
import qualified "numerals" Text.Numeral.Language.CHR as CHR
import qualified "numerals" Text.Numeral.Language.CLM as CLM
import qualified "numerals" Text.Numeral.Language.CS  as CS
import qualified "numerals" Text.Numeral.Language.DE  as DE
import qualified "numerals" Text.Numeral.Language.EN  as EN
import qualified "numerals" Text.Numeral.Language.EO  as EO
import qualified "numerals" Text.Numeral.Language.ES  as ES
import qualified "numerals" Text.Numeral.Language.FI  as FI
import qualified "numerals" Text.Numeral.Language.FR  as FR
import qualified "numerals" Text.Numeral.Language.FUR as FUR
import qualified "numerals" Text.Numeral.Language.GSW as GSW
import qualified "numerals" Text.Numeral.Language.GV  as GV
import qualified "numerals" Text.Numeral.Language.HE  as HE
import qualified "numerals" Text.Numeral.Language.HOP as HOP
import qualified "numerals" Text.Numeral.Language.IT  as IT
import qualified "numerals" Text.Numeral.Language.JA  as JA
import qualified "numerals" Text.Numeral.Language.LA  as LA
import qualified "numerals" Text.Numeral.Language.LLD as LLD
import qualified "numerals" Text.Numeral.Language.MG  as MG
import qualified "numerals" Text.Numeral.Language.NL  as NL
import qualified "numerals" Text.Numeral.Language.NO  as NO
import qualified "numerals" Text.Numeral.Language.NQM as NQM
import qualified "numerals" Text.Numeral.Language.OJ  as OJ
import qualified "numerals" Text.Numeral.Language.PDC as PDC
import qualified "numerals" Text.Numeral.Language.PL  as PL
import qualified "numerals" Text.Numeral.Language.PT  as PT
import qualified "numerals" Text.Numeral.Language.RU  as RU
import qualified "numerals" Text.Numeral.Language.SCO as SCO
import qualified "numerals" Text.Numeral.Language.SV  as SV
import qualified "numerals" Text.Numeral.Language.TR  as TR
import qualified "numerals" Text.Numeral.Language.WO  as WO
import qualified "numerals" Text.Numeral.Language.YOR as YOR
import qualified "numerals" Text.Numeral.Language.ZH  as ZH

import qualified "this" Text.Numeral.Language.ACH.TestData as ACH
import qualified "this" Text.Numeral.Language.ADY.TestData as ADY
import qualified "this" Text.Numeral.Language.AF.TestData  as AF
import qualified "this" Text.Numeral.Language.AMP.TestData as AMP
import qualified "this" Text.Numeral.Language.ARI.TestData as ARI
import qualified "this" Text.Numeral.Language.AST.TestData as AST
import qualified "this" Text.Numeral.Language.AZ.TestData  as AZ
import qualified "this" Text.Numeral.Language.BA.TestData  as BA
import qualified "this" Text.Numeral.Language.BG.TestData  as BG
import qualified "this" Text.Numeral.Language.BM.TestData  as BM
import qualified "this" Text.Numeral.Language.CA.TestData  as CA
import qualified "this" Text.Numeral.Language.CAF.TestData as CAF
import qualified "this" Text.Numeral.Language.CBK.TestData as CBK
import qualified "this" Text.Numeral.Language.CHN.TestData as CHN
import qualified "this" Text.Numeral.Language.CHR.TestData as CHR
import qualified "this" Text.Numeral.Language.CLM.TestData as CLM
import qualified "this" Text.Numeral.Language.CO.TestData  as CO
import qualified "this" Text.Numeral.Language.COD.TestData as COD
import qualified "this" Text.Numeral.Language.COO.TestData as COO
import qualified "this" Text.Numeral.Language.CS.TestData  as CS
import qualified "this" Text.Numeral.Language.CY.TestData  as CY
import qualified "this" Text.Numeral.Language.DE.TestData  as DE
import qualified "this" Text.Numeral.Language.DJK.TestData as DJK
import qualified "this" Text.Numeral.Language.EN.TestData  as EN
import qualified "this" Text.Numeral.Language.EO.TestData  as EO
import qualified "this" Text.Numeral.Language.ES.TestData  as ES
import qualified "this" Text.Numeral.Language.ET.TestData  as ET
import qualified "this" Text.Numeral.Language.FI.TestData  as FI
import qualified "this" Text.Numeral.Language.FO.TestData  as FO
import qualified "this" Text.Numeral.Language.FR.TestData  as FR
import qualified "this" Text.Numeral.Language.FUR.TestData as FUR
import qualified "this" Text.Numeral.Language.GCF_MTQ.TestData as GCF_MTQ
import qualified "this" Text.Numeral.Language.GIL.TestData as GIL
import qualified "this" Text.Numeral.Language.GL.TestData  as GL
import qualified "this" Text.Numeral.Language.GSW.TestData as GSW
import qualified "this" Text.Numeral.Language.GV.TestData  as GV
import qualified "this" Text.Numeral.Language.HAI.TestData as HAI
import qualified "this" Text.Numeral.Language.HE.TestData  as HE
import qualified "this" Text.Numeral.Language.HOP.TestData as HOP
import qualified "this" Text.Numeral.Language.HR.TestData  as HR
import qualified "this" Text.Numeral.Language.HU.TestData  as HU
import qualified "this" Text.Numeral.Language.HY.TestData  as HY
import qualified "this" Text.Numeral.Language.IT.TestData  as IT
import qualified "this" Text.Numeral.Language.JA.TestData  as JA
import qualified "this" Text.Numeral.Language.KAP.TestData as KAP
import qualified "this" Text.Numeral.Language.KEA.TestData as KEA
import qualified "this" Text.Numeral.Language.LA.TestData  as LA
import qualified "this" Text.Numeral.Language.LLD.TestData as LLD
import qualified "this" Text.Numeral.Language.MG.TestData  as MG
import qualified "this" Text.Numeral.Language.MOH.TestData as MOH
import qualified "this" Text.Numeral.Language.NL.TestData  as NL
import qualified "this" Text.Numeral.Language.NO.TestData  as NO
import qualified "this" Text.Numeral.Language.NQM.TestData as NQM
import qualified "this" Text.Numeral.Language.OJ.TestData  as OJ
import qualified "this" Text.Numeral.Language.PAA.TestData as PAA
import qualified "this" Text.Numeral.Language.PDC.TestData as PDC
import qualified "this" Text.Numeral.Language.PL.TestData  as PL
import qualified "this" Text.Numeral.Language.PT.TestData  as PT
import qualified "this" Text.Numeral.Language.RMN_DZA.TestData as RMN_DZA
import qualified "this" Text.Numeral.Language.RO.TestData  as RO
import qualified "this" Text.Numeral.Language.RU.TestData  as RU
import qualified "this" Text.Numeral.Language.SCO.TestData as SCO
import qualified "this" Text.Numeral.Language.SV.TestData  as SV
import qualified "this" Text.Numeral.Language.TAR.TestData as TAR
import qualified "this" Text.Numeral.Language.TR.TestData  as TR
import qualified "this" Text.Numeral.Language.WO.TestData  as WO
import qualified "this" Text.Numeral.Language.YOR.TestData as YOR
import qualified "this" Text.Numeral.Language.ZAQ.TestData as ZAQ
import qualified "this" Text.Numeral.Language.ZH.TestData  as ZH
import qualified "this" Text.Numeral.Language.ZPC.TestData as ZPC


--------------------------------------------------------------------------------
-- Test suite
--------------------------------------------------------------------------------

main ∷ IO ()
main = do opts ← interpretArgsOrExit =<< getArgs
          defaultMainWithOpts tests opts { ropt_hide_successes = Just True }

tests ∷ [Test]
tests =
  [ testGroup "Grammar"
    [ testGroup "Case"
      [ testCase "noCase"       $ testInf noCase       hasNoCase
      , testCase "nominative"   $ testInf nominative   isNominative
      , testCase "accusative"   $ testInf accusative   isAccusative
      , testCase "dative"       $ testInf dative       isDative
      , testCase "ablative"     $ testInf ablative     isAblative
      , testCase "genitive"     $ testInf genitive     isGenitive
      , testCase "vocative"     $ testInf vocative     isVocative
      , testCase "instrumental" $ testInf instrumental isInstrumental
      ]
    , testGroup "Gender"
      [ testCase "noGender"  $ testInf noGender  hasNoGender
      , testCase "neuter"    $ testInf neuter    isNeuter
      , testCase "masculine" $ testInf masculine isMasculine
      , testCase "feminine"  $ testInf feminine  isFeminine
      , testCase "common"    $ testInf common    isCommon
      ]
    , testGroup "Number"
      [ testCase "noNumber" $ testInf noNumber hasNoNumber
      , testCase "singular" $ testInf singular isSingular
      , testCase "dual"     $ testInf dual     isDual
      , testCase "trial"    $ testInf trial    isTrial
      , testCase "paucal"   $ testInf paucal   isPaucal
      , testCase "plural"   $ testInf plural   isPlural
      ]
    ]
  , testGroup "Misc"
    [ testGroup "intLog"
      [ testProperty "power of 10" intLog_pow10
      , testProperty "power of 10 minus 1" intLog_pow10m1
      , testProperty "multiply" intLog_mul
      ]
    ]
  , testGroup "ACH"
    [ testGroup "unique data"
      [testUnique "cardinal" (ACH.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "ADY"
    [ testGroup "unique data"
      [testUnique "cardinal" (ADY.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "AF"
    [ testGroup "unique data"
      [ testUnique "cardinal" (AF.cardinals ∷ TestData ℤ)
      , testUnique "ordinal"  (AF.ordinals  ∷ TestData ℤ)
      ]
    , mkTests "cardinal" AF.cardinal (AF.cardinals ∷ TestData ℤ)
    , mkTests "ordinal"  AF.ordinal  (AF.ordinals  ∷ TestData ℤ)
    ]
  , testGroup "AMP"
    [ testGroup "unique data"
      [testUnique "cardinal" (AMP.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" AMP.cardinal (AMP.cardinals ∷ TestData ℤ)
    ]
  , testGroup "ARI"
    [ testGroup "unique data"
      [testUnique "cardinal" (ARI.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "AST"
    [ testGroup "unique data"
      [testUnique "cardinal" (AST.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "AZ"
    [ testGroup "unique data"
      [testUnique "cardinal" (AZ.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "BA"
    [ testGroup "unique data"
      [testUnique "cardinal" (BA.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "BG"
    [ testGroup "unique data"
      [testUnique "cardinal" (BG.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" BG.cardinal (BG.cardinals ∷ TestData ℤ)
    ]
  , testGroup "BM"
    [ testGroup "unique data"
      [testUnique "cardinal" (BM.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "CA"
    [ testGroup "unique data"
      [testUnique "cardinal" (CA.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "CAF"
    [ testGroup "unique data"
      [ testUnique "cardinal" (CAF.cardinals ∷ TestData ℤ)
      , testUnique "cardinal (syllabic)" (CAF.syllabic_cardinals ∷ TestData ℤ)
      ]
    ]
  , testGroup "CBK"
    [ testGroup "unique data"
      [testUnique "cardinal" (CBK.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "CHN"
    [ testGroup "unique data"
      [testUnique "cardinal" (CHN.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" CHN.cardinal (CHN.cardinals ∷ TestData ℤ)
    ]
  , testGroup "CHR"
    [ testGroup "unique data"
      [testUnique "cardinal" (CHR.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" CHR.cardinal (CHR.cardinals ∷ TestData ℤ)
    ]
  , testGroup "CLM"
    [ testGroup "unique data"
      [testUnique "cardinal" (CLM.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" CLM.cardinal (CLM.cardinals ∷ TestData ℤ)
    ]
  , testGroup "CO"
    [ testGroup "unique data"
      [testUnique "cardinal" (CO.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "COD"
    [ testGroup "unique data"
      [testUnique "cardinal" (COD.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "COO"
    [ testGroup "unique data"
      [testUnique "cardinal" (COO.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "CS"
    [ testGroup "unique data"
      [testUnique "cardinal" (CS.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" CS.cardinal (CS.cardinals ∷ TestData ℤ)
    ]
  , testGroup "CY"
    [ testGroup "unique data"
      [testUnique "cardinal" (CY.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "DE"
    [ testGroup "unique data"
      [ testUnique "cardinal" (DE.cardinals ∷ TestData ℤ)
      , testUnique "ordinal"  (DE.ordinals  ∷ TestData ℤ)
      ]
    , mkTests "cardinal" DE.cardinal (DE.cardinals ∷ TestData ℤ)
    , mkTests "ordinal"  DE.ordinal  (DE.ordinals  ∷ TestData ℤ)
    ]
  , testGroup "DJK"
    [ testGroup "unique data"
      [testUnique "cardinal" (DJK.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "EN"
    [ testGroup "GB"
      [ testGroup "unique data"
        [ testUnique "cardinal" (EN.gb_cardinals ∷ TestData ℤ)
        , testUnique "ordinal"  (EN.gb_ordinals  ∷ TestData ℤ)
        ]
      , mkTests "cardinal" EN.gb_cardinal (EN.gb_cardinals ∷ TestData ℤ)
      , mkTests "ordinal"  EN.gb_ordinal  (EN.gb_ordinals  ∷ TestData ℤ)
      ]
    , testGroup "US"
      [ testGroup "unique data"
        [ testUnique "cardinal" (EN.us_cardinals ∷ TestData ℤ)
        , testUnique "ordinal"  (EN.us_ordinals  ∷ TestData ℤ)
        ]
      , mkTests "cardinal" EN.us_cardinal (EN.us_cardinals ∷ TestData ℤ)
      , mkTests "ordinal"  EN.us_ordinal  (EN.us_ordinals  ∷ TestData ℤ)
      ]
    ]
  , testGroup "EO"
    [ testGroup "unique data"
      [testUnique "cardinal" (EO.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" EO.cardinal (EO.cardinals ∷ TestData ℤ)
    ]
  , testGroup "ES"
    [ testGroup "unique data"
      [testUnique "cardinal" (ES.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" ES.cardinal (ES.cardinals ∷ TestData ℤ)
    ]
  , testGroup "ET"
    [ testGroup "unique data"
      [testUnique "cardinal" (ET.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "FI"
    [ testGroup "unique data"
      [ testUnique "cardinal" (FI.cardinals ∷ TestData ℤ)
      , testUnique "ordinal"  (FI.ordinals  ∷ TestData ℤ)
      ]
    , mkTests "cardinal" FI.cardinal (FI.cardinals ∷ TestData ℤ)
    , mkTests "ordinal"  FI.ordinal  (FI.ordinals ∷ TestData ℤ)
    ]
  , testGroup "FO"
    [ testGroup "unique data"
      [testUnique "cardinal" (FO.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "FR"
    [ testGroup "unique data"
      [ testUnique "cardinal" (FR.cardinals ∷ TestData ℤ)
      , testUnique "ordinal"  (FR.ordinals  ∷ TestData ℤ)
      ]
    , mkTests "cardinal" FR.cardinal (FR.cardinals ∷ TestData ℤ)
    , mkTests "ordinal"  FR.ordinal  (FR.ordinals  ∷ TestData ℤ)
    ]
  , testGroup "FUR"
    [ testGroup "unique data"
      [testUnique "cardinal" (FUR.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" FUR.cardinal (FUR.cardinals ∷ TestData ℤ)
   ]
  , testGroup "GCF_MTQ"
    [ testGroup "unique data"
      [testUnique "cardinal" (GCF_MTQ.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "GIL"
    [ testGroup "unique data"
      [testUnique "cardinal" (GIL.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "GL"
    [ testGroup "unique data"
      [testUnique "cardinal" (GL.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "GSW"
    [ testGroup "unique data"
      [testUnique "cardinal" (GSW.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" GSW.cardinal (GSW.cardinals ∷ TestData ℤ)
    ]
  , testGroup "GV"
    [ testGroup "unique data"
      [testUnique "cardinal" (GV.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" GV.cardinal  (GV.cardinals  ∷ TestData ℤ)
    ]
  , testGroup "HAI"
    [ testGroup "unique data"
      [testUnique "cardinal" (HAI.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "HE"
    [ testGroup "unique data"
      [testUnique "cardinal" (HE.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" HE.cardinal  (HE.cardinals  ∷ TestData ℤ)
    ]
  , testGroup "HOP"
    [ testGroup "unique data"
      [testUnique "cardinal" (HOP.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" HOP.cardinal (HOP.cardinals ∷ TestData ℤ)
    ]
  , testGroup "HR"
    [ testGroup "unique data"
      [testUnique "cardinal" (HR.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "HU"
    [ testGroup "unique data"
      [testUnique "cardinal" (HU.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "HY"
    [ testGroup "unique data"
      [testUnique "cardinal" (HY.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "IT"
    [ testGroup "unique data"
      [testUnique "cardinal" (IT.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" IT.cardinal (IT.cardinals ∷ TestData ℤ)
    , mkTests "ordinal"  IT.ordinal  (IT.ordinals  ∷ TestData ℤ)
    ]
  , testGroup "JA"
    [ testGroup "preferred"
      [ testGroup "unique data"
        [testUnique "cardinal" (JA.preferred_cardinals ∷ TestData ℤ)]
      , mkTests "cardinal" JA.preferred_cardinal
                          (JA.preferred_cardinals ∷ TestData ℤ)
      ]
    , testGroup "kanji"
      [ testGroup "unique data"
        [testUnique "cardinal" (JA.kanji_cardinals ∷ TestData ℤ)]
      , mkTests "cardinal" JA.kanji_cardinal (JA.kanji_cardinals ∷ TestData ℤ)
      ]
    , testGroup "daiji"
      [ testGroup "unique data"
        [testUnique "cardinal" (JA.daiji_cardinals ∷ TestData ℤ)]
      , mkTests "cardinal" JA.daiji_cardinal (JA.daiji_cardinals ∷ TestData ℤ)
      ]
    ]
  , testGroup "KAP"
    [ testGroup "unique data"
      [testUnique "cardinal" (KAP.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "KEA"
    [ testGroup "unique data"
      [testUnique "cardinal" (KEA.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "LA"
    [ testGroup "unique data"
      [testUnique "cardinal" (LA.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" LA.cardinal (LA.cardinals ∷ TestData ℤ)
    ]
  , testGroup "LLD"
    [ testGroup "unique data"
      [testUnique "cardinal" (LLD.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" LLD.cardinal (LLD.cardinals ∷ TestData ℤ)
    ]
  , testGroup "MG"
    [ testGroup "unique data"
      [testUnique "cardinal" (MG.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" MG.cardinal (MG.cardinals  ∷ TestData ℤ)
    ]
  , testGroup "MOH"
    [ testGroup "unique data"
      [testUnique "cardinal" (MOH.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "NL"
    [ testGroup "unique data"
      [ testUnique "cardinal"       (NL.cardinals       ∷ TestData ℤ)
      , testUnique "ordinal"        (NL.ordinals        ∷ TestData ℤ)
      , testUnique "partitive"      (NL.partitives      ∷ TestData (ℤ, ℤ))
      , testUnique "multiplicative" (NL.multiplicatives ∷ TestData ℤ)
      ]
    , mkTests "cardinal"       NL.cardinal  (NL.cardinals  ∷ TestData ℤ)
    , mkTests "ordinal"        NL.ordinal   (NL.ordinals   ∷ TestData ℤ)
    , mkTests "partitive"      NL.partitive (NL.partitives ∷ TestData (ℤ, ℤ))
    , mkTests "multiplicative" NL.multiplicative (NL.multiplicatives ∷ TestData ℤ)
    ]
  , testGroup "NO"
    [ testGroup "unique data"
      [testUnique "cardinal" (NO.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" NO.cardinal  (NO.cardinals  ∷ TestData ℤ)
    ]
  , testGroup "NQM"
    [ testGroup "unique data"
      [testUnique "cardinal" (NQM.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" NQM.cardinal (NQM.cardinals ∷ TestData ℤ)
    ]
  , testGroup "OJ"
    [ testGroup "unique data"
      [testUnique "cardinal" (OJ.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" OJ.cardinal  (OJ.cardinals  ∷ TestData ℤ)
    ]
  , testGroup "PAA"
    [ testGroup "unique data"
      [testUnique "cardinal" (PAA.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "PDC"
    [ testGroup "unique data"
      [testUnique "cardinal" (PDC.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" PDC.cardinal (PDC.cardinals ∷ TestData ℤ)
    ]
  , testGroup "PL"
    [ testGroup "unique data"
      [testUnique "cardinal" (PL.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" PL.cardinal  (PL.cardinals  ∷ TestData ℤ)
    ]
  , testGroup "PT"
    [ testGroup "unique data"
      [testUnique "cardinal" (PT.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" PT.cardinal (PT.cardinals  ∷ TestData ℤ)
    , mkTests "ordinal"  PT.ordinal  (PT.ordinals   ∷ TestData ℤ)
    ]
  , testGroup "RMN_DZA"
    [ testGroup "unique data"
      [testUnique "cardinal" (RMN_DZA.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "RO"
    [ testGroup "unique data"
      [testUnique "cardinal" (RO.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "RU"
    [ testGroup "unique data"
      [testUnique "cardinal" (RU.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" RU.cardinal  (RU.cardinals  ∷ TestData ℤ)
    ]
  , testGroup "SCO"
    [ testGroup "unique data"
      [testUnique "cardinal" (SCO.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" SCO.cardinal (SCO.cardinals ∷ TestData ℤ)
    ]
  , testGroup "SV"
    [ testGroup "unique data"
      [ testUnique "cardinal" (SV.cardinals ∷ TestData ℤ)
      , testUnique "ordinal"  (SV.ordinals  ∷ TestData ℤ)
      ]
    , mkTests "cardinal" SV.cardinal (SV.cardinals ∷ TestData ℤ)
    , mkTests "ordinal"  SV.ordinal  (SV.ordinals  ∷ TestData ℤ)
    ]
  , testGroup "TAR"
    [ testGroup "unique data"
      [testUnique "cardinal" (TAR.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "TR"
    [ testGroup "unique data"
      [testUnique "cardinal" (TR.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" TR.cardinal (TR.cardinals ∷ TestData ℤ)
    ]
  , testGroup "WO"
    [ testGroup "unique data"
      [testUnique "cardinal" (WO.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" WO.cardinal (WO.cardinals ∷ TestData ℤ)
    ]
  , testGroup "YOR"
    [ testGroup "unique data"
      [testUnique "cardinal" (YOR.cardinals ∷ TestData ℤ)]
    , mkTests "cardinal" YOR.cardinal (YOR.cardinals ∷ TestData ℤ)
    ]
  , testGroup "ZAQ"
    [ testGroup "unique data"
      [testUnique "cardinal" (ZAQ.cardinals ∷ TestData ℤ)]
    ]
  , testGroup "ZH"
    [ testGroup "characters (traditional)"
      [ testGroup "unique data"
        [testUnique "cardinal" (ZH.trad_cardinals ∷ TestData ℤ)]
      , mkTests "cardinal" ZH.trad_cardinal (ZH.trad_cardinals ∷ TestData ℤ)
      ]
    , testGroup "characters (simplified)"
      [ testGroup "unique data"
        [testUnique "cardinal" (ZH.simpl_cardinals ∷ TestData ℤ)]
      , mkTests "cardinal" ZH.simpl_cardinal (ZH.simpl_cardinals ∷ TestData ℤ)
      ]
    , testGroup "financial characters (traditional)"
      [ testGroup "unique data"
        [testUnique "cardinal" (ZH.finance_trad_cardinals ∷ TestData ℤ)]
      , mkTests "cardinal" ZH.finance_trad_cardinal (ZH.finance_trad_cardinals ∷ TestData ℤ)
      ]
    , testGroup "financial characters (simplified)"
      [ testGroup "unique data"
        [testUnique "cardinal" (ZH.finance_simpl_cardinals ∷ TestData ℤ)]
      , mkTests "cardinal" ZH.finance_simpl_cardinal (ZH.finance_simpl_cardinals ∷ TestData ℤ)
      ]
    , testGroup "pinyin"
      [ testGroup "unique data"
        [testUnique "cardinal" (ZH.pinyin_cardinals ∷ TestData ℤ)]
      , mkTests "cardinal" ZH.pinyin_cardinal (ZH.pinyin_cardinals ∷ TestData ℤ)
      ]
  , testGroup "ZPC"
    [ testGroup "unique data"
      [testUnique "cardinal" (ZPC.cardinals ∷ TestData ℤ)]
    ]
    ]
  ]


--------------------------------------------------------------------------------
-- Utils
--------------------------------------------------------------------------------

{-
-- TODO: this takes way to long for large values (10 ^ 60000 - 1)
testBounds ∷ Text → (ℤ → Maybe Text) → (ℤ, ℤ) → Test
testBounds name conversion bounds@(lo, hi) =
      testGroup name
                [ testCase "lower bound" $ assertBool "conversion error" $ checkConv lo
                , testCase "upper bound" $ assertBool "conversion error" $ checkConv hi
                -- , testProperty "in between" $ forAll (choose bounds) checkConv
                ]
    where
      checkConv ∷ ℤ → Bool
      checkConv = isJust ∘ conversion
-}

testInf ∷ (GR.Inflection → GR.Inflection) → (GR.Inflection → Bool) → Assertion
testInf set test = assertBool "False" $ test $ set GR.defaultInflection

intLog_pow10 ∷ Positive ℤ → Bool
intLog_pow10 (Positive x) = x ≡ intLog (dec x)

intLog_pow10m1 ∷ NonNegative ℤ → Bool
intLog_pow10m1 (NonNegative x) = x - 1 ≡ intLog (dec x) - 1

intLog_mul ∷ Positive ℤ → Positive ℤ → Bool
intLog_mul (Positive x) (Positive y) = intLog (dec x ⋅ dec y) ≡ intLog (dec x) + intLog (dec y)

mkTests ∷ ∀ α. (Show α)
        ⇒ String
        → (GR.Inflection → α → Maybe Text)
        → TestData α
        → Test
mkTests name f = testGroup name ∘ map perInflection
  where
    perInflection ∷ (String, GR.Inflection, [(α, Text)]) → Test
    perInflection (infName, inf, xs) = testGroup infName $ map (perValue inf) xs

    perValue ∷ GR.Inflection → (α, Text) → Test
    perValue inf (n, s) = testCase (show n) $ testConversion f inf n s

-- | Tests whether the test data contains duplicates (different
-- numbers with the same representation).
testUnique ∷ ∀ α. (Show α) ⇒ String → TestData α → Test
testUnique name = testGroup name ∘ map perInflection
  where
    perInflection ∷ (String, inf, [(α, Text)]) → Test
    perInflection (infName, _, xs) = testCase infName $ unique xs

    unique ∷ [(α, Text)] → Assertion
    unique xs = when (length ys > 0)
                  $ assertFailure
                  $ intercalate "\n" $ map msg ys
      where
        ys ∷ [[(α, Text)]]
        ys = filter ((1 <) ∘ length)
             $ groupBy ((≡) `on` snd)
             $ sortBy (compare `on` snd) xs

    msg ∷ [(α, Text)] → String
    msg xs = let (_, s) = head xs
             in printf "The string \"%s\" is associated with multiple values: %s"
                       (T.unpack s)
                       (intercalate ", " $ map (show ∘ fst) xs)

testConversion ∷ (Show α)
               ⇒ (GR.Inflection → α → Maybe Text)
               → GR.Inflection
               → α
               → Text
               → Assertion
testConversion f inf n s =
  let r = f inf n
  in when (r ≢ Just s)
        $ assertFailure
        $ printf "Expected %s = \"%s\" but got \"%s\""
                 (show n)
                 (T.unpack s)
                 (T.unpack $ fromMaybe "no result" r)
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE NoImplicitPrelude   #-}
{-# LANGUAGE OverloadedStrings   #-}
{-# LANGUAGE PackageImports      #-}
{-# LANGUAGE ScopedTypeVariables #-}
{-# LANGUAGE UnicodeSyntax       #-}


module Main where


--------------------------------------------------------------------------------
-- Imports
--------------------------------------------------------------------------------

import  Control.Monad      ( (=<<), when )
import  Data.Bool          ( Bool(True) )
import  Data.Function      ( ($), on )
import  Data.List          ( filter, groupBy, head, intercalate, length, map, sortBy )
import  Data.Maybe         ( Maybe(Just), fromMaybe )
import  Data.Ord           ( (<), (>), compare )
import  Data.Tuple         ( fst, snd )
import  Prelude            ( (+), (-), String )
import  System.Environment ( getArgs )
import  System.IO          ( IO )
import  Text.Printf        ( printf )
import  Text.Show          ( Show, show )
import  Data.Eq.Unicode       ( (≡), (≢) )
import  Data.Function.Unicode ( (∘) )
import  Prelude.Unicode       ( ℤ, (⋅) )
import  Test.HUnit ( Assertion, assertFailure, assertBool )
import            Text.Numeral.Grammar
import qualified  Text.Numeral.Grammar.Reified as GR
import            Text.Numeral.Misc ( dec, intLog )
import  Test.QuickCheck.Modifiers
    ( Positive(Positive), NonNegative(NonNegative) )
import  Test.Framework ( defaultMainWithOpts
                                       , interpretArgsOrExit
                                       , ropt_hide_successes
                                       , Test, testGroup
                                       )
import  Test.Framework.Providers.HUnit ( testCase )
import  Test.Framework.Providers.QuickCheck2 ( testProperty )
import            Text.Numeral.Test ( TestData )
import  Data.Text ( Text )
import qualified  Data.Text as T ( unpack )

import qualified  Text.Numeral.Language.AF  as AF
import qualified  Text.Numeral.Language.AMP as AMP
import qualified  Text.Numeral.Language.BG  as BG
import qualified  Text.Numeral.Language.CHN as CHN
import qualified  Text.Numeral.Language.CHR as CHR
import qualified  Text.Numeral.Language.CLM as CLM
import qualified  Text.Numeral.Language.CS  as CS
import qualified  Text.Numeral.Language.DE  as DE
import qualified  Text.Numeral.Language.EN  as EN
import qualified  Text.Numeral.Language.EO  as EO
import qualified  Text.Numeral.Language.ES  as ES
import qualified  Text.Numeral.Language.FI  as FI
import qualified  Text.Numeral.Language.FR  as FR
import qualified  Text.Numeral.Language.FUR as FUR
import qualified  Text.Numeral.Language.GSW as GSW
import qualified  Text.Numeral.Language.GV  as GV
import qualified  Text.Numeral.Language.HE  as HE
import qualified  Text.Numeral.Language.HOP as HOP
import qualified  Text.Numeral.Language.IT  as IT
import qualified  Text.Numeral.Language.JA  as JA
import qualified  Text.Numeral.Language.LA  as LA
import qualified  Text.Numeral.Language.LLD as LLD
import qualified  Text.Numeral.Language.MG  as MG
import qualified  Text.Numeral.Language.NL  as NL
import qualified  Text.Numeral.Language.NO  as NO
import qualified  Text.Numeral.Language.NQM as NQM
import qualified  Text.Numeral.Language.OJ  as OJ
import qualified  Text.Numeral.Language.PDC as PDC
import qualified  Text.Numeral.Language.PL  as PL
import qualified  Text.Numeral.Language.PT  as PT
import qualified  Text.Numeral.Language.RU  as RU
import qualified  Text.Numeral.Language.SCO as SCO
import qualified  Text.Numeral.Language.SV  as SV
import qualified  Text.Numeral.Language.TR  as TR
import qualified  Text.Numeral.Language.WO  as WO
import qualified  Text.Numeral.Language.YOR as YOR
import qualified  Text.Numeral.Language.ZH  as ZH

import qualified  Text.Numeral.Language.ACH.TestData as ACH
import qualified  Text.Numeral.Language.ADY.TestData as ADY
import qualified  Text.Numeral.Language.AF.TestData  as AF
import qualified  Text.Numeral.Language.AMP.TestData as AMP
import qualified  Text.Numeral.Language.ARI.TestData as ARI
import qualified  Text.Numeral.Language.AST.TestData as AST
import qualified  Text.Numeral.Language.AZ.TestData  as AZ
import qualified  Text.Numeral.Language.BA.TestData  as BA
import qualified  Text.Numeral.Language.BG.TestData  as BG
import qualified  Text.Numeral.Language.BM.TestData  as BM
import qualified  Text.Numeral.Language.CA.TestData  as CA
import qualified  Text.Numeral.Language.CAF.TestData as CAF
import qualified  Text.Numeral.Language.CBK.TestData as CBK
import qualified  Text.Numeral.Language.CHN.TestData as CHN
import qualified  Text.Numeral.Language.CHR.TestData as CHR
import qualified  Text.Numeral.Language.CLM.TestData as CLM
import qualified  Text.Numeral.Language.CO.TestData  as CO
import qualified  Text.Numeral.Language.COD.TestData as COD
import qualified  Text.Numeral.Language.COO.TestData as COO
import qualified  Text.Numeral.Language.CS.TestData  as CS
import qualified  Text.Numeral.Language.CY.TestData  as CY
import qualified  Text.Numeral.Language.DE.TestData  as DE
import qualified  Text.Numeral.Language.DJK.TestData as DJK
import qualified  Text.Numeral.Language.EN.TestData  as EN
import qualified  Text.Numeral.Language.EO.TestData  as EO
import qualified  Text.Numeral.Language.ES.TestData  as ES
import qualified  Text.Numeral.Language.ET.TestData  as ET
import qualified  Text.Numeral.Language.FI.TestData  as FI
import qualified  Text.Numeral.Language.FO.TestData  as FO
import qualified  Text.Numeral.Language.FR.TestData  as FR
import qualified  Text.Numeral.Language.FUR.TestData as FUR
import qualified  Text.Numeral.Language.GCF_MTQ.TestData as GCF_MTQ
import qualified  Text.Numeral.Language.GIL.TestData as GIL
import qualified  Text.Numeral.Language.GL.TestData  as GL
import qualified  Text.Numeral.Language.GSW.TestData as GSW
import qualified  Text.Numeral.Language.GV.TestData  as GV
import qualified  Text.Numeral.Language.HAI.TestData as HAI
import qualified  Text.Numeral.Language.HE.TestData  as HE
import qualified  Text.Numeral.Language.HOP.TestData as HOP
import qualified  Text.Numeral.Language.HR.TestData  as HR
import qualified  Text.Numeral.Language.HU.TestData  as HU
import qualified  Text.Numeral.Language.HY.TestData  as HY
import qualified  Text.Numeral.Language.IT.TestData  as IT
import qualified  Text.Numeral.Language.JA.TestData  as JA
import qualified  Text.Numeral.Language.KAP.TestData as KAP
import qualified  Text.Numeral.Language.KEA.TestData as KEA
import qualified  Text.Numeral.Language.LA.TestData  as LA
import qualified  Text.Numeral.Language.LLD.TestData as LLD
import qualified  Text.Numeral.Language.MG.TestData  as MG
import qualified  Text.Numeral.Language.MOH.TestData as MOH
import qualified  Text.Numeral.Language.NL.TestData  as NL
import qualified  Text.Numeral.Language.NO.TestData  as NO
import qualified  Text.Numeral.Language.NQM.TestData as NQM
import qualified  Text.Numeral.Language.OJ.TestData  as OJ
import qualified  Text.Numeral.Language.PAA.TestData as PAA
import qualified  Text.Numeral.Language.PDC.TestData as PDC
import qualified  Text.Numeral.Language.PL.TestData  as PL
import qualified  Text.Numeral.Language.PT.TestData  as PT
import qualified  Text.Numeral.Language.RMN_DZA.TestData as RMN_DZA
import qualified  Text.Numeral.Language.RO.TestData  as RO
import qualified  Text.Numeral.Language.RU.TestData  as RU
import qualified  Text.Numeral.Language.SCO.TestData as SCO
import qualified  Text.Numeral.Language.SV.TestData  as SV
import qualified  Text.Numeral.Language.TAR.TestData as TAR
import qualified  Text.Numeral.Language.TR.TestData  as TR
import qualified  Text.Numeral.Language.WO.TestData  as WO
import qualified  Text.Numeral.Language.YOR.TestData as YOR
import qualified  Text.Numeral.Language.ZAQ.TestData as ZAQ
import qualified  Text.Numeral.Language.ZH.TestData  as ZH
import qualified  Text.Numeral.Language.ZPC.TestData as ZPC


--------------------------------------------------------------------------------
-- Test suite
--------------------------------------------------------------------------------

main :: IO ()
main = do opts <- interpretArgsOrExit =<< getArgs
          defaultMainWithOpts tests opts { ropt_hide_successes = Just True }

tests :: [Test]
tests =
  [ testGroup "Grammar"
    [ testGroup "Case"
      [ testCase "noCase"       $ testInf noCase       hasNoCase
      , testCase "nominative"   $ testInf nominative   isNominative
      , testCase "accusative"   $ testInf accusative   isAccusative
      , testCase "dative"       $ testInf dative       isDative
      , testCase "ablative"     $ testInf ablative     isAblative
      , testCase "genitive"     $ testInf genitive     isGenitive
      , testCase "vocative"     $ testInf vocative     isVocative
      , testCase "instrumental" $ testInf instrumental isInstrumental
      ]
    , testGroup "Gender"
      [ testCase "noGender"  $ testInf noGender  hasNoGender
      , testCase "neuter"    $ testInf neuter    isNeuter
      , testCase "masculine" $ testInf masculine isMasculine
      , testCase "feminine"  $ testInf feminine  isFeminine
      , testCase "common"    $ testInf common    isCommon
      ]
    , testGroup "Number"
      [ testCase "noNumber" $ testInf noNumber hasNoNumber
      , testCase "singular" $ testInf singular isSingular
      , testCase "dual"     $ testInf dual     isDual
      , testCase "trial"    $ testInf trial    isTrial
      , testCase "paucal"   $ testInf paucal   isPaucal
      , testCase "plural"   $ testInf plural   isPlural
      ]
    ]
  , testGroup "Misc"
    [ testGroup "intLog"
      [ testProperty "power of 10" intLog_pow10
      , testProperty "power of 10 minus 1" intLog_pow10m1
      , testProperty "multiply" intLog_mul
      ]
    ]
  , testGroup "ACH"
    [ testGroup "unique data"
      [testUnique "cardinal" (ACH.cardinals :: TestData ℤ)]
    ]
  , testGroup "ADY"
    [ testGroup "unique data"
      [testUnique "cardinal" (ADY.cardinals :: TestData ℤ)]
    ]
  , testGroup "AF"
    [ testGroup "unique data"
      [ testUnique "cardinal" (AF.cardinals :: TestData ℤ)
      , testUnique "ordinal"  (AF.ordinals  :: TestData ℤ)
      ]
    , mkTests "cardinal" AF.cardinal (AF.cardinals :: TestData ℤ)
    , mkTests "ordinal"  AF.ordinal  (AF.ordinals  :: TestData ℤ)
    ]
  , testGroup "AMP"
    [ testGroup "unique data"
      [testUnique "cardinal" (AMP.cardinals :: TestData ℤ)]
    , mkTests "cardinal" AMP.cardinal (AMP.cardinals :: TestData ℤ)
    ]
  , testGroup "ARI"
    [ testGroup "unique data"
      [testUnique "cardinal" (ARI.cardinals :: TestData ℤ)]
    ]
  , testGroup "AST"
    [ testGroup "unique data"
      [testUnique "cardinal" (AST.cardinals :: TestData ℤ)]
    ]
  , testGroup "AZ"
    [ testGroup "unique data"
      [testUnique "cardinal" (AZ.cardinals :: TestData ℤ)]
    ]
  , testGroup "BA"
    [ testGroup "unique data"
      [testUnique "cardinal" (BA.cardinals :: TestData ℤ)]
    ]
  , testGroup "BG"
    [ testGroup "unique data"
      [testUnique "cardinal" (BG.cardinals :: TestData ℤ)]
    , mkTests "cardinal" BG.cardinal (BG.cardinals :: TestData ℤ)
    ]
  , testGroup "BM"
    [ testGroup "unique data"
      [testUnique "cardinal" (BM.cardinals :: TestData ℤ)]
    ]
  , testGroup "CA"
    [ testGroup "unique data"
      [testUnique "cardinal" (CA.cardinals :: TestData ℤ)]
    ]
  , testGroup "CAF"
    [ testGroup "unique data"
      [ testUnique "cardinal" (CAF.cardinals :: TestData ℤ)
      , testUnique "cardinal (syllabic)" (CAF.syllabic_cardinals :: TestData ℤ)
      ]
    ]
  , testGroup "CBK"
    [ testGroup "unique data"
      [testUnique "cardinal" (CBK.cardinals :: TestData ℤ)]
    ]
  , testGroup "CHN"
    [ testGroup "unique data"
      [testUnique "cardinal" (CHN.cardinals :: TestData ℤ)]
    , mkTests "cardinal" CHN.cardinal (CHN.cardinals :: TestData ℤ)
    ]
  , testGroup "CHR"
    [ testGroup "unique data"
      [testUnique "cardinal" (CHR.cardinals :: TestData ℤ)]
    , mkTests "cardinal" CHR.cardinal (CHR.cardinals :: TestData ℤ)
    ]
  , testGroup "CLM"
    [ testGroup "unique data"
      [testUnique "cardinal" (CLM.cardinals :: TestData ℤ)]
    , mkTests "cardinal" CLM.cardinal (CLM.cardinals :: TestData ℤ)
    ]
  , testGroup "CO"
    [ testGroup "unique data"
      [testUnique "cardinal" (CO.cardinals :: TestData ℤ)]
    ]
  , testGroup "COD"
    [ testGroup "unique data"
      [testUnique "cardinal" (COD.cardinals :: TestData ℤ)]
    ]
  , testGroup "COO"
    [ testGroup "unique data"
      [testUnique "cardinal" (COO.cardinals :: TestData ℤ)]
    ]
  , testGroup "CS"
    [ testGroup "unique data"
      [testUnique "cardinal" (CS.cardinals :: TestData ℤ)]
    , mkTests "cardinal" CS.cardinal (CS.cardinals :: TestData ℤ)
    ]
  , testGroup "CY"
    [ testGroup "unique data"
      [testUnique "cardinal" (CY.cardinals :: TestData ℤ)]
    ]
  , testGroup "DE"
    [ testGroup "unique data"
      [ testUnique "cardinal" (DE.cardinals :: TestData ℤ)
      , testUnique "ordinal"  (DE.ordinals  :: TestData ℤ)
      ]
    , mkTests "cardinal" DE.cardinal (DE.cardinals :: TestData ℤ)
    , mkTests "ordinal"  DE.ordinal  (DE.ordinals  :: TestData ℤ)
    ]
  , testGroup "DJK"
    [ testGroup "unique data"
      [testUnique "cardinal" (DJK.cardinals :: TestData ℤ)]
    ]
  , testGroup "EN"
    [ testGroup "GB"
      [ testGroup "unique data"
        [ testUnique "cardinal" (EN.gb_cardinals :: TestData ℤ)
        , testUnique "ordinal"  (EN.gb_ordinals  :: TestData ℤ)
        ]
      , mkTests "cardinal" EN.gb_cardinal (EN.gb_cardinals :: TestData ℤ)
      , mkTests "ordinal"  EN.gb_ordinal  (EN.gb_ordinals  :: TestData ℤ)
      ]
    , testGroup "US"
      [ testGroup "unique data"
        [ testUnique "cardinal" (EN.us_cardinals :: TestData ℤ)
        , testUnique "ordinal"  (EN.us_ordinals  :: TestData ℤ)
        ]
      , mkTests "cardinal" EN.us_cardinal (EN.us_cardinals :: TestData ℤ)
      , mkTests "ordinal"  EN.us_ordinal  (EN.us_ordinals  :: TestData ℤ)
      ]
    ]
  , testGroup "EO"
    [ testGroup "unique data"
      [testUnique "cardinal" (EO.cardinals :: TestData ℤ)]
    , mkTests "cardinal" EO.cardinal (EO.cardinals :: TestData ℤ)
    ]
  , testGroup "ES"
    [ testGroup "unique data"
      [testUnique "cardinal" (ES.cardinals :: TestData ℤ)]
    , mkTests "cardinal" ES.cardinal (ES.cardinals :: TestData ℤ)
    ]
  , testGroup "ET"
    [ testGroup "unique data"
      [testUnique "cardinal" (ET.cardinals :: TestData ℤ)]
    ]
  , testGroup "FI"
    [ testGroup "unique data"
      [ testUnique "cardinal" (FI.cardinals :: TestData ℤ)
      , testUnique "ordinal"  (FI.ordinals  :: TestData ℤ)
      ]
    , mkTests "cardinal" FI.cardinal (FI.cardinals :: TestData ℤ)
    , mkTests "ordinal"  FI.ordinal  (FI.ordinals :: TestData ℤ)
    ]
  , testGroup "FO"
    [ testGroup "unique data"
      [testUnique "cardinal" (FO.cardinals :: TestData ℤ)]
    ]
  , testGroup "FR"
    [ testGroup "unique data"
      [ testUnique "cardinal" (FR.cardinals :: TestData ℤ)
      , testUnique "ordinal"  (FR.ordinals  :: TestData ℤ)
      ]
    , mkTests "cardinal" FR.cardinal (FR.cardinals :: TestData ℤ)
    , mkTests "ordinal"  FR.ordinal  (FR.ordinals  :: TestData ℤ)
    ]
  , testGroup "FUR"
    [ testGroup "unique data"
      [testUnique "cardinal" (FUR.cardinals :: TestData ℤ)]
    , mkTests "cardinal" FUR.cardinal (FUR.cardinals :: TestData ℤ)
   ]
  , testGroup "GCF_MTQ"
    [ testGroup "unique data"
      [testUnique "cardinal" (GCF_MTQ.cardinals :: TestData ℤ)]
    ]
  , testGroup "GIL"
    [ testGroup "unique data"
      [testUnique "cardinal" (GIL.cardinals :: TestData ℤ)]
    ]
  , testGroup "GL"
    [ testGroup "unique data"
      [testUnique "cardinal" (GL.cardinals :: TestData ℤ)]
    ]
  , testGroup "GSW"
    [ testGroup "unique data"
      [testUnique "cardinal" (GSW.cardinals :: TestData ℤ)]
    , mkTests "cardinal" GSW.cardinal (GSW.cardinals :: TestData ℤ)
    ]
  , testGroup "GV"
    [ testGroup "unique data"
      [testUnique "cardinal" (GV.cardinals :: TestData ℤ)]
    , mkTests "cardinal" GV.cardinal  (GV.cardinals  :: TestData ℤ)
    ]
  , testGroup "HAI"
    [ testGroup "unique data"
      [testUnique "cardinal" (HAI.cardinals :: TestData ℤ)]
    ]
  , testGroup "HE"
    [ testGroup "unique data"
      [testUnique "cardinal" (HE.cardinals :: TestData ℤ)]
    , mkTests "cardinal" HE.cardinal  (HE.cardinals  :: TestData ℤ)
    ]
  , testGroup "HOP"
    [ testGroup "unique data"
      [testUnique "cardinal" (HOP.cardinals :: TestData ℤ)]
    , mkTests "cardinal" HOP.cardinal (HOP.cardinals :: TestData ℤ)
    ]
  , testGroup "HR"
    [ testGroup "unique data"
      [testUnique "cardinal" (HR.cardinals :: TestData ℤ)]
    ]
  , testGroup "HU"
    [ testGroup "unique data"
      [testUnique "cardinal" (HU.cardinals :: TestData ℤ)]
    ]
  , testGroup "HY"
    [ testGroup "unique data"
      [testUnique "cardinal" (HY.cardinals :: TestData ℤ)]
    ]
  , testGroup "IT"
    [ testGroup "unique data"
      [testUnique "cardinal" (IT.cardinals :: TestData ℤ)]
    , mkTests "cardinal" IT.cardinal (IT.cardinals :: TestData ℤ)
    , mkTests "ordinal"  IT.ordinal  (IT.ordinals  :: TestData ℤ)
    ]
  , testGroup "JA"
    [ testGroup "preferred"
      [ testGroup "unique data"
        [testUnique "cardinal" (JA.preferred_cardinals :: TestData ℤ)]
      , mkTests "cardinal" JA.preferred_cardinal
                          (JA.preferred_cardinals :: TestData ℤ)
      ]
    , testGroup "kanji"
      [ testGroup "unique data"
        [testUnique "cardinal" (JA.kanji_cardinals :: TestData ℤ)]
      , mkTests "cardinal" JA.kanji_cardinal (JA.kanji_cardinals :: TestData ℤ)
      ]
    , testGroup "daiji"
      [ testGroup "unique data"
        [testUnique "cardinal" (JA.daiji_cardinals :: TestData ℤ)]
      , mkTests "cardinal" JA.daiji_cardinal (JA.daiji_cardinals :: TestData ℤ)
      ]
    ]
  , testGroup "KAP"
    [ testGroup "unique data"
      [testUnique "cardinal" (KAP.cardinals :: TestData ℤ)]
    ]
  , testGroup "KEA"
    [ testGroup "unique data"
      [testUnique "cardinal" (KEA.cardinals :: TestData ℤ)]
    ]
  , testGroup "LA"
    [ testGroup "unique data"
      [testUnique "cardinal" (LA.cardinals :: TestData ℤ)]
    , mkTests "cardinal" LA.cardinal (LA.cardinals :: TestData ℤ)
    ]
  , testGroup "LLD"
    [ testGroup "unique data"
      [testUnique "cardinal" (LLD.cardinals :: TestData ℤ)]
    , mkTests "cardinal" LLD.cardinal (LLD.cardinals :: TestData ℤ)
    ]
  , testGroup "MG"
    [ testGroup "unique data"
      [testUnique "cardinal" (MG.cardinals :: TestData ℤ)]
    , mkTests "cardinal" MG.cardinal (MG.cardinals  :: TestData ℤ)
    ]
  , testGroup "MOH"
    [ testGroup "unique data"
      [testUnique "cardinal" (MOH.cardinals :: TestData ℤ)]
    ]
  , testGroup "NL"
    [ testGroup "unique data"
      [ testUnique "cardinal"       (NL.cardinals       :: TestData ℤ)
      , testUnique "ordinal"        (NL.ordinals        :: TestData ℤ)
      , testUnique "partitive"      (NL.partitives      :: TestData (ℤ, ℤ))
      , testUnique "multiplicative" (NL.multiplicatives :: TestData ℤ)
      ]
    , mkTests "cardinal"       NL.cardinal  (NL.cardinals  :: TestData ℤ)
    , mkTests "ordinal"        NL.ordinal   (NL.ordinals   :: TestData ℤ)
    , mkTests "partitive"      NL.partitive (NL.partitives :: TestData (ℤ, ℤ))
    , mkTests "multiplicative" NL.multiplicative (NL.multiplicatives :: TestData ℤ)
    ]
  , testGroup "NO"
    [ testGroup "unique data"
      [testUnique "cardinal" (NO.cardinals :: TestData ℤ)]
    , mkTests "cardinal" NO.cardinal  (NO.cardinals  :: TestData ℤ)
    ]
  , testGroup "NQM"
    [ testGroup "unique data"
      [testUnique "cardinal" (NQM.cardinals :: TestData ℤ)]
    , mkTests "cardinal" NQM.cardinal (NQM.cardinals :: TestData ℤ)
    ]
  , testGroup "OJ"
    [ testGroup "unique data"
      [testUnique "cardinal" (OJ.cardinals :: TestData ℤ)]
    , mkTests "cardinal" OJ.cardinal  (OJ.cardinals  :: TestData ℤ)
    ]
  , testGroup "PAA"
    [ testGroup "unique data"
      [testUnique "cardinal" (PAA.cardinals :: TestData ℤ)]
    ]
  , testGroup "PDC"
    [ testGroup "unique data"
      [testUnique "cardinal" (PDC.cardinals :: TestData ℤ)]
    , mkTests "cardinal" PDC.cardinal (PDC.cardinals :: TestData ℤ)
    ]
  , testGroup "PL"
    [ testGroup "unique data"
      [testUnique "cardinal" (PL.cardinals :: TestData ℤ)]
    , mkTests "cardinal" PL.cardinal  (PL.cardinals  :: TestData ℤ)
    ]
  , testGroup "PT"
    [ testGroup "unique data"
      [testUnique "cardinal" (PT.cardinals :: TestData ℤ)]
    , mkTests "cardinal" PT.cardinal (PT.cardinals  :: TestData ℤ)
    , mkTests "ordinal"  PT.ordinal  (PT.ordinals   :: TestData ℤ)
    ]
  , testGroup "RMN_DZA"
    [ testGroup "unique data"
      [testUnique "cardinal" (RMN_DZA.cardinals :: TestData ℤ)]
    ]
  , testGroup "RO"
    [ testGroup "unique data"
      [testUnique "cardinal" (RO.cardinals :: TestData ℤ)]
    ]
  , testGroup "RU"
    [ testGroup "unique data"
      [testUnique "cardinal" (RU.cardinals :: TestData ℤ)]
    , mkTests "cardinal" RU.cardinal  (RU.cardinals  :: TestData ℤ)
    ]
  , testGroup "SCO"
    [ testGroup "unique data"
      [testUnique "cardinal" (SCO.cardinals :: TestData ℤ)]
    , mkTests "cardinal" SCO.cardinal (SCO.cardinals :: TestData ℤ)
    ]
  , testGroup "SV"
    [ testGroup "unique data"
      [ testUnique "cardinal" (SV.cardinals :: TestData ℤ)
      , testUnique "ordinal"  (SV.ordinals  :: TestData ℤ)
      ]
    , mkTests "cardinal" SV.cardinal (SV.cardinals :: TestData ℤ)
    , mkTests "ordinal"  SV.ordinal  (SV.ordinals  :: TestData ℤ)
    ]
  , testGroup "TAR"
    [ testGroup "unique data"
      [testUnique "cardinal" (TAR.cardinals :: TestData ℤ)]
    ]
  , testGroup "TR"
    [ testGroup "unique data"
      [testUnique "cardinal" (TR.cardinals :: TestData ℤ)]
    , mkTests "cardinal" TR.cardinal (TR.cardinals :: TestData ℤ)
    ]
  , testGroup "WO"
    [ testGroup "unique data"
      [testUnique "cardinal" (WO.cardinals :: TestData ℤ)]
    , mkTests "cardinal" WO.cardinal (WO.cardinals :: TestData ℤ)
    ]
  , testGroup "YOR"
    [ testGroup "unique data"
      [testUnique "cardinal" (YOR.cardinals :: TestData ℤ)]
    , mkTests "cardinal" YOR.cardinal (YOR.cardinals :: TestData ℤ)
    ]
  , testGroup "ZAQ"
    [ testGroup "unique data"
      [testUnique "cardinal" (ZAQ.cardinals :: TestData ℤ)]
    ]
  , testGroup "ZH"
    [ testGroup "characters (traditional)"
      [ testGroup "unique data"
        [testUnique "cardinal" (ZH.trad_cardinals :: TestData ℤ)]
      , mkTests "cardinal" ZH.trad_cardinal (ZH.trad_cardinals :: TestData ℤ)
      ]
    , testGroup "characters (simplified)"
      [ testGroup "unique data"
        [testUnique "cardinal" (ZH.simpl_cardinals :: TestData ℤ)]
      , mkTests "cardinal" ZH.simpl_cardinal (ZH.simpl_cardinals :: TestData ℤ)
      ]
    , testGroup "financial characters (traditional)"
      [ testGroup "unique data"
        [testUnique "cardinal" (ZH.finance_trad_cardinals :: TestData ℤ)]
      , mkTests "cardinal" ZH.finance_trad_cardinal (ZH.finance_trad_cardinals :: TestData ℤ)
      ]
    , testGroup "financial characters (simplified)"
      [ testGroup "unique data"
        [testUnique "cardinal" (ZH.finance_simpl_cardinals :: TestData ℤ)]
      , mkTests "cardinal" ZH.finance_simpl_cardinal (ZH.finance_simpl_cardinals :: TestData ℤ)
      ]
    , testGroup "pinyin"
      [ testGroup "unique data"
        [testUnique "cardinal" (ZH.pinyin_cardinals :: TestData ℤ)]
      , mkTests "cardinal" ZH.pinyin_cardinal (ZH.pinyin_cardinals :: TestData ℤ)
      ]
  , testGroup "ZPC"
    [ testGroup "unique data"
      [testUnique "cardinal" (ZPC.cardinals :: TestData ℤ)]
    ]
    ]
  ]


--------------------------------------------------------------------------------
-- Utils
--------------------------------------------------------------------------------

{-
-- TODO: this takes way to long for large values (10 ^ 60000 - 1)
testBounds ∷ Text → (ℤ → Maybe Text) → (ℤ, ℤ) → Test
testBounds name conversion bounds@(lo, hi) =
      testGroup name
                [ testCase "lower bound" $ assertBool "conversion error" $ checkConv lo
                , testCase "upper bound" $ assertBool "conversion error" $ checkConv hi
                -- , testProperty "in between" $ forAll (choose bounds) checkConv
                ]
    where
      checkConv ∷ ℤ → Bool
      checkConv = isJust ∘ conversion
-}

testInf :: (GR.Inflection -> GR.Inflection) -> (GR.Inflection -> Bool) -> Assertion
testInf set test = assertBool "False" $ test $ set GR.defaultInflection

intLog_pow10 :: Positive ℤ -> Bool
intLog_pow10 (Positive x) = x ≡ intLog (dec x)

intLog_pow10m1 :: NonNegative ℤ -> Bool
intLog_pow10m1 (NonNegative x) = x - 1 ≡ intLog (dec x) - 1

intLog_mul :: Positive ℤ -> Positive ℤ -> Bool
intLog_mul (Positive x) (Positive y) = intLog (dec x ⋅ dec y) ≡ intLog (dec x) + intLog (dec y)

mkTests :: forall α. (Show α)
        => String
        -> (GR.Inflection -> α -> Maybe Text)
        -> TestData α
        -> Test
mkTests name f = testGroup name ∘ map perInflection
  where
    perInflection :: (String, GR.Inflection, [(α, Text)]) -> Test
    perInflection (infName, inf, xs) = testGroup infName $ map (perValue inf) xs

    perValue :: GR.Inflection -> (α, Text) -> Test
    perValue inf (n, s) = testCase (show n) $ testConversion f inf n s

-- | Tests whether the test data contains duplicates (different
-- numbers with the same representation).
testUnique :: forall α. (Show α) => String -> TestData α -> Test
testUnique name = testGroup name ∘ map perInflection
  where
    perInflection :: (String, inf, [(α, Text)]) -> Test
    perInflection (infName, _, xs) = testCase infName $ unique xs

    unique :: [(α, Text)] -> Assertion
    unique xs = when (length ys > 0)
                  $ assertFailure
                  $ intercalate "\n" $ map msg ys
      where
        ys :: [[(α, Text)]]
        ys = filter ((1 <) ∘ length)
             $ groupBy ((≡) `on` snd)
             $ sortBy (compare `on` snd) xs

    msg :: [(α, Text)] -> String
    msg xs = let (_, s) = head xs
             in printf "The string \"%s\" is associated with multiple values: %s"
                       (T.unpack s)
                       (intercalate ", " $ map (show ∘ fst) xs)

testConversion :: (Show α)
               => (GR.Inflection -> α -> Maybe Text)
               -> GR.Inflection
               -> α
               -> Text
               -> Assertion
testConversion f inf n s =
  let r = f inf n
  in when (r ≢ Just s)
        $ assertFailure
        $ printf "Expected %s = \"%s\" but got \"%s\""
                 (show n)
                 (T.unpack s)
                 (T.unpack $ fromMaybe "no result" r)

</pre>