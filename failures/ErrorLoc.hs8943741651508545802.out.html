<a href="ErrorHandling.hs1088387561264032581.out.html">prev</a></br><a href="failures.html">home</a></br><a href="ErrorMessages.hs1645347854214459759.out.html">next</a></br></br><pre>25c25
<     [e|(.) P.error (concat [$(stringE (loc_filename loc))
---
>     [|(.) P.error (concat [$(stringE (loc_filename loc))
30a31
> 
</pre></br><h2>original</h2></br><pre>{-# LANGUAGE TemplateHaskell #-}
{-# LANGUAGE QuasiQuotes #-}

-- |
--
-- > {-# LANGUAGE TemplateHaskell #-}
-- >
-- > import Prelude hiding (error)
-- > import ErrorLoc
-- >
-- > main :: IO ()
-- > main = $error "Oh no!"
--
-- > test.hs:7:10: Oh no!
module ErrorLoc (error) where

import Language.Haskell.TH
import Prelude hiding (error)
import qualified Prelude as P

-- | Provides a version of 'Prelude.error' with call-site metadata.
error :: Q Exp
error = do
    loc <- location
    [e|(.) P.error (concat [$(stringE (loc_filename loc))
                           , ":"
                           , $(stringE . show . fst $ loc_start loc)
                           , ":"
                           , $(stringE . show . snd $ loc_start loc)
                           , ": "] ++)|]
</pre></br><h2>printed</h2></br><pre>{-# LANGUAGE TemplateHaskell #-}
{-# LANGUAGE QuasiQuotes #-}

-- |
--
-- > {-# LANGUAGE TemplateHaskell #-}
-- >
-- > import Prelude hiding (error)
-- > import ErrorLoc
-- >
-- > main :: IO ()
-- > main = $error "Oh no!"
--
-- > test.hs:7:10: Oh no!
module ErrorLoc (error) where

import Language.Haskell.TH
import Prelude hiding (error)
import qualified Prelude as P

-- | Provides a version of 'Prelude.error' with call-site metadata.
error :: Q Exp
error = do
    loc <- location
    [|(.) P.error (concat [$(stringE (loc_filename loc))
                           , ":"
                           , $(stringE . show . fst $ loc_start loc)
                           , ":"
                           , $(stringE . show . snd $ loc_start loc)
                           , ": "] ++)|]

</pre>