<a href="Protocol.hs16174283591270425987.out.html">prev</a></br><a href="failures.html">home</a></br><a href="PushStream.hs4983839121152185684.out.html">next</a></br></br><pre>1d0
< {-# LINE 1 "ProtocolHandler.hs" #-}
83a83
> 
</pre></br><h2>original</h2></br><pre>{-# LINE 1 "ProtocolHandler.hs" #-}
-- ------------------------------------------------------------
--
-- protocol handler functions
-- configuration file
-- real handler is generated with cpp

module Text.XML.HXT.Parser.ProtocolHandler
    ( getProtocolHandler
    )

where

import Text.XML.HXT.DOM.XmlState

-- ------------------------------------------------------------
--
-- file io and network

import Data.Maybe
    ( fromMaybe
    )

import Network.URI
    ( URI
    , uriScheme
    )

import Text.XML.HXT.Parser.ProtocolHandlerFile
    ( getFileContents
    )


import Text.XML.HXT.Parser.ProtocolHandlerHttpNativeOrCurl
    ( getHttpContentsNativeOrWithCurl
    )





-- ------------------------------------------------------------
--

getProtocolHandler  :: String -> (URI -> XmlStateFilter a)
getProtocolHandler proto
    = fromMaybe getUnsupported handler
      where
      handler  = lookup proto protocolHandler

--
-- the fall back protocol handler

getUnsupported  :: URI -> XmlStateFilter a
getUnsupported uri
    = addFatal ( "unsupported protocol "
         ++ show (uriScheme uri)
         ++ " in URI: "
         ++ show uri
           )

-- ------------------------------------------------------------
--
-- the table of potocol handlers
-- looked up in getProtocolHandler

protocolHandler :: [(String, URI -> XmlStateFilter a)]
protocolHandler
    = [ ("file", getFileContents)
      , ("http",


     getHttpContentsNativeOrWithCurl




    )
      ]

-- ------------------------------------------------------------


</pre></br><h2>printed</h2></br><pre>-- ------------------------------------------------------------
--
-- protocol handler functions
-- configuration file
-- real handler is generated with cpp

module Text.XML.HXT.Parser.ProtocolHandler
    ( getProtocolHandler
    )

where

import Text.XML.HXT.DOM.XmlState

-- ------------------------------------------------------------
--
-- file io and network

import Data.Maybe
    ( fromMaybe
    )

import Network.URI
    ( URI
    , uriScheme
    )

import Text.XML.HXT.Parser.ProtocolHandlerFile
    ( getFileContents
    )


import Text.XML.HXT.Parser.ProtocolHandlerHttpNativeOrCurl
    ( getHttpContentsNativeOrWithCurl
    )





-- ------------------------------------------------------------
--

getProtocolHandler  :: String -> (URI -> XmlStateFilter a)
getProtocolHandler proto
    = fromMaybe getUnsupported handler
      where
      handler  = lookup proto protocolHandler

--
-- the fall back protocol handler

getUnsupported  :: URI -> XmlStateFilter a
getUnsupported uri
    = addFatal ( "unsupported protocol "
         ++ show (uriScheme uri)
         ++ " in URI: "
         ++ show uri
           )

-- ------------------------------------------------------------
--
-- the table of potocol handlers
-- looked up in getProtocolHandler

protocolHandler :: [(String, URI -> XmlStateFilter a)]
protocolHandler
    = [ ("file", getFileContents)
      , ("http",


     getHttpContentsNativeOrWithCurl




    )
      ]

-- ------------------------------------------------------------



</pre>