<a href="Fractional.hs174076737834991545.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Framework.hs17195338081517273377.out.html">next</a></br></br><pre>70d69
<     initialFrame $ \id rect txt -> \props style ->
71d69
<     do f <- frameCreate parent id txt rect style
72d69
<        let initProps = (if (containsProperty visible props)
73d69
<                         then [] else [visible := True]) ++
74d69
<                        (if (containsProperty bgcolor props)
75d69
<                         then [] else [bgcolor := colorSystem Color3DFace])
76d69
<        set f initProps
77d69
<        set f props
78c70
<        return f
---
>     initialFrame $ \id rect txt ->              ->props style ->
78a71
>                   do f <- frameCreate parent id txt rect style
78a72
>                      let initProps = (if (containsProperty visible props)
78a73
>                                       then [] else [visible := True]) ++
78a74
>                                      (if (containsProperty bgcolor props)
78a75
>                                       then [] else [bgcolor := colorSystem Color3DFace])
78a76
>                      set f initProps
78a77
>                      set f props
78a78
>                      return f
122d121
<     initialFrame $ \id rect txt -> \props stl ->
123d121
<     do f <- mdiParentFrameCreate parent id txt rect stl
124d121
<        let initProps = (if (containsProperty visible props)
125d121
<                         then [] else [visible := True]) ++
126d121
<                        (if (containsProperty bgcolor props)
127d121
<                         then [] else [bgcolor := colorSystem Color3DFace])
128d121
<        set f initProps
129d121
<        set f props
130c122
<        return f
---
>     initialFrame $ \id rect txt ->            ->props stl ->
130a123
>                 do f <- mdiParentFrameCreate parent id txt rect stl
130a124
>                    let initProps = (if (containsProperty visible props)
130a125
>                                     then [] else [visible := True]) ++
130a126
>                                    (if (containsProperty bgcolor props)
130a127
>                                     then [] else [bgcolor := colorSystem Color3DFace])
130a128
>                    set f initProps
130a129
>                    set f props
130a130
>                    return f
142d141
<     initialFrame $ \id rect txt -> \props stl ->
143d141
<     do f <- mdiChildFrameCreate parent id txt rect stl
144d141
<        let initProps = (if (containsProperty visible props)
145d141
<                          then [] else [visible := True]) ++
146d141
<                        (if (containsProperty bgcolor props)
147d141
<                          then [] else [bgcolor := colorSystem Color3DFace])
148d141
<        set f initProps
149d141
<        set f props
150c142
<        return f
---
>     initialFrame $ \id rect txt ->            ->props stl ->
150a143
>                 do f <- mdiChildFrameCreate parent id txt rect stl
150a144
>                    let initProps = (if (containsProperty visible props)
150a145
>                                      then [] else [visible := True]) ++
150a146
>                                    (if (containsProperty bgcolor props)
150a147
>                                      then [] else [bgcolor := colorSystem Color3DFace])
150a148
>                    set f initProps
150a149
>                    set f props
150a150
>                    return f
179a180
> 
</pre></br><h2>original</h2></br><pre>
--------------------------------------------------------------------------------
{-| Module      :  Frame
    Copyright   :  (c) Daan Leijen 2003
                   (c) Jeremy O'Donoghue 2007
    License     :  wxWindows

    Maintainer  :  wxhaskell-devel@lists.sourceforge.net
    Stability   :  provisional
    Portability :  portable

Frames.

* Instances: 'Form', 'Closeable', 'Framed' --
             'Textual', 'Literate', 'Dimensions', 'Colored', 'Visible', 'Child',
             'Able', 'Tipped', 'Identity', 'Styled', 'Reactive', 'Paint',
             'HasDefault'.


-}
--------------------------------------------------------------------------------
module Graphics.UI.WX.Frame
    ( -- * Frames
      Frame, frame, frameFixed, frameTool, frameEx
    , frameLoadRes, frameLoadChildRes
    , initialFrame
      -- * MDI Frames
    , MDIParentFrame, MDIChildFrame
    , mdiParentFrame, mdiChildFrame
    , mdiParentFrameEx, mdiChildFrameEx
     -- ** Operations
    , activeChild, activateNext, activatePrevious, arrangeIcons
    , cascade, tile
    -- * Internal
    ) where

import Graphics.UI.WXCore

import Graphics.UI.WX.Types
import Graphics.UI.WX.Attributes
import Graphics.UI.WX.Layout
import Graphics.UI.WX.Classes
import Graphics.UI.WX.Window
import Graphics.UI.WX.TopLevelWindow
import Graphics.UI.WX.Events

defaultStyle
  = frameDefaultStyle -- .+. wxTAB_TRAVERSAL -- .+. wxNO_FULL_REPAINT_ON_RESIZE

-- | Create a top-level frame window.
frame :: [Prop (Frame ())]  -> IO (Frame ())
frame props
  = frameEx defaultStyle props objectNull

-- | Create a top-level frame window that is not resizeable.
frameFixed :: [Prop (Frame ())]  -> IO (Frame ())
frameFixed props
  = frameEx (defaultStyle .-. wxMAXIMIZE_BOX .-. wxRESIZE_BORDER)  props objectNull

-- | Create a tool window; floats on the parent and has a small caption.
frameTool :: [Prop (Frame ())]  -> Window a -> IO (Frame ())
frameTool props parent
  = frameEx (defaultStyle .-. wxFRAME_TOOL_WINDOW .-. wxFRAME_FLOAT_ON_PARENT)  props parent


-- | Create a top-level frame window in a custom style.
frameEx :: Style -> [Prop (Frame ())]  -> Window a -> IO (Frame ())
frameEx style props parent
  = feed2 props style $
    initialFrame $ \id rect txt -> \props style ->
    do f <- frameCreate parent id txt rect style
       let initProps = (if (containsProperty visible props)
                        then [] else [visible := True]) ++
                       (if (containsProperty bgcolor props)
                        then [] else [bgcolor := colorSystem Color3DFace])
       set f initProps
       set f props
       return f

-- | Complete the construction of a top level frame which has been loaded
--   from a resource file.
frameLoadRes :: FilePath -> String -> [Prop (Frame ())] -> IO (Frame ())
frameLoadRes rc name props =
    frameLoadChildRes objectNull rc name props

-- | Complete the construction of a frame whcih is the child of some
--   existing parent window.
frameLoadChildRes :: Window a -> FilePath -> String -> [Prop (Frame ())] -> IO (Frame ())
frameLoadChildRes parent rc name props =
    do res <- xmlResourceCreateFromFile rc wxXRC_USE_LOCALE
       f   <- xmlResourceLoadFrame res parent name
       set f props
       return f

-- | initial Frame flags
initialFrame :: (Id -> Rect -> String -> [Prop (Window w)] -> Style -> a) -> [Prop (Window w)] -> Style -> a
initialFrame cont
  = initialContainer    $ \id rect ->
    initialText         $ \txt ->
    initialResizeable   $
    initialMinimizeable $
    initialMaximizeable $
    initialCloseable    $
    initialClipChildren $
    initialFullRepaintOnResize $
    cont id rect txt


{--------------------------------------------------------------------------
  MDI frames
--------------------------------------------------------------------------}
-- | Create an MDI parent frame.
mdiParentFrame :: [Prop (MDIParentFrame ())] -> IO (MDIParentFrame ())
mdiParentFrame props
  = mdiParentFrameEx objectNull defaultStyle props


-- | Create an MDI parent frame with a custom style.
mdiParentFrameEx :: Window a -> Style -> [Prop (MDIParentFrame ())] -> IO (MDIParentFrame ())
mdiParentFrameEx parent stl props
  = feed2 props stl $
    initialFrame $ \id rect txt -> \props stl ->
    do f <- mdiParentFrameCreate parent id txt rect stl
       let initProps = (if (containsProperty visible props)
                        then [] else [visible := True]) ++
                       (if (containsProperty bgcolor props)
                        then [] else [bgcolor := colorSystem Color3DFace])
       set f initProps
       set f props
       return f


-- | Create a MDI child frame.
mdiChildFrame :: MDIParentFrame a -> [Prop (MDIChildFrame ())] -> IO (MDIChildFrame ())
mdiChildFrame parent props
  = mdiChildFrameEx parent defaultStyle props

-- | Create a MDI child frame with a custom style.
mdiChildFrameEx :: MDIParentFrame a -> Style -> [Prop (MDIChildFrame ())] -> IO (MDIChildFrame ())
mdiChildFrameEx parent stl props
  = feed2 props stl $
    initialFrame $ \id rect txt -> \props stl ->
    do f <- mdiChildFrameCreate parent id txt rect stl
       let initProps = (if (containsProperty visible props)
                         then [] else [visible := True]) ++
                       (if (containsProperty bgcolor props)
                         then [] else [bgcolor := colorSystem Color3DFace])
       set f initProps
       set f props
       return f



-- | Return the active child frame ('objectIsNull' when no child is active)
activeChild :: ReadAttr (MDIParentFrame a) (MDIChildFrame ())
activeChild = readAttr "activeChild" mdiParentFrameGetActiveChild

-- | Activate the next child frame.
activateNext :: MDIParentFrame a -> IO ()
activateNext  = mdiParentFrameActivateNext

-- | Activate the previous child frame
activatePrevious :: MDIParentFrame a -> IO ()
activatePrevious  = mdiParentFrameActivatePrevious

-- | Arrange iconized mdi child frames.
arrangeIcons :: MDIParentFrame a -> IO ()
arrangeIcons = mdiParentFrameArrangeIcons

-- | Cascade the child frames.
cascade :: MDIParentFrame a -> IO ()
cascade = mdiParentFrameCascade

-- | Tile the child frames
tile :: MDIParentFrame a -> IO ()
tile = mdiParentFrameTile



</pre></br><h2>printed</h2></br><pre>
--------------------------------------------------------------------------------
{-| Module      :  Frame
    Copyright   :  (c) Daan Leijen 2003
                   (c) Jeremy O'Donoghue 2007
    License     :  wxWindows

    Maintainer  :  wxhaskell-devel@lists.sourceforge.net
    Stability   :  provisional
    Portability :  portable

Frames.

* Instances: 'Form', 'Closeable', 'Framed' --
             'Textual', 'Literate', 'Dimensions', 'Colored', 'Visible', 'Child',
             'Able', 'Tipped', 'Identity', 'Styled', 'Reactive', 'Paint',
             'HasDefault'.


-}
--------------------------------------------------------------------------------
module Graphics.UI.WX.Frame
    ( -- * Frames
      Frame, frame, frameFixed, frameTool, frameEx
    , frameLoadRes, frameLoadChildRes
    , initialFrame
      -- * MDI Frames
    , MDIParentFrame, MDIChildFrame
    , mdiParentFrame, mdiChildFrame
    , mdiParentFrameEx, mdiChildFrameEx
     -- ** Operations
    , activeChild, activateNext, activatePrevious, arrangeIcons
    , cascade, tile
    -- * Internal
    ) where

import Graphics.UI.WXCore

import Graphics.UI.WX.Types
import Graphics.UI.WX.Attributes
import Graphics.UI.WX.Layout
import Graphics.UI.WX.Classes
import Graphics.UI.WX.Window
import Graphics.UI.WX.TopLevelWindow
import Graphics.UI.WX.Events

defaultStyle
  = frameDefaultStyle -- .+. wxTAB_TRAVERSAL -- .+. wxNO_FULL_REPAINT_ON_RESIZE

-- | Create a top-level frame window.
frame :: [Prop (Frame ())]  -> IO (Frame ())
frame props
  = frameEx defaultStyle props objectNull

-- | Create a top-level frame window that is not resizeable.
frameFixed :: [Prop (Frame ())]  -> IO (Frame ())
frameFixed props
  = frameEx (defaultStyle .-. wxMAXIMIZE_BOX .-. wxRESIZE_BORDER)  props objectNull

-- | Create a tool window; floats on the parent and has a small caption.
frameTool :: [Prop (Frame ())]  -> Window a -> IO (Frame ())
frameTool props parent
  = frameEx (defaultStyle .-. wxFRAME_TOOL_WINDOW .-. wxFRAME_FLOAT_ON_PARENT)  props parent


-- | Create a top-level frame window in a custom style.
frameEx :: Style -> [Prop (Frame ())]  -> Window a -> IO (Frame ())
frameEx style props parent
  = feed2 props style $
    initialFrame $ \id rect txt ->              ->props style ->
                  do f <- frameCreate parent id txt rect style
                     let initProps = (if (containsProperty visible props)
                                      then [] else [visible := True]) ++
                                     (if (containsProperty bgcolor props)
                                      then [] else [bgcolor := colorSystem Color3DFace])
                     set f initProps
                     set f props
                     return f

-- | Complete the construction of a top level frame which has been loaded
--   from a resource file.
frameLoadRes :: FilePath -> String -> [Prop (Frame ())] -> IO (Frame ())
frameLoadRes rc name props =
    frameLoadChildRes objectNull rc name props

-- | Complete the construction of a frame whcih is the child of some
--   existing parent window.
frameLoadChildRes :: Window a -> FilePath -> String -> [Prop (Frame ())] -> IO (Frame ())
frameLoadChildRes parent rc name props =
    do res <- xmlResourceCreateFromFile rc wxXRC_USE_LOCALE
       f   <- xmlResourceLoadFrame res parent name
       set f props
       return f

-- | initial Frame flags
initialFrame :: (Id -> Rect -> String -> [Prop (Window w)] -> Style -> a) -> [Prop (Window w)] -> Style -> a
initialFrame cont
  = initialContainer    $ \id rect ->
    initialText         $ \txt ->
    initialResizeable   $
    initialMinimizeable $
    initialMaximizeable $
    initialCloseable    $
    initialClipChildren $
    initialFullRepaintOnResize $
    cont id rect txt


{--------------------------------------------------------------------------
  MDI frames
--------------------------------------------------------------------------}
-- | Create an MDI parent frame.
mdiParentFrame :: [Prop (MDIParentFrame ())] -> IO (MDIParentFrame ())
mdiParentFrame props
  = mdiParentFrameEx objectNull defaultStyle props


-- | Create an MDI parent frame with a custom style.
mdiParentFrameEx :: Window a -> Style -> [Prop (MDIParentFrame ())] -> IO (MDIParentFrame ())
mdiParentFrameEx parent stl props
  = feed2 props stl $
    initialFrame $ \id rect txt ->            ->props stl ->
                do f <- mdiParentFrameCreate parent id txt rect stl
                   let initProps = (if (containsProperty visible props)
                                    then [] else [visible := True]) ++
                                   (if (containsProperty bgcolor props)
                                    then [] else [bgcolor := colorSystem Color3DFace])
                   set f initProps
                   set f props
                   return f


-- | Create a MDI child frame.
mdiChildFrame :: MDIParentFrame a -> [Prop (MDIChildFrame ())] -> IO (MDIChildFrame ())
mdiChildFrame parent props
  = mdiChildFrameEx parent defaultStyle props

-- | Create a MDI child frame with a custom style.
mdiChildFrameEx :: MDIParentFrame a -> Style -> [Prop (MDIChildFrame ())] -> IO (MDIChildFrame ())
mdiChildFrameEx parent stl props
  = feed2 props stl $
    initialFrame $ \id rect txt ->            ->props stl ->
                do f <- mdiChildFrameCreate parent id txt rect stl
                   let initProps = (if (containsProperty visible props)
                                     then [] else [visible := True]) ++
                                   (if (containsProperty bgcolor props)
                                     then [] else [bgcolor := colorSystem Color3DFace])
                   set f initProps
                   set f props
                   return f



-- | Return the active child frame ('objectIsNull' when no child is active)
activeChild :: ReadAttr (MDIParentFrame a) (MDIChildFrame ())
activeChild = readAttr "activeChild" mdiParentFrameGetActiveChild

-- | Activate the next child frame.
activateNext :: MDIParentFrame a -> IO ()
activateNext  = mdiParentFrameActivateNext

-- | Activate the previous child frame
activatePrevious :: MDIParentFrame a -> IO ()
activatePrevious  = mdiParentFrameActivatePrevious

-- | Arrange iconized mdi child frames.
arrangeIcons :: MDIParentFrame a -> IO ()
arrangeIcons = mdiParentFrameArrangeIcons

-- | Cascade the child frames.
cascade :: MDIParentFrame a -> IO ()
cascade = mdiParentFrameCascade

-- | Tile the child frames
tile :: MDIParentFrame a -> IO ()
tile = mdiParentFrameTile




</pre>