<a href="XPath.hs9845803181479904491.out.html">prev</a></br><a href="failures.html">home</a></br><a href="Yoneda.hs7079531781509658266.out.html">next</a></br></br><pre>1d0
< {-# LINE 1 "XSLT.hs.neat" #-}
11d9
<  output (File path block) = ({-# LINE 10 "XSLT.hs.neat" #-}
12d9
<   "<?xml version=\"1.0\"?>\n<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\">" ++ ({-# LINE 12 "XSLT.hs.neat" #-}
13d9
<   output (block)) ++ {-# LINE 12 "XSLT.hs.neat" #-}
14c10
<   "\n</xsl:stylesheet>"){-# LINE 14 "XSLT.hs.neat" #-}
---
>  output (File path block) = ( ++ (
15a12
>   output (block)) ++)
16a14
> 
16a15
> 
18d16
<  output (Block chunks) = ({-# LINE 17 "XSLT.hs.neat" #-}
19c17
<   "" ++ ({-# LINE 18 "XSLT.hs.neat" #-}
---
>  output (Block chunks) = ( ++ (
22d19
<       then _l >>= \{-# LINE 18 "XSLT.hs.neat" #-}
23d19
<   chunk -> ({-# LINE 18 "XSLT.hs.neat" #-}
24d19
<     "" ++ ({-# LINE 19 "XSLT.hs.neat" #-}
25d19
<     output (chunk)) ++ {-# LINE 19 "XSLT.hs.neat" #-}
26d19
<     "")
27d19
<       else []) ++ {-# LINE 20 "XSLT.hs.neat" #-}
28c20
<   ""){-# LINE 21 "XSLT.hs.neat" #-}
---
>       then  _l >>= \ -> ( ++ (
28a21
>     output (chunk)))
28a22
>       else) ++)
32d25
<  output (Chunk location element) = ({-# LINE 24 "XSLT.hs.neat" #-}
33d25
<   "" ++ ({-# LINE 25 "XSLT.hs.neat" #-}
34d25
<   output (element)) ++ {-# LINE 25 "XSLT.hs.neat" #-}
35c26
<   ""){-# LINE 26 "XSLT.hs.neat" #-}
---
>  output (Chunk location element) = ( ++ (
35a27
>   output (element)) ++)
39d30
<  output (Location file line) = ({-# LINE 29 "XSLT.hs.neat" #-}
40d30
<   "<!-- Source: " ++ ({-# LINE 29 "XSLT.hs.neat" #-}
41d30
<   output (file)) ++ {-# LINE 29 "XSLT.hs.neat" #-}
42d30
<   ":" ++ ({-# LINE 29 "XSLT.hs.neat" #-}
43d30
<   output (line)) ++ {-# LINE 29 "XSLT.hs.neat" #-}
44d30
<   " -->"){-# LINE 29 "XSLT.hs.neat" #-}
45c31
< 
---
>  output (Location file line) = ( ++ ( (file)) ++ ++ ())
48d33
<  output (Value _ value) = (({-# LINE 32 "XSLT.hs.neat" #-}
49d33
<   output (value))){-# LINE 32 "XSLT.hs.neat" #-}
50c34
< 
---
>  output (Value _ value) = (( (value)))
53d36
<  output (Pattern _ pattern) = (({-# LINE 35 "XSLT.hs.neat" #-}
54d36
<   output (pattern))){-# LINE 35 "XSLT.hs.neat" #-}
55c37
< 
---
>  output (Pattern _ pattern) = (( (pattern)))
58d39
<  output (Output value) = ({-# LINE 38 "XSLT.hs.neat" #-}
59d39
<   "\n  <xsl:value-of select=" ++ ({-# LINE 39 "XSLT.hs.neat" #-}
60d39
<   output (quote $ value)) ++ {-# LINE 39 "XSLT.hs.neat" #-}
61c40
<   " />"){-# LINE 40 "XSLT.hs.neat" #-}
---
>  output (Output value) = ( ++ (
61a41
>   output (quote $ value)) ++)
64d43
<  output (Comment comment) = ({-# LINE 42 "XSLT.hs.neat" #-}
65d43
<   "\n  <xsl:comment>" ++ ({-# LINE 43 "XSLT.hs.neat" #-}
66d43
<   output (comment)) ++ {-# LINE 43 "XSLT.hs.neat" #-}
67c44
<   "</xsl:comment>"){-# LINE 44 "XSLT.hs.neat" #-}
---
>  output (Comment comment) = ( ++ (
67a45
>   output (comment)) ++)
70d47
<  output (Define (Function location name pattern) block) = ({-# LINE 46 "XSLT.hs.neat" #-}
71d47
<   "" ++ ({-# LINE 47 "XSLT.hs.neat" #-}
72d47
<   output (location)) ++ {-# LINE 47 "XSLT.hs.neat" #-}
73d47
<   "\n  <xsl:template name=" ++ ({-# LINE 48 "XSLT.hs.neat" #-}
74d47
<   output (quote $ name)) ++ {-# LINE 48 "XSLT.hs.neat" #-}
75d47
<   " match=" ++ ({-# LINE 48 "XSLT.hs.neat" #-}
76d47
<   output (quote $ pattern)) ++ {-# LINE 48 "XSLT.hs.neat" #-}
77d47
<   ">" ++ ({-# LINE 49 "XSLT.hs.neat" #-}
78d47
<   output (block)) ++ {-# LINE 49 "XSLT.hs.neat" #-}
79c48
<   "\n  </xsl:template>"){-# LINE 51 "XSLT.hs.neat" #-}
---
>  output (Define (Function location name pattern) block) = ( ++ (
79a49
>   output (location)) ++ ++ (
79a50
>   output (quote $ name)) ++ ++ ( ( pattern)) ++ ++ (
79a51
>   output (block)) ++)
82d53
<  output (Filter value block) = ({-# LINE 53 "XSLT.hs.neat" #-}
83d53
<   "\n  <!-- TODO: filters -->"){-# LINE 55 "XSLT.hs.neat" #-}
84a55
>  output (Filter value block) = ()
86d56
<  output (For (Binding pattern value) block else') = ({-# LINE 57 "XSLT.hs.neat" #-}
87d56
<   "\n  <xsl:choose>\n    <xsl:when test=" ++ ({-# LINE 59 "XSLT.hs.neat" #-}
88d56
<   output (quote $ value)) ++ {-# LINE 59 "XSLT.hs.neat" #-}
89d56
<   ">\n      <xsl:for-each select=" ++ ({-# LINE 60 "XSLT.hs.neat" #-}
90d56
<   output (quote $ value)) ++ {-# LINE 60 "XSLT.hs.neat" #-}
91d56
<   ">" ++ ({-# LINE 61 "XSLT.hs.neat" #-}
92d56
<   output (block)) ++ {-# LINE 61 "XSLT.hs.neat" #-}
93c57
<   "\n      </xsl:for-each>\n    </xsl:when>" ++ ({-# LINE 64 "XSLT.hs.neat" #-}
---
> 
93a58
> 
93a59
>  output (For (Binding pattern value) block else') = ( ++ (
93a60
> 
93a61
>   output (quote $ value)) ++ ++ (
93a62
>   output (quote $ value)) ++ ++ (
93a63
>   output (block)) ++ ++ (
93a64
> 
93a65
> 
95d66
<     then ({-# LINE 64 "XSLT.hs.neat" #-}
96d66
<     "\n      <xsl:otherwise>" ++ ({-# LINE 65 "XSLT.hs.neat" #-}
97d66
<     output (else')) ++ {-# LINE 65 "XSLT.hs.neat" #-}
98d66
<     "</xsl:otherwise>")
99d66
<     else []) ++ {-# LINE 66 "XSLT.hs.neat" #-}
100c67
<   "\n  </xsl:choose>"){-# LINE 68 "XSLT.hs.neat" #-}
---
>     then ( ++ (
100a68
>     output (else')) ++)
100a69
>     else []) ++)
103d71
<  output (If value block else') = ({-# LINE 70 "XSLT.hs.neat" #-}
104d71
<   "\n  <xsl:if test=" ++ ({-# LINE 71 "XSLT.hs.neat" #-}
105d71
<   output (quote $ value)) ++ {-# LINE 71 "XSLT.hs.neat" #-}
106d71
<   ">\n    <xsl:for-each select=" ++ ({-# LINE 72 "XSLT.hs.neat" #-}
107d71
<   output (quote $ value)) ++ {-# LINE 72 "XSLT.hs.neat" #-}
108d71
<   ">" ++ ({-# LINE 73 "XSLT.hs.neat" #-}
109d71
<   output (block)) ++ {-# LINE 73 "XSLT.hs.neat" #-}
110c72
<   "\n    </xsl:for-each>\n  </xsl:if>" ++ ({-# LINE 76 "XSLT.hs.neat" #-}
---
> 
110a73
>  output (If value block else') = ( ++ (
110a74
>   output (quote $ value)) ++ ++ (
110a75
>   output (quote $ value)) ++ ++ (
110a76
>   output (block)) ++ ++ (
110a77
> 
110a78
> 
112d79
<     then ({-# LINE 76 "XSLT.hs.neat" #-}
113d79
<     "\n    <xsl:if test=" ++ ({-# LINE 77 "XSLT.hs.neat" #-}
114d79
<     output (quote $ prepend "!" $ value)) ++ {-# LINE 77 "XSLT.hs.neat" #-}
115d79
<     ">\n      <xsl:for-each select=" ++ ({-# LINE 78 "XSLT.hs.neat" #-}
116d79
<     output (quote $ value)) ++ {-# LINE 78 "XSLT.hs.neat" #-}
117d79
<     ">" ++ ({-# LINE 79 "XSLT.hs.neat" #-}
118d79
<     output (block)) ++ {-# LINE 79 "XSLT.hs.neat" #-}
119d79
<     "\n      </xsl:for-each>\n    </xsl:if>")
120d79
<     else []) ++ {-# LINE 82 "XSLT.hs.neat" #-}
121c80
<   ""){-# LINE 83 "XSLT.hs.neat" #-}
---
>     then ( ++ (
121a81
>     output (quote $ prepend "!" $ value)) ++ ++ (
121a82
>     output (quote $ value)) ++ ++ (
121a83
>     output (block)) ++)
121a84
>     else []) ++
122a86
>   "")
124d87
<  output (Switch value cases default') = ({-# LINE 85 "XSLT.hs.neat" #-}
125c88
<   "\n  <xsl:choose>" ++ ({-# LINE 87 "XSLT.hs.neat" #-}
---
> 
125a89
>  output (Switch value cases default') = ( ++ (
125a90
> 
128d92
<       then _l >>= \{-# LINE 87 "XSLT.hs.neat" #-}
129d92
<   (Case pattern block) -> ({-# LINE 87 "XSLT.hs.neat" #-}
130d92
<     "\n      <xsl:when test=" ++ ({-# LINE 88 "XSLT.hs.neat" #-}
131d92
<     output (quote $ prepend value $ prepend " = " $ pattern)) ++ {-# LINE 88 "XSLT.hs.neat" #-}
132d92
<     ">" ++ ({-# LINE 89 "XSLT.hs.neat" #-}
133d92
<     output (block)) ++ {-# LINE 89 "XSLT.hs.neat" #-}
134d92
<     "\n      </xsl:when>")
135d92
<       else []) ++ {-# LINE 91 "XSLT.hs.neat" #-}
136c93
<   "" ++ ({-# LINE 92 "XSLT.hs.neat" #-}
---
>       then                 _l >>= \Case pattern block) -> ( ++ (
136a94
>     output (quote $ prepend value $ prepend " = " $ pattern)) ++ ++ (
136a95
>     output (block)) ++)
136a96
>       else []) ++
136a97
>   "" ++ (
138d98
<     then ({-# LINE 92 "XSLT.hs.neat" #-}
139d98
<     "\n      <xsl:otherwise>" ++ ({-# LINE 93 "XSLT.hs.neat" #-}
140d98
<     output (default')) ++ {-# LINE 93 "XSLT.hs.neat" #-}
141d98
<     "</xsl:otherwise>")
142d98
<     else []) ++ {-# LINE 94 "XSLT.hs.neat" #-}
143c99
<   "\n  </xsl:choose>"){-# LINE 96 "XSLT.hs.neat" #-}
---
>     then ( ++ (
143a100
>     output (default')) ++)
143a101
>     else []) ++)
146d103
<  output (With (Binding pattern value) block) = ({-# LINE 98 "XSLT.hs.neat" #-}
147d103
<   "\n  <xsl:variable name=" ++ ({-# LINE 99 "XSLT.hs.neat" #-}
148d103
<   output (quote $ pattern)) ++ {-# LINE 99 "XSLT.hs.neat" #-}
149d103
<   " select=" ++ ({-# LINE 99 "XSLT.hs.neat" #-}
150d103
<   output (quote $ value)) ++ {-# LINE 99 "XSLT.hs.neat" #-}
151d103
<   "" ++ ({-# LINE 100 "XSLT.hs.neat" #-}
152d103
<   output (block)) ++ {-# LINE 100 "XSLT.hs.neat" #-}
153d103
<   "\n  </xsl:variable>"){-# LINE 102 "XSLT.hs.neat" #-}
154a105
>  output (With (Binding pattern value) block) = ( ++ (
154a106
>   output (quote $ pattern)) ++ ++ ( ( value)) ++ ++ (
154a107
>   output (block)) ++)
156d108
<  output (Text text) = ({-# LINE 104 "XSLT.hs.neat" #-}
157d108
<   "\n  <xsl:text>" ++ ({-# LINE 105 "XSLT.hs.neat" #-}
158d108
<   output (text)) ++ {-# LINE 105 "XSLT.hs.neat" #-}
159d108
<   "</xsl:text>"){-# LINE 106 "XSLT.hs.neat" #-}
161a111
>  output (Text text) = ( ++
161a112
>   output (text) ++)
162a114
> 
162a115
> 
164a118
> 
</pre></br><h2>original</h2></br><pre>{-# LINE 1 "XSLT.hs.neat" #-}
-- Copyright 2014 Alvaro J. Genial [http://alva.ro]; see LICENSE file for more.

module Text.Neat.Output.XSLT (outputXSLT) where

import Text.Neat.Template
import Text.Neat.Output


instance Output File where
 output (File path block) = ({-# LINE 10 "XSLT.hs.neat" #-}
  "<?xml version=\"1.0\"?>\n<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\">" ++ ({-# LINE 12 "XSLT.hs.neat" #-}
  output (block)) ++ {-# LINE 12 "XSLT.hs.neat" #-}
  "\n</xsl:stylesheet>"){-# LINE 14 "XSLT.hs.neat" #-}


instance Output Block where
 output (Block chunks) = ({-# LINE 17 "XSLT.hs.neat" #-}
  "" ++ ({-# LINE 18 "XSLT.hs.neat" #-}
  let _l = list (chunks) in
    if (not . null) _l
      then _l >>= \{-# LINE 18 "XSLT.hs.neat" #-}
  chunk -> ({-# LINE 18 "XSLT.hs.neat" #-}
    "" ++ ({-# LINE 19 "XSLT.hs.neat" #-}
    output (chunk)) ++ {-# LINE 19 "XSLT.hs.neat" #-}
    "")
      else []) ++ {-# LINE 20 "XSLT.hs.neat" #-}
  ""){-# LINE 21 "XSLT.hs.neat" #-}


instance Output Chunk where
 output (Chunk location element) = ({-# LINE 24 "XSLT.hs.neat" #-}
  "" ++ ({-# LINE 25 "XSLT.hs.neat" #-}
  output (element)) ++ {-# LINE 25 "XSLT.hs.neat" #-}
  ""){-# LINE 26 "XSLT.hs.neat" #-}


instance Output Location where
 output (Location file line) = ({-# LINE 29 "XSLT.hs.neat" #-}
  "<!-- Source: " ++ ({-# LINE 29 "XSLT.hs.neat" #-}
  output (file)) ++ {-# LINE 29 "XSLT.hs.neat" #-}
  ":" ++ ({-# LINE 29 "XSLT.hs.neat" #-}
  output (line)) ++ {-# LINE 29 "XSLT.hs.neat" #-}
  " -->"){-# LINE 29 "XSLT.hs.neat" #-}


instance Output Value where
 output (Value _ value) = (({-# LINE 32 "XSLT.hs.neat" #-}
  output (value))){-# LINE 32 "XSLT.hs.neat" #-}


instance Output Pattern where
 output (Pattern _ pattern) = (({-# LINE 35 "XSLT.hs.neat" #-}
  output (pattern))){-# LINE 35 "XSLT.hs.neat" #-}


instance Output Element where
 output (Output value) = ({-# LINE 38 "XSLT.hs.neat" #-}
  "\n  <xsl:value-of select=" ++ ({-# LINE 39 "XSLT.hs.neat" #-}
  output (quote $ value)) ++ {-# LINE 39 "XSLT.hs.neat" #-}
  " />"){-# LINE 40 "XSLT.hs.neat" #-}


 output (Comment comment) = ({-# LINE 42 "XSLT.hs.neat" #-}
  "\n  <xsl:comment>" ++ ({-# LINE 43 "XSLT.hs.neat" #-}
  output (comment)) ++ {-# LINE 43 "XSLT.hs.neat" #-}
  "</xsl:comment>"){-# LINE 44 "XSLT.hs.neat" #-}


 output (Define (Function location name pattern) block) = ({-# LINE 46 "XSLT.hs.neat" #-}
  "" ++ ({-# LINE 47 "XSLT.hs.neat" #-}
  output (location)) ++ {-# LINE 47 "XSLT.hs.neat" #-}
  "\n  <xsl:template name=" ++ ({-# LINE 48 "XSLT.hs.neat" #-}
  output (quote $ name)) ++ {-# LINE 48 "XSLT.hs.neat" #-}
  " match=" ++ ({-# LINE 48 "XSLT.hs.neat" #-}
  output (quote $ pattern)) ++ {-# LINE 48 "XSLT.hs.neat" #-}
  ">" ++ ({-# LINE 49 "XSLT.hs.neat" #-}
  output (block)) ++ {-# LINE 49 "XSLT.hs.neat" #-}
  "\n  </xsl:template>"){-# LINE 51 "XSLT.hs.neat" #-}


 output (Filter value block) = ({-# LINE 53 "XSLT.hs.neat" #-}
  "\n  <!-- TODO: filters -->"){-# LINE 55 "XSLT.hs.neat" #-}


 output (For (Binding pattern value) block else') = ({-# LINE 57 "XSLT.hs.neat" #-}
  "\n  <xsl:choose>\n    <xsl:when test=" ++ ({-# LINE 59 "XSLT.hs.neat" #-}
  output (quote $ value)) ++ {-# LINE 59 "XSLT.hs.neat" #-}
  ">\n      <xsl:for-each select=" ++ ({-# LINE 60 "XSLT.hs.neat" #-}
  output (quote $ value)) ++ {-# LINE 60 "XSLT.hs.neat" #-}
  ">" ++ ({-# LINE 61 "XSLT.hs.neat" #-}
  output (block)) ++ {-# LINE 61 "XSLT.hs.neat" #-}
  "\n      </xsl:for-each>\n    </xsl:when>" ++ ({-# LINE 64 "XSLT.hs.neat" #-}
  if (not . zero) (else')
    then ({-# LINE 64 "XSLT.hs.neat" #-}
    "\n      <xsl:otherwise>" ++ ({-# LINE 65 "XSLT.hs.neat" #-}
    output (else')) ++ {-# LINE 65 "XSLT.hs.neat" #-}
    "</xsl:otherwise>")
    else []) ++ {-# LINE 66 "XSLT.hs.neat" #-}
  "\n  </xsl:choose>"){-# LINE 68 "XSLT.hs.neat" #-}


 output (If value block else') = ({-# LINE 70 "XSLT.hs.neat" #-}
  "\n  <xsl:if test=" ++ ({-# LINE 71 "XSLT.hs.neat" #-}
  output (quote $ value)) ++ {-# LINE 71 "XSLT.hs.neat" #-}
  ">\n    <xsl:for-each select=" ++ ({-# LINE 72 "XSLT.hs.neat" #-}
  output (quote $ value)) ++ {-# LINE 72 "XSLT.hs.neat" #-}
  ">" ++ ({-# LINE 73 "XSLT.hs.neat" #-}
  output (block)) ++ {-# LINE 73 "XSLT.hs.neat" #-}
  "\n    </xsl:for-each>\n  </xsl:if>" ++ ({-# LINE 76 "XSLT.hs.neat" #-}
  if (not . zero) (else')
    then ({-# LINE 76 "XSLT.hs.neat" #-}
    "\n    <xsl:if test=" ++ ({-# LINE 77 "XSLT.hs.neat" #-}
    output (quote $ prepend "!" $ value)) ++ {-# LINE 77 "XSLT.hs.neat" #-}
    ">\n      <xsl:for-each select=" ++ ({-# LINE 78 "XSLT.hs.neat" #-}
    output (quote $ value)) ++ {-# LINE 78 "XSLT.hs.neat" #-}
    ">" ++ ({-# LINE 79 "XSLT.hs.neat" #-}
    output (block)) ++ {-# LINE 79 "XSLT.hs.neat" #-}
    "\n      </xsl:for-each>\n    </xsl:if>")
    else []) ++ {-# LINE 82 "XSLT.hs.neat" #-}
  ""){-# LINE 83 "XSLT.hs.neat" #-}


 output (Switch value cases default') = ({-# LINE 85 "XSLT.hs.neat" #-}
  "\n  <xsl:choose>" ++ ({-# LINE 87 "XSLT.hs.neat" #-}
  let _l = list (cases) in
    if (not . null) _l
      then _l >>= \{-# LINE 87 "XSLT.hs.neat" #-}
  (Case pattern block) -> ({-# LINE 87 "XSLT.hs.neat" #-}
    "\n      <xsl:when test=" ++ ({-# LINE 88 "XSLT.hs.neat" #-}
    output (quote $ prepend value $ prepend " = " $ pattern)) ++ {-# LINE 88 "XSLT.hs.neat" #-}
    ">" ++ ({-# LINE 89 "XSLT.hs.neat" #-}
    output (block)) ++ {-# LINE 89 "XSLT.hs.neat" #-}
    "\n      </xsl:when>")
      else []) ++ {-# LINE 91 "XSLT.hs.neat" #-}
  "" ++ ({-# LINE 92 "XSLT.hs.neat" #-}
  if (not . zero) (default')
    then ({-# LINE 92 "XSLT.hs.neat" #-}
    "\n      <xsl:otherwise>" ++ ({-# LINE 93 "XSLT.hs.neat" #-}
    output (default')) ++ {-# LINE 93 "XSLT.hs.neat" #-}
    "</xsl:otherwise>")
    else []) ++ {-# LINE 94 "XSLT.hs.neat" #-}
  "\n  </xsl:choose>"){-# LINE 96 "XSLT.hs.neat" #-}


 output (With (Binding pattern value) block) = ({-# LINE 98 "XSLT.hs.neat" #-}
  "\n  <xsl:variable name=" ++ ({-# LINE 99 "XSLT.hs.neat" #-}
  output (quote $ pattern)) ++ {-# LINE 99 "XSLT.hs.neat" #-}
  " select=" ++ ({-# LINE 99 "XSLT.hs.neat" #-}
  output (quote $ value)) ++ {-# LINE 99 "XSLT.hs.neat" #-}
  "" ++ ({-# LINE 100 "XSLT.hs.neat" #-}
  output (block)) ++ {-# LINE 100 "XSLT.hs.neat" #-}
  "\n  </xsl:variable>"){-# LINE 102 "XSLT.hs.neat" #-}


 output (Text text) = ({-# LINE 104 "XSLT.hs.neat" #-}
  "\n  <xsl:text>" ++ ({-# LINE 105 "XSLT.hs.neat" #-}
  output (text)) ++ {-# LINE 105 "XSLT.hs.neat" #-}
  "</xsl:text>"){-# LINE 106 "XSLT.hs.neat" #-}



outputXSLT :: File -> String
outputXSLT = output
</pre></br><h2>printed</h2></br><pre>-- Copyright 2014 Alvaro J. Genial [http://alva.ro]; see LICENSE file for more.

module Text.Neat.Output.XSLT (outputXSLT) where

import Text.Neat.Template
import Text.Neat.Output


instance Output File where
 output (File path block) = ( ++ (

  output (block)) ++)



instance Output Block where
 output (Block chunks) = ( ++ (
  let _l = list (chunks) in
    if (not . null) _l
      then  _l >>= \ -> ( ++ (
    output (chunk)))
      else) ++)


instance Output Chunk where
 output (Chunk location element) = ( ++ (
  output (element)) ++)


instance Output Location where
 output (Location file line) = ( ++ ( (file)) ++ ++ ())

instance Output Value where
 output (Value _ value) = (( (value)))

instance Output Pattern where
 output (Pattern _ pattern) = (( (pattern)))

instance Output Element where
 output (Output value) = ( ++ (
  output (quote $ value)) ++)


 output (Comment comment) = ( ++ (
  output (comment)) ++)


 output (Define (Function location name pattern) block) = ( ++ (
  output (location)) ++ ++ (
  output (quote $ name)) ++ ++ ( ( pattern)) ++ ++ (
  output (block)) ++)



 output (Filter value block) = ()



 output (For (Binding pattern value) block else') = ( ++ (

  output (quote $ value)) ++ ++ (
  output (quote $ value)) ++ ++ (
  output (block)) ++ ++ (


  if (not . zero) (else')
    then ( ++ (
    output (else')) ++)
    else []) ++)



 output (If value block else') = ( ++ (
  output (quote $ value)) ++ ++ (
  output (quote $ value)) ++ ++ (
  output (block)) ++ ++ (


  if (not . zero) (else')
    then ( ++ (
    output (quote $ prepend "!" $ value)) ++ ++ (
    output (quote $ value)) ++ ++ (
    output (block)) ++)
    else []) ++

  "")


 output (Switch value cases default') = ( ++ (

  let _l = list (cases) in
    if (not . null) _l
      then                 _l >>= \Case pattern block) -> ( ++ (
    output (quote $ prepend value $ prepend " = " $ pattern)) ++ ++ (
    output (block)) ++)
      else []) ++
  "" ++ (
  if (not . zero) (default')
    then ( ++ (
    output (default')) ++)
    else []) ++)



 output (With (Binding pattern value) block) = ( ++ (
  output (quote $ pattern)) ++ ++ ( ( value)) ++ ++ (
  output (block)) ++)



 output (Text text) = ( ++
  output (text) ++)



outputXSLT :: File -> String
outputXSLT = output

</pre>