<a href="Haskell.hs20059862881265768163.out.html">prev</a></br><a href="failures.html">home</a></br><a href="HaskellPdfPresenter.hs10447881241927702196.out.html">next</a></br></br><pre>1d0
< {-# LINE 1 "Haskell.hs.neat" #-}
11d9
<  output (File path (Block chunks)) = ({-# LINE 10 "Haskell.hs.neat" #-}
12c10
<   "" ++ ({-# LINE 11 "Haskell.hs.neat" #-}
---
>  output (File path (Block chunks)) = ( ++ (
15d12
<       then _l >>= \{-# LINE 11 "Haskell.hs.neat" #-}
16d12
<   chunk @ (Chunk location element) -> ({-# LINE 11 "Haskell.hs.neat" #-}
17c13
<     "" ++ ({-# LINE 12 "Haskell.hs.neat" #-}
---
>       then                             _l >>= \ @ (Chunk location element) ->  ( ++ (
19d14
<       case (element) of {-# LINE 13 "Haskell.hs.neat" #-}
20d14
<     (Text text) -> (({-# LINE 13 "Haskell.hs.neat" #-}
21d14
<       output (location)) ++ ({-# LINE 13 "Haskell.hs.neat" #-}
22d14
<       output (text)) ++ {-# LINE 13 "Haskell.hs.neat" #-}
23d14
<       "")
24d14
<     _ -> (({-# LINE 14 "Haskell.hs.neat" #-}
25d14
<       output (chunk)) ++ {-# LINE 14 "Haskell.hs.neat" #-}
26c15
<       "")) ++ {-# LINE 15 "Haskell.hs.neat" #-}
---
>       case (element) ofText text) -> (( (location)) ++ ( (text)) ++)
26a16
>     _ -> (( (chunk)) ++)) ++
28d17
<       else []) ++ {-# LINE 16 "Haskell.hs.neat" #-}
29c18
<   ""){-# LINE 17 "Haskell.hs.neat" #-}
---
>       else []) ++)
33d21
<  output (Block chunks) = ({-# LINE 20 "Haskell.hs.neat" #-}
34d21
<   "(" ++ ({-# LINE 20 "Haskell.hs.neat" #-}
35d21
<   output (nest $ join " ++ " $ chunks)) ++ {-# LINE 20 "Haskell.hs.neat" #-}
36d21
<   ")"){-# LINE 20 "Haskell.hs.neat" #-}
37c22
< 
---
>  output (Block chunks) = ( ++ ( (nest $ join " ++ " $ chunks)) ++)
40d24
<  output chunk @ (Chunk location element) = ({-# LINE 23 "Haskell.hs.neat" #-}
41c25
<   "" ++ ({-# LINE 24 "Haskell.hs.neat" #-}
---
>  output chunk @ (Chunk location element) = ( ++ (
43d26
<     case (chunk) of {-# LINE 25 "Haskell.hs.neat" #-}
44d26
<   (Chunk _ (Define _ _)) -> (({-# LINE 25 "Haskell.hs.neat" #-}
45d26
<     output (element)) ++ {-# LINE 25 "Haskell.hs.neat" #-}
46d26
<     ""){-# LINE 26 "Haskell.hs.neat" #-}
47d26
<   (Chunk _ (Text _)) -> (({-# LINE 26 "Haskell.hs.neat" #-}
48d26
<     output (location)) ++ ({-# LINE 26 "Haskell.hs.neat" #-}
49d26
<     output (element)) ++ {-# LINE 26 "Haskell.hs.neat" #-}
50d26
<     "")
51d26
<   _ -> ({-# LINE 27 "Haskell.hs.neat" #-}
52d26
<     "(" ++ ({-# LINE 27 "Haskell.hs.neat" #-}
53d26
<     output (location)) ++ ({-# LINE 27 "Haskell.hs.neat" #-}
54d26
<     output (element)) ++ {-# LINE 27 "Haskell.hs.neat" #-}
55d26
<     ")")) ++ {-# LINE 28 "Haskell.hs.neat" #-}
56c27
<   ""){-# LINE 29 "Haskell.hs.neat" #-}
---
>     case (chunk) ofChunk _ (Define _ _)) -> (( (element)) ++)
56a28
>   (Chunk _ (Text _)) -> (( (location)) ++ ( (element)) ++)
56a29
>   _ -> ( ++ ( (location)) ++ ( (element)) ++)) ++
56a30
>   "")
60d33
<  output (Case pattern block) = (({-# LINE 32 "Haskell.hs.neat" #-}
61d33
<   output (pattern)) ++ {-# LINE 32 "Haskell.hs.neat" #-}
62d33
<   " -> " ++ ({-# LINE 32 "Haskell.hs.neat" #-}
63d33
<   output (block))){-# LINE 32 "Haskell.hs.neat" #-}
64c34
< 
---
>  output (Case pattern block) = (( (pattern)) ++ ++ ( (block)))
67d36
<  output (Location file line) = ({-# LINE 35 "Haskell.hs.neat" #-}
68d36
<   "{-# LINE " ++ ({-# LINE 35 "Haskell.hs.neat" #-}
69d36
<   output (line)) ++ {-# LINE 35 "Haskell.hs.neat" #-}
70d36
<   " " ++ ({-# LINE 35 "Haskell.hs.neat" #-}
71d36
<   output (quote $ file)) ++ {-# LINE 35 "Haskell.hs.neat" #-}
72c37
<   " #-}\n"){-# LINE 37 "Haskell.hs.neat" #-}
---
>  output (Location file line) = ( ++ ( (line)) ++ ++ ( (quote $ file)) ++)
75d39
< instance Output Function where
76d39
<  output (Function _ name (Pattern _ pattern)) = (({-# LINE 40 "Haskell.hs.neat" #-}
77d39
<   output (name)) ++ ({-# LINE 40 "Haskell.hs.neat" #-}
78d39
<   output (pattern))){-# LINE 40 "Haskell.hs.neat" #-}
79a41
> instance Output Function where
79a42
>  output (Function _ name (Pattern _ pattern)) = (( (name)) ++ ( (pattern)))
82d44
<  output (Value location pipeline) = ({-# LINE 43 "Haskell.hs.neat" #-}
83d44
<   "(" ++ ({-# LINE 43 "Haskell.hs.neat" #-}
84d44
<   output (join " $ " $ reverse $ pipeline)) ++ {-# LINE 43 "Haskell.hs.neat" #-}
85d44
<   ")"){-# LINE 43 "Haskell.hs.neat" #-}
86c45
< 
---
>  output (Value location pipeline) = ( ++ ( (join " $ " $ reverse $ pipeline)) ++)
89d47
<  output (Pattern location pattern) = (({-# LINE 46 "Haskell.hs.neat" #-}
90d47
<   output (location)) ++ ({-# LINE 46 "Haskell.hs.neat" #-}
91d47
<   output (pattern))){-# LINE 46 "Haskell.hs.neat" #-}
92c48
< 
---
>  output (Pattern location pattern) = (( (location)) ++ ( (pattern)))
95d50
<  output (Output value) = ({-# LINE 49 "Haskell.hs.neat" #-}
96d50
<   "output " ++ ({-# LINE 49 "Haskell.hs.neat" #-}
97d50
<   output (value))){-# LINE 49 "Haskell.hs.neat" #-}
98d50
< 
99d50
<  output (Comment comment) = (({-# LINE 50 "Haskell.hs.neat" #-}
100d50
<   output ('{')) ++ {-# LINE 50 "Haskell.hs.neat" #-}
101d50
<   "#" ++ ({-# LINE 50 "Haskell.hs.neat" #-}
102d50
<   output (comment)) ++ {-# LINE 50 "Haskell.hs.neat" #-}
103d50
<   "#" ++ ({-# LINE 50 "Haskell.hs.neat" #-}
104d50
<   output ('}'))){-# LINE 50 "Haskell.hs.neat" #-}
105d50
< 
106d50
<  output (Define function block) = (({-# LINE 51 "Haskell.hs.neat" #-}
107d50
<   output (function)) ++ {-# LINE 51 "Haskell.hs.neat" #-}
108d50
<   " = " ++ ({-# LINE 51 "Haskell.hs.neat" #-}
109d50
<   output (block))){-# LINE 51 "Haskell.hs.neat" #-}
110d50
< 
111d50
<  output (Filter value block) = (({-# LINE 52 "Haskell.hs.neat" #-}
112d50
<   output (value)) ++ {-# LINE 52 "Haskell.hs.neat" #-}
113d50
<   " " ++ ({-# LINE 52 "Haskell.hs.neat" #-}
114c51
<   output (block))){-# LINE 52 "Haskell.hs.neat" #-}
---
>  output (Output value) = ( ++ ( (value)))
114a52
>  output (Comment comment) = (( ('{')) ++ ++ ( (comment)) ++ ())
114a53
>  output (Define function block) = (( (function)) ++ ++ ( (block)))
114a54
>  output (Filter value block) = (( (value)) ++ ++ ())
115a56
>  output (For (Binding pattern value) block other) = ( ++ ( (value)) ++ ++ (
117d57
<  output (For (Binding pattern value) block other) = ({-# LINE 54 "Haskell.hs.neat" #-}
118d57
<   "let _l = list " ++ ({-# LINE 54 "Haskell.hs.neat" #-}
119d57
<   output (value)) ++ {-# LINE 54 "Haskell.hs.neat" #-}
120d57
<   " in\n  if (not . null) _l\n    then _l >>= \\" ++ ({-# LINE 56 "Haskell.hs.neat" #-}
121d57
<   output (pattern)) ++ {-# LINE 56 "Haskell.hs.neat" #-}
122d57
<   " -> " ++ ({-# LINE 56 "Haskell.hs.neat" #-}
123d57
<   output (block)) ++ {-# LINE 56 "Haskell.hs.neat" #-}
124d57
<   "\n    else " ++ ({-# LINE 57 "Haskell.hs.neat" #-}
125d57
<   output (unless other "[]")) ++ {-# LINE 57 "Haskell.hs.neat" #-}
126c58
<   ""){-# LINE 58 "Haskell.hs.neat" #-}
---
>   output (pattern)) ++ ++ ( (block)) ++ ++ (
126a59
>   output (unless other "[]")) ++)
129d61
<  output (If value block other) = ({-# LINE 60 "Haskell.hs.neat" #-}
130d61
<   "if (not . zero) " ++ ({-# LINE 60 "Haskell.hs.neat" #-}
131d61
<   output (value)) ++ {-# LINE 60 "Haskell.hs.neat" #-}
132d61
<   "\n  then " ++ ({-# LINE 61 "Haskell.hs.neat" #-}
133d61
<   output (block)) ++ {-# LINE 61 "Haskell.hs.neat" #-}
134d61
<   "\n  else " ++ ({-# LINE 62 "Haskell.hs.neat" #-}
135d61
<   output (unless other "[]")) ++ {-# LINE 62 "Haskell.hs.neat" #-}
136c62
<   ""){-# LINE 63 "Haskell.hs.neat" #-}
---
>  output (If value block other) = ( ++ ( (value)) ++ ++ (
136a63
>   output (block)) ++ ++ (
136a64
>   output (unless other "[]")) ++)
139d66
<  output (Switch value cases other) = ({-# LINE 65 "Haskell.hs.neat" #-}
140d66
<   "\n  case " ++ ({-# LINE 66 "Haskell.hs.neat" #-}
141d66
<   output (value)) ++ {-# LINE 66 "Haskell.hs.neat" #-}
142d66
<   " of " ++ ({-# LINE 66 "Haskell.hs.neat" #-}
143d66
<   output (cases)) ++ {-# LINE 66 "Haskell.hs.neat" #-}
144d66
<   " " ++ ({-# LINE 66 "Haskell.hs.neat" #-}
145d66
<   if (not . zero) (other)
146d66
<     then ({-# LINE 66 "Haskell.hs.neat" #-}
147c67
<     "\n_ -> " ++ ({-# LINE 67 "Haskell.hs.neat" #-}
---
>  output (Switch value cases other) = ( ++ (
147a68
>   output (value)) ++ ++ () ++ ( (not . zero) (other)
147a69
>     then ( ++ (
149d70
<     else []) ++ {-# LINE 67 "Haskell.hs.neat" #-}
150c71
<   ""){-# LINE 68 "Haskell.hs.neat" #-}
---
>     else []) ++)
153d73
<  output (With (Binding pattern value) block) = ({-# LINE 70 "Haskell.hs.neat" #-}
154d73
<   "\n  case " ++ ({-# LINE 71 "Haskell.hs.neat" #-}
155d73
<   output (value)) ++ {-# LINE 71 "Haskell.hs.neat" #-}
156d73
<   " of " ++ ({-# LINE 71 "Haskell.hs.neat" #-}
157d73
<   output (pattern)) ++ {-# LINE 71 "Haskell.hs.neat" #-}
158d73
<   " -> " ++ ({-# LINE 71 "Haskell.hs.neat" #-}
159d73
<   output (block)) ++ {-# LINE 71 "Haskell.hs.neat" #-}
160c74
<   ""){-# LINE 72 "Haskell.hs.neat" #-}
---
>  output (With (Binding pattern value) block) = ( ++ (
160a75
>   output (value)) ++ ++ ( (pattern)) ++ ())
163d77
<  output (Text text) = (({-# LINE 74 "Haskell.hs.neat" #-}
164d77
<   output (quote $ prune $ text))){-# LINE 74 "Haskell.hs.neat" #-}
165c78
< 
---
>  output (Text text) = (( (quote $ prune $ text)))
169a83
> 
</pre></br><h2>original</h2></br><pre>{-# LINE 1 "Haskell.hs.neat" #-}
-- Copyright 2014 Alvaro J. Genial [http://alva.ro]; see LICENSE file for more.

module Text.Neat.Output.Haskell (outputHS) where

import Text.Neat.Template
import Text.Neat.Output


instance Output File where
 output (File path (Block chunks)) = ({-# LINE 10 "Haskell.hs.neat" #-}
  "" ++ ({-# LINE 11 "Haskell.hs.neat" #-}
  let _l = list (chunks) in
    if (not . null) _l
      then _l >>= \{-# LINE 11 "Haskell.hs.neat" #-}
  chunk @ (Chunk location element) -> ({-# LINE 11 "Haskell.hs.neat" #-}
    "" ++ ({-# LINE 12 "Haskell.hs.neat" #-}

      case (element) of {-# LINE 13 "Haskell.hs.neat" #-}
    (Text text) -> (({-# LINE 13 "Haskell.hs.neat" #-}
      output (location)) ++ ({-# LINE 13 "Haskell.hs.neat" #-}
      output (text)) ++ {-# LINE 13 "Haskell.hs.neat" #-}
      "")
    _ -> (({-# LINE 14 "Haskell.hs.neat" #-}
      output (chunk)) ++ {-# LINE 14 "Haskell.hs.neat" #-}
      "")) ++ {-# LINE 15 "Haskell.hs.neat" #-}
    "")
      else []) ++ {-# LINE 16 "Haskell.hs.neat" #-}
  ""){-# LINE 17 "Haskell.hs.neat" #-}


instance Output Block where
 output (Block chunks) = ({-# LINE 20 "Haskell.hs.neat" #-}
  "(" ++ ({-# LINE 20 "Haskell.hs.neat" #-}
  output (nest $ join " ++ " $ chunks)) ++ {-# LINE 20 "Haskell.hs.neat" #-}
  ")"){-# LINE 20 "Haskell.hs.neat" #-}


instance Output Chunk where
 output chunk @ (Chunk location element) = ({-# LINE 23 "Haskell.hs.neat" #-}
  "" ++ ({-# LINE 24 "Haskell.hs.neat" #-}

    case (chunk) of {-# LINE 25 "Haskell.hs.neat" #-}
  (Chunk _ (Define _ _)) -> (({-# LINE 25 "Haskell.hs.neat" #-}
    output (element)) ++ {-# LINE 25 "Haskell.hs.neat" #-}
    ""){-# LINE 26 "Haskell.hs.neat" #-}
  (Chunk _ (Text _)) -> (({-# LINE 26 "Haskell.hs.neat" #-}
    output (location)) ++ ({-# LINE 26 "Haskell.hs.neat" #-}
    output (element)) ++ {-# LINE 26 "Haskell.hs.neat" #-}
    "")
  _ -> ({-# LINE 27 "Haskell.hs.neat" #-}
    "(" ++ ({-# LINE 27 "Haskell.hs.neat" #-}
    output (location)) ++ ({-# LINE 27 "Haskell.hs.neat" #-}
    output (element)) ++ {-# LINE 27 "Haskell.hs.neat" #-}
    ")")) ++ {-# LINE 28 "Haskell.hs.neat" #-}
  ""){-# LINE 29 "Haskell.hs.neat" #-}


instance Output Case where
 output (Case pattern block) = (({-# LINE 32 "Haskell.hs.neat" #-}
  output (pattern)) ++ {-# LINE 32 "Haskell.hs.neat" #-}
  " -> " ++ ({-# LINE 32 "Haskell.hs.neat" #-}
  output (block))){-# LINE 32 "Haskell.hs.neat" #-}


instance Output Location where
 output (Location file line) = ({-# LINE 35 "Haskell.hs.neat" #-}
  "{-# LINE " ++ ({-# LINE 35 "Haskell.hs.neat" #-}
  output (line)) ++ {-# LINE 35 "Haskell.hs.neat" #-}
  " " ++ ({-# LINE 35 "Haskell.hs.neat" #-}
  output (quote $ file)) ++ {-# LINE 35 "Haskell.hs.neat" #-}
  " #-}\n"){-# LINE 37 "Haskell.hs.neat" #-}


instance Output Function where
 output (Function _ name (Pattern _ pattern)) = (({-# LINE 40 "Haskell.hs.neat" #-}
  output (name)) ++ ({-# LINE 40 "Haskell.hs.neat" #-}
  output (pattern))){-# LINE 40 "Haskell.hs.neat" #-}


instance Output Value where
 output (Value location pipeline) = ({-# LINE 43 "Haskell.hs.neat" #-}
  "(" ++ ({-# LINE 43 "Haskell.hs.neat" #-}
  output (join " $ " $ reverse $ pipeline)) ++ {-# LINE 43 "Haskell.hs.neat" #-}
  ")"){-# LINE 43 "Haskell.hs.neat" #-}


instance Output Pattern where
 output (Pattern location pattern) = (({-# LINE 46 "Haskell.hs.neat" #-}
  output (location)) ++ ({-# LINE 46 "Haskell.hs.neat" #-}
  output (pattern))){-# LINE 46 "Haskell.hs.neat" #-}


instance Output Element where
 output (Output value) = ({-# LINE 49 "Haskell.hs.neat" #-}
  "output " ++ ({-# LINE 49 "Haskell.hs.neat" #-}
  output (value))){-# LINE 49 "Haskell.hs.neat" #-}

 output (Comment comment) = (({-# LINE 50 "Haskell.hs.neat" #-}
  output ('{')) ++ {-# LINE 50 "Haskell.hs.neat" #-}
  "#" ++ ({-# LINE 50 "Haskell.hs.neat" #-}
  output (comment)) ++ {-# LINE 50 "Haskell.hs.neat" #-}
  "#" ++ ({-# LINE 50 "Haskell.hs.neat" #-}
  output ('}'))){-# LINE 50 "Haskell.hs.neat" #-}

 output (Define function block) = (({-# LINE 51 "Haskell.hs.neat" #-}
  output (function)) ++ {-# LINE 51 "Haskell.hs.neat" #-}
  " = " ++ ({-# LINE 51 "Haskell.hs.neat" #-}
  output (block))){-# LINE 51 "Haskell.hs.neat" #-}

 output (Filter value block) = (({-# LINE 52 "Haskell.hs.neat" #-}
  output (value)) ++ {-# LINE 52 "Haskell.hs.neat" #-}
  " " ++ ({-# LINE 52 "Haskell.hs.neat" #-}
  output (block))){-# LINE 52 "Haskell.hs.neat" #-}


 output (For (Binding pattern value) block other) = ({-# LINE 54 "Haskell.hs.neat" #-}
  "let _l = list " ++ ({-# LINE 54 "Haskell.hs.neat" #-}
  output (value)) ++ {-# LINE 54 "Haskell.hs.neat" #-}
  " in\n  if (not . null) _l\n    then _l >>= \\" ++ ({-# LINE 56 "Haskell.hs.neat" #-}
  output (pattern)) ++ {-# LINE 56 "Haskell.hs.neat" #-}
  " -> " ++ ({-# LINE 56 "Haskell.hs.neat" #-}
  output (block)) ++ {-# LINE 56 "Haskell.hs.neat" #-}
  "\n    else " ++ ({-# LINE 57 "Haskell.hs.neat" #-}
  output (unless other "[]")) ++ {-# LINE 57 "Haskell.hs.neat" #-}
  ""){-# LINE 58 "Haskell.hs.neat" #-}


 output (If value block other) = ({-# LINE 60 "Haskell.hs.neat" #-}
  "if (not . zero) " ++ ({-# LINE 60 "Haskell.hs.neat" #-}
  output (value)) ++ {-# LINE 60 "Haskell.hs.neat" #-}
  "\n  then " ++ ({-# LINE 61 "Haskell.hs.neat" #-}
  output (block)) ++ {-# LINE 61 "Haskell.hs.neat" #-}
  "\n  else " ++ ({-# LINE 62 "Haskell.hs.neat" #-}
  output (unless other "[]")) ++ {-# LINE 62 "Haskell.hs.neat" #-}
  ""){-# LINE 63 "Haskell.hs.neat" #-}


 output (Switch value cases other) = ({-# LINE 65 "Haskell.hs.neat" #-}
  "\n  case " ++ ({-# LINE 66 "Haskell.hs.neat" #-}
  output (value)) ++ {-# LINE 66 "Haskell.hs.neat" #-}
  " of " ++ ({-# LINE 66 "Haskell.hs.neat" #-}
  output (cases)) ++ {-# LINE 66 "Haskell.hs.neat" #-}
  " " ++ ({-# LINE 66 "Haskell.hs.neat" #-}
  if (not . zero) (other)
    then ({-# LINE 66 "Haskell.hs.neat" #-}
    "\n_ -> " ++ ({-# LINE 67 "Haskell.hs.neat" #-}
    output (other)))
    else []) ++ {-# LINE 67 "Haskell.hs.neat" #-}
  ""){-# LINE 68 "Haskell.hs.neat" #-}


 output (With (Binding pattern value) block) = ({-# LINE 70 "Haskell.hs.neat" #-}
  "\n  case " ++ ({-# LINE 71 "Haskell.hs.neat" #-}
  output (value)) ++ {-# LINE 71 "Haskell.hs.neat" #-}
  " of " ++ ({-# LINE 71 "Haskell.hs.neat" #-}
  output (pattern)) ++ {-# LINE 71 "Haskell.hs.neat" #-}
  " -> " ++ ({-# LINE 71 "Haskell.hs.neat" #-}
  output (block)) ++ {-# LINE 71 "Haskell.hs.neat" #-}
  ""){-# LINE 72 "Haskell.hs.neat" #-}


 output (Text text) = (({-# LINE 74 "Haskell.hs.neat" #-}
  output (quote $ prune $ text))){-# LINE 74 "Haskell.hs.neat" #-}



outputHS :: File -> String
outputHS = output
</pre></br><h2>printed</h2></br><pre>-- Copyright 2014 Alvaro J. Genial [http://alva.ro]; see LICENSE file for more.

module Text.Neat.Output.Haskell (outputHS) where

import Text.Neat.Template
import Text.Neat.Output


instance Output File where
 output (File path (Block chunks)) = ( ++ (
  let _l = list (chunks) in
    if (not . null) _l
      then                             _l >>= \ @ (Chunk location element) ->  ( ++ (

      case (element) ofText text) -> (( (location)) ++ ( (text)) ++)
    _ -> (( (chunk)) ++)) ++
    "")
      else []) ++)


instance Output Block where
 output (Block chunks) = ( ++ ( (nest $ join " ++ " $ chunks)) ++)

instance Output Chunk where
 output chunk @ (Chunk location element) = ( ++ (

    case (chunk) ofChunk _ (Define _ _)) -> (( (element)) ++)
  (Chunk _ (Text _)) -> (( (location)) ++ ( (element)) ++)
  _ -> ( ++ ( (location)) ++ ( (element)) ++)) ++
  "")


instance Output Case where
 output (Case pattern block) = (( (pattern)) ++ ++ ( (block)))

instance Output Location where
 output (Location file line) = ( ++ ( (line)) ++ ++ ( (quote $ file)) ++)



instance Output Function where
 output (Function _ name (Pattern _ pattern)) = (( (name)) ++ ( (pattern)))

instance Output Value where
 output (Value location pipeline) = ( ++ ( (join " $ " $ reverse $ pipeline)) ++)

instance Output Pattern where
 output (Pattern location pattern) = (( (location)) ++ ( (pattern)))

instance Output Element where
 output (Output value) = ( ++ ( (value)))
 output (Comment comment) = (( ('{')) ++ ++ ( (comment)) ++ ())
 output (Define function block) = (( (function)) ++ ++ ( (block)))
 output (Filter value block) = (( (value)) ++ ++ ())

 output (For (Binding pattern value) block other) = ( ++ ( (value)) ++ ++ (

  output (pattern)) ++ ++ ( (block)) ++ ++ (
  output (unless other "[]")) ++)


 output (If value block other) = ( ++ ( (value)) ++ ++ (
  output (block)) ++ ++ (
  output (unless other "[]")) ++)


 output (Switch value cases other) = ( ++ (
  output (value)) ++ ++ () ++ ( (not . zero) (other)
    then ( ++ (
    output (other)))
    else []) ++)


 output (With (Binding pattern value) block) = ( ++ (
  output (value)) ++ ++ ( (pattern)) ++ ())


 output (Text text) = (( (quote $ prune $ text)))


outputHS :: File -> String
outputHS = output

</pre>