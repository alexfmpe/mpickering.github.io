<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- (c) The University of Glasgow 2006</span><span>
</span><a name="line-2"></a><span class="hs-comment">-- (c) The GRASP/AQUA Project, Glasgow University, 1998</span><span>
</span><a name="line-3"></a><span class="hs-comment">--</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- Type - public interface</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-comment">-- | Main functions for manipulating types and type-related things</span><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Type</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-11"></a><span>        </span><span class="hs-comment">-- Note some of this is just re-exports from TyCon..</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span>        </span><span class="hs-comment">-- * Main data types representing Types</span><span>
</span><a name="line-14"></a><span>        </span><span class="hs-comment">-- $type_classification</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span>        </span><span class="hs-comment">-- $representation_types</span><span>
</span><a name="line-17"></a><span>        </span><a href="TyCoRep.html#TyThing"><span class="hs-identifier hs-type">TyThing</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#VisibilityFlag"><span class="hs-identifier hs-type">VisibilityFlag</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#KindOrType"><span class="hs-identifier hs-type">KindOrType</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>        </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span>        </span><span class="hs-comment">-- ** Constructing and deconstructing types</span><span>
</span><a name="line-21"></a><span>        </span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkTyVarTys"><span class="hs-identifier hs-var">mkTyVarTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#getTyVar"><span class="hs-identifier hs-var">getTyVar</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#repGetTyVar_maybe"><span class="hs-identifier hs-var">repGetTyVar_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>        </span><a href="Type.html#getCastedTyVar_maybe"><span class="hs-identifier hs-var">getCastedTyVar_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span>        </span><a href="Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitAppTy"><span class="hs-identifier hs-var">splitAppTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitAppTys"><span class="hs-identifier hs-var">splitAppTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#repSplitAppTys"><span class="hs-identifier hs-var">repSplitAppTys</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>        </span><a href="Type.html#splitAppTy_maybe"><span class="hs-identifier hs-var">splitAppTy_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#repSplitAppTy_maybe"><span class="hs-identifier hs-var">repSplitAppTy_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#tcRepSplitAppTy_maybe"><span class="hs-identifier hs-var">tcRepSplitAppTy_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span>        </span><a href="TyCoRep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkFunTys"><span class="hs-identifier hs-var">mkFunTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitFunTy"><span class="hs-identifier hs-var">splitFunTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitFunTy_maybe"><span class="hs-identifier hs-var">splitFunTy_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>        </span><a href="Type.html#splitFunTys"><span class="hs-identifier hs-var">splitFunTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitFunTysN"><span class="hs-identifier hs-var">splitFunTysN</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>        </span><a href="Type.html#funResultTy"><span class="hs-identifier hs-var">funResultTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#funArgTy"><span class="hs-identifier hs-var">funArgTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span>        </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkTyConTy"><span class="hs-identifier hs-var">mkTyConTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>        </span><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#tyConAppTyConPicky_maybe"><span class="hs-identifier hs-var">tyConAppTyConPicky_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>        </span><a href="Type.html#tyConAppArgs_maybe"><span class="hs-identifier hs-var">tyConAppArgs_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#tyConAppTyCon"><span class="hs-identifier hs-var">tyConAppTyCon</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#tyConAppArgs"><span class="hs-identifier hs-var">tyConAppArgs</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>        </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitTyConApp"><span class="hs-identifier hs-var">splitTyConApp</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#tyConAppArgN"><span class="hs-identifier hs-var">tyConAppArgN</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#nextRole"><span class="hs-identifier hs-var">nextRole</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>        </span><a href="Type.html#splitListTyConApp_maybe"><span class="hs-identifier hs-var">splitListTyConApp_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>        </span><a href="Type.html#repSplitTyConApp_maybe"><span class="hs-identifier hs-var">repSplitTyConApp_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span>        </span><a href="Type.html#mkForAllTy"><span class="hs-identifier hs-var">mkForAllTy</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkForAllTys"><span class="hs-identifier hs-var">mkForAllTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkInvForAllTys"><span class="hs-identifier hs-var">mkInvForAllTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>        </span><a href="Type.html#mkVisForAllTys"><span class="hs-identifier hs-var">mkVisForAllTys</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>        </span><a href="Type.html#mkNamedForAllTy"><span class="hs-identifier hs-var">mkNamedForAllTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>        </span><a href="Type.html#splitForAllTy_maybe"><span class="hs-identifier hs-var">splitForAllTy_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitForAllTys"><span class="hs-identifier hs-var">splitForAllTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitForAllTy"><span class="hs-identifier hs-var">splitForAllTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>        </span><a href="Type.html#splitPiTy_maybe"><span class="hs-identifier hs-var">splitPiTy_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitPiTys"><span class="hs-identifier hs-var">splitPiTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitPiTy"><span class="hs-identifier hs-var">splitPiTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>        </span><a href="Type.html#splitNamedPiTys"><span class="hs-identifier hs-var">splitNamedPiTys</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>        </span><a href="Type.html#mkPiType"><span class="hs-identifier hs-var">mkPiType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkPiTypes"><span class="hs-identifier hs-var">mkPiTypes</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkTyBindersPreferAnon"><span class="hs-identifier hs-var">mkTyBindersPreferAnon</span></a><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>        </span><a href="Type.html#piResultTy"><span class="hs-identifier hs-var">piResultTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>        </span><a href="Type.html#applyTysX"><span class="hs-identifier hs-var">applyTysX</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#dropForAlls"><span class="hs-identifier hs-var">dropForAlls</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span>        </span><a href="Type.html#mkNumLitTy"><span class="hs-identifier hs-var">mkNumLitTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isNumLitTy"><span class="hs-identifier hs-var">isNumLitTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>        </span><a href="Type.html#mkStrLitTy"><span class="hs-identifier hs-var">mkStrLitTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isStrLitTy"><span class="hs-identifier hs-var">isStrLitTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span>        </span><a href="Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkCoercionTy"><span class="hs-identifier hs-var">mkCoercionTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitCastTy_maybe"><span class="hs-identifier hs-var">splitCastTy_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span>        </span><a href="Type.html#userTypeError_maybe"><span class="hs-identifier hs-var">userTypeError_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span>        </span><a href="Type.html#coAxNthLHS"><span class="hs-identifier hs-var">coAxNthLHS</span></a><span class="hs-special">,</span><span>
</span><a name="line-56"></a><span>        </span><a href="Type.html#stripCoercionTy"><span class="hs-identifier hs-var">stripCoercionTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitCoercionType_maybe"><span class="hs-identifier hs-var">splitCoercionType_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span>        </span><a href="Type.html#splitPiTysInvisible"><span class="hs-identifier hs-var">splitPiTysInvisible</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#filterOutInvisibleTypes"><span class="hs-identifier hs-var">filterOutInvisibleTypes</span></a><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>        </span><a href="Type.html#filterOutInvisibleTyVars"><span class="hs-identifier hs-var">filterOutInvisibleTyVars</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#partitionInvisibles"><span class="hs-identifier hs-var">partitionInvisibles</span></a><span class="hs-special">,</span><span>
</span><a name="line-60"></a><span>        </span><a href="Type.html#synTyConResKind"><span class="hs-identifier hs-var">synTyConResKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span>        </span><span class="hs-comment">-- Analyzing types</span><span>
</span><a name="line-63"></a><span>        </span><a href="Type.html#TyCoMapper"><span class="hs-identifier hs-type">TyCoMapper</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Type.html#mapType"><span class="hs-identifier hs-var">mapType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mapCoercion"><span class="hs-identifier hs-var">mapCoercion</span></a><span class="hs-special">,</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span>        </span><span class="hs-comment">-- (Newtypes)</span><span>
</span><a name="line-66"></a><span>        </span><a href="Type.html#newTyConInstRhs"><span class="hs-identifier hs-var">newTyConInstRhs</span></a><span class="hs-special">,</span><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span>        </span><span class="hs-comment">-- Pred types</span><span>
</span><a name="line-69"></a><span>        </span><a href="Type.html#mkFamilyTyConApp"><span class="hs-identifier hs-var">mkFamilyTyConApp</span></a><span class="hs-special">,</span><span>
</span><a name="line-70"></a><span>        </span><a href="Type.html#isDictLikeTy"><span class="hs-identifier hs-var">isDictLikeTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-71"></a><span>        </span><a href="Type.html#mkPrimEqPred"><span class="hs-identifier hs-var">mkPrimEqPred</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkReprPrimEqPred"><span class="hs-identifier hs-var">mkReprPrimEqPred</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkPrimEqPredRole"><span class="hs-identifier hs-var">mkPrimEqPredRole</span></a><span class="hs-special">,</span><span>
</span><a name="line-72"></a><span>        </span><a href="Type.html#equalityTyCon"><span class="hs-identifier hs-var">equalityTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-73"></a><span>        </span><a href="Type.html#mkHeteroPrimEqPred"><span class="hs-identifier hs-var">mkHeteroPrimEqPred</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkHeteroReprPrimEqPred"><span class="hs-identifier hs-var">mkHeteroReprPrimEqPred</span></a><span class="hs-special">,</span><span>
</span><a name="line-74"></a><span>        </span><a href="Type.html#mkClassPred"><span class="hs-identifier hs-var">mkClassPred</span></a><span class="hs-special">,</span><span>
</span><a name="line-75"></a><span>        </span><a href="Type.html#isClassPred"><span class="hs-identifier hs-var">isClassPred</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isEqPred"><span class="hs-identifier hs-var">isEqPred</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isNomEqPred"><span class="hs-identifier hs-var">isNomEqPred</span></a><span class="hs-special">,</span><span>
</span><a name="line-76"></a><span>        </span><a href="Type.html#isIPPred"><span class="hs-identifier hs-var">isIPPred</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isIPPred_maybe"><span class="hs-identifier hs-var">isIPPred_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isIPTyCon"><span class="hs-identifier hs-var">isIPTyCon</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isIPClass"><span class="hs-identifier hs-var">isIPClass</span></a><span class="hs-special">,</span><span>
</span><a name="line-77"></a><span>        </span><a href="Type.html#isCTupleClass"><span class="hs-identifier hs-var">isCTupleClass</span></a><span class="hs-special">,</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span>        </span><span class="hs-comment">-- Deconstructing predicate types</span><span>
</span><a name="line-80"></a><span>        </span><a href="Type.html#PredTree"><span class="hs-identifier hs-type">PredTree</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Type.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Type.html#eqRelRole"><span class="hs-identifier hs-var">eqRelRole</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#classifyPredType"><span class="hs-identifier hs-var">classifyPredType</span></a><span class="hs-special">,</span><span>
</span><a name="line-81"></a><span>        </span><a href="Type.html#getClassPredTys"><span class="hs-identifier hs-var">getClassPredTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#getClassPredTys_maybe"><span class="hs-identifier hs-var">getClassPredTys_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-82"></a><span>        </span><a href="Type.html#getEqPredTys"><span class="hs-identifier hs-var">getEqPredTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#getEqPredTys_maybe"><span class="hs-identifier hs-var">getEqPredTys_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#getEqPredRole"><span class="hs-identifier hs-var">getEqPredRole</span></a><span class="hs-special">,</span><span>
</span><a name="line-83"></a><span>        </span><a href="Type.html#predTypeEqRel"><span class="hs-identifier hs-var">predTypeEqRel</span></a><span class="hs-special">,</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span>        </span><span class="hs-comment">-- ** Binders</span><span>
</span><a name="line-86"></a><span>        </span><a href="TyCoRep.html#sameVis"><span class="hs-identifier hs-var">sameVis</span></a><span class="hs-special">,</span><span>
</span><a name="line-87"></a><span>        </span><a href="Type.html#mkNamedBinder"><span class="hs-identifier hs-var">mkNamedBinder</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkAnonBinder"><span class="hs-identifier hs-var">mkAnonBinder</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#isNamedBinder"><span class="hs-identifier hs-var">isNamedBinder</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#isAnonBinder"><span class="hs-identifier hs-var">isAnonBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-88"></a><span>        </span><a href="Type.html#isIdLikeBinder"><span class="hs-identifier hs-var">isIdLikeBinder</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#binderVisibility"><span class="hs-identifier hs-var">binderVisibility</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#binderVar_maybe"><span class="hs-identifier hs-var">binderVar_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-89"></a><span>        </span><a href="Type.html#binderVar"><span class="hs-identifier hs-var">binderVar</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#binderRelevantType_maybe"><span class="hs-identifier hs-var">binderRelevantType_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#caseBinder"><span class="hs-identifier hs-var">caseBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-90"></a><span>        </span><a href="Type.html#partitionBinders"><span class="hs-identifier hs-var">partitionBinders</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#partitionBindersIntoBinders"><span class="hs-identifier hs-var">partitionBindersIntoBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-91"></a><span>        </span><a href="TyCoRep.html#binderType"><span class="hs-identifier hs-var">binderType</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#isVisibleBinder"><span class="hs-identifier hs-var">isVisibleBinder</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#isInvisibleBinder"><span class="hs-identifier hs-var">isInvisibleBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span>        </span><span class="hs-comment">-- ** Common type constructors</span><span>
</span><a name="line-94"></a><span>        </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span>        </span><span class="hs-comment">-- ** Predicates on types</span><span>
</span><a name="line-97"></a><span>        </span><a href="Type.html#allDistinctTyVars"><span class="hs-identifier hs-var">allDistinctTyVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-98"></a><span>        </span><a href="Type.html#isTyVarTy"><span class="hs-identifier hs-var">isTyVarTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isFunTy"><span class="hs-identifier hs-var">isFunTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isDictTy"><span class="hs-identifier hs-var">isDictTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isPredTy"><span class="hs-identifier hs-var">isPredTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isVoidTy"><span class="hs-identifier hs-var">isVoidTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isCoercionTy"><span class="hs-identifier hs-var">isCoercionTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-99"></a><span>        </span><a href="Type.html#isCoercionTy_maybe"><span class="hs-identifier hs-var">isCoercionTy_maybe</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#isCoercionType"><span class="hs-identifier hs-var">isCoercionType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isForAllTy"><span class="hs-identifier hs-var">isForAllTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-100"></a><span>        </span><a href="Type.html#isPiTy"><span class="hs-identifier hs-var">isPiTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span>        </span><span class="hs-comment">-- (Lifting and boxity)</span><span>
</span><a name="line-103"></a><span>        </span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isUnboxedTupleType"><span class="hs-identifier hs-var">isUnboxedTupleType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isAlgType"><span class="hs-identifier hs-var">isAlgType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isClosedAlgType"><span class="hs-identifier hs-var">isClosedAlgType</span></a><span class="hs-special">,</span><span>
</span><a name="line-104"></a><span>        </span><a href="Type.html#isPrimitiveType"><span class="hs-identifier hs-var">isPrimitiveType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isStrictType"><span class="hs-identifier hs-var">isStrictType</span></a><span class="hs-special">,</span><span>
</span><a name="line-105"></a><span>        </span><a href="TyCoRep.html#isRuntimeRepTy"><span class="hs-identifier hs-var">isRuntimeRepTy</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#isRuntimeRepVar"><span class="hs-identifier hs-var">isRuntimeRepVar</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#isRuntimeRepKindedTy"><span class="hs-identifier hs-var">isRuntimeRepKindedTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-106"></a><span>        </span><a href="TyCoRep.html#dropRuntimeRepArgs"><span class="hs-identifier hs-var">dropRuntimeRepArgs</span></a><span class="hs-special">,</span><span>
</span><a name="line-107"></a><span>        </span><a href="Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#getRuntimeRepFromKind"><span class="hs-identifier hs-var">getRuntimeRepFromKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span>        </span><span class="hs-comment">-- * Main data types representing Kinds</span><span>
</span><a name="line-110"></a><span>        </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span>        </span><span class="hs-comment">-- ** Finding the kind of a type</span><span>
</span><a name="line-113"></a><span>        </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span>        </span><span class="hs-comment">-- ** Common Kind</span><span>
</span><a name="line-116"></a><span>        </span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span>        </span><span class="hs-comment">-- * Type free variables</span><span>
</span><a name="line-119"></a><span>        </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#tyCoVarsOfTypeAcc"><span class="hs-identifier hs-var">tyCoVarsOfTypeAcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-120"></a><span>        </span><a href="TyCoRep.html#tyCoVarsOfTypeDSet"><span class="hs-identifier hs-var">tyCoVarsOfTypeDSet</span></a><span class="hs-special">,</span><span>
</span><a name="line-121"></a><span>        </span><a href="TyCoRep.html#coVarsOfType"><span class="hs-identifier hs-var">coVarsOfType</span></a><span class="hs-special">,</span><span>
</span><a name="line-122"></a><span>        </span><a href="TyCoRep.html#coVarsOfTypes"><span class="hs-identifier hs-var">coVarsOfTypes</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#closeOverKinds"><span class="hs-identifier hs-var">closeOverKinds</span></a><span class="hs-special">,</span><span>
</span><a name="line-123"></a><span>        </span><a href="Type.html#splitDepVarsOfType"><span class="hs-identifier hs-var">splitDepVarsOfType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitDepVarsOfTypes"><span class="hs-identifier hs-var">splitDepVarsOfTypes</span></a><span class="hs-special">,</span><span>
</span><a name="line-124"></a><span>        </span><a href="Type.html#splitVisVarsOfType"><span class="hs-identifier hs-var">splitVisVarsOfType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitVisVarsOfTypes"><span class="hs-identifier hs-var">splitVisVarsOfTypes</span></a><span class="hs-special">,</span><span>
</span><a name="line-125"></a><span>        </span><a href="Type.html#expandTypeSynonyms"><span class="hs-identifier hs-var">expandTypeSynonyms</span></a><span class="hs-special">,</span><span>
</span><a name="line-126"></a><span>        </span><a href="Type.html#typeSize"><span class="hs-identifier hs-var">typeSize</span></a><span class="hs-special">,</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span>        </span><span class="hs-comment">-- * Well-scoped lists of variables</span><span>
</span><a name="line-129"></a><span>        </span><a href="Type.html#varSetElemsWellScoped"><span class="hs-identifier hs-var">varSetElemsWellScoped</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#toposortTyVars"><span class="hs-identifier hs-var">toposortTyVars</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#tyCoVarsOfTypeWellScoped"><span class="hs-identifier hs-var">tyCoVarsOfTypeWellScoped</span></a><span class="hs-special">,</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span>        </span><span class="hs-comment">-- * Type comparison</span><span>
</span><a name="line-132"></a><span>        </span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#eqTypeX"><span class="hs-identifier hs-var">eqTypeX</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#eqTypes"><span class="hs-identifier hs-var">eqTypes</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#cmpType"><span class="hs-identifier hs-var">cmpType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#cmpTypes"><span class="hs-identifier hs-var">cmpTypes</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#cmpTypeX"><span class="hs-identifier hs-var">cmpTypeX</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#cmpTypesX"><span class="hs-identifier hs-var">cmpTypesX</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#cmpTc"><span class="hs-identifier hs-var">cmpTc</span></a><span class="hs-special">,</span><span>
</span><a name="line-133"></a><span>        </span><a href="Type.html#eqVarBndrs"><span class="hs-identifier hs-var">eqVarBndrs</span></a><span class="hs-special">,</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span>        </span><span class="hs-comment">-- * Forcing evaluation of types</span><span>
</span><a name="line-136"></a><span>        </span><a href="Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#seqTypes"><span class="hs-identifier hs-var">seqTypes</span></a><span class="hs-special">,</span><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span>        </span><span class="hs-comment">-- * Other views onto Types</span><span>
</span><a name="line-139"></a><span>        </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#coreViewOneStarKind"><span class="hs-identifier hs-var">coreViewOneStarKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span>        </span><a href="Type.html#UnaryType"><span class="hs-identifier hs-type">UnaryType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#RepType"><span class="hs-identifier hs-type">RepType</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Type.html#flattenRepType"><span class="hs-identifier hs-var">flattenRepType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#repType"><span class="hs-identifier hs-var">repType</span></a><span class="hs-special">,</span><span>
</span><a name="line-142"></a><span>        </span><a href="Type.html#tyConsOfType"><span class="hs-identifier hs-var">tyConsOfType</span></a><span class="hs-special">,</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span>        </span><span class="hs-comment">-- * Type representation for the code generator</span><span>
</span><a name="line-145"></a><span>        </span><a href="Type.html#typePrimRep"><span class="hs-identifier hs-var">typePrimRep</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#typeRepArity"><span class="hs-identifier hs-var">typeRepArity</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#kindPrimRep"><span class="hs-identifier hs-var">kindPrimRep</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#tyConPrimRep"><span class="hs-identifier hs-var">tyConPrimRep</span></a><span class="hs-special">,</span><span>
</span><a name="line-146"></a><span>
</span><a name="line-147"></a><span>        </span><span class="hs-comment">-- * Main type substitution data types</span><span>
</span><a name="line-148"></a><span>        </span><a href="TyCoRep.html#TvSubstEnv"><span class="hs-identifier hs-type">TvSubstEnv</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- Representation widely visible</span><span>
</span><a name="line-149"></a><span>        </span><a href="TyCoRep.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- Representation visible to a few friends</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span>        </span><span class="hs-comment">-- ** Manipulating type substitutions</span><span>
</span><a name="line-152"></a><span>        </span><a href="TyCoRep.html#emptyTvSubstEnv"><span class="hs-identifier hs-var">emptyTvSubstEnv</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#emptyTCvSubst"><span class="hs-identifier hs-var">emptyTCvSubst</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkEmptyTCvSubst"><span class="hs-identifier hs-var">mkEmptyTCvSubst</span></a><span class="hs-special">,</span><span>
</span><a name="line-153"></a><span>
</span><a name="line-154"></a><span>        </span><a href="TyCoRep.html#mkTCvSubst"><span class="hs-identifier hs-var">mkTCvSubst</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#zipTvSubst"><span class="hs-identifier hs-var">zipTvSubst</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkTvSubstPrs"><span class="hs-identifier hs-var">mkTvSubstPrs</span></a><span class="hs-special">,</span><span>
</span><a name="line-155"></a><span>        </span><a href="TyCoRep.html#notElemTCvSubst"><span class="hs-identifier hs-var">notElemTCvSubst</span></a><span class="hs-special">,</span><span>
</span><a name="line-156"></a><span>        </span><a href="TyCoRep.html#getTvSubstEnv"><span class="hs-identifier hs-var">getTvSubstEnv</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#setTvSubstEnv"><span class="hs-identifier hs-var">setTvSubstEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-157"></a><span>        </span><a href="TyCoRep.html#zapTCvSubst"><span class="hs-identifier hs-var">zapTCvSubst</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#getTCvInScope"><span class="hs-identifier hs-var">getTCvInScope</span></a><span class="hs-special">,</span><span>
</span><a name="line-158"></a><span>        </span><a href="TyCoRep.html#extendTCvInScope"><span class="hs-identifier hs-var">extendTCvInScope</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#extendTCvInScopeList"><span class="hs-identifier hs-var">extendTCvInScopeList</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#extendTCvInScopeSet"><span class="hs-identifier hs-var">extendTCvInScopeSet</span></a><span class="hs-special">,</span><span>
</span><a name="line-159"></a><span>        </span><a href="TyCoRep.html#extendTCvSubst"><span class="hs-identifier hs-var">extendTCvSubst</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#extendCvSubst"><span class="hs-identifier hs-var">extendCvSubst</span></a><span class="hs-special">,</span><span>
</span><a name="line-160"></a><span>        </span><a href="TyCoRep.html#extendTvSubst"><span class="hs-identifier hs-var">extendTvSubst</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#extendTvSubstList"><span class="hs-identifier hs-var">extendTvSubstList</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#extendTvSubstAndInScope"><span class="hs-identifier hs-var">extendTvSubstAndInScope</span></a><span class="hs-special">,</span><span>
</span><a name="line-161"></a><span>        </span><a href="TyCoRep.html#isInScope"><span class="hs-identifier hs-var">isInScope</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#composeTCvSubstEnv"><span class="hs-identifier hs-var">composeTCvSubstEnv</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#composeTCvSubst"><span class="hs-identifier hs-var">composeTCvSubst</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#zipTyEnv"><span class="hs-identifier hs-var">zipTyEnv</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#zipCoEnv"><span class="hs-identifier hs-var">zipCoEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-162"></a><span>        </span><a href="TyCoRep.html#isEmptyTCvSubst"><span class="hs-identifier hs-var">isEmptyTCvSubst</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#unionTCvSubst"><span class="hs-identifier hs-var">unionTCvSubst</span></a><span class="hs-special">,</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span>        </span><span class="hs-comment">-- ** Performing substitution on types and kinds</span><span>
</span><a name="line-165"></a><span>        </span><a href="TyCoRep.html#substTy"><span class="hs-identifier hs-var">substTy</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substTys"><span class="hs-identifier hs-var">substTys</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substTyWith"><span class="hs-identifier hs-var">substTyWith</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substTysWith"><span class="hs-identifier hs-var">substTysWith</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substTheta"><span class="hs-identifier hs-var">substTheta</span></a><span class="hs-special">,</span><span>
</span><a name="line-166"></a><span>        </span><a href="TyCoRep.html#substTyAddInScope"><span class="hs-identifier hs-var">substTyAddInScope</span></a><span class="hs-special">,</span><span>
</span><a name="line-167"></a><span>        </span><a href="TyCoRep.html#substTyUnchecked"><span class="hs-identifier hs-var">substTyUnchecked</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substTysUnchecked"><span class="hs-identifier hs-var">substTysUnchecked</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substThetaUnchecked"><span class="hs-identifier hs-var">substThetaUnchecked</span></a><span class="hs-special">,</span><span>
</span><a name="line-168"></a><span>        </span><a href="TyCoRep.html#substTyWithBindersUnchecked"><span class="hs-identifier hs-var">substTyWithBindersUnchecked</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substTyWithUnchecked"><span class="hs-identifier hs-var">substTyWithUnchecked</span></a><span class="hs-special">,</span><span>
</span><a name="line-169"></a><span>        </span><a href="TyCoRep.html#substCoUnchecked"><span class="hs-identifier hs-var">substCoUnchecked</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substCoWithUnchecked"><span class="hs-identifier hs-var">substCoWithUnchecked</span></a><span class="hs-special">,</span><span>
</span><a name="line-170"></a><span>        </span><a href="TyCoRep.html#substTyVarBndr"><span class="hs-identifier hs-var">substTyVarBndr</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substTyVar"><span class="hs-identifier hs-var">substTyVar</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substTyVars"><span class="hs-identifier hs-var">substTyVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-171"></a><span>        </span><a href="TyCoRep.html#cloneTyVarBndr"><span class="hs-identifier hs-var">cloneTyVarBndr</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#cloneTyVarBndrs"><span class="hs-identifier hs-var">cloneTyVarBndrs</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#lookupTyVar"><span class="hs-identifier hs-var">lookupTyVar</span></a><span class="hs-special">,</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span>        </span><span class="hs-comment">-- * Pretty-printing</span><span>
</span><a name="line-174"></a><span>        </span><a href="TyCoRep.html#pprType"><span class="hs-identifier hs-var">pprType</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprParendType"><span class="hs-identifier hs-var">pprParendType</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprTypeApp"><span class="hs-identifier hs-var">pprTypeApp</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprTyThingCategory"><span class="hs-identifier hs-var">pprTyThingCategory</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprTyThing"><span class="hs-identifier hs-var">pprTyThing</span></a><span class="hs-special">,</span><span>
</span><a name="line-175"></a><span>        </span><a href="TyCoRep.html#pprTvBndr"><span class="hs-identifier hs-var">pprTvBndr</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprTvBndrs"><span class="hs-identifier hs-var">pprTvBndrs</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprForAll"><span class="hs-identifier hs-var">pprForAll</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprForAllImplicit"><span class="hs-identifier hs-var">pprForAllImplicit</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprUserForAll"><span class="hs-identifier hs-var">pprUserForAll</span></a><span class="hs-special">,</span><span>
</span><a name="line-176"></a><span>        </span><a href="TyCoRep.html#pprSigmaType"><span class="hs-identifier hs-var">pprSigmaType</span></a><span class="hs-special">,</span><span>
</span><a name="line-177"></a><span>        </span><a href="TyCoRep.html#pprTheta"><span class="hs-identifier hs-var">pprTheta</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprThetaArrowTy"><span class="hs-identifier hs-var">pprThetaArrowTy</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprClassPred"><span class="hs-identifier hs-var">pprClassPred</span></a><span class="hs-special">,</span><span>
</span><a name="line-178"></a><span>        </span><a href="TyCoRep.html#pprKind"><span class="hs-identifier hs-var">pprKind</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprParendKind"><span class="hs-identifier hs-var">pprParendKind</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#pprSourceTyCon"><span class="hs-identifier hs-var">pprSourceTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-179"></a><span>        </span><a href="TyCoRep.html#TyPrec"><span class="hs-identifier hs-type">TyPrec</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#maybeParen"><span class="hs-identifier hs-var">maybeParen</span></a><span class="hs-special">,</span><span>
</span><a name="line-180"></a><span>        </span><a href="Type.html#pprTyVar"><span class="hs-identifier hs-var">pprTyVar</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprTcAppTy"><span class="hs-identifier hs-var">pprTcAppTy</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprPrefixApp"><span class="hs-identifier hs-var">pprPrefixApp</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprArrowChain"><span class="hs-identifier hs-var">pprArrowChain</span></a><span class="hs-special">,</span><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span>        </span><span class="hs-comment">-- * Tidying type related things up for printing</span><span>
</span><a name="line-183"></a><span>        </span><a href="TyCoRep.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a><span class="hs-special">,</span><span>      </span><a href="TyCoRep.html#tidyTypes"><span class="hs-identifier hs-var">tidyTypes</span></a><span class="hs-special">,</span><span>
</span><a name="line-184"></a><span>        </span><a href="TyCoRep.html#tidyOpenType"><span class="hs-identifier hs-var">tidyOpenType</span></a><span class="hs-special">,</span><span>  </span><a href="TyCoRep.html#tidyOpenTypes"><span class="hs-identifier hs-var">tidyOpenTypes</span></a><span class="hs-special">,</span><span>
</span><a name="line-185"></a><span>        </span><a href="TyCoRep.html#tidyOpenKind"><span class="hs-identifier hs-var">tidyOpenKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-186"></a><span>        </span><a href="TyCoRep.html#tidyTyCoVarBndr"><span class="hs-identifier hs-var">tidyTyCoVarBndr</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#tidyTyCoVarBndrs"><span class="hs-identifier hs-var">tidyTyCoVarBndrs</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#tidyFreeTyCoVars"><span class="hs-identifier hs-var">tidyFreeTyCoVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-187"></a><span>        </span><a href="TyCoRep.html#tidyOpenTyCoVar"><span class="hs-identifier hs-var">tidyOpenTyCoVar</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#tidyOpenTyCoVars"><span class="hs-identifier hs-var">tidyOpenTyCoVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-188"></a><span>        </span><a href="TyCoRep.html#tidyTyVarOcc"><span class="hs-identifier hs-var">tidyTyVarOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-189"></a><span>        </span><a href="TyCoRep.html#tidyTopType"><span class="hs-identifier hs-var">tidyTopType</span></a><span class="hs-special">,</span><span>
</span><a name="line-190"></a><span>        </span><a href="TyCoRep.html#tidyKind"><span class="hs-identifier hs-var">tidyKind</span></a><span>
</span><a name="line-191"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span class="hs-comment">-- We import the representation and primitive functions from TyCoRep.</span><span>
</span><a name="line-196"></a><span class="hs-comment">-- Many things are reexported, but not the representation!</span><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span class="hs-keyword">import</span><span> </span><a href="Kind.html"><span class="hs-identifier">Kind</span></a><span>
</span><a name="line-199"></a><span class="hs-keyword">import</span><span> </span><a href="TyCoRep.html"><span class="hs-identifier">TyCoRep</span></a><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span class="hs-comment">-- friends:</span><span>
</span><a name="line-202"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>
</span><a name="line-203"></a><span class="hs-keyword">import</span><span> </span><a href="VarEnv.html"><span class="hs-identifier">VarEnv</span></a><span>
</span><a name="line-204"></a><span class="hs-keyword">import</span><span> </span><a href="VarSet.html"><span class="hs-identifier">VarSet</span></a><span>
</span><a name="line-205"></a><span class="hs-keyword">import</span><span> </span><a href="NameEnv.html"><span class="hs-identifier">NameEnv</span></a><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-keyword">import</span><span> </span><a href="Class.html"><span class="hs-identifier">Class</span></a><span>
</span><a name="line-208"></a><span class="hs-keyword">import</span><span> </span><a href="TyCon.html"><span class="hs-identifier">TyCon</span></a><span>
</span><a name="line-209"></a><span class="hs-keyword">import</span><span> </span><a href="TysPrim.html"><span class="hs-identifier">TysPrim</span></a><span>
</span><a name="line-210"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE #-}</span><span> </span><a href="TysWiredIn.html"><span class="hs-identifier">TysWiredIn</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="TysWiredIn.html#listTyCon"><span class="hs-identifier hs-var">listTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#typeNatKind"><span class="hs-identifier hs-var">typeNatKind</span></a><span>
</span><a name="line-211"></a><span>                                 </span><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#typeSymbolKind"><span class="hs-identifier hs-var">typeSymbolKind</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-212"></a><span class="hs-keyword">import</span><span> </span><a href="PrelNames.html"><span class="hs-identifier">PrelNames</span></a><span>
</span><a name="line-213"></a><span class="hs-keyword">import</span><span> </span><a href="CoAxiom.html"><span class="hs-identifier">CoAxiom</span></a><span>
</span><a name="line-214"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE #-}</span><span> </span><a href="Coercion.html"><span class="hs-identifier">Coercion</span></a><span>
</span><a name="line-215"></a><span>
</span><a name="line-216"></a><span class="hs-comment">-- others</span><span>
</span><a name="line-217"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#RepArity"><span class="hs-identifier hs-type">RepArity</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-219"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-220"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-221"></a><span class="hs-keyword">import</span><span> </span><a href="Pair.html"><span class="hs-identifier">Pair</span></a><span>
</span><a name="line-222"></a><span class="hs-keyword">import</span><span> </span><a href="ListSetOps.html"><span class="hs-identifier">ListSetOps</span></a><span>
</span><a name="line-223"></a><span class="hs-keyword">import</span><span> </span><a href="Digraph.html"><span class="hs-identifier">Digraph</span></a><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span class="hs-keyword">import</span><span> </span><a href="Maybes.html"><span class="hs-identifier">Maybes</span></a><span>           </span><span class="hs-special">(</span><span> </span><a href="Maybes.html#orElse"><span class="hs-identifier hs-var">orElse</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-226"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-227"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span></a><span>    </span><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#guard"><span class="hs-identifier hs-var">guard</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-228"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Arrow</span></a><span>    </span><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#first"><span class="hs-identifier hs-var">first</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-comment">-- $type_classification</span><span>
</span><a name="line-231"></a><span class="hs-comment">-- #type_classification#</span><span>
</span><a name="line-232"></a><span class="hs-comment">--</span><span>
</span><a name="line-233"></a><span class="hs-comment">-- Types are one of:</span><span>
</span><a name="line-234"></a><span class="hs-comment">--</span><span>
</span><a name="line-235"></a><span class="hs-comment">-- [Unboxed]            Iff its representation is other than a pointer</span><span>
</span><a name="line-236"></a><span class="hs-comment">--                      Unboxed types are also unlifted.</span><span>
</span><a name="line-237"></a><span class="hs-comment">--</span><span>
</span><a name="line-238"></a><span class="hs-comment">-- [Lifted]             Iff it has bottom as an element.</span><span>
</span><a name="line-239"></a><span class="hs-comment">--                      Closures always have lifted types: i.e. any</span><span>
</span><a name="line-240"></a><span class="hs-comment">--                      let-bound identifier in Core must have a lifted</span><span>
</span><a name="line-241"></a><span class="hs-comment">--                      type. Operationally, a lifted object is one that</span><span>
</span><a name="line-242"></a><span class="hs-comment">--                      can be entered.</span><span>
</span><a name="line-243"></a><span class="hs-comment">--                      Only lifted types may be unified with a type variable.</span><span>
</span><a name="line-244"></a><span class="hs-comment">--</span><span>
</span><a name="line-245"></a><span class="hs-comment">-- [Algebraic]          Iff it is a type with one or more constructors, whether</span><span>
</span><a name="line-246"></a><span class="hs-comment">--                      declared with @data@ or @newtype@.</span><span>
</span><a name="line-247"></a><span class="hs-comment">--                      An algebraic type is one that can be deconstructed</span><span>
</span><a name="line-248"></a><span class="hs-comment">--                      with a case expression. This is /not/ the same as</span><span>
</span><a name="line-249"></a><span class="hs-comment">--                      lifted types, because we also include unboxed</span><span>
</span><a name="line-250"></a><span class="hs-comment">--                      tuples in this classification.</span><span>
</span><a name="line-251"></a><span class="hs-comment">--</span><span>
</span><a name="line-252"></a><span class="hs-comment">-- [Data]               Iff it is a type declared with @data@, or a boxed tuple.</span><span>
</span><a name="line-253"></a><span class="hs-comment">--</span><span>
</span><a name="line-254"></a><span class="hs-comment">-- [Primitive]          Iff it is a built-in type that can't be expressed in Haskell.</span><span>
</span><a name="line-255"></a><span class="hs-comment">--</span><span>
</span><a name="line-256"></a><span class="hs-comment">-- Currently, all primitive types are unlifted, but that's not necessarily</span><span>
</span><a name="line-257"></a><span class="hs-comment">-- the case: for example, @Int@ could be primitive.</span><span>
</span><a name="line-258"></a><span class="hs-comment">--</span><span>
</span><a name="line-259"></a><span class="hs-comment">-- Some primitive types are unboxed, such as @Int#@, whereas some are boxed</span><span>
</span><a name="line-260"></a><span class="hs-comment">-- but unlifted (such as @ByteArray#@).  The only primitive types that we</span><span>
</span><a name="line-261"></a><span class="hs-comment">-- classify as algebraic are the unboxed tuples.</span><span>
</span><a name="line-262"></a><span class="hs-comment">--</span><span>
</span><a name="line-263"></a><span class="hs-comment">-- Some examples of type classifications that may make this a bit clearer are:</span><span>
</span><a name="line-264"></a><span class="hs-comment">--</span><span>
</span><a name="line-265"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-266"></a><span class="hs-comment">-- Type         primitive       boxed           lifted          algebraic</span><span>
</span><a name="line-267"></a><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><a name="line-268"></a><span class="hs-comment">-- Int#         Yes             No              No              No</span><span>
</span><a name="line-269"></a><span class="hs-comment">-- ByteArray#   Yes             Yes             No              No</span><span>
</span><a name="line-270"></a><span class="hs-comment">-- (\# a, b \#)   Yes             No              No              Yes</span><span>
</span><a name="line-271"></a><span class="hs-comment">-- (  a, b  )   No              Yes             Yes             Yes</span><span>
</span><a name="line-272"></a><span class="hs-comment">-- [a]          No              Yes             Yes             Yes</span><span>
</span><a name="line-273"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span class="hs-comment">-- $representation_types</span><span>
</span><a name="line-276"></a><span class="hs-comment">-- A /source type/ is a type that is a separate type as far as the type checker is</span><span>
</span><a name="line-277"></a><span class="hs-comment">-- concerned, but which has a more low-level representation as far as Core-to-Core</span><span>
</span><a name="line-278"></a><span class="hs-comment">-- passes and the rest of the back end is concerned.</span><span>
</span><a name="line-279"></a><span class="hs-comment">--</span><span>
</span><a name="line-280"></a><span class="hs-comment">-- You don't normally have to worry about this, as the utility functions in</span><span>
</span><a name="line-281"></a><span class="hs-comment">-- this module will automatically convert a source into a representation type</span><span>
</span><a name="line-282"></a><span class="hs-comment">-- if they are spotted, to the best of it's abilities. If you don't want this</span><span>
</span><a name="line-283"></a><span class="hs-comment">-- to happen, use the equivalent functions from the &quot;TcType&quot; module.</span><span>
</span><a name="line-284"></a><span>
</span><a name="line-285"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Type representation
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-292"></a><span>
</span><a name="line-293"></a><span class="hs-pragma">{-# INLINE coreView #-}</span><span>
</span><a name="line-294"></a><span class="hs-identifier">coreView</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-295"></a><span class="hs-comment">-- ^ This function Strips off the /top layer only/ of a type synonym</span><span>
</span><a name="line-296"></a><span class="hs-comment">-- application (if any) its underlying representation type.</span><span>
</span><a name="line-297"></a><span class="hs-comment">-- Returns Nothing if there is nothing to look through.</span><span>
</span><a name="line-298"></a><span class="hs-comment">--</span><span>
</span><a name="line-299"></a><span class="hs-comment">-- By being non-recursive and inlined, this case analysis gets efficiently</span><span>
</span><a name="line-300"></a><span class="hs-comment">-- joined onto the case analysis that the caller is already doing</span><span>
</span><a name="line-301"></a><a name="coreView"><a href="Type.html#coreView"><span class="hs-identifier">coreView</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627612372"><a href="#local-1627612372"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627612373"><a href="#local-1627612373"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627612374"><a href="#local-1627612374"><span class="hs-identifier">tenv</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612375"><a href="#local-1627612375"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612376"><a href="#local-1627612376"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#expandSynTyCon_maybe"><span class="hs-identifier hs-var">expandSynTyCon_maybe</span></a><span> </span><a href="#local-1627612372"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-1627612373"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-302"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTy"><span class="hs-identifier hs-var">substTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTvSubstPrs"><span class="hs-identifier hs-var">mkTvSubstPrs</span></a><span> </span><a href="#local-1627612374"><span class="hs-identifier hs-var">tenv</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612375"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612376"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">)</span><span>
</span><a name="line-303"></a><span>               </span><span class="hs-comment">-- The free vars of 'rhs' should all be bound by 'tenv', so it's</span><span>
</span><a name="line-304"></a><span>               </span><span class="hs-comment">-- ok to use 'substTy' here.</span><span>
</span><a name="line-305"></a><span>               </span><span class="hs-comment">-- See also Note [The substitution invariant] in TyCoRep.</span><span>
</span><a name="line-306"></a><span>               </span><span class="hs-comment">-- Its important to use mkAppTys, rather than (foldl AppTy),</span><span>
</span><a name="line-307"></a><span>               </span><span class="hs-comment">-- because the function part might well return a</span><span>
</span><a name="line-308"></a><span>               </span><span class="hs-comment">-- partially-applied type constructor; indeed, usually will!</span><span>
</span><a name="line-309"></a><span class="hs-identifier">coreView</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-310"></a><span>
</span><a name="line-311"></a><span class="hs-comment">-- | Like 'coreView', but it also &quot;expands&quot; @Constraint@ to become</span><span>
</span><a name="line-312"></a><span class="hs-comment">-- @TYPE PtrRepLifted@.</span><span>
</span><a name="line-313"></a><span class="hs-pragma">{-# INLINE coreViewOneStarKind #-}</span><span>
</span><a name="line-314"></a><span class="hs-identifier">coreViewOneStarKind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-315"></a><a name="coreViewOneStarKind"><a href="Type.html#coreViewOneStarKind"><span class="hs-identifier">coreViewOneStarKind</span></a></a><span> </span><a name="local-1627612377"><a href="#local-1627612377"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-316"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612378"><a href="#local-1627612378"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612377"><span class="hs-identifier hs-var">ty</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627612378"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-317"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627612379"><a href="#local-1627612379"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627612377"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-318"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Kind.html#isStarKindSynonymTyCon"><span class="hs-identifier hs-var">isStarKindSynonymTyCon</span></a><span> </span><a href="#local-1627612379"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span>
</span><a name="line-319"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span class="hs-comment">-----------------------------------------------</span><span>
</span><a name="line-322"></a><span class="hs-identifier">expandTypeSynonyms</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-323"></a><span class="hs-comment">-- ^ Expand out all type synonyms.  Actually, it'd suffice to expand out</span><span>
</span><a name="line-324"></a><span class="hs-comment">-- just the ones that discard type variables (e.g.  type Funny a = Int)</span><span>
</span><a name="line-325"></a><span class="hs-comment">-- But we don't know which those are currently, so we just expand all.</span><span>
</span><a name="line-326"></a><span class="hs-comment">--</span><span>
</span><a name="line-327"></a><span class="hs-comment">-- 'expandTypeSynonyms' only expands out type synonyms mentioned in the type,</span><span>
</span><a name="line-328"></a><span class="hs-comment">-- not in the kinds of any TyCon or TyVar mentioned in the type.</span><span>
</span><a name="line-329"></a><a name="expandTypeSynonyms"><a href="Type.html#expandTypeSynonyms"><span class="hs-identifier">expandTypeSynonyms</span></a></a><span> </span><a name="local-1627612380"><a href="#local-1627612380"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-330"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612381"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkEmptyTCvSubst"><span class="hs-identifier hs-var">mkEmptyTCvSubst</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyCoInScopeSet"><span class="hs-identifier hs-var">mkTyCoInScopeSet</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627612380"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1627612380"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-331"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-332"></a><span>    </span><a name="local-1627612381"><a href="#local-1627612381"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-1627612385"><a href="#local-1627612385"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627612386"><a href="#local-1627612386"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627612387"><a href="#local-1627612387"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-333"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627612388"><a href="#local-1627612388"><span class="hs-identifier">tenv</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612389"><a href="#local-1627612389"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612390"><a href="#local-1627612390"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#expandSynTyCon_maybe"><span class="hs-identifier hs-var">expandSynTyCon_maybe</span></a><span> </span><a href="#local-1627612386"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-1627612387"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-334"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1627612391"><a href="#local-1627612391"><span class="hs-identifier">subst'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#unionTCvSubst"><span class="hs-identifier hs-var">unionTCvSubst</span></a><span> </span><a href="#local-1627612385"><span class="hs-identifier hs-var">subst</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTvSubstPrs"><span class="hs-identifier hs-var">mkTvSubstPrs</span></a><span> </span><a href="#local-1627612388"><span class="hs-identifier hs-var">tenv</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-335"></a><span>        </span><a href="#local-1627612381"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612391"><span class="hs-identifier hs-var">subst'</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a><span> </span><a href="#local-1627612389"><span class="hs-identifier hs-var">rhs</span></a><span> </span><a href="#local-1627612390"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">)</span><span>
</span><a name="line-336"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-337"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="#local-1627612386"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612381"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612385"><span class="hs-identifier hs-var">subst</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612387"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-338"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><a name="local-1627612392"><a href="#local-1627612392"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><a href="#local-1627612392"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-339"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627612393"><a href="#local-1627612393"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-1627612394"><a href="#local-1627612394"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substTyVar"><span class="hs-identifier hs-var">substTyVar</span></a><span> </span><a href="#local-1627612393"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612394"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-340"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627612395"><a href="#local-1627612395"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1627612396"><a href="#local-1627612396"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627612397"><a href="#local-1627612397"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612381"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612395"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612396"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627612381"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612395"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612397"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-341"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627612398"><a href="#local-1627612398"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627612399"><a href="#local-1627612399"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612400"><a href="#local-1627612400"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-342"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612381"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612398"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612399"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627612381"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612398"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612400"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span>
</span><a name="line-343"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627612401"><a href="#local-1627612401"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1627612402"><a href="#local-1627612402"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-1627612403"><a href="#local-1627612403"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612404"><a href="#local-1627612404"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-344"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1627612405"><a href="#local-1627612405"><span class="hs-identifier">subst'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612406"><a href="#local-1627612406"><span class="hs-identifier">tv'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substTyVarBndrCallback"><span class="hs-identifier hs-var">substTyVarBndrCallback</span></a><span> </span><a href="#local-1627612381"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612401"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612402"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-345"></a><span>        </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a href="#local-1627612406"><span class="hs-identifier hs-var">tv'</span></a><span> </span><a href="#local-1627612403"><span class="hs-identifier hs-var">vis</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627612381"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612405"><span class="hs-identifier hs-var">subst'</span></a><span> </span><a href="#local-1627612404"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-346"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627612407"><a href="#local-1627612407"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-1627612408"><a href="#local-1627612408"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612409"><a href="#local-1627612409"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612381"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612407"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612408"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612407"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612409"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-347"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627612410"><a href="#local-1627612410"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-1627612411"><a href="#local-1627612411"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkCoercionTy"><span class="hs-identifier hs-var">mkCoercionTy</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612410"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612411"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-348"></a><span>
</span><a name="line-349"></a><span>    </span><a name="local-1627612382"><a href="#local-1627612382"><span class="hs-identifier">go_co</span></a></a><span> </span><a name="local-1627612412"><a href="#local-1627612412"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Refl"><span class="hs-identifier hs-var">Refl</span></a><span> </span><a name="local-1627612413"><a href="#local-1627612413"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-1627612414"><a href="#local-1627612414"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-350"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkReflCo"><span class="hs-identifier hs-var">mkReflCo</span></a><span> </span><a href="#local-1627612413"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612381"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612412"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612414"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-351"></a><span>       </span><span class="hs-comment">-- NB: coercions are always expanded upon creation</span><span>
</span><a name="line-352"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-1627612415"><a href="#local-1627612415"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConAppCo"><span class="hs-identifier hs-var">TyConAppCo</span></a><span> </span><a name="local-1627612416"><a href="#local-1627612416"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-1627612417"><a href="#local-1627612417"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627612418"><a href="#local-1627612418"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-353"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkTyConAppCo"><span class="hs-identifier hs-var">mkTyConAppCo</span></a><span> </span><a href="#local-1627612416"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-1627612417"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612415"><span class="hs-identifier hs-var">subst</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612418"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-354"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-1627612419"><a href="#local-1627612419"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppCo"><span class="hs-identifier hs-var">AppCo</span></a><span> </span><a name="local-1627612420"><a href="#local-1627612420"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-1627612421"><a href="#local-1627612421"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-355"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkAppCo"><span class="hs-identifier hs-var">mkAppCo</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612419"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612420"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612419"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612421"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span>
</span><a name="line-356"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-1627612422"><a href="#local-1627612422"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllCo"><span class="hs-identifier hs-var">ForAllCo</span></a><span> </span><a name="local-1627612423"><a href="#local-1627612423"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-1627612424"><a href="#local-1627612424"><span class="hs-identifier">kind_co</span></a></a><span> </span><a name="local-1627612425"><a href="#local-1627612425"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-357"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1627612426"><a href="#local-1627612426"><span class="hs-identifier">subst'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612427"><a href="#local-1627612427"><span class="hs-identifier">tv'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612428"><a href="#local-1627612428"><span class="hs-identifier">kind_co'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612384"><span class="hs-identifier hs-var">go_cobndr</span></a><span> </span><a href="#local-1627612422"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612423"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-1627612424"><span class="hs-identifier hs-var">kind_co</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-358"></a><span>        </span><a href="Coercion.html#mkForAllCo"><span class="hs-identifier hs-var">mkForAllCo</span></a><span> </span><a href="#local-1627612427"><span class="hs-identifier hs-var">tv'</span></a><span> </span><a href="#local-1627612428"><span class="hs-identifier hs-var">kind_co'</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612426"><span class="hs-identifier hs-var">subst'</span></a><span> </span><a href="#local-1627612425"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-359"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-1627612429"><a href="#local-1627612429"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoVarCo"><span class="hs-identifier hs-var">CoVarCo</span></a><span> </span><a name="local-1627612430"><a href="#local-1627612430"><span class="hs-identifier">cv</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-360"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substCoVar"><span class="hs-identifier hs-var">substCoVar</span></a><span> </span><a href="#local-1627612429"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612430"><span class="hs-identifier hs-var">cv</span></a><span>
</span><a name="line-361"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-1627612431"><a href="#local-1627612431"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AxiomInstCo"><span class="hs-identifier hs-var">AxiomInstCo</span></a><span> </span><a name="local-1627612432"><a href="#local-1627612432"><span class="hs-identifier">ax</span></a></a><span> </span><a name="local-1627612433"><a href="#local-1627612433"><span class="hs-identifier">ind</span></a></a><span> </span><a name="local-1627612434"><a href="#local-1627612434"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-362"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkAxiomInstCo"><span class="hs-identifier hs-var">mkAxiomInstCo</span></a><span> </span><a href="#local-1627612432"><span class="hs-identifier hs-var">ax</span></a><span> </span><a href="#local-1627612433"><span class="hs-identifier hs-var">ind</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612431"><span class="hs-identifier hs-var">subst</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612434"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-363"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-1627612435"><a href="#local-1627612435"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#UnivCo"><span class="hs-identifier hs-var">UnivCo</span></a><span> </span><a name="local-1627612436"><a href="#local-1627612436"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-1627612437"><a href="#local-1627612437"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-1627612438"><a href="#local-1627612438"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627612439"><a href="#local-1627612439"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-364"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkUnivCo"><span class="hs-identifier hs-var">mkUnivCo</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612383"><span class="hs-identifier hs-var">go_prov</span></a><span> </span><a href="#local-1627612435"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612436"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612437"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612381"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612435"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612438"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627612381"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612435"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612439"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-365"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-1627612440"><a href="#local-1627612440"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#SymCo"><span class="hs-identifier hs-var">SymCo</span></a><span> </span><a name="local-1627612441"><a href="#local-1627612441"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-366"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkSymCo"><span class="hs-identifier hs-var">mkSymCo</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612440"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612441"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-367"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-1627612442"><a href="#local-1627612442"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TransCo"><span class="hs-identifier hs-var">TransCo</span></a><span> </span><a name="local-1627612443"><a href="#local-1627612443"><span class="hs-identifier">co1</span></a></a><span> </span><a name="local-1627612444"><a href="#local-1627612444"><span class="hs-identifier">co2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-368"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkTransCo"><span class="hs-identifier hs-var">mkTransCo</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612442"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612443"><span class="hs-identifier hs-var">co1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612442"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612444"><span class="hs-identifier hs-var">co2</span></a><span class="hs-special">)</span><span>
</span><a name="line-369"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-1627612445"><a href="#local-1627612445"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#NthCo"><span class="hs-identifier hs-var">NthCo</span></a><span> </span><a name="local-1627612446"><a href="#local-1627612446"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627612447"><a href="#local-1627612447"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-370"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkNthCo"><span class="hs-identifier hs-var">mkNthCo</span></a><span> </span><a href="#local-1627612446"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612445"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612447"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-371"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-1627612448"><a href="#local-1627612448"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LRCo"><span class="hs-identifier hs-var">LRCo</span></a><span> </span><a name="local-1627612449"><a href="#local-1627612449"><span class="hs-identifier">lr</span></a></a><span> </span><a name="local-1627612450"><a href="#local-1627612450"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-372"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkLRCo"><span class="hs-identifier hs-var">mkLRCo</span></a><span> </span><a href="#local-1627612449"><span class="hs-identifier hs-var">lr</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612448"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612450"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-373"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-1627612451"><a href="#local-1627612451"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#InstCo"><span class="hs-identifier hs-var">InstCo</span></a><span> </span><a name="local-1627612452"><a href="#local-1627612452"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-1627612453"><a href="#local-1627612453"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-374"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkInstCo"><span class="hs-identifier hs-var">mkInstCo</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612451"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612452"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612451"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612453"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span>
</span><a name="line-375"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-1627612454"><a href="#local-1627612454"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoherenceCo"><span class="hs-identifier hs-var">CoherenceCo</span></a><span> </span><a name="local-1627612455"><a href="#local-1627612455"><span class="hs-identifier">co1</span></a></a><span> </span><a name="local-1627612456"><a href="#local-1627612456"><span class="hs-identifier">co2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-376"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkCoherenceCo"><span class="hs-identifier hs-var">mkCoherenceCo</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612454"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612455"><span class="hs-identifier hs-var">co1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612454"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612456"><span class="hs-identifier hs-var">co2</span></a><span class="hs-special">)</span><span>
</span><a name="line-377"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-1627612457"><a href="#local-1627612457"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#KindCo"><span class="hs-identifier hs-var">KindCo</span></a><span> </span><a name="local-1627612458"><a href="#local-1627612458"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-378"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkKindCo"><span class="hs-identifier hs-var">mkKindCo</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612457"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612458"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-379"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-1627612459"><a href="#local-1627612459"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#SubCo"><span class="hs-identifier hs-var">SubCo</span></a><span> </span><a name="local-1627612460"><a href="#local-1627612460"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-380"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkSubCo"><span class="hs-identifier hs-var">mkSubCo</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612459"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612460"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-381"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-1627612461"><a href="#local-1627612461"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AxiomRuleCo"><span class="hs-identifier hs-var">AxiomRuleCo</span></a><span> </span><a name="local-1627612462"><a href="#local-1627612462"><span class="hs-identifier">ax</span></a></a><span> </span><a name="local-1627612463"><a href="#local-1627612463"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#AxiomRuleCo"><span class="hs-identifier hs-var">AxiomRuleCo</span></a><span> </span><a href="#local-1627612462"><span class="hs-identifier hs-var">ax</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612461"><span class="hs-identifier hs-var">subst</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612463"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-382"></a><span>
</span><a name="line-383"></a><span>    </span><a name="local-1627612383"><a href="#local-1627612383"><span class="hs-identifier">go_prov</span></a></a><span> </span><span class="hs-identifier">_</span><span>     </span><a href="TyCoRep.html#UnsafeCoerceProv"><span class="hs-identifier hs-var">UnsafeCoerceProv</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#UnsafeCoerceProv"><span class="hs-identifier hs-var">UnsafeCoerceProv</span></a><span>
</span><a name="line-384"></a><span>    </span><span class="hs-identifier">go_prov</span><span> </span><a name="local-1627612464"><a href="#local-1627612464"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#PhantomProv"><span class="hs-identifier hs-var">PhantomProv</span></a><span> </span><a name="local-1627612465"><a href="#local-1627612465"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#PhantomProv"><span class="hs-identifier hs-var">PhantomProv</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612464"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612465"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-385"></a><span>    </span><span class="hs-identifier">go_prov</span><span> </span><a name="local-1627612466"><a href="#local-1627612466"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ProofIrrelProv"><span class="hs-identifier hs-var">ProofIrrelProv</span></a><span> </span><a name="local-1627612467"><a href="#local-1627612467"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#ProofIrrelProv"><span class="hs-identifier hs-var">ProofIrrelProv</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612466"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612467"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-386"></a><span>    </span><span class="hs-identifier">go_prov</span><span> </span><span class="hs-identifier">_</span><span>     </span><a name="local-1627612468"><a href="#local-1627612468"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#PluginProv"><span class="hs-identifier hs-var">PluginProv</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612468"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-387"></a><span>    </span><span class="hs-identifier">go_prov</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-special">(</span><a href="TyCoRep.html#HoleProv"><span class="hs-identifier hs-var">HoleProv</span></a><span> </span><a name="local-1627612469"><a href="#local-1627612469"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;expandTypeSynonyms hit a hole&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612469"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span>
</span><a name="line-388"></a><span>
</span><a name="line-389"></a><span>      </span><span class="hs-comment">-- the &quot;False&quot; and &quot;const&quot; are to accommodate the type of</span><span>
</span><a name="line-390"></a><span>      </span><span class="hs-comment">-- substForAllCoBndrCallback, which is general enough to</span><span>
</span><a name="line-391"></a><span>      </span><span class="hs-comment">-- handle coercion optimization (which sometimes swaps the</span><span>
</span><a name="line-392"></a><span>      </span><span class="hs-comment">-- order of a coercion)</span><span>
</span><a name="line-393"></a><span>    </span><a name="local-1627612384"><a href="#local-1627612384"><span class="hs-identifier">go_cobndr</span></a></a><span> </span><a name="local-1627612470"><a href="#local-1627612470"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substForAllCoBndrCallback"><span class="hs-identifier hs-var">substForAllCoBndrCallback</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">(</span><a href="#local-1627612382"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627612470"><span class="hs-identifier hs-var">subst</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612470"><span class="hs-identifier hs-var">subst</span></a><span>
</span><a name="line-394"></a><span>
</span><a name="line-395"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
   Analyzing types
*                                                                      *
************************************************************************

These functions do a map-like operation over types, performing some operation
on all variables and binding sites. Primarily used for zonking.

Note [Efficiency for mapCoercion ForAllCo case]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
As noted in Note [Forall coercions] in TyCoRep, a ForAllCo is a bit redundant.
It stores a TyVar and a Coercion, where the kind of the TyVar always matches
the left-hand kind of the coercion. This is convenient lots of the time, but
not when mapping a function over a coercion.

The problem is that tcm_tybinder will affect the TyVar's kind and
mapCoercion will affect the Coercion, and we hope that the results will be
the same. Even if they are the same (which should generally happen with
correct algorithms), then there is an efficiency issue. In particular,
this problem seems to make what should be a linear algorithm into a potentially
exponential one. But it's only going to be bad in the case where there's
lots of foralls in the kinds of other foralls. Like this:

  forall a : (forall b : (forall c : ...). ...). ...

This construction seems unlikely. So we'll do the inefficient, easy way
for now.

Note [Specialising mappers]
~~~~~~~~~~~~~~~~~~~~~~~~~~~
These INLINABLE pragmas are indispensable. mapType/mapCoercion are used
to implement zonking, and it's vital that they get specialised to the TcM
monad. This specialisation happens automatically (that is, without a
SPECIALISE pragma) as long as the definitions are INLINABLE. For example,
this one change made a 20% allocation difference in perf/compiler/T5030.

-}</span><span>
</span><a name="line-434"></a><span>
</span><a name="line-435"></a><span class="hs-comment">-- | This describes how a &quot;map&quot; operation over a type/coercion should behave</span><span>
</span><a name="line-436"></a><span class="hs-keyword">data</span><span> </span><a name="TyCoMapper"><a href="Type.html#TyCoMapper"><span class="hs-identifier">TyCoMapper</span></a></a><span> </span><a name="local-1627612363"><a href="#local-1627612363"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1627612364"><a href="#local-1627612364"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-437"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="TyCoMapper"><a href="Type.html#TyCoMapper"><span class="hs-identifier">TyCoMapper</span></a></a><span>
</span><a name="line-438"></a><span>      </span><span class="hs-special">{</span><span> </span><a href="Type.html#tcm_smart"><span class="hs-identifier">tcm_smart</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-comment">-- ^ Should the new type be created with smart</span><span>
</span><a name="line-439"></a><span>                         </span><span class="hs-comment">-- constructors?</span><span>
</span><a name="line-440"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Type.html#tcm_tyvar"><span class="hs-identifier">tcm_tyvar</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-1627612363"><span class="hs-identifier hs-type">env</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612364"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-441"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Type.html#tcm_covar"><span class="hs-identifier">tcm_covar</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-1627612363"><span class="hs-identifier hs-type">env</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612364"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-442"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Type.html#tcm_hole"><span class="hs-identifier">tcm_hole</span></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="#local-1627612363"><span class="hs-identifier hs-type">env</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#CoercionHole"><span class="hs-identifier hs-type">CoercionHole</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span>
</span><a name="line-443"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612364"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-444"></a><span>          </span><span class="hs-comment">-- ^ What to do with coercion holes. See Note [Coercion holes] in</span><span>
</span><a name="line-445"></a><span>          </span><span class="hs-comment">-- TyCoRep.</span><span>
</span><a name="line-446"></a><span>
</span><a name="line-447"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Type.html#tcm_tybinder"><span class="hs-identifier">tcm_tybinder</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-1627612363"><span class="hs-identifier hs-type">env</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#VisibilityFlag"><span class="hs-identifier hs-type">VisibilityFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612364"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612363"><span class="hs-identifier hs-type">env</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-448"></a><span>          </span><span class="hs-comment">-- ^ The returned env is used in the extended scope</span><span>
</span><a name="line-449"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-450"></a><span>
</span><a name="line-451"></a><span class="hs-pragma">{-# INLINABLE mapType #-}</span><span>  </span><span class="hs-comment">-- See Note [Specialising mappers]</span><span>
</span><a name="line-452"></a><span class="hs-identifier">mapType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-1627612370"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Type.html#TyCoMapper"><span class="hs-identifier hs-type">TyCoMapper</span></a><span> </span><a href="#local-1627612371"><span class="hs-identifier hs-type">env</span></a><span> </span><a href="#local-1627612370"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612371"><span class="hs-identifier hs-type">env</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612370"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-453"></a><a name="mapType"><a href="Type.html#mapType"><span class="hs-identifier">mapType</span></a></a><span> </span><a name="local-1627612471"><a href="#local-1627612471"><span class="hs-identifier">mapper</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Type.html#TyCoMapper"><span class="hs-identifier hs-var">TyCoMapper</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcm_smart</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627612472"><a href="#local-1627612472"><span class="hs-identifier">smart</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcm_tyvar</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627612473"><a href="#local-1627612473"><span class="hs-identifier">tyvar</span></a></a><span>
</span><a name="line-454"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcm_tybinder</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627612474"><a href="#local-1627612474"><span class="hs-identifier">tybinder</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-455"></a><span>        </span><a name="local-1627612475"><a href="#local-1627612475"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1627612476"><a href="#local-1627612476"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-456"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612477"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612476"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-457"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-458"></a><span>    </span><a name="local-1627612477"><a href="#local-1627612477"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-1627612482"><a href="#local-1627612482"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612473"><span class="hs-identifier hs-var">tyvar</span></a><span> </span><a href="#local-1627612475"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627612482"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-459"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1627612483"><a href="#local-1627612483"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627612484"><a href="#local-1627612484"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612479"><span class="hs-identifier hs-var">mkappty</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1627612477"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612483"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="#local-1627612477"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612484"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-460"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627612485"><a href="#local-1627612485"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627612486"><a href="#local-1627612486"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612478"><span class="hs-identifier hs-var">mktyconapp</span></a><span> </span><a href="#local-1627612485"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-1627612477"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612486"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-461"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627612487"><a href="#local-1627612487"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612488"><a href="#local-1627612488"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612481"><span class="hs-identifier hs-var">mkfunty</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1627612477"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612487"><span class="hs-identifier hs-var">arg</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="#local-1627612477"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612488"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-462"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1627612489"><a href="#local-1627612489"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-1627612490"><a href="#local-1627612490"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612491"><a href="#local-1627612491"><span class="hs-identifier">inner</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-463"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1627612492"><a href="#local-1627612492"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612493"><a href="#local-1627612493"><span class="hs-identifier">tv'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627612474"><span class="hs-identifier hs-var">tybinder</span></a><span> </span><a href="#local-1627612475"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627612489"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-1627612490"><span class="hs-identifier hs-var">vis</span></a><span>
</span><a name="line-464"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-1627612494"><a href="#local-1627612494"><span class="hs-identifier">inner'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#mapType"><span class="hs-identifier hs-var">mapType</span></a><span> </span><a href="#local-1627612471"><span class="hs-identifier hs-var">mapper</span></a><span> </span><a href="#local-1627612492"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-1627612491"><span class="hs-identifier hs-var">inner</span></a><span>
</span><a name="line-465"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a href="#local-1627612493"><span class="hs-identifier hs-var">tv'</span></a><span> </span><a href="#local-1627612490"><span class="hs-identifier hs-var">vis</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612494"><span class="hs-identifier hs-var">inner'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-466"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627612495"><a href="#local-1627612495"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1627612495"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-467"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-1627612496"><a href="#local-1627612496"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612497"><a href="#local-1627612497"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612480"><span class="hs-identifier hs-var">mkcastty</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1627612477"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612496"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="Type.html#mapCoercion"><span class="hs-identifier hs-var">mapCoercion</span></a><span> </span><a href="#local-1627612471"><span class="hs-identifier hs-var">mapper</span></a><span> </span><a href="#local-1627612475"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627612497"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-468"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-1627612498"><a href="#local-1627612498"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Type.html#mapCoercion"><span class="hs-identifier hs-var">mapCoercion</span></a><span> </span><a href="#local-1627612471"><span class="hs-identifier hs-var">mapper</span></a><span> </span><a href="#local-1627612475"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627612498"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-469"></a><span>
</span><a name="line-470"></a><span>    </span><span class="hs-special">(</span><a name="local-1627612478"><a href="#local-1627612478"><span class="hs-identifier">mktyconapp</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612479"><a href="#local-1627612479"><span class="hs-identifier">mkappty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612480"><a href="#local-1627612480"><span class="hs-identifier">mkcastty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612481"><a href="#local-1627612481"><span class="hs-identifier">mkfunty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-471"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627612472"><span class="hs-identifier hs-var">smart</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a><span class="hs-special">)</span><span>
</span><a name="line-472"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span class="hs-special">,</span><span>   </span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span class="hs-special">,</span><span>   </span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span class="hs-special">,</span><span>   </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span class="hs-special">)</span><span>
</span><a name="line-473"></a><span>
</span><a name="line-474"></a><span class="hs-pragma">{-# INLINABLE mapCoercion #-}</span><span>  </span><span class="hs-comment">-- See Note [Specialising mappers]</span><span>
</span><a name="line-475"></a><span class="hs-identifier">mapCoercion</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-1627612368"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-476"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Type.html#TyCoMapper"><span class="hs-identifier hs-type">TyCoMapper</span></a><span> </span><a href="#local-1627612369"><span class="hs-identifier hs-type">env</span></a><span> </span><a href="#local-1627612368"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612369"><span class="hs-identifier hs-type">env</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612368"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-477"></a><a name="mapCoercion"><a href="Type.html#mapCoercion"><span class="hs-identifier">mapCoercion</span></a></a><span> </span><a name="local-1627612499"><a href="#local-1627612499"><span class="hs-identifier">mapper</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Type.html#TyCoMapper"><span class="hs-identifier hs-var">TyCoMapper</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcm_smart</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627612500"><a href="#local-1627612500"><span class="hs-identifier">smart</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcm_covar</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627612501"><a href="#local-1627612501"><span class="hs-identifier">covar</span></a></a><span>
</span><a name="line-478"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcm_hole</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627612502"><a href="#local-1627612502"><span class="hs-identifier">cohole</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcm_tybinder</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627612503"><a href="#local-1627612503"><span class="hs-identifier">tybinder</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-479"></a><span>            </span><a name="local-1627612504"><a href="#local-1627612504"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1627612505"><a href="#local-1627612505"><span class="hs-identifier">co</span></a></a><span>
</span><a name="line-480"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612505"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-481"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-482"></a><span>    </span><a name="local-1627612506"><a href="#local-1627612506"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Refl"><span class="hs-identifier hs-var">Refl</span></a><span> </span><a name="local-1627612521"><a href="#local-1627612521"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-1627612522"><a href="#local-1627612522"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Refl"><span class="hs-identifier hs-var">Refl</span></a><span> </span><a href="#local-1627612521"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Type.html#mapType"><span class="hs-identifier hs-var">mapType</span></a><span> </span><a href="#local-1627612499"><span class="hs-identifier hs-var">mapper</span></a><span> </span><a href="#local-1627612504"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627612522"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-483"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConAppCo"><span class="hs-identifier hs-var">TyConAppCo</span></a><span> </span><a name="local-1627612523"><a href="#local-1627612523"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-1627612524"><a href="#local-1627612524"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627612525"><a href="#local-1627612525"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-484"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612508"><span class="hs-identifier hs-var">mktyconappco</span></a><span> </span><a href="#local-1627612523"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-1627612524"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612525"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-485"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppCo"><span class="hs-identifier hs-var">AppCo</span></a><span> </span><a name="local-1627612526"><a href="#local-1627612526"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-1627612527"><a href="#local-1627612527"><span class="hs-identifier">c2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612509"><span class="hs-identifier hs-var">mkappco</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612526"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612527"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-486"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllCo"><span class="hs-identifier hs-var">ForAllCo</span></a><span> </span><a name="local-1627612528"><a href="#local-1627612528"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-1627612529"><a href="#local-1627612529"><span class="hs-identifier">kind_co</span></a></a><span> </span><a name="local-1627612530"><a href="#local-1627612530"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-487"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1627612531"><a href="#local-1627612531"><span class="hs-identifier">kind_co'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612529"><span class="hs-identifier hs-var">kind_co</span></a><span>
</span><a name="line-488"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1627612532"><a href="#local-1627612532"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612533"><a href="#local-1627612533"><span class="hs-identifier">tv'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627612503"><span class="hs-identifier hs-var">tybinder</span></a><span> </span><a href="#local-1627612504"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627612528"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="TyCoRep.html#Invisible"><span class="hs-identifier hs-var">Invisible</span></a><span>
</span><a name="line-489"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-1627612534"><a href="#local-1627612534"><span class="hs-identifier">co'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#mapCoercion"><span class="hs-identifier hs-var">mapCoercion</span></a><span> </span><a href="#local-1627612499"><span class="hs-identifier hs-var">mapper</span></a><span> </span><a href="#local-1627612532"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-1627612530"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-490"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1627612520"><span class="hs-identifier hs-var">mkforallco</span></a><span> </span><a href="#local-1627612533"><span class="hs-identifier hs-var">tv'</span></a><span> </span><a href="#local-1627612531"><span class="hs-identifier hs-var">kind_co'</span></a><span> </span><a href="#local-1627612534"><span class="hs-identifier hs-var">co'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-491"></a><span>        </span><span class="hs-comment">-- See Note [Efficiency for mapCoercion ForAllCo case]</span><span>
</span><a name="line-492"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoVarCo"><span class="hs-identifier hs-var">CoVarCo</span></a><span> </span><a name="local-1627612535"><a href="#local-1627612535"><span class="hs-identifier">cv</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612501"><span class="hs-identifier hs-var">covar</span></a><span> </span><a href="#local-1627612504"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627612535"><span class="hs-identifier hs-var">cv</span></a><span>
</span><a name="line-493"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AxiomInstCo"><span class="hs-identifier hs-var">AxiomInstCo</span></a><span> </span><a name="local-1627612536"><a href="#local-1627612536"><span class="hs-identifier">ax</span></a></a><span> </span><a name="local-1627612537"><a href="#local-1627612537"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-1627612538"><a href="#local-1627612538"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-494"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612510"><span class="hs-identifier hs-var">mkaxiominstco</span></a><span> </span><a href="#local-1627612536"><span class="hs-identifier hs-var">ax</span></a><span> </span><a href="#local-1627612537"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612538"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-495"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#UnivCo"><span class="hs-identifier hs-var">UnivCo</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#HoleProv"><span class="hs-identifier hs-var">HoleProv</span></a><span> </span><a name="local-1627612539"><a href="#local-1627612539"><span class="hs-identifier">hole</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612540"><a href="#local-1627612540"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-1627612541"><a href="#local-1627612541"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627612542"><a href="#local-1627612542"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-496"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612502"><span class="hs-identifier hs-var">cohole</span></a><span> </span><a href="#local-1627612504"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627612539"><span class="hs-identifier hs-var">hole</span></a><span> </span><a href="#local-1627612540"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-1627612541"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1627612542"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-497"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#UnivCo"><span class="hs-identifier hs-var">UnivCo</span></a><span> </span><a name="local-1627612543"><a href="#local-1627612543"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-1627612544"><a href="#local-1627612544"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-1627612545"><a href="#local-1627612545"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627612546"><a href="#local-1627612546"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-498"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612511"><span class="hs-identifier hs-var">mkunivco</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1627612507"><span class="hs-identifier hs-var">go_prov</span></a><span> </span><a href="#local-1627612543"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a><span> </span><a href="#local-1627612544"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-499"></a><span>                 </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="Type.html#mapType"><span class="hs-identifier hs-var">mapType</span></a><span> </span><a href="#local-1627612499"><span class="hs-identifier hs-var">mapper</span></a><span> </span><a href="#local-1627612504"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627612545"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="Type.html#mapType"><span class="hs-identifier hs-var">mapType</span></a><span> </span><a href="#local-1627612499"><span class="hs-identifier hs-var">mapper</span></a><span> </span><a href="#local-1627612504"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627612546"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-500"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#SymCo"><span class="hs-identifier hs-var">SymCo</span></a><span> </span><a name="local-1627612547"><a href="#local-1627612547"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612512"><span class="hs-identifier hs-var">mksymco</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612547"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-501"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TransCo"><span class="hs-identifier hs-var">TransCo</span></a><span> </span><a name="local-1627612548"><a href="#local-1627612548"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-1627612549"><a href="#local-1627612549"><span class="hs-identifier">c2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612513"><span class="hs-identifier hs-var">mktransco</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612548"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612549"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-502"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AxiomRuleCo"><span class="hs-identifier hs-var">AxiomRuleCo</span></a><span> </span><a name="local-1627612550"><a href="#local-1627612550"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-1627612551"><a href="#local-1627612551"><span class="hs-identifier">cos</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#AxiomRuleCo"><span class="hs-identifier hs-var">AxiomRuleCo</span></a><span> </span><a href="#local-1627612550"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612551"><span class="hs-identifier hs-var">cos</span></a><span>
</span><a name="line-503"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#NthCo"><span class="hs-identifier hs-var">NthCo</span></a><span> </span><a name="local-1627612552"><a href="#local-1627612552"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-1627612553"><a href="#local-1627612553"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612514"><span class="hs-identifier hs-var">mknthco</span></a><span> </span><a href="#local-1627612552"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612553"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-504"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LRCo"><span class="hs-identifier hs-var">LRCo</span></a><span> </span><a name="local-1627612554"><a href="#local-1627612554"><span class="hs-identifier">lr</span></a></a><span> </span><a name="local-1627612555"><a href="#local-1627612555"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612515"><span class="hs-identifier hs-var">mklrco</span></a><span> </span><a href="#local-1627612554"><span class="hs-identifier hs-var">lr</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612555"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-505"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#InstCo"><span class="hs-identifier hs-var">InstCo</span></a><span> </span><a name="local-1627612556"><a href="#local-1627612556"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-1627612557"><a href="#local-1627612557"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612516"><span class="hs-identifier hs-var">mkinstco</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612556"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612557"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-506"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoherenceCo"><span class="hs-identifier hs-var">CoherenceCo</span></a><span> </span><a name="local-1627612558"><a href="#local-1627612558"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-1627612559"><a href="#local-1627612559"><span class="hs-identifier">c2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612517"><span class="hs-identifier hs-var">mkcoherenceco</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612558"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612559"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-507"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#KindCo"><span class="hs-identifier hs-var">KindCo</span></a><span> </span><a name="local-1627612560"><a href="#local-1627612560"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612518"><span class="hs-identifier hs-var">mkkindco</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612560"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-508"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#SubCo"><span class="hs-identifier hs-var">SubCo</span></a><span> </span><a name="local-1627612561"><a href="#local-1627612561"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612519"><span class="hs-identifier hs-var">mksubco</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612561"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><span>    </span><a name="local-1627612507"><a href="#local-1627612507"><span class="hs-identifier">go_prov</span></a></a><span> </span><a href="TyCoRep.html#UnsafeCoerceProv"><span class="hs-identifier hs-var">UnsafeCoerceProv</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="TyCoRep.html#UnsafeCoerceProv"><span class="hs-identifier hs-var">UnsafeCoerceProv</span></a><span>
</span><a name="line-511"></a><span>    </span><span class="hs-identifier">go_prov</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#PhantomProv"><span class="hs-identifier hs-var">PhantomProv</span></a><span> </span><a name="local-1627612562"><a href="#local-1627612562"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#PhantomProv"><span class="hs-identifier hs-var">PhantomProv</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612562"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-512"></a><span>    </span><span class="hs-identifier">go_prov</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ProofIrrelProv"><span class="hs-identifier hs-var">ProofIrrelProv</span></a><span> </span><a name="local-1627612563"><a href="#local-1627612563"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#ProofIrrelProv"><span class="hs-identifier hs-var">ProofIrrelProv</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1627612506"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612563"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-513"></a><span>    </span><span class="hs-identifier">go_prov</span><span> </span><a name="local-1627612564"><a href="#local-1627612564"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#PluginProv"><span class="hs-identifier hs-var">PluginProv</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1627612564"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-514"></a><span>    </span><span class="hs-identifier">go_prov</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#HoleProv"><span class="hs-identifier hs-var">HoleProv</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;mapCoercion&quot;</span><span>
</span><a name="line-515"></a><span>
</span><a name="line-516"></a><span>    </span><span class="hs-special">(</span><span> </span><a name="local-1627612508"><a href="#local-1627612508"><span class="hs-identifier">mktyconappco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612509"><a href="#local-1627612509"><span class="hs-identifier">mkappco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612510"><a href="#local-1627612510"><span class="hs-identifier">mkaxiominstco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612511"><a href="#local-1627612511"><span class="hs-identifier">mkunivco</span></a></a><span>
</span><a name="line-517"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="local-1627612512"><a href="#local-1627612512"><span class="hs-identifier">mksymco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612513"><a href="#local-1627612513"><span class="hs-identifier">mktransco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612514"><a href="#local-1627612514"><span class="hs-identifier">mknthco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612515"><a href="#local-1627612515"><span class="hs-identifier">mklrco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612516"><a href="#local-1627612516"><span class="hs-identifier">mkinstco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612517"><a href="#local-1627612517"><span class="hs-identifier">mkcoherenceco</span></a></a><span>
</span><a name="line-518"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="local-1627612518"><a href="#local-1627612518"><span class="hs-identifier">mkkindco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612519"><a href="#local-1627612519"><span class="hs-identifier">mksubco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612520"><a href="#local-1627612520"><span class="hs-identifier">mkforallco</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-519"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627612500"><span class="hs-identifier hs-var">smart</span></a><span>
</span><a name="line-520"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><a href="Coercion.html#mkTyConAppCo"><span class="hs-identifier hs-var">mkTyConAppCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkAppCo"><span class="hs-identifier hs-var">mkAppCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkAxiomInstCo"><span class="hs-identifier hs-var">mkAxiomInstCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkUnivCo"><span class="hs-identifier hs-var">mkUnivCo</span></a><span>
</span><a name="line-521"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkSymCo"><span class="hs-identifier hs-var">mkSymCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkTransCo"><span class="hs-identifier hs-var">mkTransCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkNthCo"><span class="hs-identifier hs-var">mkNthCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkLRCo"><span class="hs-identifier hs-var">mkLRCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkInstCo"><span class="hs-identifier hs-var">mkInstCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkCoherenceCo"><span class="hs-identifier hs-var">mkCoherenceCo</span></a><span>
</span><a name="line-522"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkKindCo"><span class="hs-identifier hs-var">mkKindCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkSubCo"><span class="hs-identifier hs-var">mkSubCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkForAllCo"><span class="hs-identifier hs-var">mkForAllCo</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-523"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-524"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><a href="TyCoRep.html#TyConAppCo"><span class="hs-identifier hs-var">TyConAppCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#AppCo"><span class="hs-identifier hs-var">AppCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#AxiomInstCo"><span class="hs-identifier hs-var">AxiomInstCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#UnivCo"><span class="hs-identifier hs-var">UnivCo</span></a><span>
</span><a name="line-525"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#SymCo"><span class="hs-identifier hs-var">SymCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#TransCo"><span class="hs-identifier hs-var">TransCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#NthCo"><span class="hs-identifier hs-var">NthCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#LRCo"><span class="hs-identifier hs-var">LRCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#InstCo"><span class="hs-identifier hs-var">InstCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#CoherenceCo"><span class="hs-identifier hs-var">CoherenceCo</span></a><span>
</span><a name="line-526"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#KindCo"><span class="hs-identifier hs-var">KindCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#SubCo"><span class="hs-identifier hs-var">SubCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#ForAllCo"><span class="hs-identifier hs-var">ForAllCo</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-527"></a><span>
</span><a name="line-528"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Constructor-specific functions}
*                                                                      *
************************************************************************


---------------------------------------------------------------------
                                TyVarTy
                                ~~~~~~~
-}</span><span>
</span><a name="line-540"></a><span>
</span><a name="line-541"></a><span class="hs-comment">-- | Attempts to obtain the type variable underlying a 'Type', and panics with the</span><span>
</span><a name="line-542"></a><span class="hs-comment">-- given message if this is not a type variable type. See also 'getTyVar_maybe'</span><span>
</span><a name="line-543"></a><span class="hs-identifier">getTyVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-544"></a><a name="getTyVar"><a href="Type.html#getTyVar"><span class="hs-identifier">getTyVar</span></a></a><span> </span><a name="local-1627612565"><a href="#local-1627612565"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-1627612566"><a href="#local-1627612566"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a><span> </span><a href="#local-1627612566"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-545"></a><span>                    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612567"><a href="#local-1627612567"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612567"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-546"></a><span>                    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;getTyVar: &quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627612565"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-547"></a><span>
</span><a name="line-548"></a><span class="hs-identifier">isTyVarTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-549"></a><a name="isTyVarTy"><a href="Type.html#isTyVarTy"><span class="hs-identifier">isTyVarTy</span></a></a><span> </span><a name="local-1627612568"><a href="#local-1627612568"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a><span> </span><a href="#local-1627612568"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-550"></a><span>
</span><a name="line-551"></a><span class="hs-comment">-- | Attempts to obtain the type variable underlying a 'Type'</span><span>
</span><a name="line-552"></a><span class="hs-identifier">getTyVar_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-553"></a><a name="getTyVar_maybe"><a href="Type.html#getTyVar_maybe"><span class="hs-identifier">getTyVar_maybe</span></a></a><span> </span><a name="local-1627612569"><a href="#local-1627612569"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612570"><a href="#local-1627612570"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612569"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a><span> </span><a href="#local-1627612570"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-554"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#repGetTyVar_maybe"><span class="hs-identifier hs-var">repGetTyVar_maybe</span></a><span> </span><a href="#local-1627612569"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-555"></a><span>
</span><a name="line-556"></a><span class="hs-comment">-- | If the type is a tyvar, possibly under a cast, returns it, along</span><span>
</span><a name="line-557"></a><span class="hs-comment">-- with the coercion. Thus, the co is :: kind tv ~R kind type</span><span>
</span><a name="line-558"></a><span class="hs-identifier">getCastedTyVar_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span class="hs-special">)</span><span>
</span><a name="line-559"></a><a name="getCastedTyVar_maybe"><a href="Type.html#getCastedTyVar_maybe"><span class="hs-identifier">getCastedTyVar_maybe</span></a></a><span> </span><a name="local-1627612571"><a href="#local-1627612571"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612572"><a href="#local-1627612572"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612571"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getCastedTyVar_maybe"><span class="hs-identifier hs-var">getCastedTyVar_maybe</span></a><span> </span><a href="#local-1627612572"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-560"></a><span class="hs-identifier">getCastedTyVar_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-1627612573"><a href="#local-1627612573"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612574"><a href="#local-1627612574"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612573"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612574"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-561"></a><span class="hs-identifier">getCastedTyVar_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-1627612575"><a href="#local-1627612575"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-562"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612575"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkReflCo"><span class="hs-identifier hs-var">mkReflCo</span></a><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1627612575"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-563"></a><span class="hs-identifier">getCastedTyVar_maybe</span><span> </span><span class="hs-identifier">_</span><span>                            </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-564"></a><span>
</span><a name="line-565"></a><span class="hs-comment">-- | Attempts to obtain the type variable underlying a 'Type', without</span><span>
</span><a name="line-566"></a><span class="hs-comment">-- any expansion</span><span>
</span><a name="line-567"></a><span class="hs-identifier">repGetTyVar_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-568"></a><a name="repGetTyVar_maybe"><a href="Type.html#repGetTyVar_maybe"><span class="hs-identifier">repGetTyVar_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-1627612576"><a href="#local-1627612576"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627612576"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-569"></a><span class="hs-identifier">repGetTyVar_maybe</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-570"></a><span>
</span><a name="line-571"></a><span class="hs-identifier">allDistinctTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#KindOrType"><span class="hs-identifier hs-type">KindOrType</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-572"></a><a name="allDistinctTyVars"><a href="Type.html#allDistinctTyVars"><span class="hs-identifier">allDistinctTyVars</span></a></a><span> </span><a name="local-1627612577"><a href="#local-1627612577"><span class="hs-identifier">tkvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612578"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="VarSet.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a><span> </span><a href="#local-1627612577"><span class="hs-identifier hs-var">tkvs</span></a><span>
</span><a name="line-573"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-574"></a><span>    </span><a name="local-1627612578"><a href="#local-1627612578"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-575"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627612579"><a href="#local-1627612579"><span class="hs-identifier">so_far</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627612580"><a href="#local-1627612580"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-1627612581"><a href="#local-1627612581"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-576"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a><span> </span><a href="#local-1627612580"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-577"></a><span>             </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-578"></a><span>             </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612582"><a href="#local-1627612582"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627612582"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#elemVarSet"><span class="hs-identifier hs-var">elemVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627612579"><span class="hs-identifier hs-var">so_far</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-579"></a><span>                     </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612578"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612579"><span class="hs-identifier hs-var">so_far</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#extendVarSet"><span class="hs-identifier hs-var">extendVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627612582"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612581"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-580"></a><span>
</span><a name="line-581"></a><span class="hs-comment">{-
---------------------------------------------------------------------
                                AppTy
                                ~~~~~
We need to be pretty careful with AppTy to make sure we obey the
invariant that a TyConApp is always visibly so.  mkAppTy maintains the
invariant: use it.

Note [Decomposing fat arrow c=&gt;t]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Can we unify (a b) with (Eq a =&gt; ty)?   If we do so, we end up with
a partial application like ((=&gt;) Eq a) which doesn't make sense in
source Haskell.  In constrast, we *can* unify (a b) with (t1 -&gt; t2).
Here's an example (Trac #9858) of how you might do it:
   i :: (Typeable a, Typeable b) =&gt; Proxy (a b) -&gt; TypeRep
   i p = typeRep p

   j = i (Proxy :: Proxy (Eq Int =&gt; Int))
The type (Proxy (Eq Int =&gt; Int)) is only accepted with -XImpredicativeTypes,
but suppose we want that.  But then in the call to 'i', we end
up decomposing (Eq Int =&gt; Int), and we definitely don't want that.

This really only applies to the type checker; in Core, '=&gt;' and '-&gt;'
are the same, as are 'Constraint' and '*'.  But for now I've put
the test in repSplitAppTy_maybe, which applies throughout, because
the other calls to splitAppTy are in Unify, which is also used by
the type checker (e.g. when matching type-function equations).

-}</span><span>
</span><a name="line-610"></a><span>
</span><a name="line-611"></a><span class="hs-comment">-- | Applies a type to another, as in e.g. @k a@</span><span>
</span><a name="line-612"></a><span class="hs-identifier">mkAppTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-613"></a><a name="mkAppTy"><a href="Type.html#mkAppTy"><span class="hs-identifier">mkAppTy</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627612583"><a href="#local-1627612583"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627612584"><a href="#local-1627612584"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612585"><a href="#local-1627612585"><span class="hs-identifier">ty2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><a href="#local-1627612583"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612584"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627612585"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-614"></a><span class="hs-identifier">mkAppTy</span><span> </span><a name="local-1627612586"><a href="#local-1627612586"><span class="hs-identifier">ty1</span></a></a><span>               </span><a name="local-1627612587"><a href="#local-1627612587"><span class="hs-identifier">ty2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a href="#local-1627612586"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1627612587"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-615"></a><span>        </span><span class="hs-comment">-- Note that the TyConApp could be an</span><span>
</span><a name="line-616"></a><span>        </span><span class="hs-comment">-- under-saturated type synonym.  GHC allows that; e.g.</span><span>
</span><a name="line-617"></a><span>        </span><span class="hs-comment">--      type Foo k = k a -&gt; k a</span><span>
</span><a name="line-618"></a><span>        </span><span class="hs-comment">--      type Id x = x</span><span>
</span><a name="line-619"></a><span>        </span><span class="hs-comment">--      foo :: Foo Id -&gt; Foo Id</span><span>
</span><a name="line-620"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-621"></a><span>        </span><span class="hs-comment">-- Here Id is partially applied in the type sig for Foo,</span><span>
</span><a name="line-622"></a><span>        </span><span class="hs-comment">-- but once the type synonyms are expanded all is well</span><span>
</span><a name="line-623"></a><span>
</span><a name="line-624"></a><span class="hs-identifier">mkAppTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-625"></a><a name="mkAppTys"><a href="Type.html#mkAppTys"><span class="hs-identifier">mkAppTys</span></a></a><span> </span><a name="local-1627612588"><a href="#local-1627612588"><span class="hs-identifier">ty1</span></a></a><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612588"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-626"></a><span class="hs-identifier">mkAppTys</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627612589"><a href="#local-1627612589"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627612590"><a href="#local-1627612590"><span class="hs-identifier">tys1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612591"><a href="#local-1627612591"><span class="hs-identifier">tys2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><a href="#local-1627612589"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612590"><span class="hs-identifier hs-var">tys1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627612591"><span class="hs-identifier hs-var">tys2</span></a><span class="hs-special">)</span><span>
</span><a name="line-627"></a><span class="hs-identifier">mkAppTys</span><span> </span><a name="local-1627612592"><a href="#local-1627612592"><span class="hs-identifier">ty1</span></a></a><span>                </span><a name="local-1627612593"><a href="#local-1627612593"><span class="hs-identifier">tys2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a href="#local-1627612592"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1627612593"><span class="hs-identifier hs-var">tys2</span></a><span>
</span><a name="line-628"></a><span>
</span><a name="line-629"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-630"></a><span class="hs-identifier">splitAppTy_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-631"></a><span class="hs-comment">-- ^ Attempt to take a type application apart, whether it is a</span><span>
</span><a name="line-632"></a><span class="hs-comment">-- function, type constructor, or plain type application. Note</span><span>
</span><a name="line-633"></a><span class="hs-comment">-- that type family applications are NEVER unsaturated by this!</span><span>
</span><a name="line-634"></a><a name="splitAppTy_maybe"><a href="Type.html#splitAppTy_maybe"><span class="hs-identifier">splitAppTy_maybe</span></a></a><span> </span><a name="local-1627612594"><a href="#local-1627612594"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612595"><a href="#local-1627612595"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612594"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-635"></a><span>                    </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#splitAppTy_maybe"><span class="hs-identifier hs-var">splitAppTy_maybe</span></a><span> </span><a href="#local-1627612595"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-636"></a><span class="hs-identifier">splitAppTy_maybe</span><span> </span><a name="local-1627612596"><a href="#local-1627612596"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#repSplitAppTy_maybe"><span class="hs-identifier hs-var">repSplitAppTy_maybe</span></a><span> </span><a href="#local-1627612596"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-637"></a><span>
</span><a name="line-638"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-639"></a><span class="hs-identifier">repSplitAppTy_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-640"></a><span class="hs-comment">-- ^ Does the AppTy split as in 'splitAppTy_maybe', but assumes that</span><span>
</span><a name="line-641"></a><span class="hs-comment">-- any Core view stuff is already done</span><span>
</span><a name="line-642"></a><a name="repSplitAppTy_maybe"><a href="Type.html#repSplitAppTy_maybe"><span class="hs-identifier">repSplitAppTy_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627612597"><a href="#local-1627612597"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612598"><a href="#local-1627612598"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-643"></a><span>                                      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627612597"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-1627612598"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-644"></a><span class="hs-identifier">repSplitAppTy_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1627612599"><a href="#local-1627612599"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1627612600"><a href="#local-1627612600"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612599"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612600"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-645"></a><span class="hs-identifier">repSplitAppTy_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627612601"><a href="#local-1627612601"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627612602"><a href="#local-1627612602"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-646"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#mightBeUnsaturatedTyCon"><span class="hs-identifier hs-var">mightBeUnsaturatedTyCon</span></a><span> </span><a href="#local-1627612601"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-1627612602"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-special">`</span><a href="Util.html#lengthExceeds"><span class="hs-identifier hs-var">lengthExceeds</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><a href="#local-1627612601"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-647"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627612603"><a href="#local-1627612603"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612604"><a href="#local-1627612604"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Util.html#snocView"><span class="hs-identifier hs-var">snocView</span></a><span> </span><a href="#local-1627612602"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-648"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="#local-1627612601"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-1627612603"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612604"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- Never create unsaturated type family apps!</span><span>
</span><a name="line-649"></a><span class="hs-identifier">repSplitAppTy_maybe</span><span> </span><a name="local-1627612605"><a href="#local-1627612605"><span class="hs-identifier">_other</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-650"></a><span>
</span><a name="line-651"></a><span class="hs-comment">-- this one doesn't braek apart (c =&gt; t).</span><span>
</span><a name="line-652"></a><span class="hs-comment">-- See Note [Decomposing fat arrow c=&gt;t]</span><span>
</span><a name="line-653"></a><span class="hs-comment">-- Defined here to avoid module loops between Unify and TcType.</span><span>
</span><a name="line-654"></a><span class="hs-identifier">tcRepSplitAppTy_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-655"></a><span class="hs-comment">-- ^ Does the AppTy split as in 'tcSplitAppTy_maybe', but assumes that</span><span>
</span><a name="line-656"></a><span class="hs-comment">-- any coreView stuff is already done. Refuses to look through (c =&gt; t)</span><span>
</span><a name="line-657"></a><a name="tcRepSplitAppTy_maybe"><a href="Type.html#tcRepSplitAppTy_maybe"><span class="hs-identifier">tcRepSplitAppTy_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627612606"><a href="#local-1627612606"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612607"><a href="#local-1627612607"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-658"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Kind.html#isConstraintKind"><span class="hs-identifier hs-var">isConstraintKind</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1627612606"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-comment">-- See Note [Decomposing fat arrow c=&gt;t]</span><span>
</span><a name="line-659"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                           </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627612606"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-1627612607"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-660"></a><span class="hs-identifier">tcRepSplitAppTy_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1627612608"><a href="#local-1627612608"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1627612609"><a href="#local-1627612609"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612608"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612609"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-661"></a><span class="hs-identifier">tcRepSplitAppTy_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627612610"><a href="#local-1627612610"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627612611"><a href="#local-1627612611"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-662"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#mightBeUnsaturatedTyCon"><span class="hs-identifier hs-var">mightBeUnsaturatedTyCon</span></a><span> </span><a href="#local-1627612610"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-1627612611"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-special">`</span><a href="Util.html#lengthExceeds"><span class="hs-identifier hs-var">lengthExceeds</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><a href="#local-1627612610"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-663"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627612612"><a href="#local-1627612612"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612613"><a href="#local-1627612613"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Util.html#snocView"><span class="hs-identifier hs-var">snocView</span></a><span> </span><a href="#local-1627612611"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-664"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="#local-1627612610"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-1627612612"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612613"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- Never create unsaturated type family apps!</span><span>
</span><a name="line-665"></a><span class="hs-identifier">tcRepSplitAppTy_maybe</span><span> </span><a name="local-1627612614"><a href="#local-1627612614"><span class="hs-identifier">_other</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-666"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-667"></a><span class="hs-identifier">splitAppTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-668"></a><span class="hs-comment">-- ^ Attempts to take a type application apart, as in 'splitAppTy_maybe',</span><span>
</span><a name="line-669"></a><span class="hs-comment">-- and panics if this is not possible</span><span>
</span><a name="line-670"></a><a name="splitAppTy"><a href="Type.html#splitAppTy"><span class="hs-identifier">splitAppTy</span></a></a><span> </span><a name="local-1627612615"><a href="#local-1627612615"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitAppTy_maybe"><span class="hs-identifier hs-var">splitAppTy_maybe</span></a><span> </span><a href="#local-1627612615"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-671"></a><span>                </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612616"><a href="#local-1627612616"><span class="hs-identifier">pr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612616"><span class="hs-identifier hs-var">pr</span></a><span>
</span><a name="line-672"></a><span>                </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;splitAppTy&quot;</span><span>
</span><a name="line-673"></a><span>
</span><a name="line-674"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-675"></a><span class="hs-identifier">splitAppTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-676"></a><span class="hs-comment">-- ^ Recursively splits a type as far as is possible, leaving a residual</span><span>
</span><a name="line-677"></a><span class="hs-comment">-- type being applied to and the type arguments applied to it. Never fails,</span><span>
</span><a name="line-678"></a><span class="hs-comment">-- even if that means returning an empty list of type applications.</span><span>
</span><a name="line-679"></a><a name="splitAppTys"><a href="Type.html#splitAppTys"><span class="hs-identifier">splitAppTys</span></a></a><span> </span><a name="local-1627612617"><a href="#local-1627612617"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612618"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-1627612617"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1627612617"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-680"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-681"></a><span>    </span><a name="local-1627612618"><a href="#local-1627612618"><span class="hs-identifier">split</span></a></a><span> </span><a name="local-1627612619"><a href="#local-1627612619"><span class="hs-identifier">orig_ty</span></a></a><span> </span><a name="local-1627612620"><a href="#local-1627612620"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612621"><a href="#local-1627612621"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612622"><a href="#local-1627612622"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612620"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612618"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-1627612619"><span class="hs-identifier hs-var">orig_ty</span></a><span> </span><a href="#local-1627612622"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-1627612621"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-682"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1627612623"><a href="#local-1627612623"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612624"><a href="#local-1627612624"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span>        </span><a name="local-1627612625"><a href="#local-1627612625"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612618"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-1627612623"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1627612623"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612624"><span class="hs-identifier hs-var">arg</span></a><span class="hs-glyph">:</span><a href="#local-1627612625"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-683"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627612626"><a href="#local-1627612626"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627612627"><a href="#local-1627612627"><span class="hs-identifier">tc_args</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612628"><a href="#local-1627612628"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-684"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- keep type families saturated</span><span>
</span><a name="line-685"></a><span>            </span><a name="local-1627612629"><a href="#local-1627612629"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#mightBeUnsaturatedTyCon"><span class="hs-identifier hs-var">mightBeUnsaturatedTyCon</span></a><span> </span><a href="#local-1627612626"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-686"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><a href="#local-1627612626"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-687"></a><span>            </span><span class="hs-special">(</span><a name="local-1627612630"><a href="#local-1627612630"><span class="hs-identifier">tc_args1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612631"><a href="#local-1627612631"><span class="hs-identifier">tc_args2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a><span> </span><a href="#local-1627612629"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627612627"><span class="hs-identifier hs-var">tc_args</span></a><span>
</span><a name="line-688"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-689"></a><span>        </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="#local-1627612626"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-1627612630"><span class="hs-identifier hs-var">tc_args1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612631"><span class="hs-identifier hs-var">tc_args2</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627612628"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-690"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627612632"><a href="#local-1627612632"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612633"><a href="#local-1627612633"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612634"><a href="#local-1627612634"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-identifier">args</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-691"></a><span>                                               </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-1627612632"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><a href="#local-1627612633"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-692"></a><span>    </span><span class="hs-identifier">split</span><span> </span><a name="local-1627612635"><a href="#local-1627612635"><span class="hs-identifier">orig_ty</span></a></a><span> </span><span class="hs-identifier">_</span><span>                     </span><a name="local-1627612636"><a href="#local-1627612636"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627612635"><span class="hs-identifier hs-var">orig_ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612636"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-693"></a><span>
</span><a name="line-694"></a><span class="hs-comment">-- | Like 'splitAppTys', but doesn't look through type synonyms</span><span>
</span><a name="line-695"></a><span class="hs-identifier">repSplitAppTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-696"></a><a name="repSplitAppTys"><a href="Type.html#repSplitAppTys"><span class="hs-identifier">repSplitAppTys</span></a></a><span> </span><a name="local-1627612637"><a href="#local-1627612637"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612638"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-1627612637"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-697"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-698"></a><span>    </span><a name="local-1627612638"><a href="#local-1627612638"><span class="hs-identifier">split</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1627612639"><a href="#local-1627612639"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612640"><a href="#local-1627612640"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612641"><a href="#local-1627612641"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612638"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-1627612639"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612640"><span class="hs-identifier hs-var">arg</span></a><span class="hs-glyph">:</span><a href="#local-1627612641"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-699"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627612642"><a href="#local-1627612642"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627612643"><a href="#local-1627612643"><span class="hs-identifier">tc_args</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612644"><a href="#local-1627612644"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-700"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1627612645"><a href="#local-1627612645"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#mightBeUnsaturatedTyCon"><span class="hs-identifier hs-var">mightBeUnsaturatedTyCon</span></a><span> </span><a href="#local-1627612642"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-701"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><a href="#local-1627612642"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-702"></a><span>            </span><span class="hs-special">(</span><a name="local-1627612646"><a href="#local-1627612646"><span class="hs-identifier">tc_args1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612647"><a href="#local-1627612647"><span class="hs-identifier">tc_args2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a><span> </span><a href="#local-1627612645"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627612643"><span class="hs-identifier hs-var">tc_args</span></a><span>
</span><a name="line-703"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-704"></a><span>        </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="#local-1627612642"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-1627612646"><span class="hs-identifier hs-var">tc_args1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612647"><span class="hs-identifier hs-var">tc_args2</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627612644"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-705"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627612648"><a href="#local-1627612648"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612649"><a href="#local-1627612649"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612650"><a href="#local-1627612650"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-identifier">args</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-706"></a><span>                                           </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-1627612648"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612649"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-707"></a><span>    </span><span class="hs-identifier">split</span><span> </span><a name="local-1627612651"><a href="#local-1627612651"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612652"><a href="#local-1627612652"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627612651"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612652"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-708"></a><span>
</span><a name="line-709"></a><span class="hs-comment">{-
                      LitTy
                      ~~~~~
-}</span><span>
</span><a name="line-713"></a><span>
</span><a name="line-714"></a><span class="hs-identifier">mkNumLitTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-715"></a><a name="mkNumLitTy"><a href="Type.html#mkNumLitTy"><span class="hs-identifier">mkNumLitTy</span></a></a><span> </span><a name="local-1627612653"><a href="#local-1627612653"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#NumTyLit"><span class="hs-identifier hs-var">NumTyLit</span></a><span> </span><a href="#local-1627612653"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-716"></a><span>
</span><a name="line-717"></a><span class="hs-comment">-- | Is this a numeric literal. We also look through type synonyms.</span><span>
</span><a name="line-718"></a><span class="hs-identifier">isNumLitTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-719"></a><a name="isNumLitTy"><a href="Type.html#isNumLitTy"><span class="hs-identifier">isNumLitTy</span></a></a><span> </span><a name="local-1627612654"><a href="#local-1627612654"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612655"><a href="#local-1627612655"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612654"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isNumLitTy"><span class="hs-identifier hs-var">isNumLitTy</span></a><span> </span><a href="#local-1627612655"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-720"></a><span class="hs-identifier">isNumLitTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#NumTyLit"><span class="hs-identifier hs-var">NumTyLit</span></a><span> </span><a name="local-1627612656"><a href="#local-1627612656"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627612656"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-721"></a><span class="hs-identifier">isNumLitTy</span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-722"></a><span>
</span><a name="line-723"></a><span class="hs-identifier">mkStrLitTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-724"></a><a name="mkStrLitTy"><a href="Type.html#mkStrLitTy"><span class="hs-identifier">mkStrLitTy</span></a></a><span> </span><a name="local-1627612657"><a href="#local-1627612657"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#StrTyLit"><span class="hs-identifier hs-var">StrTyLit</span></a><span> </span><a href="#local-1627612657"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-725"></a><span>
</span><a name="line-726"></a><span class="hs-comment">-- | Is this a symbol literal. We also look through type synonyms.</span><span>
</span><a name="line-727"></a><span class="hs-identifier">isStrLitTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span>
</span><a name="line-728"></a><a name="isStrLitTy"><a href="Type.html#isStrLitTy"><span class="hs-identifier">isStrLitTy</span></a></a><span> </span><a name="local-1627612658"><a href="#local-1627612658"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612659"><a href="#local-1627612659"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612658"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isStrLitTy"><span class="hs-identifier hs-var">isStrLitTy</span></a><span> </span><a href="#local-1627612659"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-729"></a><span class="hs-identifier">isStrLitTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#StrTyLit"><span class="hs-identifier hs-var">StrTyLit</span></a><span> </span><a name="local-1627612660"><a href="#local-1627612660"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627612660"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-730"></a><span class="hs-identifier">isStrLitTy</span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-731"></a><span>
</span><a name="line-732"></a><span>
</span><a name="line-733"></a><span class="hs-comment">-- | Is this type a custom user error?</span><span>
</span><a name="line-734"></a><span class="hs-comment">-- If so, give us the kind and the error message.</span><span>
</span><a name="line-735"></a><span class="hs-identifier">userTypeError_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-736"></a><a name="userTypeError_maybe"><a href="Type.html#userTypeError_maybe"><span class="hs-identifier">userTypeError_maybe</span></a></a><span> </span><a name="local-1627612661"><a href="#local-1627612661"><span class="hs-identifier">t</span></a></a><span>
</span><a name="line-737"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1627612662"><a href="#local-1627612662"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612663"><a href="#local-1627612663"><span class="hs-identifier">_kind</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-1627612664"><a href="#local-1627612664"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627612661"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-738"></a><span>          </span><span class="hs-comment">-- There may be more than 2 arguments, if the type error is</span><span>
</span><a name="line-739"></a><span>          </span><span class="hs-comment">-- used as a type constructor (e.g. at kind `Type -&gt; Type`).</span><span>
</span><a name="line-740"></a><span>
</span><a name="line-741"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#guard"><span class="hs-identifier hs-var">guard</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-1627612662"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="PrelNames.html#errorMessageTypeErrorFamName"><span class="hs-identifier hs-var">errorMessageTypeErrorFamName</span></a><span class="hs-special">)</span><span>
</span><a name="line-742"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1627612664"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-743"></a><span>
</span><a name="line-744"></a><span class="hs-comment">-- | Render a type corresponding to a user type error into a SDoc.</span><span>
</span><a name="line-745"></a><span class="hs-identifier">pprUserTypeErrorTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-746"></a><a name="pprUserTypeErrorTy"><a href="Type.html#pprUserTypeErrorTy"><span class="hs-identifier">pprUserTypeErrorTy</span></a></a><span> </span><a name="local-1627612665"><a href="#local-1627612665"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-747"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627612665"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-748"></a><span>
</span><a name="line-749"></a><span>    </span><span class="hs-comment">-- Text &quot;Something&quot;</span><span>
</span><a name="line-750"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627612666"><a href="#local-1627612666"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><a name="local-1627612667"><a href="#local-1627612667"><span class="hs-identifier">txt</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-751"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-1627612666"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="PrelNames.html#typeErrorTextDataConName"><span class="hs-identifier hs-var">typeErrorTextDataConName</span></a><span>
</span><a name="line-752"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612668"><a href="#local-1627612668"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#isStrLitTy"><span class="hs-identifier hs-var">isStrLitTy</span></a><span> </span><a href="#local-1627612667"><span class="hs-identifier hs-var">txt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#ftext"><span class="hs-identifier hs-var">ftext</span></a><span> </span><a href="#local-1627612668"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-753"></a><span>
</span><a name="line-754"></a><span>    </span><span class="hs-comment">-- ShowType t</span><span>
</span><a name="line-755"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627612669"><a href="#local-1627612669"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><a name="local-1627612670"><a href="#local-1627612670"><span class="hs-identifier">_k</span></a></a><span class="hs-special">,</span><a name="local-1627612671"><a href="#local-1627612671"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-756"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-1627612669"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="PrelNames.html#typeErrorShowTypeDataConName"><span class="hs-identifier hs-var">typeErrorShowTypeDataConName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612671"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-757"></a><span>
</span><a name="line-758"></a><span>    </span><span class="hs-comment">-- t1 :&lt;&gt;: t2</span><span>
</span><a name="line-759"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627612672"><a href="#local-1627612672"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><a name="local-1627612673"><a href="#local-1627612673"><span class="hs-identifier">t1</span></a></a><span class="hs-special">,</span><a name="local-1627612674"><a href="#local-1627612674"><span class="hs-identifier">t2</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-760"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-1627612672"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="PrelNames.html#typeErrorAppendDataConName"><span class="hs-identifier hs-var">typeErrorAppendDataConName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-761"></a><span>        </span><a href="Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a><span> </span><a href="#local-1627612673"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a><span> </span><a href="#local-1627612674"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-762"></a><span>
</span><a name="line-763"></a><span>    </span><span class="hs-comment">-- t1 :$$: t2</span><span>
</span><a name="line-764"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627612675"><a href="#local-1627612675"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><a name="local-1627612676"><a href="#local-1627612676"><span class="hs-identifier">t1</span></a></a><span class="hs-special">,</span><a name="local-1627612677"><a href="#local-1627612677"><span class="hs-identifier">t2</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-765"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-1627612675"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="PrelNames.html#typeErrorVAppendDataConName"><span class="hs-identifier hs-var">typeErrorVAppendDataConName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-766"></a><span>        </span><a href="Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a><span> </span><a href="#local-1627612676"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a><span> </span><a href="#local-1627612677"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-767"></a><span>
</span><a name="line-768"></a><span>    </span><span class="hs-comment">-- An uneavaluated type function</span><span>
</span><a name="line-769"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612665"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-770"></a><span>
</span><a name="line-771"></a><span>
</span><a name="line-772"></a><span>
</span><a name="line-773"></a><span>
</span><a name="line-774"></a><span class="hs-comment">{-
---------------------------------------------------------------------
                                FunTy
                                ~~~~~

Function types are represented with (ForAllTy (Anon ...) ...)
-}</span><span>
</span><a name="line-781"></a><span>
</span><a name="line-782"></a><span class="hs-identifier">isFunTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-783"></a><a name="isFunTy"><a href="Type.html#isFunTy"><span class="hs-identifier">isFunTy</span></a></a><span> </span><a name="local-1627612678"><a href="#local-1627612678"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#splitFunTy_maybe"><span class="hs-identifier hs-var">splitFunTy_maybe</span></a><span> </span><a href="#local-1627612678"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-784"></a><span>
</span><a name="line-785"></a><span class="hs-identifier">splitFunTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-786"></a><span class="hs-comment">-- ^ Attempts to extract the argument and result types from a type, and</span><span>
</span><a name="line-787"></a><span class="hs-comment">-- panics if that is not possible. See also 'splitFunTy_maybe'</span><span>
</span><a name="line-788"></a><a name="splitFunTy"><a href="Type.html#splitFunTy"><span class="hs-identifier">splitFunTy</span></a></a><span> </span><a name="local-1627612679"><a href="#local-1627612679"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612680"><a href="#local-1627612680"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612679"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#splitFunTy"><span class="hs-identifier hs-var">splitFunTy</span></a><span> </span><a href="#local-1627612680"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-789"></a><span class="hs-identifier">splitFunTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627612681"><a href="#local-1627612681"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612682"><a href="#local-1627612682"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627612681"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612682"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span>
</span><a name="line-790"></a><span class="hs-identifier">splitFunTy</span><span> </span><a name="local-1627612683"><a href="#local-1627612683"><span class="hs-identifier">other</span></a></a><span>                        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;splitFunTy&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612683"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-791"></a><span>
</span><a name="line-792"></a><span class="hs-identifier">splitFunTy_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-793"></a><span class="hs-comment">-- ^ Attempts to extract the argument and result types from a type</span><span>
</span><a name="line-794"></a><a name="splitFunTy_maybe"><a href="Type.html#splitFunTy_maybe"><span class="hs-identifier">splitFunTy_maybe</span></a></a><span> </span><a name="local-1627612684"><a href="#local-1627612684"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612685"><a href="#local-1627612685"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612684"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#splitFunTy_maybe"><span class="hs-identifier hs-var">splitFunTy_maybe</span></a><span> </span><a href="#local-1627612685"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-795"></a><span class="hs-identifier">splitFunTy_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627612686"><a href="#local-1627612686"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612687"><a href="#local-1627612687"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612686"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612687"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span>
</span><a name="line-796"></a><span class="hs-identifier">splitFunTy_maybe</span><span> </span><span class="hs-identifier">_</span><span>                         </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-797"></a><span>
</span><a name="line-798"></a><span class="hs-identifier">splitFunTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-799"></a><a name="splitFunTys"><a href="Type.html#splitFunTys"><span class="hs-identifier">splitFunTys</span></a></a><span> </span><a name="local-1627612688"><a href="#local-1627612688"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612689"><span class="hs-identifier hs-var">split</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-1627612688"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1627612688"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-800"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-801"></a><span>    </span><a name="local-1627612689"><a href="#local-1627612689"><span class="hs-identifier">split</span></a></a><span> </span><a name="local-1627612690"><a href="#local-1627612690"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-1627612691"><a href="#local-1627612691"><span class="hs-identifier">orig_ty</span></a></a><span> </span><a name="local-1627612692"><a href="#local-1627612692"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612693"><a href="#local-1627612693"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612692"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612689"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-1627612690"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-1627612691"><span class="hs-identifier hs-var">orig_ty</span></a><span> </span><a href="#local-1627612693"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-802"></a><span>    </span><span class="hs-identifier">split</span><span> </span><a name="local-1627612694"><a href="#local-1627612694"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627612695"><a href="#local-1627612695"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612696"><a href="#local-1627612696"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612689"><span class="hs-identifier hs-var">split</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612695"><span class="hs-identifier hs-var">arg</span></a><span class="hs-glyph">:</span><a href="#local-1627612694"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612696"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-1627612696"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-803"></a><span>    </span><span class="hs-identifier">split</span><span> </span><a name="local-1627612697"><a href="#local-1627612697"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-1627612698"><a href="#local-1627612698"><span class="hs-identifier">orig_ty</span></a></a><span> </span><span class="hs-identifier">_</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-1627612697"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612698"><span class="hs-identifier hs-var">orig_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-804"></a><span>
</span><a name="line-805"></a><span class="hs-identifier">splitFunTysN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-806"></a><span class="hs-comment">-- ^ Split off exactly the given number argument types, and panics if that is not possible</span><span>
</span><a name="line-807"></a><a name="splitFunTysN"><a href="Type.html#splitFunTysN"><span class="hs-identifier">splitFunTysN</span></a></a><span> </span><span class="hs-number">0</span><span> </span><a name="local-1627612699"><a href="#local-1627612699"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-1627612699"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-808"></a><span class="hs-identifier">splitFunTysN</span><span> </span><a name="local-1627612700"><a href="#local-1627612700"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627612701"><a href="#local-1627612701"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isFunTy</span><span> </span><span class="hs-identifier hs-var">ty</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">int</span><span> </span><a href="Type.html#isFunTy"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-809"></a><span>                    </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitFunTy"><span class="hs-identifier hs-var">splitFunTy</span></a><span> </span><a href="#local-1627612701"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1627612702"><a href="#local-1627612702"><span class="hs-identifier">arg</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612703"><a href="#local-1627612703"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-810"></a><span>                    </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitFunTysN"><span class="hs-identifier hs-var">splitFunTysN</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612700"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-1627612703"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1627612704"><a href="#local-1627612704"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612705"><a href="#local-1627612705"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-811"></a><span>                    </span><span class="hs-special">(</span><a href="#local-1627612702"><span class="hs-identifier hs-var">arg</span></a><span class="hs-glyph">:</span><a href="#local-1627612704"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612705"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><a name="line-812"></a><span>
</span><a name="line-813"></a><span class="hs-identifier">funResultTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-814"></a><span class="hs-comment">-- ^ Extract the function result type and panic if that is not possible</span><span>
</span><a name="line-815"></a><a name="funResultTy"><a href="Type.html#funResultTy"><span class="hs-identifier">funResultTy</span></a></a><span> </span><a name="local-1627612706"><a href="#local-1627612706"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612707"><a href="#local-1627612707"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612706"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#funResultTy"><span class="hs-identifier hs-var">funResultTy</span></a><span> </span><a href="#local-1627612707"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-816"></a><span class="hs-identifier">funResultTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-1627612708"><a href="#local-1627612708"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612708"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-817"></a><span class="hs-identifier">funResultTy</span><span> </span><a name="local-1627612709"><a href="#local-1627612709"><span class="hs-identifier">ty</span></a></a><span>                           </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;funResultTy&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612709"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-818"></a><span>
</span><a name="line-819"></a><span class="hs-identifier">funArgTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-820"></a><span class="hs-comment">-- ^ Extract the function argument type and panic if that is not possible</span><span>
</span><a name="line-821"></a><a name="funArgTy"><a href="Type.html#funArgTy"><span class="hs-identifier">funArgTy</span></a></a><span> </span><a name="local-1627612710"><a href="#local-1627612710"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612711"><a href="#local-1627612711"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612710"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#funArgTy"><span class="hs-identifier hs-var">funArgTy</span></a><span> </span><a href="#local-1627612711"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-822"></a><span class="hs-identifier">funArgTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627612712"><a href="#local-1627612712"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612713"><a href="#local-1627612713"><span class="hs-identifier">_res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612712"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-823"></a><span class="hs-identifier">funArgTy</span><span> </span><a name="local-1627612714"><a href="#local-1627612714"><span class="hs-identifier">ty</span></a></a><span>                         </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;funArgTy&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612714"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-824"></a><span>
</span><a name="line-825"></a><span class="hs-identifier">piResultTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-826"></a><span class="hs-comment">-- ^ Just like 'piResultTys' but for a single argument</span><span>
</span><a name="line-827"></a><span class="hs-comment">-- Try not to iterate 'piResultTy', because it's inefficient to substitute</span><span>
</span><a name="line-828"></a><span class="hs-comment">-- one variable at a time; instead use 'piResultTys&quot;</span><span>
</span><a name="line-829"></a><a name="piResultTy"><a href="Type.html#piResultTy"><span class="hs-identifier">piResultTy</span></a></a><span> </span><a name="local-1627612715"><a href="#local-1627612715"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612716"><a href="#local-1627612716"><span class="hs-identifier">arg</span></a></a><span>
</span><a name="line-830"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612717"><a href="#local-1627612717"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612715"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#piResultTy"><span class="hs-identifier hs-var">piResultTy</span></a><span> </span><a href="#local-1627612717"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-1627612716"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-831"></a><span>
</span><a name="line-832"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><a name="local-1627612718"><a href="#local-1627612718"><span class="hs-identifier">bndr</span></a></a><span> </span><a name="local-1627612719"><a href="#local-1627612719"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627612715"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-833"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627612718"><span class="hs-identifier hs-var">bndr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-834"></a><span>      </span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612719"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-835"></a><span>      </span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1627612720"><a href="#local-1627612720"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#substTy"><span class="hs-identifier hs-var">substTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#extendTvSubst"><span class="hs-identifier hs-var">extendTvSubst</span></a><span> </span><a href="#local-1627612721"><span class="hs-identifier hs-var">empty_subst</span></a><span> </span><a href="#local-1627612720"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-1627612716"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612719"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-836"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-837"></a><span>          </span><a name="local-1627612721"><a href="#local-1627612721"><span class="hs-identifier">empty_subst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkEmptyTCvSubst"><span class="hs-identifier hs-var">mkEmptyTCvSubst</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="VarEnv.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-838"></a><span>                        </span><a href="TyCoRep.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627612716"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">,</span><a href="#local-1627612719"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span>
</span><a name="line-839"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-840"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;piResultTys&quot;</span><span>
</span><a name="line-841"></a><span>
</span><a name="line-842"></a><span class="hs-comment">-- | (piResultTys f_ty [ty1, .., tyn]) gives the type of (f ty1 .. tyn)</span><span>
</span><a name="line-843"></a><span class="hs-comment">--   where f :: f_ty</span><span>
</span><a name="line-844"></a><span class="hs-comment">-- 'piResultTys' is interesting because:</span><span>
</span><a name="line-845"></a><span class="hs-comment">--      1. 'f_ty' may have more for-alls than there are args</span><span>
</span><a name="line-846"></a><span class="hs-comment">--      2. Less obviously, it may have fewer for-alls</span><span>
</span><a name="line-847"></a><span class="hs-comment">-- For case 2. think of:</span><span>
</span><a name="line-848"></a><span class="hs-comment">--   piResultTys (forall a.a) [forall b.b, Int]</span><span>
</span><a name="line-849"></a><span class="hs-comment">-- This really can happen, but only (I think) in situations involving</span><span>
</span><a name="line-850"></a><span class="hs-comment">-- undefined.  For example:</span><span>
</span><a name="line-851"></a><span class="hs-comment">--       undefined :: forall a. a</span><span>
</span><a name="line-852"></a><span class="hs-comment">-- Term: undefined @(forall b. b-&gt;b) @Int</span><span>
</span><a name="line-853"></a><span class="hs-comment">-- This term should have type (Int -&gt; Int), but notice that</span><span>
</span><a name="line-854"></a><span class="hs-comment">-- there are more type args than foralls in 'undefined's type.</span><span>
</span><a name="line-855"></a><span>
</span><a name="line-856"></a><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><a name="line-857"></a><span class="hs-comment">-- See Note [GHC Formalism] in coreSyn/CoreLint.hs</span><span>
</span><a name="line-858"></a><span>
</span><a name="line-859"></a><span class="hs-comment">-- This is a heavily used function (e.g. from typeKind),</span><span>
</span><a name="line-860"></a><span class="hs-comment">-- so we pay attention to efficiency, especially in the special case</span><span>
</span><a name="line-861"></a><span class="hs-comment">-- where there are no for-alls so we are just dropping arrows from</span><span>
</span><a name="line-862"></a><span class="hs-comment">-- a function type/kind.</span><span>
</span><a name="line-863"></a><span class="hs-identifier">piResultTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-864"></a><a name="piResultTys"><a href="Type.html#piResultTys"><span class="hs-identifier">piResultTys</span></a></a><span> </span><a name="local-1627612722"><a href="#local-1627612722"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612722"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-865"></a><span class="hs-identifier">piResultTys</span><span> </span><a name="local-1627612723"><a href="#local-1627612723"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612724"><a href="#local-1627612724"><span class="hs-identifier">orig_args</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-1627612725"><a href="#local-1627612725"><span class="hs-identifier">arg</span></a></a><span class="hs-glyph">:</span><a name="local-1627612726"><a href="#local-1627612726"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-866"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612742"><a href="#local-1627612742"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612723"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-867"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a><span> </span><a href="#local-1627612742"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-1627612724"><span class="hs-identifier hs-var">orig_args</span></a><span>
</span><a name="line-868"></a><span>
</span><a name="line-869"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><a name="local-1627612743"><a href="#local-1627612743"><span class="hs-identifier">bndr</span></a></a><span> </span><a name="local-1627612744"><a href="#local-1627612744"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627612723"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-870"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627612743"><span class="hs-identifier hs-var">bndr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-871"></a><span>      </span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a><span> </span><a href="#local-1627612744"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-1627612726"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-872"></a><span>      </span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1627612745"><a href="#local-1627612745"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612727"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a><span> </span><a href="TyCoRep.html#emptyTvSubstEnv"><span class="hs-identifier hs-var">emptyTvSubstEnv</span></a><span> </span><a href="#local-1627612745"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-1627612725"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612744"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-1627612726"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-873"></a><span>
</span><a name="line-874"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-875"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;piResultTys&quot;</span><span>
</span><a name="line-876"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-877"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TvSubstEnv"><span class="hs-identifier hs-type">TvSubstEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-878"></a><span>    </span><a name="local-1627612727"><a href="#local-1627612727"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-1627612728"><a href="#local-1627612728"><span class="hs-identifier">tv_env</span></a></a><span> </span><a name="local-1627612729"><a href="#local-1627612729"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substTy"><span class="hs-identifier hs-var">substTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTvSubst"><span class="hs-identifier hs-var">mkTvSubst</span></a><span> </span><a href="#local-1627612730"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><a href="#local-1627612728"><span class="hs-identifier hs-var">tv_env</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612729"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-879"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-880"></a><span>        </span><a name="local-1627612730"><a href="#local-1627612730"><span class="hs-identifier">in_scope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612729"><span class="hs-identifier hs-var">ty</span></a><span class="hs-glyph">:</span><a href="#local-1627612724"><span class="hs-identifier hs-var">orig_args</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-881"></a><span>
</span><a name="line-882"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627612731"><a href="#local-1627612731"><span class="hs-identifier">tv_env</span></a></a><span> </span><a name="local-1627612732"><a href="#local-1627612732"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612733"><a href="#local-1627612733"><span class="hs-identifier">all_args</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-1627612734"><a href="#local-1627612734"><span class="hs-identifier">arg</span></a></a><span class="hs-glyph">:</span><a name="local-1627612735"><a href="#local-1627612735"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-883"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612736"><a href="#local-1627612736"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612732"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-884"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612727"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612731"><span class="hs-identifier hs-var">tv_env</span></a><span> </span><a href="#local-1627612736"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-1627612733"><span class="hs-identifier hs-var">all_args</span></a><span>
</span><a name="line-885"></a><span>
</span><a name="line-886"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><a name="local-1627612737"><a href="#local-1627612737"><span class="hs-identifier">bndr</span></a></a><span> </span><a name="local-1627612738"><a href="#local-1627612738"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627612732"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-887"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627612737"><span class="hs-identifier hs-var">bndr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-888"></a><span>          </span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612727"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612731"><span class="hs-identifier hs-var">tv_env</span></a><span> </span><a href="#local-1627612738"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-1627612735"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-889"></a><span>          </span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1627612739"><a href="#local-1627612739"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612727"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a><span> </span><a href="#local-1627612731"><span class="hs-identifier hs-var">tv_env</span></a><span> </span><a href="#local-1627612739"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-1627612734"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612738"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-1627612735"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-890"></a><span>
</span><a name="line-891"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-1627612740"><a href="#local-1627612740"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627612732"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-892"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612741"><a href="#local-1627612741"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="VarEnv.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a><span> </span><a href="#local-1627612731"><span class="hs-identifier hs-var">tv_env</span></a><span> </span><a href="#local-1627612740"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-893"></a><span>        </span><span class="hs-comment">-- Deals with piResultTys (forall a. a) [forall b.b, Int]</span><span>
</span><a name="line-894"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a><span> </span><a href="#local-1627612741"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-1627612733"><span class="hs-identifier hs-var">all_args</span></a><span>
</span><a name="line-895"></a><span>
</span><a name="line-896"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-897"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;piResultTys&quot;</span><span>
</span><a name="line-898"></a><span>
</span><a name="line-899"></a><span class="hs-comment">{-
---------------------------------------------------------------------
                                TyConApp
                                ~~~~~~~~
-}</span><span>
</span><a name="line-904"></a><span>
</span><a name="line-905"></a><span class="hs-comment">-- | A key function: builds a 'TyConApp' or 'FunTy' as appropriate to</span><span>
</span><a name="line-906"></a><span class="hs-comment">-- its arguments.  Applies its arguments to the constructor from left to right.</span><span>
</span><a name="line-907"></a><span class="hs-identifier">mkTyConApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-908"></a><a name="mkTyConApp"><a href="Type.html#mkTyConApp"><span class="hs-identifier">mkTyConApp</span></a></a><span> </span><a name="local-1627612746"><a href="#local-1627612746"><span class="hs-identifier">tycon</span></a></a><span> </span><a name="local-1627612747"><a href="#local-1627612747"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-909"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isFunTyCon"><span class="hs-identifier hs-var">isFunTyCon</span></a><span> </span><a href="#local-1627612746"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-1627612748"><a href="#local-1627612748"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><a name="local-1627612749"><a href="#local-1627612749"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627612747"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-910"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a href="#local-1627612748"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612749"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-911"></a><span>
</span><a name="line-912"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-913"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="#local-1627612746"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="#local-1627612747"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-914"></a><span>
</span><a name="line-915"></a><span class="hs-comment">-- splitTyConApp &quot;looks through&quot; synonyms, because they don't</span><span>
</span><a name="line-916"></a><span class="hs-comment">-- mean a distinct type, but all other type-constructor applications</span><span>
</span><a name="line-917"></a><span class="hs-comment">-- including functions are returned as Just ..</span><span>
</span><a name="line-918"></a><span>
</span><a name="line-919"></a><span class="hs-comment">-- | Retrieve the tycon heading this type, if there is one. Does /not/</span><span>
</span><a name="line-920"></a><span class="hs-comment">-- look through synonyms.</span><span>
</span><a name="line-921"></a><span class="hs-identifier">tyConAppTyConPicky_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-922"></a><a name="tyConAppTyConPicky_maybe"><a href="Type.html#tyConAppTyConPicky_maybe"><span class="hs-identifier">tyConAppTyConPicky_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627612750"><a href="#local-1627612750"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627612750"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-923"></a><span class="hs-identifier">tyConAppTyConPicky_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span>
</span><a name="line-924"></a><span class="hs-identifier">tyConAppTyConPicky_maybe</span><span> </span><span class="hs-identifier">_</span><span>                     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-925"></a><span>
</span><a name="line-926"></a><span>
</span><a name="line-927"></a><span class="hs-comment">-- | The same as @fst . splitTyConApp@</span><span>
</span><a name="line-928"></a><span class="hs-identifier">tyConAppTyCon_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-929"></a><a name="tyConAppTyCon_maybe"><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier">tyConAppTyCon_maybe</span></a></a><span> </span><a name="local-1627612751"><a href="#local-1627612751"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612752"><a href="#local-1627612752"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612751"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a><span> </span><a href="#local-1627612752"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-930"></a><span class="hs-identifier">tyConAppTyCon_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627612753"><a href="#local-1627612753"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627612753"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-931"></a><span class="hs-identifier">tyConAppTyCon_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span>
</span><a name="line-932"></a><span class="hs-identifier">tyConAppTyCon_maybe</span><span> </span><span class="hs-identifier">_</span><span>                     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-933"></a><span>
</span><a name="line-934"></a><span class="hs-identifier">tyConAppTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-935"></a><a name="tyConAppTyCon"><a href="Type.html#tyConAppTyCon"><span class="hs-identifier">tyConAppTyCon</span></a></a><span> </span><a name="local-1627612754"><a href="#local-1627612754"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a><span> </span><a href="#local-1627612754"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><a href="Maybes.html#orElse"><span class="hs-identifier hs-var">orElse</span></a><span class="hs-special">`</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;tyConAppTyCon&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612754"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-936"></a><span>
</span><a name="line-937"></a><span class="hs-comment">-- | The same as @snd . splitTyConApp@</span><span>
</span><a name="line-938"></a><span class="hs-identifier">tyConAppArgs_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-939"></a><a name="tyConAppArgs_maybe"><a href="Type.html#tyConAppArgs_maybe"><span class="hs-identifier">tyConAppArgs_maybe</span></a></a><span> </span><a name="local-1627612755"><a href="#local-1627612755"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612756"><a href="#local-1627612756"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612755"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#tyConAppArgs_maybe"><span class="hs-identifier hs-var">tyConAppArgs_maybe</span></a><span> </span><a href="#local-1627612756"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-940"></a><span class="hs-identifier">tyConAppArgs_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627612757"><a href="#local-1627612757"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627612757"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-941"></a><span class="hs-identifier">tyConAppArgs_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627612758"><a href="#local-1627612758"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612759"><a href="#local-1627612759"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627612758"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">,</span><a href="#local-1627612759"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span>
</span><a name="line-942"></a><span class="hs-identifier">tyConAppArgs_maybe</span><span> </span><span class="hs-identifier">_</span><span>                         </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-943"></a><span>
</span><a name="line-944"></a><span class="hs-identifier">tyConAppArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-945"></a><a name="tyConAppArgs"><a href="Type.html#tyConAppArgs"><span class="hs-identifier">tyConAppArgs</span></a></a><span> </span><a name="local-1627612760"><a href="#local-1627612760"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#tyConAppArgs_maybe"><span class="hs-identifier hs-var">tyConAppArgs_maybe</span></a><span> </span><a href="#local-1627612760"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><a href="Maybes.html#orElse"><span class="hs-identifier hs-var">orElse</span></a><span class="hs-special">`</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;tyConAppArgs&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612760"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-946"></a><span>
</span><a name="line-947"></a><span class="hs-identifier">tyConAppArgN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-948"></a><span class="hs-comment">-- Executing Nth</span><span>
</span><a name="line-949"></a><a name="tyConAppArgN"><a href="Type.html#tyConAppArgN"><span class="hs-identifier">tyConAppArgN</span></a></a><span> </span><a name="local-1627612761"><a href="#local-1627612761"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627612762"><a href="#local-1627612762"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-950"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#tyConAppArgs_maybe"><span class="hs-identifier hs-var">tyConAppArgs_maybe</span></a><span> </span><a href="#local-1627612762"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-951"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612763"><a href="#local-1627612763"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="Util.html#debugIsOn"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-special">)</span><span> </span><a href="Outputable.html#assertPprPanic"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-special">`</span><a href="Outputable.html#assertPprPanic"><span class="hs-identifier hs-var">getNth</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">n</span><span>
</span><a name="line-952"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;tyConAppArgN&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612761"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612762"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-953"></a><span>
</span><a name="line-954"></a><span class="hs-comment">-- | Attempts to tease a type apart into a type constructor and the application</span><span>
</span><a name="line-955"></a><span class="hs-comment">-- of a number of arguments to that constructor. Panics if that is not possible.</span><span>
</span><a name="line-956"></a><span class="hs-comment">-- See also 'splitTyConApp_maybe'</span><span>
</span><a name="line-957"></a><span class="hs-identifier">splitTyConApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-958"></a><a name="splitTyConApp"><a href="Type.html#splitTyConApp"><span class="hs-identifier">splitTyConApp</span></a></a><span> </span><a name="local-1627612764"><a href="#local-1627612764"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627612764"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-959"></a><span>                   </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612765"><a href="#local-1627612765"><span class="hs-identifier">stuff</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612765"><span class="hs-identifier hs-var">stuff</span></a><span>
</span><a name="line-960"></a><span>                   </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;splitTyConApp&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612764"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-961"></a><span>
</span><a name="line-962"></a><span class="hs-comment">-- | Attempts to tease a type apart into a type constructor and the application</span><span>
</span><a name="line-963"></a><span class="hs-comment">-- of a number of arguments to that constructor</span><span>
</span><a name="line-964"></a><span class="hs-identifier">splitTyConApp_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-965"></a><a name="splitTyConApp_maybe"><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier">splitTyConApp_maybe</span></a></a><span> </span><a name="local-1627612766"><a href="#local-1627612766"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612767"><a href="#local-1627612767"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612766"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627612767"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-966"></a><span class="hs-identifier">splitTyConApp_maybe</span><span> </span><a name="local-1627612768"><a href="#local-1627612768"><span class="hs-identifier">ty</span></a></a><span>                           </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#repSplitTyConApp_maybe"><span class="hs-identifier hs-var">repSplitTyConApp_maybe</span></a><span> </span><a href="#local-1627612768"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-967"></a><span>
</span><a name="line-968"></a><span class="hs-comment">-- | Like 'splitTyConApp_maybe', but doesn't look through synonyms. This</span><span>
</span><a name="line-969"></a><span class="hs-comment">-- assumes the synonyms have already been dealt with.</span><span>
</span><a name="line-970"></a><span class="hs-identifier">repSplitTyConApp_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-971"></a><a name="repSplitTyConApp_maybe"><a href="Type.html#repSplitTyConApp_maybe"><span class="hs-identifier">repSplitTyConApp_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627612769"><a href="#local-1627612769"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627612770"><a href="#local-1627612770"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612769"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612770"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-972"></a><span class="hs-identifier">repSplitTyConApp_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627612771"><a href="#local-1627612771"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612772"><a href="#local-1627612772"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-1627612771"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">,</span><a href="#local-1627612772"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-973"></a><span class="hs-identifier">repSplitTyConApp_maybe</span><span> </span><span class="hs-identifier">_</span><span>                         </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-974"></a><span>
</span><a name="line-975"></a><span class="hs-comment">-- | Attempts to tease a list type apart and gives the type of the elements if</span><span>
</span><a name="line-976"></a><span class="hs-comment">-- successful (looks through type synonyms)</span><span>
</span><a name="line-977"></a><span class="hs-identifier">splitListTyConApp_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-978"></a><a name="splitListTyConApp_maybe"><a href="Type.html#splitListTyConApp_maybe"><span class="hs-identifier">splitListTyConApp_maybe</span></a></a><span> </span><a name="local-1627612773"><a href="#local-1627612773"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627612773"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-979"></a><span>  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627612774"><a href="#local-1627612774"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><a name="local-1627612775"><a href="#local-1627612775"><span class="hs-identifier">e</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627612774"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TysWiredIn.html#listTyCon"><span class="hs-identifier hs-var">listTyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627612775"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-980"></a><span>  </span><a name="local-1627612776"><a href="#local-1627612776"><span class="hs-identifier">_other</span></a></a><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-981"></a><span>
</span><a name="line-982"></a><span class="hs-comment">-- | What is the role assigned to the next parameter of this type? Usually,</span><span>
</span><a name="line-983"></a><span class="hs-comment">-- this will be 'Nominal', but if the type is a 'TyConApp', we may be able to</span><span>
</span><a name="line-984"></a><span class="hs-comment">-- do better. The type does *not* have to be well-kinded when applied for this</span><span>
</span><a name="line-985"></a><span class="hs-comment">-- to work!</span><span>
</span><a name="line-986"></a><span class="hs-identifier">nextRole</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span>
</span><a name="line-987"></a><a name="nextRole"><a href="Type.html#nextRole"><span class="hs-identifier">nextRole</span></a></a><span> </span><a name="local-1627612777"><a href="#local-1627612777"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-988"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627612778"><a href="#local-1627612778"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612779"><a href="#local-1627612779"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627612777"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-989"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1627612780"><a href="#local-1627612780"><span class="hs-identifier">num_tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1627612779"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-990"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="#local-1627612780"><span class="hs-identifier hs-var">num_tys</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><a href="#local-1627612778"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-991"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tyConRoles"><span class="hs-identifier hs-var">tyConRoles</span></a><span> </span><a href="#local-1627612778"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="ListSetOps.html#getNth"><span class="hs-identifier hs-var">getNth</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627612780"><span class="hs-identifier hs-var">num_tys</span></a><span>
</span><a name="line-992"></a><span>
</span><a name="line-993"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-994"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span>
</span><a name="line-995"></a><span>
</span><a name="line-996"></a><span class="hs-identifier">newTyConInstRhs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-997"></a><span class="hs-comment">-- ^ Unwrap one 'layer' of newtype on a type constructor and its</span><span>
</span><a name="line-998"></a><span class="hs-comment">-- arguments, using an eta-reduced version of the @newtype@ if possible.</span><span>
</span><a name="line-999"></a><span class="hs-comment">-- This requires tys to have at least @newTyConInstArity tycon@ elements.</span><span>
</span><a name="line-1000"></a><a name="newTyConInstRhs"><a href="Type.html#newTyConInstRhs"><span class="hs-identifier">newTyConInstRhs</span></a></a><span> </span><a name="local-1627612781"><a href="#local-1627612781"><span class="hs-identifier">tycon</span></a></a><span> </span><a name="local-1627612782"><a href="#local-1627612782"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-1001"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">leLength</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">,</span><span> </span><a href="Util.html#leLength"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-identifier">tycon</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tys</span><span> </span><a href="Outputable.html#assertPprPanic"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#assertPprPanic"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="Outputable.html#assertPprPanic"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1002"></a><span>      </span><a href="Type.html#applyTysX"><span class="hs-identifier hs-var">applyTysX</span></a><span> </span><a href="#local-1627612783"><span class="hs-identifier hs-var">tvs</span></a><span> </span><a href="#local-1627612784"><span class="hs-identifier hs-var">rhs</span></a><span> </span><a href="#local-1627612782"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1003"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1004"></a><span>    </span><span class="hs-special">(</span><a name="local-1627612783"><a href="#local-1627612783"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612784"><a href="#local-1627612784"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#newTyConEtadRhs"><span class="hs-identifier hs-var">newTyConEtadRhs</span></a><span> </span><a href="#local-1627612781"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-1005"></a><span>
</span><a name="line-1006"></a><span class="hs-comment">{-
---------------------------------------------------------------------
                           CastTy
                           ~~~~~~
A casted type has its *kind* casted into something new.

Note [Weird typing rule for ForAllTy]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Here is the (truncated) typing rule for the dependent ForAllTy:

inner : kind
------------------------------------
ForAllTy (Named tv vis) inner : kind

Note that neither the inner type nor for ForAllTy itself have to have
kind *! But, it means that we should push any kind casts through the
ForAllTy. The only trouble is avoiding capture.

-}</span><span>
</span><a name="line-1026"></a><span>
</span><a name="line-1027"></a><span class="hs-identifier">splitCastTy_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span class="hs-special">)</span><span>
</span><a name="line-1028"></a><a name="splitCastTy_maybe"><a href="Type.html#splitCastTy_maybe"><span class="hs-identifier">splitCastTy_maybe</span></a></a><span> </span><a name="local-1627612785"><a href="#local-1627612785"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612786"><a href="#local-1627612786"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612785"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#splitCastTy_maybe"><span class="hs-identifier hs-var">splitCastTy_maybe</span></a><span> </span><a href="#local-1627612786"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1029"></a><span class="hs-identifier">splitCastTy_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-1627612787"><a href="#local-1627612787"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612788"><a href="#local-1627612788"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612787"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612788"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-1030"></a><span class="hs-identifier">splitCastTy_maybe</span><span> </span><span class="hs-identifier">_</span><span>                            </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1031"></a><span>
</span><a name="line-1032"></a><span class="hs-comment">-- | Make a 'CastTy'. The Coercion must be nominal. This function looks</span><span>
</span><a name="line-1033"></a><span class="hs-comment">-- at the entire structure of the type and coercion in an attempt to</span><span>
</span><a name="line-1034"></a><span class="hs-comment">-- maintain representation invariance (that is, any two types that are `eqType`</span><span>
</span><a name="line-1035"></a><span class="hs-comment">-- look the same). Be very wary of calling this in a loop.</span><span>
</span><a name="line-1036"></a><span class="hs-identifier">mkCastTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1037"></a><span class="hs-comment">-- Running example:</span><span>
</span><a name="line-1038"></a><span class="hs-comment">--   T :: forall k1. k1 -&gt; forall k2. k2 -&gt; Bool -&gt; Maybe k1 -&gt; *</span><span>
</span><a name="line-1039"></a><span class="hs-comment">--   co :: * ~R X    (maybe X is a newtype around *)</span><span>
</span><a name="line-1040"></a><span class="hs-comment">--   ty = T Nat 3 Symbol &quot;foo&quot; True (Just 2)</span><span>
</span><a name="line-1041"></a><span class="hs-comment">--</span><span>
</span><a name="line-1042"></a><span class="hs-comment">-- We wish to &quot;push&quot; the cast down as far as possible. See also</span><span>
</span><a name="line-1043"></a><span class="hs-comment">-- Note [Pushing down casts] in TyCoRep. Here is where we end</span><span>
</span><a name="line-1044"></a><span class="hs-comment">-- up:</span><span>
</span><a name="line-1045"></a><span class="hs-comment">--</span><span>
</span><a name="line-1046"></a><span class="hs-comment">--   (T Nat 3 Symbol |&gt; &lt;Symbol&gt; -&gt; &lt;Bool&gt; -&gt; &lt;Maybe Nat&gt; -&gt; co)</span><span>
</span><a name="line-1047"></a><span class="hs-comment">--      &quot;foo&quot; True (Just 2)</span><span>
</span><a name="line-1048"></a><span class="hs-comment">--</span><span>
</span><a name="line-1049"></a><a name="mkCastTy"><a href="Type.html#mkCastTy"><span class="hs-identifier">mkCastTy</span></a></a><span> </span><a name="local-1627612789"><a href="#local-1627612789"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612790"><a href="#local-1627612790"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Coercion.html#isReflexiveCo"><span class="hs-identifier hs-var">isReflexiveCo</span></a><span> </span><a href="#local-1627612790"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612789"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1050"></a><span class="hs-comment">-- NB: Do the slow check here. This is important to keep the splitXXX</span><span>
</span><a name="line-1051"></a><span class="hs-comment">-- functions working properly. Otherwise, we may end up with something</span><span>
</span><a name="line-1052"></a><span class="hs-comment">-- like (((-&gt;) |&gt; something_reflexive_but_not_obviously_so) biz baz)</span><span>
</span><a name="line-1053"></a><span class="hs-comment">-- fails under splitFunTy_maybe. This happened with the cheaper check</span><span>
</span><a name="line-1054"></a><span class="hs-comment">-- in test dependent/should_compile/dynamic-paper.</span><span>
</span><a name="line-1055"></a><span>
</span><a name="line-1056"></a><span class="hs-identifier">mkCastTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-1627612791"><a href="#local-1627612791"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612792"><a href="#local-1627612792"><span class="hs-identifier">co1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612793"><a href="#local-1627612793"><span class="hs-identifier">co2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a><span> </span><a href="#local-1627612791"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612792"><span class="hs-identifier hs-var">co1</span></a><span> </span><span class="hs-special">`</span><a href="Coercion.html#mkTransCo"><span class="hs-identifier hs-var">mkTransCo</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627612793"><span class="hs-identifier hs-var">co2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1057"></a><span class="hs-comment">-- See Note [Weird typing rule for ForAllTy]</span><span>
</span><a name="line-1058"></a><span class="hs-identifier">mkCastTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1627612794"><a href="#local-1627612794"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-1627612795"><a href="#local-1627612795"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612796"><a href="#local-1627612796"><span class="hs-identifier">inner_ty</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612797"><a href="#local-1627612797"><span class="hs-identifier">co</span></a></a><span>
</span><a name="line-1059"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- have to make sure that pushing the co in doesn't capture the bound var</span><span>
</span><a name="line-1060"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-1627612798"><a href="#local-1627612798"><span class="hs-identifier">fvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tyCoVarsOfCo"><span class="hs-identifier hs-var">tyCoVarsOfCo</span></a><span> </span><a href="#local-1627612797"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1061"></a><span>        </span><a name="local-1627612799"><a href="#local-1627612799"><span class="hs-identifier">empty_subst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkEmptyTCvSubst"><span class="hs-identifier hs-var">mkEmptyTCvSubst</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a><span> </span><a href="#local-1627612798"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1062"></a><span>        </span><span class="hs-special">(</span><a name="local-1627612800"><a href="#local-1627612800"><span class="hs-identifier">subst</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612801"><a href="#local-1627612801"><span class="hs-identifier">tv'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substTyVarBndr"><span class="hs-identifier hs-var">substTyVarBndr</span></a><span> </span><a href="#local-1627612799"><span class="hs-identifier hs-var">empty_subst</span></a><span> </span><a href="#local-1627612794"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1063"></a><span>    </span><span class="hs-keyword">in</span><span>
</span><a name="line-1064"></a><span>    </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a href="#local-1627612801"><span class="hs-identifier hs-var">tv'</span></a><span> </span><a href="#local-1627612795"><span class="hs-identifier hs-var">vis</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTy"><span class="hs-identifier hs-var">substTy</span></a><span> </span><a href="#local-1627612800"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612796"><span class="hs-identifier hs-var">inner_ty</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627612797"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-1065"></a><span class="hs-identifier">mkCastTy</span><span> </span><a name="local-1627612802"><a href="#local-1627612802"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612803"><a href="#local-1627612803"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- NB: don't check if the coercion &quot;from&quot; type matches here;</span><span>
</span><a name="line-1066"></a><span>                 </span><span class="hs-comment">-- there may be unzonked variables about</span><span>
</span><a name="line-1067"></a><span>                 </span><span class="hs-keyword">let</span><span> </span><a name="local-1627612844"><a href="#local-1627612844"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612804"><span class="hs-identifier hs-var">split_apps</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-1627612802"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1627612803"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-1068"></a><span>                 </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">CastTy</span><span> </span><span class="hs-identifier hs-var">ty</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">eqType</span><span class="hs-special">`</span><span> </span><a href="Coercion.html#coercionKind"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-1069"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">ty</span><span> </span><a href="Outputable.html#assertPprPanic"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#assertPprPanic"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">typeKind</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$$</span><span>
</span><a name="line-1070"></a><span>                          </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">co</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">dcolon</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">coercionKind</span><span> </span><span class="hs-identifier">co</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$$</span><span>
</span><a name="line-1071"></a><span>                          </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">result</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">dcolon</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">typeKind</span><span> </span><span class="hs-identifier">result</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1072"></a><span>                 </span><a href="#local-1627612844"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-1073"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1074"></a><span>    </span><span class="hs-comment">-- split_apps breaks apart any type applications, so we can see how far down</span><span>
</span><a name="line-1075"></a><span>    </span><span class="hs-comment">-- to push the cast</span><span>
</span><a name="line-1076"></a><span>    </span><a name="local-1627612804"><a href="#local-1627612804"><span class="hs-identifier">split_apps</span></a></a><span> </span><a name="local-1627612807"><a href="#local-1627612807"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1627612808"><a href="#local-1627612808"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627612809"><a href="#local-1627612809"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612810"><a href="#local-1627612810"><span class="hs-identifier">co</span></a></a><span>
</span><a name="line-1077"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612804"><span class="hs-identifier hs-var">split_apps</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612809"><span class="hs-identifier hs-var">t2</span></a><span class="hs-glyph">:</span><a href="#local-1627612807"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612808"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1627612810"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1078"></a><span>    </span><span class="hs-identifier">split_apps</span><span> </span><a name="local-1627612811"><a href="#local-1627612811"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627612812"><a href="#local-1627612812"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627612813"><a href="#local-1627612813"><span class="hs-identifier">tc_args</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612814"><a href="#local-1627612814"><span class="hs-identifier">co</span></a></a><span>
</span><a name="line-1079"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#mightBeUnsaturatedTyCon"><span class="hs-identifier hs-var">mightBeUnsaturatedTyCon</span></a><span> </span><a href="#local-1627612812"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1080"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612805"><span class="hs-identifier hs-var">affix_co</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConBinders</span><span> </span><a href="#local-1627612812"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyConTy"><span class="hs-identifier hs-var">mkTyConTy</span></a><span> </span><a href="#local-1627612812"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627612813"><span class="hs-identifier hs-var">tc_args</span></a><span> </span><span class="hs-special">`</span><a href="Util.html#chkAppend"><span class="hs-identifier hs-var">chkAppend</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627612811"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612814"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1081"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-comment">-- not decomposable... but it may still be oversaturated</span><span>
</span><a name="line-1082"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1627612815"><a href="#local-1627612815"><span class="hs-identifier">non_decomp_args</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612816"><a href="#local-1627612816"><span class="hs-identifier">decomp_args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConArity</span><span> </span><a href="#local-1627612812"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612813"><span class="hs-identifier hs-var">tc_args</span></a><span>
</span><a name="line-1083"></a><span>            </span><a name="local-1627612817"><a href="#local-1627612817"><span class="hs-identifier">saturated_tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><a href="#local-1627612812"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-1627612815"><span class="hs-identifier hs-var">non_decomp_args</span></a><span>
</span><a name="line-1084"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-1085"></a><span>        </span><a href="#local-1627612805"><span class="hs-identifier hs-var">affix_co</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#splitPiTys"><span class="hs-identifier hs-var">splitPiTys</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1627612817"><span class="hs-identifier hs-var">saturated_tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1086"></a><span>                 </span><a href="#local-1627612817"><span class="hs-identifier hs-var">saturated_tc</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612816"><span class="hs-identifier hs-var">decomp_args</span></a><span> </span><span class="hs-special">`</span><a href="Util.html#chkAppend"><span class="hs-identifier hs-var">chkAppend</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627612811"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612814"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1087"></a><span>
</span><a name="line-1088"></a><span>    </span><span class="hs-identifier">split_apps</span><span> </span><a name="local-1627612818"><a href="#local-1627612818"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627612819"><a href="#local-1627612819"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612820"><a href="#local-1627612820"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612821"><a href="#local-1627612821"><span class="hs-identifier">co</span></a></a><span>
</span><a name="line-1089"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612805"><span class="hs-identifier hs-var">affix_co</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConBinders</span><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyConTy"><span class="hs-identifier hs-var">mkTyConTy</span></a><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span class="hs-special">)</span><span>
</span><a name="line-1090"></a><span>                 </span><span class="hs-special">(</span><a href="#local-1627612819"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1627612820"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1627612818"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612821"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1091"></a><span>    </span><span class="hs-identifier">split_apps</span><span> </span><a name="local-1627612822"><a href="#local-1627612822"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-1627612823"><a href="#local-1627612823"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612824"><a href="#local-1627612824"><span class="hs-identifier">co</span></a></a><span>
</span><a name="line-1092"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612805"><span class="hs-identifier hs-var">affix_co</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#splitPiTys"><span class="hs-identifier hs-var">splitPiTys</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1627612823"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1093"></a><span>                 </span><a href="#local-1627612823"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1627612822"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-1627612824"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1094"></a><span>
</span><a name="line-1095"></a><span>    </span><span class="hs-comment">-- having broken everything apart, this figures out the point at which there</span><span>
</span><a name="line-1096"></a><span>    </span><span class="hs-comment">-- are no more dependent quantifications, and puts the cast there</span><span>
</span><a name="line-1097"></a><span>    </span><a name="local-1627612805"><a href="#local-1627612805"><span class="hs-identifier">affix_co</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627612825"><a href="#local-1627612825"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-1627612826"><a href="#local-1627612826"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612806"><span class="hs-identifier hs-var">no_double_casts</span></a><span> </span><a href="#local-1627612825"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1627612826"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1098"></a><span>    </span><span class="hs-identifier">affix_co</span><span> </span><a name="local-1627612827"><a href="#local-1627612827"><span class="hs-identifier">bndrs</span></a></a><span> </span><a name="local-1627612828"><a href="#local-1627612828"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612829"><a href="#local-1627612829"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-1627612830"><a href="#local-1627612830"><span class="hs-identifier">co</span></a></a><span>
</span><a name="line-1099"></a><span>      </span><span class="hs-comment">-- if kind contains any dependent quantifications, we can't push.</span><span>
</span><a name="line-1100"></a><span>      </span><span class="hs-comment">-- apply arguments until it doesn't</span><span>
</span><a name="line-1101"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1627612831"><a href="#local-1627612831"><span class="hs-identifier">no_dep_bndrs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612832"><a href="#local-1627612832"><span class="hs-identifier">some_dep_bndrs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#spanEnd"><span class="hs-identifier hs-var">spanEnd</span></a><span> </span><a href="TyCoRep.html#isAnonBinder"><span class="hs-identifier hs-var">isAnonBinder</span></a><span> </span><a href="#local-1627612827"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1102"></a><span>            </span><span class="hs-special">(</span><a name="local-1627612833"><a href="#local-1627612833"><span class="hs-identifier">some_dep_args</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612834"><a href="#local-1627612834"><span class="hs-identifier">rest_args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#splitAtList"><span class="hs-identifier hs-var">splitAtList</span></a><span> </span><a href="#local-1627612832"><span class="hs-identifier hs-var">some_dep_bndrs</span></a><span> </span><a href="#local-1627612829"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1103"></a><span>            </span><a name="local-1627612835"><a href="#local-1627612835"><span class="hs-identifier">dep_subst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#zipTyBinderSubst"><span class="hs-identifier hs-var">zipTyBinderSubst</span></a><span> </span><a href="#local-1627612832"><span class="hs-identifier hs-var">some_dep_bndrs</span></a><span> </span><a href="#local-1627612833"><span class="hs-identifier hs-var">some_dep_args</span></a><span>
</span><a name="line-1104"></a><span>            </span><a name="local-1627612836"><a href="#local-1627612836"><span class="hs-identifier">used_no_dep_bndrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#takeList"><span class="hs-identifier hs-var">takeList</span></a><span> </span><a href="#local-1627612834"><span class="hs-identifier hs-var">rest_args</span></a><span> </span><a href="#local-1627612831"><span class="hs-identifier hs-var">no_dep_bndrs</span></a><span>
</span><a name="line-1105"></a><span>            </span><a name="local-1627612837"><a href="#local-1627612837"><span class="hs-identifier">rest_arg_tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substTys"><span class="hs-identifier hs-var">substTys</span></a><span> </span><a href="#local-1627612835"><span class="hs-identifier hs-var">dep_subst</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="TyCoRep.html#binderType"><span class="hs-identifier hs-var">binderType</span></a><span> </span><a href="#local-1627612836"><span class="hs-identifier hs-var">used_no_dep_bndrs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1106"></a><span>            </span><a name="local-1627612838"><a href="#local-1627612838"><span class="hs-identifier">co'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkFunCos"><span class="hs-identifier hs-var">mkFunCos</span></a><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span>
</span><a name="line-1107"></a><span>                           </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="Coercion.html#mkReflCo"><span class="hs-identifier hs-var">mkReflCo</span></a><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612837"><span class="hs-identifier hs-var">rest_arg_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1108"></a><span>                           </span><a href="#local-1627612830"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1109"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-1110"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-1627612828"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627612833"><span class="hs-identifier hs-var">some_dep_args</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="#local-1627612806"><span class="hs-identifier hs-var">no_double_casts</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627612838"><span class="hs-identifier hs-var">co'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627612834"><span class="hs-identifier hs-var">rest_args</span></a><span>
</span><a name="line-1111"></a><span>
</span><a name="line-1112"></a><span>    </span><a name="local-1627612806"><a href="#local-1627612806"><span class="hs-identifier">no_double_casts</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-1627612839"><a href="#local-1627612839"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612840"><a href="#local-1627612840"><span class="hs-identifier">co1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612841"><a href="#local-1627612841"><span class="hs-identifier">co2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a href="#local-1627612839"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612840"><span class="hs-identifier hs-var">co1</span></a><span> </span><span class="hs-special">`</span><a href="Coercion.html#mkTransCo"><span class="hs-identifier hs-var">mkTransCo</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627612841"><span class="hs-identifier hs-var">co2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1113"></a><span>    </span><span class="hs-identifier">no_double_casts</span><span> </span><a name="local-1627612842"><a href="#local-1627612842"><span class="hs-identifier">ty</span></a></a><span>              </span><a name="local-1627612843"><a href="#local-1627612843"><span class="hs-identifier">co</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a href="#local-1627612842"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1627612843"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1114"></a><span>
</span><a name="line-1115"></a><span class="hs-comment">{-
--------------------------------------------------------------------
                            CoercionTy
                            ~~~~~~~~~~
CoercionTy allows us to inject coercions into types. A CoercionTy
should appear only in the right-hand side of an application.
-}</span><span>
</span><a name="line-1122"></a><span>
</span><a name="line-1123"></a><span class="hs-identifier">mkCoercionTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1124"></a><a name="mkCoercionTy"><a href="Type.html#mkCoercionTy"><span class="hs-identifier">mkCoercionTy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span>
</span><a name="line-1125"></a><span>
</span><a name="line-1126"></a><span class="hs-identifier">isCoercionTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1127"></a><a name="isCoercionTy"><a href="Type.html#isCoercionTy"><span class="hs-identifier">isCoercionTy</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1128"></a><span class="hs-identifier">isCoercionTy</span><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1129"></a><span>
</span><a name="line-1130"></a><span class="hs-identifier">isCoercionTy_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-1131"></a><a name="isCoercionTy_maybe"><a href="Type.html#isCoercionTy_maybe"><span class="hs-identifier">isCoercionTy_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-1627612845"><a href="#local-1627612845"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627612845"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1132"></a><span class="hs-identifier">isCoercionTy_maybe</span><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1133"></a><span>
</span><a name="line-1134"></a><span class="hs-identifier">stripCoercionTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-1135"></a><a name="stripCoercionTy"><a href="Type.html#stripCoercionTy"><span class="hs-identifier">stripCoercionTy</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-1627612846"><a href="#local-1627612846"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612846"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1136"></a><span class="hs-identifier">stripCoercionTy</span><span> </span><a name="local-1627612847"><a href="#local-1627612847"><span class="hs-identifier">ty</span></a></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;stripCoercionTy&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612847"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1137"></a><span>
</span><a name="line-1138"></a><span class="hs-comment">{-
---------------------------------------------------------------------
                                SynTy
                                ~~~~~

Notes on type synonyms
~~~~~~~~~~~~~~~~~~~~~~
The various &quot;split&quot; functions (splitFunTy, splitRhoTy, splitForAllTy) try
to return type synonyms wherever possible. Thus

        type Foo a = a -&gt; a

we want
        splitFunTys (a -&gt; Foo a) = ([a], Foo a)
not                                ([a], a -&gt; a)

The reason is that we then get better (shorter) type signatures in
interfaces.  Notably this plays a role in tcTySigs in TcBinds.hs.


                Representation types
                ~~~~~~~~~~~~~~~~~~~~

Note [Nullary unboxed tuple]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We represent the nullary unboxed tuple as the unary (but void) type
Void#.  The reason for this is that the ReprArity is never
less than the Arity (as it would otherwise be for a function type like
(# #) -&gt; Int).

As a result, ReprArity is always strictly positive if Arity is. This
is important because it allows us to distinguish at runtime between a
thunk and a function takes a nullary unboxed tuple as an argument!
-}</span><span>
</span><a name="line-1172"></a><span>
</span><a name="line-1173"></a><span class="hs-keyword">type</span><span> </span><a name="UnaryType"><a href="Type.html#UnaryType"><span class="hs-identifier">UnaryType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1174"></a><span>
</span><a name="line-1175"></a><span class="hs-keyword">data</span><span> </span><a name="RepType"><a href="Type.html#RepType"><span class="hs-identifier">RepType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="UbxTupleRep"><a href="Type.html#UbxTupleRep"><span class="hs-identifier">UbxTupleRep</span></a></a><span> </span><span class="hs-special">[</span><a href="Type.html#UnaryType"><span class="hs-identifier hs-type">UnaryType</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- INVARIANT: never an empty list (see Note [Nullary unboxed tuple])</span><span>
</span><a name="line-1176"></a><span>             </span><span class="hs-glyph">|</span><span> </span><a name="UnaryRep"><a href="Type.html#UnaryRep"><span class="hs-identifier">UnaryRep</span></a></a><span> </span><a href="Type.html#UnaryType"><span class="hs-identifier hs-type">UnaryType</span></a><span>
</span><a name="line-1177"></a><span>
</span><a name="line-1178"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="Type.html#RepType"><span class="hs-identifier hs-type">RepType</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1179"></a><span>  </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="Type.html#UbxTupleRep"><span class="hs-identifier hs-var">UbxTupleRep</span></a><span> </span><a name="local-1627613365"><a href="#local-1627613365"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;UbxTupleRep&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627613365"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1180"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="Type.html#UnaryRep"><span class="hs-identifier hs-var">UnaryRep</span></a><span> </span><a name="local-1627613366"><a href="#local-1627613366"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;UnaryRep&quot;</span><span>    </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627613366"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1181"></a><span>
</span><a name="line-1182"></a><span class="hs-identifier">flattenRepType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Type.html#RepType"><span class="hs-identifier hs-type">RepType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Type.html#UnaryType"><span class="hs-identifier hs-type">UnaryType</span></a><span class="hs-special">]</span><span>
</span><a name="line-1183"></a><a name="flattenRepType"><a href="Type.html#flattenRepType"><span class="hs-identifier">flattenRepType</span></a></a><span> </span><span class="hs-special">(</span><a href="Type.html#UbxTupleRep"><span class="hs-identifier hs-var">UbxTupleRep</span></a><span> </span><a name="local-1627612848"><a href="#local-1627612848"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612848"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1184"></a><span class="hs-identifier">flattenRepType</span><span> </span><span class="hs-special">(</span><a href="Type.html#UnaryRep"><span class="hs-identifier hs-var">UnaryRep</span></a><span> </span><a name="local-1627612849"><a href="#local-1627612849"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1627612849"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">]</span><span>
</span><a name="line-1185"></a><span>
</span><a name="line-1186"></a><span class="hs-comment">-- | Looks through:</span><span>
</span><a name="line-1187"></a><span class="hs-comment">--</span><span>
</span><a name="line-1188"></a><span class="hs-comment">--      1. For-alls</span><span>
</span><a name="line-1189"></a><span class="hs-comment">--      2. Synonyms</span><span>
</span><a name="line-1190"></a><span class="hs-comment">--      3. Predicates</span><span>
</span><a name="line-1191"></a><span class="hs-comment">--      4. All newtypes, including recursive ones, but not newtype families</span><span>
</span><a name="line-1192"></a><span class="hs-comment">--      5. Casts</span><span>
</span><a name="line-1193"></a><span class="hs-comment">--</span><span>
</span><a name="line-1194"></a><span class="hs-comment">-- It's useful in the back end of the compiler.</span><span>
</span><a name="line-1195"></a><span class="hs-identifier">repType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#RepType"><span class="hs-identifier hs-type">RepType</span></a><span>
</span><a name="line-1196"></a><a name="repType"><a href="Type.html#repType"><span class="hs-identifier">repType</span></a></a><span> </span><a name="local-1627612850"><a href="#local-1627612850"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1197"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612851"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="TyCon.html#initRecTc"><span class="hs-identifier hs-var">initRecTc</span></a><span> </span><a href="#local-1627612850"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1198"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1199"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#RecTcChecker"><span class="hs-identifier hs-type">RecTcChecker</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#RepType"><span class="hs-identifier hs-type">RepType</span></a><span>
</span><a name="line-1200"></a><span>    </span><a name="local-1627612851"><a href="#local-1627612851"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-1627612852"><a href="#local-1627612852"><span class="hs-identifier">rec_nts</span></a></a><span> </span><a name="local-1627612853"><a href="#local-1627612853"><span class="hs-identifier">ty</span></a></a><span>                       </span><span class="hs-comment">-- Expand predicates and synonyms</span><span>
</span><a name="line-1201"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612854"><a href="#local-1627612854"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612853"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1202"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612851"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612852"><span class="hs-identifier hs-var">rec_nts</span></a><span> </span><a href="#local-1627612854"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1203"></a><span>
</span><a name="line-1204"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627612855"><a href="#local-1627612855"><span class="hs-identifier">rec_nts</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-1627612856"><a href="#local-1627612856"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Drop type foralls</span><span>
</span><a name="line-1205"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612851"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612855"><span class="hs-identifier hs-var">rec_nts</span></a><span> </span><a href="#local-1627612856"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1206"></a><span>
</span><a name="line-1207"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627612857"><a href="#local-1627612857"><span class="hs-identifier">rec_nts</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627612858"><a href="#local-1627612858"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627612859"><a href="#local-1627612859"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-comment">-- Expand newtypes</span><span>
</span><a name="line-1208"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isNewTyCon"><span class="hs-identifier hs-var">isNewTyCon</span></a><span> </span><a href="#local-1627612858"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1209"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="#local-1627612859"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-special">`</span><a href="Util.html#lengthAtLeast"><span class="hs-identifier hs-var">lengthAtLeast</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><a href="#local-1627612858"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1210"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612861"><a href="#local-1627612861"><span class="hs-identifier">rec_nts'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#checkRecTc"><span class="hs-identifier hs-var">checkRecTc</span></a><span> </span><a href="#local-1627612857"><span class="hs-identifier hs-var">rec_nts</span></a><span> </span><a href="#local-1627612858"><span class="hs-identifier hs-var">tc</span></a><span>   </span><span class="hs-comment">-- See Note [Expanding newtypes] in TyCon</span><span>
</span><a name="line-1211"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612851"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612861"><span class="hs-identifier hs-var">rec_nts'</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#newTyConInstRhs"><span class="hs-identifier hs-var">newTyConInstRhs</span></a><span> </span><a href="#local-1627612858"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-1627612859"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1212"></a><span>
</span><a name="line-1213"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isUnboxedTupleTyCon"><span class="hs-identifier hs-var">isUnboxedTupleTyCon</span></a><span> </span><a href="#local-1627612858"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1214"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1627612859"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1215"></a><span>         </span><span class="hs-keyword">then</span><span> </span><a href="Type.html#UnaryRep"><span class="hs-identifier hs-var">UnaryRep</span></a><span> </span><a href="TysPrim.html#voidPrimTy"><span class="hs-identifier hs-var">voidPrimTy</span></a><span> </span><span class="hs-comment">-- See Note [Nullary unboxed tuple]</span><span>
</span><a name="line-1216"></a><span>         </span><span class="hs-keyword">else</span><span> </span><a href="Type.html#UbxTupleRep"><span class="hs-identifier hs-var">UbxTupleRep</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#flattenRepType"><span class="hs-identifier hs-var">flattenRepType</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-1627612851"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612857"><span class="hs-identifier hs-var">rec_nts</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612860"><span class="hs-identifier hs-var">non_rr_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1217"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1218"></a><span>          </span><span class="hs-comment">-- See Note [Unboxed tuple RuntimeRep vars] in TyCon</span><span>
</span><a name="line-1219"></a><span>        </span><a name="local-1627612860"><a href="#local-1627612860"><span class="hs-identifier">non_rr_tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#dropRuntimeRepArgs"><span class="hs-identifier hs-var">dropRuntimeRepArgs</span></a><span> </span><a href="#local-1627612859"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1220"></a><span>
</span><a name="line-1221"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627612862"><a href="#local-1627612862"><span class="hs-identifier">rec_nts</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-1627612863"><a href="#local-1627612863"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1222"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612851"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612862"><span class="hs-identifier hs-var">rec_nts</span></a><span> </span><a href="#local-1627612863"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1223"></a><span>
</span><a name="line-1224"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627612864"><a href="#local-1627612864"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1225"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;repType&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612864"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1226"></a><span>
</span><a name="line-1227"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627612865"><a href="#local-1627612865"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#UnaryRep"><span class="hs-identifier hs-var">UnaryRep</span></a><span> </span><a href="#local-1627612865"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1228"></a><span>
</span><a name="line-1229"></a><span class="hs-comment">-- ToDo: this could be moved to the code generator, using splitTyConApp instead</span><span>
</span><a name="line-1230"></a><span class="hs-comment">-- of inspecting the type directly.</span><span>
</span><a name="line-1231"></a><span>
</span><a name="line-1232"></a><span class="hs-comment">-- | Discovers the primitive representation of a more abstract 'UnaryType'</span><span>
</span><a name="line-1233"></a><span class="hs-identifier">typePrimRep</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Type.html#UnaryType"><span class="hs-identifier hs-type">UnaryType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#PrimRep"><span class="hs-identifier hs-type">PrimRep</span></a><span>
</span><a name="line-1234"></a><a name="typePrimRep"><a href="Type.html#typePrimRep"><span class="hs-identifier">typePrimRep</span></a></a><span> </span><a name="local-1627612866"><a href="#local-1627612866"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#kindPrimRep"><span class="hs-identifier hs-var">kindPrimRep</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1627612866"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1235"></a><span>
</span><a name="line-1236"></a><span class="hs-comment">-- | Find the primitive representation of a 'TyCon'. Defined here to</span><span>
</span><a name="line-1237"></a><span class="hs-comment">-- avoid module loops. Call this only on unlifted tycons.</span><span>
</span><a name="line-1238"></a><span class="hs-identifier">tyConPrimRep</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#PrimRep"><span class="hs-identifier hs-type">PrimRep</span></a><span>
</span><a name="line-1239"></a><a name="tyConPrimRep"><a href="Type.html#tyConPrimRep"><span class="hs-identifier">tyConPrimRep</span></a></a><span> </span><a name="local-1627612867"><a href="#local-1627612867"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#kindPrimRep"><span class="hs-identifier hs-var">kindPrimRep</span></a><span> </span><a href="#local-1627612868"><span class="hs-identifier hs-var">res_kind</span></a><span>
</span><a name="line-1240"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1241"></a><span>    </span><a name="local-1627612868"><a href="#local-1627612868"><span class="hs-identifier">res_kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConResKind</span><span> </span><a href="#local-1627612867"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1242"></a><span>
</span><a name="line-1243"></a><span class="hs-comment">-- | Take a kind (of shape @TYPE rr@) and produce the 'PrimRep' of values</span><span>
</span><a name="line-1244"></a><span class="hs-comment">-- of types of this kind.</span><span>
</span><a name="line-1245"></a><span class="hs-identifier">kindPrimRep</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#PrimRep"><span class="hs-identifier hs-type">PrimRep</span></a><span>
</span><a name="line-1246"></a><a name="kindPrimRep"><a href="Type.html#kindPrimRep"><span class="hs-identifier">kindPrimRep</span></a></a><span> </span><a name="local-1627612869"><a href="#local-1627612869"><span class="hs-identifier">ki</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612870"><a href="#local-1627612870"><span class="hs-identifier">ki'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreViewOneStarKind"><span class="hs-identifier hs-var">coreViewOneStarKind</span></a><span> </span><a href="#local-1627612869"><span class="hs-identifier hs-var">ki</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#kindPrimRep"><span class="hs-identifier hs-var">kindPrimRep</span></a><span> </span><a href="#local-1627612870"><span class="hs-identifier hs-var">ki'</span></a><span>
</span><a name="line-1247"></a><span class="hs-identifier">kindPrimRep</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627612871"><a href="#local-1627612871"><span class="hs-identifier">typ</span></a></a><span> </span><span class="hs-special">[</span><a name="local-1627612872"><a href="#local-1627612872"><span class="hs-identifier">runtime_rep</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1248"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">typ</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">hasKey</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tYPETyConKey</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1249"></a><span>    </span><a href="#local-1627612873"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612872"><span class="hs-identifier hs-var">runtime_rep</span></a><span>
</span><a name="line-1250"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1251"></a><span>    </span><a name="local-1627612873"><a href="#local-1627612873"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-1627612874"><a href="#local-1627612874"><span class="hs-identifier">rr</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612875"><a href="#local-1627612875"><span class="hs-identifier">rr'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612874"><span class="hs-identifier hs-var">rr</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612873"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612875"><span class="hs-identifier hs-var">rr'</span></a><span>
</span><a name="line-1252"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627612876"><a href="#local-1627612876"><span class="hs-identifier">rr_dc</span></a></a><span> </span><a name="local-1627612877"><a href="#local-1627612877"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1253"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#RuntimeRep"><span class="hs-identifier hs-var">RuntimeRep</span></a><span> </span><a name="local-1627612878"><a href="#local-1627612878"><span class="hs-identifier">fun</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#tyConRuntimeRepInfo"><span class="hs-identifier hs-var">tyConRuntimeRepInfo</span></a><span> </span><a href="#local-1627612876"><span class="hs-identifier hs-var">rr_dc</span></a><span>
</span><a name="line-1254"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612878"><span class="hs-identifier hs-var">fun</span></a><span> </span><a href="#local-1627612877"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1255"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627612879"><a href="#local-1627612879"><span class="hs-identifier">rr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;kindPrimRep.go&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612879"><span class="hs-identifier hs-var">rr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1256"></a><span class="hs-identifier">kindPrimRep</span><span> </span><a name="local-1627612880"><a href="#local-1627612880"><span class="hs-identifier">ki</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">WARN</span><span class="hs-special">(</span><span> </span><a href="Outputable.html#warnPprTrace"><span class="hs-identifier hs-var">True</span></a><span>
</span><a name="line-1257"></a><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;kindPrimRep defaulting to PtrRep on&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">ki</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1258"></a><span>                 </span><a href="TyCon.html#PtrRep"><span class="hs-identifier hs-var">PtrRep</span></a><span>  </span><span class="hs-comment">-- this can happen legitimately for, e.g., Any</span><span>
</span><a name="line-1259"></a><span>
</span><a name="line-1260"></a><span class="hs-identifier">typeRepArity</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#RepArity"><span class="hs-identifier hs-type">RepArity</span></a><span>
</span><a name="line-1261"></a><a name="typeRepArity"><a href="Type.html#typeRepArity"><span class="hs-identifier">typeRepArity</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1262"></a><span class="hs-identifier">typeRepArity</span><span> </span><a name="local-1627612881"><a href="#local-1627612881"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627612882"><a href="#local-1627612882"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#repType"><span class="hs-identifier hs-var">repType</span></a><span> </span><a href="#local-1627612882"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1263"></a><span>  </span><a href="Type.html#UnaryRep"><span class="hs-identifier hs-var">UnaryRep</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><a name="local-1627612883"><a href="#local-1627612883"><span class="hs-identifier">bndr</span></a></a><span> </span><a name="local-1627612884"><a href="#local-1627612884"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#flattenRepType"><span class="hs-identifier hs-var">flattenRepType</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#repType"><span class="hs-identifier hs-var">repType</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#binderType"><span class="hs-identifier hs-var">binderType</span></a><span> </span><a href="#local-1627612883"><span class="hs-identifier hs-var">bndr</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Type.html#typeRepArity"><span class="hs-identifier hs-var">typeRepArity</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612881"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-1627612884"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1264"></a><span>  </span><span class="hs-identifier">_</span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;typeRepArity: arity greater than type can handle&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612881"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612882"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#repType"><span class="hs-identifier hs-var">repType</span></a><span> </span><a href="#local-1627612882"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1265"></a><span>
</span><a name="line-1266"></a><span class="hs-identifier">isVoidTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1267"></a><span class="hs-comment">-- True if the type has zero width</span><span>
</span><a name="line-1268"></a><a name="isVoidTy"><a href="Type.html#isVoidTy"><span class="hs-identifier">isVoidTy</span></a></a><span> </span><a name="local-1627612885"><a href="#local-1627612885"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#repType"><span class="hs-identifier hs-var">repType</span></a><span> </span><a href="#local-1627612885"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1269"></a><span>                </span><a href="Type.html#UnaryRep"><span class="hs-identifier hs-var">UnaryRep</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627612886"><a href="#local-1627612886"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#isUnliftedTyCon"><span class="hs-identifier hs-var">isUnliftedTyCon</span></a><span> </span><a href="#local-1627612886"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>
</span><a name="line-1270"></a><span>                                            </span><a href="TyCon.html#isVoidRep"><span class="hs-identifier hs-var">isVoidRep</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#tyConPrimRep"><span class="hs-identifier hs-var">tyConPrimRep</span></a><span> </span><a href="#local-1627612886"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1271"></a><span>                </span><span class="hs-identifier">_</span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1272"></a><span>
</span><a name="line-1273"></a><span class="hs-comment">{-
Note [AppTy rep]
~~~~~~~~~~~~~~~~
Types of the form 'f a' must be of kind *, not #, so we are guaranteed
that they are represented by pointers.  The reason is that f must have
kind (kk -&gt; kk) and kk cannot be unlifted; see Note [The kind invariant]
in TyCoRep.

---------------------------------------------------------------------
                                ForAllTy
                                ~~~~~~~~
-}</span><span>
</span><a name="line-1285"></a><span>
</span><a name="line-1286"></a><span class="hs-identifier">mkForAllTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1287"></a><a name="mkForAllTy"><a href="Type.html#mkForAllTy"><span class="hs-identifier">mkForAllTy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span>
</span><a name="line-1288"></a><span>
</span><a name="line-1289"></a><span class="hs-comment">-- | Make a dependent forall.</span><span>
</span><a name="line-1290"></a><span class="hs-identifier">mkNamedForAllTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#VisibilityFlag"><span class="hs-identifier hs-type">VisibilityFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1291"></a><a name="mkNamedForAllTy"><a href="Type.html#mkNamedForAllTy"><span class="hs-identifier">mkNamedForAllTy</span></a></a><span> </span><a name="local-1627612887"><a href="#local-1627612887"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-1627612888"><a href="#local-1627612888"><span class="hs-identifier">vis</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier hs-var">tv</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1292"></a><span>                         </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a href="#local-1627612887"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-1627612888"><span class="hs-identifier hs-var">vis</span></a><span class="hs-special">)</span><span>
</span><a name="line-1293"></a><span>
</span><a name="line-1294"></a><span class="hs-comment">-- | Like mkForAllTys, but assumes all variables are dependent and invisible,</span><span>
</span><a name="line-1295"></a><span class="hs-comment">-- a common case</span><span>
</span><a name="line-1296"></a><span class="hs-identifier">mkInvForAllTys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1297"></a><a name="mkInvForAllTys"><a href="Type.html#mkInvForAllTys"><span class="hs-identifier">mkInvForAllTys</span></a></a><span> </span><a name="local-1627612889"><a href="#local-1627612889"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">all</span></a><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">tvs</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1298"></a><span>                     </span><a href="TyCoRep.html#mkForAllTys"><span class="hs-identifier hs-var">mkForAllTys</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a><span> </span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a href="TyCoRep.html#Invisible"><span class="hs-identifier hs-var">Invisible</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612889"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1299"></a><span>
</span><a name="line-1300"></a><span class="hs-comment">-- | Like mkForAllTys, but assumes all variables are dependent and specified,</span><span>
</span><a name="line-1301"></a><span class="hs-comment">-- a common case</span><span>
</span><a name="line-1302"></a><span class="hs-identifier">mkSpecForAllTys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1303"></a><a name="mkSpecForAllTys"><a href="Type.html#mkSpecForAllTys"><span class="hs-identifier">mkSpecForAllTys</span></a></a><span> </span><a name="local-1627612890"><a href="#local-1627612890"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">all</span></a><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">tvs</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1304"></a><span>                      </span><a href="TyCoRep.html#mkForAllTys"><span class="hs-identifier hs-var">mkForAllTys</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a><span> </span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a href="TyCoRep.html#Specified"><span class="hs-identifier hs-var">Specified</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612890"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1305"></a><span>
</span><a name="line-1306"></a><span class="hs-comment">-- | Like mkForAllTys, but assumes all variables are dependent and visible</span><span>
</span><a name="line-1307"></a><span class="hs-identifier">mkVisForAllTys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1308"></a><a name="mkVisForAllTys"><a href="Type.html#mkVisForAllTys"><span class="hs-identifier">mkVisForAllTys</span></a></a><span> </span><a name="local-1627612891"><a href="#local-1627612891"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">all</span></a><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">tvs</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1309"></a><span>                     </span><a href="TyCoRep.html#mkForAllTys"><span class="hs-identifier hs-var">mkForAllTys</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a><span> </span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a href="TyCoRep.html#Visible"><span class="hs-identifier hs-var">Visible</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612891"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1310"></a><span>
</span><a name="line-1311"></a><span class="hs-identifier">mkPiType</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1312"></a><span class="hs-comment">-- ^ Makes a @(-&gt;)@ type or an implicit forall type, depending</span><span>
</span><a name="line-1313"></a><span class="hs-comment">-- on whether it is given a type variable or a term variable.</span><span>
</span><a name="line-1314"></a><span class="hs-comment">-- This is used, for example, when producing the type of a lambda.</span><span>
</span><a name="line-1315"></a><span class="hs-comment">-- Always uses Invisible binders.</span><span>
</span><a name="line-1316"></a><span class="hs-identifier">mkPiTypes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1317"></a><span class="hs-comment">-- ^ 'mkPiType' for multiple type or value arguments</span><span>
</span><a name="line-1318"></a><span>
</span><a name="line-1319"></a><a name="mkPiType"><a href="Type.html#mkPiType"><span class="hs-identifier">mkPiType</span></a></a><span> </span><a name="local-1627612892"><a href="#local-1627612892"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-1627612893"><a href="#local-1627612893"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1320"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span> </span><a href="#local-1627612892"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkForAllTy"><span class="hs-identifier hs-var">mkForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a href="#local-1627612892"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="TyCoRep.html#Invisible"><span class="hs-identifier hs-var">Invisible</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612893"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1321"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkForAllTy"><span class="hs-identifier hs-var">mkForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">varType</span><span> </span><a href="#local-1627612892"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1627612893"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1322"></a><span>
</span><a name="line-1323"></a><a name="mkPiTypes"><a href="Type.html#mkPiTypes"><span class="hs-identifier">mkPiTypes</span></a></a><span> </span><a name="local-1627612894"><a href="#local-1627612894"><span class="hs-identifier">vs</span></a></a><span> </span><a name="local-1627612895"><a href="#local-1627612895"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="Type.html#mkPiType"><span class="hs-identifier hs-var">mkPiType</span></a><span> </span><a href="#local-1627612895"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1627612894"><span class="hs-identifier hs-var">vs</span></a><span>
</span><a name="line-1324"></a><span>
</span><a name="line-1325"></a><span class="hs-comment">-- | Given a list of type-level vars and a result type, makes TyBinders, preferring</span><span>
</span><a name="line-1326"></a><span class="hs-comment">-- anonymous binders if the variable is, in fact, not dependent.</span><span>
</span><a name="line-1327"></a><span class="hs-comment">-- All binders are /visible/.</span><span>
</span><a name="line-1328"></a><span class="hs-identifier">mkTyBindersPreferAnon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">]</span><span>
</span><a name="line-1329"></a><a name="mkTyBindersPreferAnon"><a href="Type.html#mkTyBindersPreferAnon"><span class="hs-identifier">mkTyBindersPreferAnon</span></a></a><span> </span><a name="local-1627612896"><a href="#local-1627612896"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-1627612897"><a href="#local-1627612897"><span class="hs-identifier">inner_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1627612898"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612896"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-1627612897"><span class="hs-identifier hs-var">inner_ty</span></a><span>
</span><a name="line-1330"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1331"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- also returns the free vars</span><span>
</span><a name="line-1332"></a><span>    </span><a name="local-1627612898"><a href="#local-1627612898"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-1627612899"><a href="#local-1627612899"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="#local-1627612899"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1333"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a name="local-1627612900"><a href="#local-1627612900"><span class="hs-identifier">v</span></a></a><span class="hs-glyph">:</span><a name="local-1627612901"><a href="#local-1627612901"><span class="hs-identifier">vs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612902"><a href="#local-1627612902"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span>  </span><a href="#local-1627612900"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#elemVarSet"><span class="hs-identifier hs-var">elemVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627612904"><span class="hs-identifier hs-var">fvs</span></a><span>
</span><a name="line-1334"></a><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a href="#local-1627612900"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="TyCoRep.html#Visible"><span class="hs-identifier hs-var">Visible</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1627612903"><span class="hs-identifier hs-var">binders</span></a><span>
</span><a name="line-1335"></a><span>                   </span><span class="hs-special">,</span><span> </span><a href="#local-1627612904"><span class="hs-identifier hs-var">fvs</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#delVarSet"><span class="hs-identifier hs-var">delVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627612900"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#unionVarSet"><span class="hs-identifier hs-var">unionVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627612905"><span class="hs-identifier hs-var">kind_vars</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1336"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1337"></a><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1627612900"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1627612903"><span class="hs-identifier hs-var">binders</span></a><span>
</span><a name="line-1338"></a><span>                   </span><span class="hs-special">,</span><span> </span><a href="#local-1627612904"><span class="hs-identifier hs-var">fvs</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#unionVarSet"><span class="hs-identifier hs-var">unionVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627612905"><span class="hs-identifier hs-var">kind_vars</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1339"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1340"></a><span>        </span><span class="hs-special">(</span><a name="local-1627612903"><a href="#local-1627612903"><span class="hs-identifier">binders</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627612904"><a href="#local-1627612904"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612898"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612901"><span class="hs-identifier hs-var">vs</span></a><span> </span><a href="#local-1627612902"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1341"></a><span>        </span><a name="local-1627612905"><a href="#local-1627612905"><span class="hs-identifier">kind_vars</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1627612900"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1342"></a><span>
</span><a name="line-1343"></a><span class="hs-comment">-- | Take a ForAllTy apart, returning the list of tyvars and the result type.</span><span>
</span><a name="line-1344"></a><span class="hs-comment">-- This always succeeds, even if it returns only an empty list. Note that the</span><span>
</span><a name="line-1345"></a><span class="hs-comment">-- result type returned may have free variables that were bound by a forall.</span><span>
</span><a name="line-1346"></a><span class="hs-identifier">splitForAllTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1347"></a><a name="splitForAllTys"><a href="Type.html#splitForAllTys"><span class="hs-identifier">splitForAllTys</span></a></a><span> </span><a name="local-1627612906"><a href="#local-1627612906"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612907"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-1627612906"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1627612906"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1348"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1349"></a><span>    </span><a name="local-1627612907"><a href="#local-1627612907"><span class="hs-identifier">split</span></a></a><span> </span><a name="local-1627612908"><a href="#local-1627612908"><span class="hs-identifier">orig_ty</span></a></a><span> </span><a name="local-1627612909"><a href="#local-1627612909"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612910"><a href="#local-1627612910"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612911"><a href="#local-1627612911"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612909"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612907"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-1627612908"><span class="hs-identifier hs-var">orig_ty</span></a><span> </span><a href="#local-1627612911"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-1627612910"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-1350"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1627612912"><a href="#local-1627612912"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-1627612913"><a href="#local-1627612913"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612914"><a href="#local-1627612914"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612907"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-1627612913"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1627612913"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612912"><span class="hs-identifier hs-var">tv</span></a><span class="hs-glyph">:</span><a href="#local-1627612914"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1351"></a><span>    </span><span class="hs-identifier">split</span><span> </span><a name="local-1627612915"><a href="#local-1627612915"><span class="hs-identifier">orig_ty</span></a></a><span> </span><span class="hs-identifier">_</span><span>                          </span><a name="local-1627612916"><a href="#local-1627612916"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-1627612916"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612915"><span class="hs-identifier hs-var">orig_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1352"></a><span>
</span><a name="line-1353"></a><span class="hs-comment">-- | Split off all TyBinders to a type, splitting both proper foralls</span><span>
</span><a name="line-1354"></a><span class="hs-comment">-- and functions</span><span>
</span><a name="line-1355"></a><span class="hs-identifier">splitPiTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1356"></a><a name="splitPiTys"><a href="Type.html#splitPiTys"><span class="hs-identifier">splitPiTys</span></a></a><span> </span><a name="local-1627612917"><a href="#local-1627612917"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612918"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-1627612917"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1627612917"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1357"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1358"></a><span>    </span><a name="local-1627612918"><a href="#local-1627612918"><span class="hs-identifier">split</span></a></a><span> </span><a name="local-1627612919"><a href="#local-1627612919"><span class="hs-identifier">orig_ty</span></a></a><span> </span><a name="local-1627612920"><a href="#local-1627612920"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612921"><a href="#local-1627612921"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612922"><a href="#local-1627612922"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612920"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612918"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-1627612919"><span class="hs-identifier hs-var">orig_ty</span></a><span> </span><a href="#local-1627612922"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-1627612921"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-1359"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><a name="local-1627612923"><a href="#local-1627612923"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1627612924"><a href="#local-1627612924"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612925"><a href="#local-1627612925"><span class="hs-identifier">bs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612918"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-1627612924"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-1627612924"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612923"><span class="hs-identifier hs-var">b</span></a><span class="hs-glyph">:</span><a href="#local-1627612925"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1360"></a><span>    </span><span class="hs-identifier">split</span><span> </span><a name="local-1627612926"><a href="#local-1627612926"><span class="hs-identifier">orig_ty</span></a></a><span> </span><span class="hs-identifier">_</span><span>                </span><a name="local-1627612927"><a href="#local-1627612927"><span class="hs-identifier">bs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-1627612927"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612926"><span class="hs-identifier hs-var">orig_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1361"></a><span>
</span><a name="line-1362"></a><span class="hs-comment">-- | Like 'splitPiTys' but split off only /named/ binders.</span><span>
</span><a name="line-1363"></a><span class="hs-identifier">splitNamedPiTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1364"></a><a name="splitNamedPiTys"><a href="Type.html#splitNamedPiTys"><span class="hs-identifier">splitNamedPiTys</span></a></a><span> </span><a name="local-1627612928"><a href="#local-1627612928"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612929"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-1627612928"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1627612928"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1365"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1366"></a><span>    </span><a name="local-1627612929"><a href="#local-1627612929"><span class="hs-identifier">split</span></a></a><span> </span><a name="local-1627612930"><a href="#local-1627612930"><span class="hs-identifier">orig_ty</span></a></a><span> </span><a name="local-1627612931"><a href="#local-1627612931"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612932"><a href="#local-1627612932"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612933"><a href="#local-1627612933"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612931"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612929"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-1627612930"><span class="hs-identifier hs-var">orig_ty</span></a><span> </span><a href="#local-1627612933"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-1627612932"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-1367"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><a name="local-1627612934"><a href="#local-1627612934"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-1627612935"><a href="#local-1627612935"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612936"><a href="#local-1627612936"><span class="hs-identifier">bs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612929"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-1627612935"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-1627612935"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612934"><span class="hs-identifier hs-var">b</span></a><span class="hs-glyph">:</span><a href="#local-1627612936"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1368"></a><span>    </span><span class="hs-identifier">split</span><span> </span><a name="local-1627612937"><a href="#local-1627612937"><span class="hs-identifier">orig_ty</span></a></a><span> </span><span class="hs-identifier">_</span><span>                           </span><a name="local-1627612938"><a href="#local-1627612938"><span class="hs-identifier">bs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-1627612938"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612937"><span class="hs-identifier hs-var">orig_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1369"></a><span>
</span><a name="line-1370"></a><span class="hs-comment">-- | Checks whether this is a proper forall (with a named binder)</span><span>
</span><a name="line-1371"></a><span class="hs-identifier">isForAllTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1372"></a><a name="isForAllTy"><a href="Type.html#isForAllTy"><span class="hs-identifier">isForAllTy</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1373"></a><span class="hs-identifier">isForAllTy</span><span> </span><span class="hs-identifier">_</span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1374"></a><span>
</span><a name="line-1375"></a><span class="hs-comment">-- | Is this a function or forall?</span><span>
</span><a name="line-1376"></a><span class="hs-identifier">isPiTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1377"></a><a name="isPiTy"><a href="Type.html#isPiTy"><span class="hs-identifier">isPiTy</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1378"></a><span class="hs-identifier">isPiTy</span><span> </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1379"></a><span>
</span><a name="line-1380"></a><span class="hs-comment">-- | Take a forall type apart, or panics if that is not possible.</span><span>
</span><a name="line-1381"></a><span class="hs-identifier">splitForAllTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1382"></a><a name="splitForAllTy"><a href="Type.html#splitForAllTy"><span class="hs-identifier">splitForAllTy</span></a></a><span> </span><a name="local-1627612939"><a href="#local-1627612939"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1383"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612940"><a href="#local-1627612940"><span class="hs-identifier">answer</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitForAllTy_maybe"><span class="hs-identifier hs-var">splitForAllTy_maybe</span></a><span> </span><a href="#local-1627612939"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612940"><span class="hs-identifier hs-var">answer</span></a><span>
</span><a name="line-1384"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                             </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;splitForAllTy&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612939"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1385"></a><span>
</span><a name="line-1386"></a><span class="hs-comment">-- | Attempts to take a forall type apart, but only if it's a proper forall,</span><span>
</span><a name="line-1387"></a><span class="hs-comment">-- with a named binder</span><span>
</span><a name="line-1388"></a><span class="hs-identifier">splitForAllTy_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1389"></a><a name="splitForAllTy_maybe"><a href="Type.html#splitForAllTy_maybe"><span class="hs-identifier">splitForAllTy_maybe</span></a></a><span> </span><a name="local-1627612941"><a href="#local-1627612941"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612942"><span class="hs-identifier hs-var">splitFAT_m</span></a><span> </span><a href="#local-1627612941"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1390"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1391"></a><span>    </span><a name="local-1627612942"><a href="#local-1627612942"><span class="hs-identifier">splitFAT_m</span></a></a><span> </span><a name="local-1627612943"><a href="#local-1627612943"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612944"><a href="#local-1627612944"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612943"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612942"><span class="hs-identifier hs-var">splitFAT_m</span></a><span> </span><a href="#local-1627612944"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1392"></a><span>    </span><span class="hs-identifier">splitFAT_m</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1627612945"><a href="#local-1627612945"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-1627612946"><a href="#local-1627612946"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612945"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612946"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1393"></a><span>    </span><span class="hs-identifier">splitFAT_m</span><span> </span><span class="hs-identifier">_</span><span>                          </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1394"></a><span>
</span><a name="line-1395"></a><span class="hs-comment">-- | Attempts to take a forall type apart; works with proper foralls and</span><span>
</span><a name="line-1396"></a><span class="hs-comment">-- functions</span><span>
</span><a name="line-1397"></a><span class="hs-identifier">splitPiTy_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1398"></a><a name="splitPiTy_maybe"><a href="Type.html#splitPiTy_maybe"><span class="hs-identifier">splitPiTy_maybe</span></a></a><span> </span><a name="local-1627612947"><a href="#local-1627612947"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612948"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612947"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1399"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1400"></a><span>    </span><a name="local-1627612948"><a href="#local-1627612948"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-1627612949"><a href="#local-1627612949"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612950"><a href="#local-1627612950"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612949"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612948"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612950"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1401"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><a name="local-1627612951"><a href="#local-1627612951"><span class="hs-identifier">bndr</span></a></a><span> </span><a name="local-1627612952"><a href="#local-1627612952"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612951"><span class="hs-identifier hs-var">bndr</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612952"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1402"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1403"></a><span>
</span><a name="line-1404"></a><span class="hs-comment">-- | Takes a forall type apart, or panics</span><span>
</span><a name="line-1405"></a><span class="hs-identifier">splitPiTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1406"></a><a name="splitPiTy"><a href="Type.html#splitPiTy"><span class="hs-identifier">splitPiTy</span></a></a><span> </span><a name="local-1627612953"><a href="#local-1627612953"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1407"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612954"><a href="#local-1627612954"><span class="hs-identifier">answer</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitPiTy_maybe"><span class="hs-identifier hs-var">splitPiTy_maybe</span></a><span> </span><a href="#local-1627612953"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612954"><span class="hs-identifier hs-var">answer</span></a><span>
</span><a name="line-1408"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                         </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;splitPiTy&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612953"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1409"></a><span>
</span><a name="line-1410"></a><span class="hs-comment">-- | Drops all non-anonymous ForAllTys</span><span>
</span><a name="line-1411"></a><span class="hs-identifier">dropForAlls</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1412"></a><a name="dropForAlls"><a href="Type.html#dropForAlls"><span class="hs-identifier">dropForAlls</span></a></a><span> </span><a name="local-1627612955"><a href="#local-1627612955"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612959"><a href="#local-1627612959"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612955"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#dropForAlls"><span class="hs-identifier hs-var">dropForAlls</span></a><span> </span><a href="#local-1627612959"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1413"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612956"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612955"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1414"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1415"></a><span>    </span><a name="local-1627612956"><a href="#local-1627612956"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-1627612957"><a href="#local-1627612957"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612956"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612957"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-1416"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627612958"><a href="#local-1627612958"><span class="hs-identifier">res</span></a></a><span>                       </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612958"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-1417"></a><span>
</span><a name="line-1418"></a><span class="hs-comment">-- | Given a tycon and its arguments, filters out any invisible arguments</span><span>
</span><a name="line-1419"></a><span class="hs-identifier">filterOutInvisibleTypes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-1420"></a><a name="filterOutInvisibleTypes"><a href="Type.html#filterOutInvisibleTypes"><span class="hs-identifier">filterOutInvisibleTypes</span></a></a><span> </span><a name="local-1627612960"><a href="#local-1627612960"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627612961"><a href="#local-1627612961"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#partitionInvisibles"><span class="hs-identifier hs-var">partitionInvisibles</span></a><span> </span><a href="#local-1627612960"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-1627612961"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1421"></a><span>
</span><a name="line-1422"></a><span class="hs-comment">-- | Like 'filterOutInvisibles', but works on 'TyVar's</span><span>
</span><a name="line-1423"></a><span class="hs-identifier">filterOutInvisibleTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-1424"></a><a name="filterOutInvisibleTyVars"><a href="Type.html#filterOutInvisibleTyVars"><span class="hs-identifier">filterOutInvisibleTyVars</span></a></a><span> </span><a name="local-1627612962"><a href="#local-1627612962"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627612963"><a href="#local-1627612963"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#partitionInvisibles"><span class="hs-identifier hs-var">partitionInvisibles</span></a><span> </span><a href="#local-1627612962"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span> </span><a href="#local-1627612963"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-1425"></a><span>
</span><a name="line-1426"></a><span class="hs-comment">-- | Given a tycon and a list of things (which correspond to arguments),</span><span>
</span><a name="line-1427"></a><span class="hs-comment">-- partitions the things into the invisible ones and the visible ones.</span><span>
</span><a name="line-1428"></a><span class="hs-comment">-- The callback function is necessary for this scenario:</span><span>
</span><a name="line-1429"></a><span class="hs-comment">--</span><span>
</span><a name="line-1430"></a><span class="hs-comment">-- &gt; T :: forall k. k -&gt; k</span><span>
</span><a name="line-1431"></a><span class="hs-comment">-- &gt; partitionInvisibles T [forall m. m -&gt; m -&gt; m, S, R, Q]</span><span>
</span><a name="line-1432"></a><span class="hs-comment">--</span><span>
</span><a name="line-1433"></a><span class="hs-comment">-- After substituting, we get</span><span>
</span><a name="line-1434"></a><span class="hs-comment">--</span><span>
</span><a name="line-1435"></a><span class="hs-comment">-- &gt; T (forall m. m -&gt; m -&gt; m) :: (forall m. m -&gt; m -&gt; m) -&gt; forall n. n -&gt; n -&gt; n</span><span>
</span><a name="line-1436"></a><span class="hs-comment">--</span><span>
</span><a name="line-1437"></a><span class="hs-comment">-- Thus, the first argument is invisible, @S@ is visible, @R@ is invisible again,</span><span>
</span><a name="line-1438"></a><span class="hs-comment">-- and @Q@ is visible.</span><span>
</span><a name="line-1439"></a><span class="hs-comment">--</span><span>
</span><a name="line-1440"></a><span class="hs-comment">-- If you're absolutely sure that your tycon's kind doesn't end in a variable,</span><span>
</span><a name="line-1441"></a><span class="hs-comment">-- it's OK if the callback function panics, as that's the only time it's</span><span>
</span><a name="line-1442"></a><span class="hs-comment">-- consulted.</span><span>
</span><a name="line-1443"></a><span class="hs-identifier">partitionInvisibles</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627612367"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627612367"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-1627612367"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-1627612367"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1444"></a><a name="partitionInvisibles"><a href="Type.html#partitionInvisibles"><span class="hs-identifier">partitionInvisibles</span></a></a><span> </span><a name="local-1627612964"><a href="#local-1627612964"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627612965"><a href="#local-1627612965"><span class="hs-identifier">get_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612966"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="TyCoRep.html#emptyTCvSubst"><span class="hs-identifier hs-var">emptyTCvSubst</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConKind</span><span> </span><a href="#local-1627612964"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1445"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1446"></a><span>    </span><a name="local-1627612966"><a href="#local-1627612966"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1447"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627612967"><a href="#local-1627612967"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><a name="local-1627612968"><a href="#local-1627612968"><span class="hs-identifier">bndr</span></a></a><span> </span><a name="local-1627612969"><a href="#local-1627612969"><span class="hs-identifier">res_ki</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-1627612970"><a href="#local-1627612970"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-1627612971"><a href="#local-1627612971"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1448"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#isVisibleBinder"><span class="hs-identifier hs-var">isVisibleBinder</span></a><span> </span><a href="#local-1627612968"><span class="hs-identifier hs-var">bndr</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612970"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627612966"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612972"><span class="hs-identifier hs-var">subst'</span></a><span> </span><a href="#local-1627612969"><span class="hs-identifier hs-var">res_ki</span></a><span> </span><a href="#local-1627612971"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1449"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#first"><span class="hs-identifier hs-var">first</span></a><span>  </span><span class="hs-special">(</span><a href="#local-1627612970"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627612966"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612972"><span class="hs-identifier hs-var">subst'</span></a><span> </span><a href="#local-1627612969"><span class="hs-identifier hs-var">res_ki</span></a><span> </span><a href="#local-1627612971"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1450"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1451"></a><span>        </span><a name="local-1627612972"><a href="#local-1627612972"><span class="hs-identifier">subst'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#extendTvSubstBinder"><span class="hs-identifier hs-var">extendTvSubstBinder</span></a><span> </span><a href="#local-1627612967"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612968"><span class="hs-identifier hs-var">bndr</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612965"><span class="hs-identifier hs-var">get_ty</span></a><span> </span><a href="#local-1627612970"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1452"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627612973"><a href="#local-1627612973"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-1627612974"><a href="#local-1627612974"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612975"><a href="#local-1627612975"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-1453"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612976"><a href="#local-1627612976"><span class="hs-identifier">ki</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCoRep.html#lookupTyVar"><span class="hs-identifier hs-var">lookupTyVar</span></a><span> </span><a href="#local-1627612973"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612974"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612966"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627612973"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1627612976"><span class="hs-identifier hs-var">ki</span></a><span> </span><a href="#local-1627612975"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1454"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627612977"><a href="#local-1627612977"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-1627612977"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- something is ill-kinded. But this can happen</span><span>
</span><a name="line-1455"></a><span>                          </span><span class="hs-comment">-- when printing errors. Assume everything is visible.</span><span>
</span><a name="line-1456"></a><span>
</span><a name="line-1457"></a><span class="hs-comment">-- like splitPiTys, but returns only *invisible* binders, including constraints</span><span>
</span><a name="line-1458"></a><span class="hs-identifier">splitPiTysInvisible</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1459"></a><a name="splitPiTysInvisible"><a href="Type.html#splitPiTysInvisible"><span class="hs-identifier">splitPiTysInvisible</span></a></a><span> </span><a name="local-1627612978"><a href="#local-1627612978"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612979"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-1627612978"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1627612978"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1460"></a><span>   </span><span class="hs-keyword">where</span><span>
</span><a name="line-1461"></a><span>     </span><a name="local-1627612979"><a href="#local-1627612979"><span class="hs-identifier">split</span></a></a><span> </span><a name="local-1627612980"><a href="#local-1627612980"><span class="hs-identifier">orig_ty</span></a></a><span> </span><a name="local-1627612981"><a href="#local-1627612981"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627612982"><a href="#local-1627612982"><span class="hs-identifier">bndrs</span></a></a><span>
</span><a name="line-1462"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627612983"><a href="#local-1627612983"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627612981"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612979"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-1627612980"><span class="hs-identifier hs-var">orig_ty</span></a><span> </span><a href="#local-1627612983"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-1627612982"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1463"></a><span>     </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><a name="local-1627612984"><a href="#local-1627612984"><span class="hs-identifier">bndr</span></a></a><span> </span><a name="local-1627612985"><a href="#local-1627612985"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627612986"><a href="#local-1627612986"><span class="hs-identifier">bndrs</span></a></a><span>
</span><a name="line-1464"></a><span>       </span><span class="hs-glyph">|</span><span>  </span><a href="TyCoRep.html#isInvisibleBinder"><span class="hs-identifier hs-var">isInvisibleBinder</span></a><span> </span><a href="#local-1627612984"><span class="hs-identifier hs-var">bndr</span></a><span>
</span><a name="line-1465"></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612979"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-1627612985"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1627612985"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627612984"><span class="hs-identifier hs-var">bndr</span></a><span class="hs-glyph">:</span><a href="#local-1627612986"><span class="hs-identifier hs-var">bndrs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1466"></a><span>
</span><a name="line-1467"></a><span>     </span><span class="hs-identifier">split</span><span> </span><a name="local-1627612987"><a href="#local-1627612987"><span class="hs-identifier">orig_ty</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627612988"><a href="#local-1627612988"><span class="hs-identifier">bndrs</span></a></a><span>
</span><a name="line-1468"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-1627612988"><span class="hs-identifier hs-var">bndrs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627612987"><span class="hs-identifier hs-var">orig_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1469"></a><span>
</span><a name="line-1470"></a><span class="hs-identifier">applyTysX</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1471"></a><span class="hs-comment">-- applyTyxX beta-reduces (/\tvs. body_ty) arg_tys</span><span>
</span><a name="line-1472"></a><span class="hs-comment">-- Assumes that (/\tvs. body_ty) is closed</span><span>
</span><a name="line-1473"></a><a name="applyTysX"><a href="Type.html#applyTysX"><span class="hs-identifier">applyTysX</span></a></a><span> </span><a name="local-1627612989"><a href="#local-1627612989"><span class="hs-identifier">tvs</span></a></a><span> </span><a name="local-1627612990"><a href="#local-1627612990"><span class="hs-identifier">body_ty</span></a></a><span> </span><a name="local-1627612991"><a href="#local-1627612991"><span class="hs-identifier">arg_tys</span></a></a><span>
</span><a name="line-1474"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">arg_tys</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-operator hs-var">&gt;=</span></a><span> </span><span class="hs-identifier">n_tvs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pp_stuff</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1475"></a><span>    </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">tyCoVarsOfType</span><span> </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">body_ty</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">subVarSet</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">mkVarSet</span><span> </span><a href="VarSet.html#subVarSet"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pp_stuff</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1476"></a><span>    </span><a href="Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTyWith"><span class="hs-identifier hs-var">substTyWith</span></a><span> </span><a href="#local-1627612989"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-1627612993"><span class="hs-identifier hs-var">n_tvs</span></a><span> </span><a href="#local-1627612991"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627612990"><span class="hs-identifier hs-var">body_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1477"></a><span>             </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#drop"><span class="hs-identifier hs-var">drop</span></a><span> </span><a href="#local-1627612993"><span class="hs-identifier hs-var">n_tvs</span></a><span> </span><a href="#local-1627612991"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1478"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1479"></a><span>    </span><a name="local-1627612992"><a href="#local-1627612992"><span class="hs-identifier">pp_stuff</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612989"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612990"><span class="hs-identifier hs-var">body_ty</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627612991"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">]</span><span>
</span><a name="line-1480"></a><span>    </span><a name="local-1627612993"><a href="#local-1627612993"><span class="hs-identifier">n_tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1627612989"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-1481"></a><span>
</span><a name="line-1482"></a><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
   TyBinders
%*                                                                      *
%************************************************************************
-}</span><span>
</span><a name="line-1489"></a><span>
</span><a name="line-1490"></a><span class="hs-comment">-- | Make a named binder</span><span>
</span><a name="line-1491"></a><span class="hs-identifier">mkNamedBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#VisibilityFlag"><span class="hs-identifier hs-type">VisibilityFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span>
</span><a name="line-1492"></a><a name="mkNamedBinder"><a href="Type.html#mkNamedBinder"><span class="hs-identifier">mkNamedBinder</span></a></a><span> </span><a name="local-1627612994"><a href="#local-1627612994"><span class="hs-identifier">vis</span></a></a><span> </span><a name="local-1627612995"><a href="#local-1627612995"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a href="#local-1627612995"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-1627612994"><span class="hs-identifier hs-var">vis</span></a><span>
</span><a name="line-1493"></a><span>
</span><a name="line-1494"></a><span class="hs-comment">-- | Make an anonymous binder</span><span>
</span><a name="line-1495"></a><span class="hs-identifier">mkAnonBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span>
</span><a name="line-1496"></a><a name="mkAnonBinder"><a href="Type.html#mkAnonBinder"><span class="hs-identifier">mkAnonBinder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span>
</span><a name="line-1497"></a><span>
</span><a name="line-1498"></a><span class="hs-comment">-- | Does this binder bind a variable that is /not/ erased? Returns</span><span>
</span><a name="line-1499"></a><span class="hs-comment">-- 'True' for anonymous binders.</span><span>
</span><a name="line-1500"></a><span class="hs-identifier">isIdLikeBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1501"></a><a name="isIdLikeBinder"><a href="Type.html#isIdLikeBinder"><span class="hs-identifier">isIdLikeBinder</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1502"></a><span class="hs-identifier">isIdLikeBinder</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1503"></a><span>
</span><a name="line-1504"></a><span class="hs-comment">-- | Does this type, when used to the left of an arrow, require</span><span>
</span><a name="line-1505"></a><span class="hs-comment">-- a visible argument? This checks to see if the kind of the type</span><span>
</span><a name="line-1506"></a><span class="hs-comment">-- is constraint.</span><span>
</span><a name="line-1507"></a><span class="hs-identifier">isVisibleType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1508"></a><a name="isVisibleType"><a href="Type.html#isVisibleType"><span class="hs-identifier">isVisibleType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Type.html#isPredTy"><span class="hs-identifier hs-var">isPredTy</span></a><span>
</span><a name="line-1509"></a><span>
</span><a name="line-1510"></a><span class="hs-identifier">binderVisibility</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#VisibilityFlag"><span class="hs-identifier hs-type">VisibilityFlag</span></a><span>
</span><a name="line-1511"></a><a name="binderVisibility"><a href="Type.html#binderVisibility"><span class="hs-identifier">binderVisibility</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627612996"><a href="#local-1627612996"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612996"><span class="hs-identifier hs-var">vis</span></a><span>
</span><a name="line-1512"></a><span class="hs-identifier">binderVisibility</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627612997"><a href="#local-1627612997"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1513"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Type.html#isVisibleType"><span class="hs-identifier hs-var">isVisibleType</span></a><span> </span><a href="#local-1627612997"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Visible"><span class="hs-identifier hs-var">Visible</span></a><span>
</span><a name="line-1514"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Invisible"><span class="hs-identifier hs-var">Invisible</span></a><span>
</span><a name="line-1515"></a><span>
</span><a name="line-1516"></a><span class="hs-comment">-- | Extract a bound variable in a binder, if any</span><span>
</span><a name="line-1517"></a><span class="hs-identifier">binderVar_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>
</span><a name="line-1518"></a><a name="binderVar_maybe"><a href="Type.html#binderVar_maybe"><span class="hs-identifier">binderVar_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1627612998"><a href="#local-1627612998"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627612998"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1519"></a><span class="hs-identifier">binderVar_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1520"></a><span>
</span><a name="line-1521"></a><span class="hs-comment">-- | Extract a bound variable in a binder, or panics</span><span>
</span><a name="line-1522"></a><span class="hs-identifier">binderVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>   </span><span class="hs-comment">-- ^ printed if there is a panic</span><span>
</span><a name="line-1523"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>
</span><a name="line-1524"></a><a name="binderVar"><a href="Type.html#binderVar"><span class="hs-identifier">binderVar</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1627612999"><a href="#local-1627612999"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627612999"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1525"></a><span class="hs-identifier">binderVar</span><span> </span><a name="local-1627613000"><a href="#local-1627613000"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627613001"><a href="#local-1627613001"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;binderVar (&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627613000"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627613001"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-1526"></a><span>
</span><a name="line-1527"></a><span class="hs-comment">-- | Extract a relevant type, if there is one.</span><span>
</span><a name="line-1528"></a><span class="hs-identifier">binderRelevantType_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1529"></a><a name="binderRelevantType_maybe"><a href="Type.html#binderRelevantType_maybe"><span class="hs-identifier">binderRelevantType_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1530"></a><span class="hs-identifier">binderRelevantType_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627613002"><a href="#local-1627613002"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627613002"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1531"></a><span>
</span><a name="line-1532"></a><span class="hs-comment">-- | Like 'maybe', but for binders.</span><span>
</span><a name="line-1533"></a><span class="hs-identifier">caseBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span>       </span><span class="hs-comment">-- ^ binder to scrutinize</span><span>
</span><a name="line-1534"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612366"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ named case</span><span>
</span><a name="line-1535"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612366"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ anonymous case</span><span>
</span><a name="line-1536"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627612366"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1537"></a><a name="caseBinder"><a href="Type.html#caseBinder"><span class="hs-identifier">caseBinder</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1627613003"><a href="#local-1627613003"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-1627613004"><a href="#local-1627613004"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613004"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627613003"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1538"></a><span class="hs-identifier">caseBinder</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627613005"><a href="#local-1627613005"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627613006"><a href="#local-1627613006"><span class="hs-identifier">d</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613006"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-1627613005"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1539"></a><span>
</span><a name="line-1540"></a><span class="hs-comment">-- | Break apart a list of binders into tyvars and anonymous types.</span><span>
</span><a name="line-1541"></a><span class="hs-identifier">partitionBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1542"></a><a name="partitionBinders"><a href="Type.html#partitionBinders"><span class="hs-identifier">partitionBinders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#partitionWith"><span class="hs-identifier hs-var">partitionWith</span></a><span> </span><a href="#local-1627613007"><span class="hs-identifier hs-var">named_or_anon</span></a><span>
</span><a name="line-1543"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1544"></a><span>    </span><a name="local-1627613007"><a href="#local-1627613007"><span class="hs-identifier">named_or_anon</span></a></a><span> </span><a name="local-1627613008"><a href="#local-1627613008"><span class="hs-identifier">bndr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#caseBinder"><span class="hs-identifier hs-var">caseBinder</span></a><span> </span><a href="#local-1627613008"><span class="hs-identifier hs-var">bndr</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span>
</span><a name="line-1545"></a><span>
</span><a name="line-1546"></a><span class="hs-comment">-- | Break apart a list of binders into a list of named binders and</span><span>
</span><a name="line-1547"></a><span class="hs-comment">-- a list of anonymous types.</span><span>
</span><a name="line-1548"></a><span class="hs-identifier">partitionBindersIntoBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1549"></a><a name="partitionBindersIntoBinders"><a href="Type.html#partitionBindersIntoBinders"><span class="hs-identifier">partitionBindersIntoBinders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#partitionWith"><span class="hs-identifier hs-var">partitionWith</span></a><span> </span><a href="#local-1627613009"><span class="hs-identifier hs-var">named_or_anon</span></a><span>
</span><a name="line-1550"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1551"></a><span>    </span><a name="local-1627613009"><a href="#local-1627613009"><span class="hs-identifier">named_or_anon</span></a></a><span> </span><a name="local-1627613010"><a href="#local-1627613010"><span class="hs-identifier">bndr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#caseBinder"><span class="hs-identifier hs-var">caseBinder</span></a><span> </span><a href="#local-1627613010"><span class="hs-identifier hs-var">bndr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a href="#local-1627613010"><span class="hs-identifier hs-var">bndr</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span>
</span><a name="line-1552"></a><span>
</span><a name="line-1553"></a><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
                         Pred
*                                                                      *
************************************************************************

Predicates on PredType

Note [isPredTy complications]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
You would think that we could define
  isPredTy ty = isConstraintKind (typeKind ty)
But there are a number of complications:

* isPredTy is used when printing types, which can happen in debug
  printing during type checking of not-fully-zonked types.  So it's
  not cool to say isConstraintKind (typeKind ty) because, absent
  zonking, the type might be ill-kinded, and typeKind crashes. Hence the
  rather tiresome story here

* isPredTy must return &quot;True&quot; to *unlifted* coercions, such as (t1 ~# t2)
  and (t1 ~R# t2), which are not of kind Constraint!  Currently they are
  of kind #.

* If we do form the type '(C a =&gt; C [a]) =&gt; blah', then we'd like to
  print it as such. But that means that isPredTy must return True for
  (C a =&gt; C [a]).  Admittedly that type is illegal in Haskell, but we
  want to print it nicely in error messages.
-}</span><span>
</span><a name="line-1583"></a><span>
</span><a name="line-1584"></a><span class="hs-comment">-- | Is the type suitable to classify a given/wanted in the typechecker?</span><span>
</span><a name="line-1585"></a><span class="hs-identifier">isPredTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1586"></a><span class="hs-comment">-- See Note [isPredTy complications]</span><span>
</span><a name="line-1587"></a><a name="isPredTy"><a href="Type.html#isPredTy"><span class="hs-identifier">isPredTy</span></a></a><span> </span><a name="local-1627613011"><a href="#local-1627613011"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613012"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613011"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1588"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1589"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#KindOrType"><span class="hs-identifier hs-type">KindOrType</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1590"></a><span>    </span><a name="local-1627613012"><a href="#local-1627613012"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1627613015"><a href="#local-1627613015"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1627613016"><a href="#local-1627613016"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>   </span><a name="local-1627613017"><a href="#local-1627613017"><span class="hs-identifier">args</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613012"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613015"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627613016"><span class="hs-identifier hs-var">ty2</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1627613017"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-1591"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-1627613018"><a href="#local-1627613018"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>      </span><a name="local-1627613019"><a href="#local-1627613019"><span class="hs-identifier">args</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613014"><span class="hs-identifier hs-var">go_k</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1627613018"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627613019"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1592"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627613020"><a href="#local-1627613020"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627613021"><a href="#local-1627613021"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627613022"><a href="#local-1627613022"><span class="hs-identifier">args</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-identifier">args</span><span> </span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- TyConApp invariant</span><span>
</span><a name="line-1593"></a><span>                                      </span><a href="#local-1627613013"><span class="hs-identifier hs-var">go_tc</span></a><span> </span><a href="#local-1627613020"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-1627613021"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1594"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627613023"><a href="#local-1627613023"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627613024"><a href="#local-1627613024"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1595"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="Type.html#isPredTy"><span class="hs-identifier hs-var">isPredTy</span></a><span> </span><a href="#local-1627613023"><span class="hs-identifier hs-var">arg</span></a><span>                </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isPredTy"><span class="hs-identifier hs-var">isPredTy</span></a><span> </span><a href="#local-1627613024"><span class="hs-identifier hs-var">res</span></a><span>   </span><span class="hs-comment">-- (Eq a =&gt; C a)</span><span>
</span><a name="line-1596"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>          </span><span class="hs-comment">-- (Int -&gt; Bool)</span><span>
</span><a name="line-1597"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-1627613025"><a href="#local-1627613025"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613012"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613025"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1598"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1599"></a><span>
</span><a name="line-1600"></a><span>    </span><span class="hs-identifier">go_tc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#KindOrType"><span class="hs-identifier hs-type">KindOrType</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1601"></a><span>    </span><a name="local-1627613013"><a href="#local-1627613013"><span class="hs-identifier">go_tc</span></a></a><span> </span><a name="local-1627613026"><a href="#local-1627613026"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627613027"><a href="#local-1627613027"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-1602"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627613026"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqPrimTyConKey"><span class="hs-identifier hs-var">eqPrimTyConKey</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-1627613026"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqReprPrimTyConKey"><span class="hs-identifier hs-var">eqReprPrimTyConKey</span></a><span>
</span><a name="line-1603"></a><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1627613027"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">4</span><span>  </span><span class="hs-comment">-- ~# and ~R# sadly have result kind #</span><span>
</span><a name="line-1604"></a><span>                                      </span><span class="hs-comment">-- not Contraint; but we still want</span><span>
</span><a name="line-1605"></a><span>                                      </span><span class="hs-comment">-- isPredTy to reply True.</span><span>
</span><a name="line-1606"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613014"><span class="hs-identifier hs-var">go_k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConKind</span><span> </span><a href="#local-1627613026"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627613027"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1607"></a><span>
</span><a name="line-1608"></a><span>    </span><span class="hs-identifier">go_k</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#KindOrType"><span class="hs-identifier hs-type">KindOrType</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1609"></a><span>    </span><span class="hs-comment">-- True &lt;=&gt; ('k' applied to 'kts') = Constraint</span><span>
</span><a name="line-1610"></a><span>    </span><a name="local-1627613014"><a href="#local-1627613014"><span class="hs-identifier">go_k</span></a></a><span> </span><a name="local-1627613028"><a href="#local-1627613028"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-1627613029"><a href="#local-1627613029"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Kind.html#isConstraintKind"><span class="hs-identifier hs-var">isConstraintKind</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a><span> </span><a href="#local-1627613028"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-1627613029"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-1611"></a><span>
</span><a name="line-1612"></a><span class="hs-identifier">isClassPred</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">isEqPred</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">isNomEqPred</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">isIPPred</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1613"></a><a name="isClassPred"><a href="Type.html#isClassPred"><span class="hs-identifier">isClassPred</span></a></a><span> </span><a name="local-1627613030"><a href="#local-1627613030"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a><span> </span><a href="#local-1627613030"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1614"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627613031"><a href="#local-1627613031"><span class="hs-identifier">tyCon</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isClassTyCon"><span class="hs-identifier hs-var">isClassTyCon</span></a><span> </span><a href="#local-1627613031"><span class="hs-identifier hs-var">tyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1615"></a><span>    </span><span class="hs-identifier">_</span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1616"></a><a name="isEqPred"><a href="Type.html#isEqPred"><span class="hs-identifier">isEqPred</span></a></a><span> </span><a name="local-1627613032"><a href="#local-1627613032"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a><span> </span><a href="#local-1627613032"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1617"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627613033"><a href="#local-1627613033"><span class="hs-identifier">tyCon</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627613033"><span class="hs-identifier hs-var">tyCon</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqPrimTyConKey"><span class="hs-identifier hs-var">eqPrimTyConKey</span></a><span>
</span><a name="line-1618"></a><span>               </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-1627613033"><span class="hs-identifier hs-var">tyCon</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqReprPrimTyConKey"><span class="hs-identifier hs-var">eqReprPrimTyConKey</span></a><span>
</span><a name="line-1619"></a><span>    </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1620"></a><span>
</span><a name="line-1621"></a><a name="isNomEqPred"><a href="Type.html#isNomEqPred"><span class="hs-identifier">isNomEqPred</span></a></a><span> </span><a name="local-1627613034"><a href="#local-1627613034"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a><span> </span><a href="#local-1627613034"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1622"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627613035"><a href="#local-1627613035"><span class="hs-identifier">tyCon</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627613035"><span class="hs-identifier hs-var">tyCon</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqPrimTyConKey"><span class="hs-identifier hs-var">eqPrimTyConKey</span></a><span>
</span><a name="line-1623"></a><span>    </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1624"></a><span>
</span><a name="line-1625"></a><a name="isIPPred"><a href="Type.html#isIPPred"><span class="hs-identifier">isIPPred</span></a></a><span> </span><a name="local-1627613036"><a href="#local-1627613036"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a><span> </span><a href="#local-1627613036"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1626"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627613037"><a href="#local-1627613037"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#isIPTyCon"><span class="hs-identifier hs-var">isIPTyCon</span></a><span> </span><a href="#local-1627613037"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1627"></a><span>    </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1628"></a><span>
</span><a name="line-1629"></a><span class="hs-identifier">isIPTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1630"></a><a name="isIPTyCon"><a href="Type.html#isIPTyCon"><span class="hs-identifier">isIPTyCon</span></a></a><span> </span><a name="local-1627613038"><a href="#local-1627613038"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613038"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#ipClassKey"><span class="hs-identifier hs-var">ipClassKey</span></a><span>
</span><a name="line-1631"></a><span>  </span><span class="hs-comment">-- Class and its corresponding TyCon have the same Unique</span><span>
</span><a name="line-1632"></a><span>
</span><a name="line-1633"></a><span class="hs-identifier">isIPClass</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1634"></a><a name="isIPClass"><a href="Type.html#isIPClass"><span class="hs-identifier">isIPClass</span></a></a><span> </span><a name="local-1627613039"><a href="#local-1627613039"><span class="hs-identifier">cls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613039"><span class="hs-identifier hs-var">cls</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#ipClassKey"><span class="hs-identifier hs-var">ipClassKey</span></a><span>
</span><a name="line-1635"></a><span>
</span><a name="line-1636"></a><span class="hs-identifier">isCTupleClass</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1637"></a><a name="isCTupleClass"><a href="Type.html#isCTupleClass"><span class="hs-identifier">isCTupleClass</span></a></a><span> </span><a name="local-1627613040"><a href="#local-1627613040"><span class="hs-identifier">cls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#isTupleTyCon"><span class="hs-identifier hs-var">isTupleTyCon</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">classTyCon</span><span> </span><a href="#local-1627613040"><span class="hs-identifier hs-var">cls</span></a><span class="hs-special">)</span><span>
</span><a name="line-1638"></a><span>
</span><a name="line-1639"></a><span class="hs-identifier">isIPPred_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1640"></a><a name="isIPPred_maybe"><a href="Type.html#isIPPred_maybe"><span class="hs-identifier">isIPPred_maybe</span></a></a><span> </span><a name="local-1627613041"><a href="#local-1627613041"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1641"></a><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-1627613042"><a href="#local-1627613042"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><a name="local-1627613043"><a href="#local-1627613043"><span class="hs-identifier">t1</span></a></a><span class="hs-special">,</span><a name="local-1627613044"><a href="#local-1627613044"><span class="hs-identifier">t2</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627613041"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1642"></a><span>     </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#guard"><span class="hs-identifier hs-var">guard</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#isIPTyCon"><span class="hs-identifier hs-var">isIPTyCon</span></a><span> </span><a href="#local-1627613042"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1643"></a><span>     </span><a name="local-1627613045"><a href="#local-1627613045"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#isStrLitTy"><span class="hs-identifier hs-var">isStrLitTy</span></a><span> </span><a href="#local-1627613043"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-1644"></a><span>     </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627613045"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-1627613044"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1645"></a><span>
</span><a name="line-1646"></a><span class="hs-comment">{-
Make PredTypes

--------------------- Equality types ---------------------------------
-}</span><span>
</span><a name="line-1651"></a><span>
</span><a name="line-1652"></a><span class="hs-comment">-- | Makes a lifted equality predicate at the given role</span><span>
</span><a name="line-1653"></a><span class="hs-identifier">mkPrimEqPredRole</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span>
</span><a name="line-1654"></a><a name="mkPrimEqPredRole"><a href="Type.html#mkPrimEqPredRole"><span class="hs-identifier">mkPrimEqPredRole</span></a></a><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkPrimEqPred"><span class="hs-identifier hs-var">mkPrimEqPred</span></a><span>
</span><a name="line-1655"></a><span class="hs-identifier">mkPrimEqPredRole</span><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkReprPrimEqPred"><span class="hs-identifier hs-var">mkReprPrimEqPred</span></a><span>
</span><a name="line-1656"></a><span class="hs-identifier">mkPrimEqPredRole</span><span> </span><a href="CoAxiom.html#Phantom"><span class="hs-identifier hs-var">Phantom</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;mkPrimEqPredRole phantom&quot;</span><span>
</span><a name="line-1657"></a><span>
</span><a name="line-1658"></a><span class="hs-comment">-- | Creates a primitive type equality predicate.</span><span>
</span><a name="line-1659"></a><span class="hs-comment">-- Invariant: the types are not Coercions</span><span>
</span><a name="line-1660"></a><span class="hs-identifier">mkPrimEqPred</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1661"></a><a name="mkPrimEqPred"><a href="Type.html#mkPrimEqPred"><span class="hs-identifier">mkPrimEqPred</span></a></a><span> </span><a name="local-1627613046"><a href="#local-1627613046"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1627613047"><a href="#local-1627613047"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-1662"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="TysPrim.html#eqPrimTyCon"><span class="hs-identifier hs-var">eqPrimTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627613048"><span class="hs-identifier hs-var">k1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613049"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613046"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613047"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span>
</span><a name="line-1663"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1664"></a><span>    </span><a name="local-1627613048"><a href="#local-1627613048"><span class="hs-identifier">k1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1627613046"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-1665"></a><span>    </span><a name="local-1627613049"><a href="#local-1627613049"><span class="hs-identifier">k2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1627613047"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1666"></a><span>
</span><a name="line-1667"></a><span class="hs-comment">-- | Creates a primite type equality predicate with explicit kinds</span><span>
</span><a name="line-1668"></a><span class="hs-identifier">mkHeteroPrimEqPred</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1669"></a><a name="mkHeteroPrimEqPred"><a href="Type.html#mkHeteroPrimEqPred"><span class="hs-identifier">mkHeteroPrimEqPred</span></a></a><span> </span><a name="local-1627613050"><a href="#local-1627613050"><span class="hs-identifier">k1</span></a></a><span> </span><a name="local-1627613051"><a href="#local-1627613051"><span class="hs-identifier">k2</span></a></a><span> </span><a name="local-1627613052"><a href="#local-1627613052"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1627613053"><a href="#local-1627613053"><span class="hs-identifier">ty2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="TysPrim.html#eqPrimTyCon"><span class="hs-identifier hs-var">eqPrimTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627613050"><span class="hs-identifier hs-var">k1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613051"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613052"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613053"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span>
</span><a name="line-1670"></a><span>
</span><a name="line-1671"></a><span class="hs-comment">-- | Creates a primitive representational type equality predicate</span><span>
</span><a name="line-1672"></a><span class="hs-comment">-- with explicit kinds</span><span>
</span><a name="line-1673"></a><span class="hs-identifier">mkHeteroReprPrimEqPred</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1674"></a><a name="mkHeteroReprPrimEqPred"><a href="Type.html#mkHeteroReprPrimEqPred"><span class="hs-identifier">mkHeteroReprPrimEqPred</span></a></a><span> </span><a name="local-1627613054"><a href="#local-1627613054"><span class="hs-identifier">k1</span></a></a><span> </span><a name="local-1627613055"><a href="#local-1627613055"><span class="hs-identifier">k2</span></a></a><span> </span><a name="local-1627613056"><a href="#local-1627613056"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1627613057"><a href="#local-1627613057"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-1675"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="TysPrim.html#eqReprPrimTyCon"><span class="hs-identifier hs-var">eqReprPrimTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627613054"><span class="hs-identifier hs-var">k1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613055"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613056"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613057"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span>
</span><a name="line-1676"></a><span>
</span><a name="line-1677"></a><span class="hs-comment">-- | Try to split up a coercion type into the types that it coerces</span><span>
</span><a name="line-1678"></a><span class="hs-identifier">splitCoercionType_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1679"></a><a name="splitCoercionType_maybe"><a href="Type.html#splitCoercionType_maybe"><span class="hs-identifier">splitCoercionType_maybe</span></a></a><span> </span><a name="local-1627613058"><a href="#local-1627613058"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1680"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1627613059"><a href="#local-1627613059"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627613060"><a href="#local-1627613060"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627613061"><a href="#local-1627613061"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627613058"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1681"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#guard"><span class="hs-identifier hs-var">guard</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1627613059"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqPrimTyConKey"><span class="hs-identifier hs-var">eqPrimTyConKey</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-1627613059"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqReprPrimTyConKey"><span class="hs-identifier hs-var">eqReprPrimTyConKey</span></a><span>
</span><a name="line-1682"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627613060"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613061"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1683"></a><span>
</span><a name="line-1684"></a><span class="hs-identifier">mkReprPrimEqPred</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1685"></a><a name="mkReprPrimEqPred"><a href="Type.html#mkReprPrimEqPred"><span class="hs-identifier">mkReprPrimEqPred</span></a></a><span> </span><a name="local-1627613062"><a href="#local-1627613062"><span class="hs-identifier">ty1</span></a></a><span>  </span><a name="local-1627613063"><a href="#local-1627613063"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-1686"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="TysPrim.html#eqReprPrimTyCon"><span class="hs-identifier hs-var">eqReprPrimTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627613064"><span class="hs-identifier hs-var">k1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613065"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613062"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613063"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span>
</span><a name="line-1687"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1688"></a><span>    </span><a name="local-1627613064"><a href="#local-1627613064"><span class="hs-identifier">k1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1627613062"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-1689"></a><span>    </span><a name="local-1627613065"><a href="#local-1627613065"><span class="hs-identifier">k2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1627613063"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1690"></a><span>
</span><a name="line-1691"></a><span class="hs-identifier">equalityTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1692"></a><a name="equalityTyCon"><a href="Type.html#equalityTyCon"><span class="hs-identifier">equalityTyCon</span></a></a><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#eqPrimTyCon"><span class="hs-identifier hs-var">eqPrimTyCon</span></a><span>
</span><a name="line-1693"></a><span class="hs-identifier">equalityTyCon</span><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#eqReprPrimTyCon"><span class="hs-identifier hs-var">eqReprPrimTyCon</span></a><span>
</span><a name="line-1694"></a><span class="hs-identifier">equalityTyCon</span><span> </span><a href="CoAxiom.html#Phantom"><span class="hs-identifier hs-var">Phantom</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#eqPhantPrimTyCon"><span class="hs-identifier hs-var">eqPhantPrimTyCon</span></a><span>
</span><a name="line-1695"></a><span>
</span><a name="line-1696"></a><span class="hs-comment">-- --------------------- Dictionary types ---------------------------------</span><span>
</span><a name="line-1697"></a><span>
</span><a name="line-1698"></a><span class="hs-identifier">mkClassPred</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span>
</span><a name="line-1699"></a><a name="mkClassPred"><a href="Type.html#mkClassPred"><span class="hs-identifier">mkClassPred</span></a></a><span> </span><a name="local-1627613066"><a href="#local-1627613066"><span class="hs-identifier">clas</span></a></a><span> </span><a name="local-1627613067"><a href="#local-1627613067"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">classTyCon</span><span> </span><a href="#local-1627613066"><span class="hs-identifier hs-var">clas</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627613067"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1700"></a><span>
</span><a name="line-1701"></a><span class="hs-identifier">isDictTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1702"></a><a name="isDictTy"><a href="Type.html#isDictTy"><span class="hs-identifier">isDictTy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isClassPred"><span class="hs-identifier hs-var">isClassPred</span></a><span>
</span><a name="line-1703"></a><span>
</span><a name="line-1704"></a><span class="hs-identifier">isDictLikeTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1705"></a><span class="hs-comment">-- Note [Dictionary-like types]</span><span>
</span><a name="line-1706"></a><a name="isDictLikeTy"><a href="Type.html#isDictLikeTy"><span class="hs-identifier">isDictLikeTy</span></a></a><span> </span><a name="local-1627613068"><a href="#local-1627613068"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627613069"><a href="#local-1627613069"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627613068"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isDictLikeTy"><span class="hs-identifier hs-var">isDictLikeTy</span></a><span> </span><a href="#local-1627613069"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1707"></a><span class="hs-identifier">isDictLikeTy</span><span> </span><a name="local-1627613070"><a href="#local-1627613070"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627613070"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1708"></a><span>        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627613071"><a href="#local-1627613071"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627613072"><a href="#local-1627613072"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isClassTyCon"><span class="hs-identifier hs-var">isClassTyCon</span></a><span> </span><a href="#local-1627613071"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1709"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isTupleTyCon"><span class="hs-identifier hs-var">isTupleTyCon</span></a><span> </span><a href="#local-1627613071"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="Type.html#isDictLikeTy"><span class="hs-identifier hs-var">isDictLikeTy</span></a><span> </span><a href="#local-1627613072"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1710"></a><span>        </span><a name="local-1627613073"><a href="#local-1627613073"><span class="hs-identifier">_other</span></a></a><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1711"></a><span>
</span><a name="line-1712"></a><span class="hs-comment">{-
Note [Dictionary-like types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Being &quot;dictionary-like&quot; means either a dictionary type or a tuple thereof.
In GHC 6.10 we build implication constraints which construct such tuples,
and if we land up with a binding
    t :: (C [a], Eq [a])
    t = blah
then we want to treat t as cheap under &quot;-fdicts-cheap&quot; for example.
(Implication constraints are normally inlined, but sadly not if the
occurrence is itself inside an INLINE function!  Until we revise the
handling of implication constraints, that is.)  This turned out to
be important in getting good arities in DPH code.  Example:

    class C a
    class D a where { foo :: a -&gt; a }
    instance C a =&gt; D (Maybe a) where { foo x = x }

    bar :: (C a, C b) =&gt; a -&gt; b -&gt; (Maybe a, Maybe b)
    {-# INLINE bar #-}
    bar x y = (foo (Just x), foo (Just y))

Then 'bar' should jolly well have arity 4 (two dicts, two args), but
we ended up with something like
   bar = __inline_me__ (\d1,d2. let t :: (D (Maybe a), D (Maybe b)) = ...
                                in \x,y. &lt;blah&gt;)

This is all a bit ad-hoc; eg it relies on knowing that implication
constraints build tuples.


Decomposing PredType
-}</span><span>
</span><a name="line-1745"></a><span>
</span><a name="line-1746"></a><span class="hs-comment">-- | A choice of equality relation. This is separate from the type 'Role'</span><span>
</span><a name="line-1747"></a><span class="hs-comment">-- because 'Phantom' does not define a (non-trivial) equality relation.</span><span>
</span><a name="line-1748"></a><span class="hs-keyword">data</span><span> </span><a name="EqRel"><a href="Type.html#EqRel"><span class="hs-identifier">EqRel</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="NomEq"><a href="Type.html#NomEq"><span class="hs-identifier">NomEq</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ReprEq"><a href="Type.html#ReprEq"><span class="hs-identifier">ReprEq</span></a></a><span>
</span><a name="line-1749"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-1750"></a><span>
</span><a name="line-1751"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="Type.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1752"></a><span>  </span><a name="local-1912686315"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;nominal equality&quot;</span><span>
</span><a name="line-1753"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="Type.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;representational equality&quot;</span><span>
</span><a name="line-1754"></a><span>
</span><a name="line-1755"></a><span class="hs-identifier">eqRelRole</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Type.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span>
</span><a name="line-1756"></a><a name="eqRelRole"><a href="Type.html#eqRelRole"><span class="hs-identifier">eqRelRole</span></a></a><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span>
</span><a name="line-1757"></a><span class="hs-identifier">eqRelRole</span><span> </span><a href="Type.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span>
</span><a name="line-1758"></a><span>
</span><a name="line-1759"></a><span class="hs-keyword">data</span><span> </span><a name="PredTree"><a href="Type.html#PredTree"><span class="hs-identifier">PredTree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ClassPred"><a href="Type.html#ClassPred"><span class="hs-identifier">ClassPred</span></a></a><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-1760"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="EqPred"><a href="Type.html#EqPred"><span class="hs-identifier">EqPred</span></a></a><span> </span><a href="Type.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1761"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="IrredPred"><a href="Type.html#IrredPred"><span class="hs-identifier">IrredPred</span></a></a><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span>
</span><a name="line-1762"></a><span>
</span><a name="line-1763"></a><span class="hs-identifier">classifyPredType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#PredTree"><span class="hs-identifier hs-type">PredTree</span></a><span>
</span><a name="line-1764"></a><a name="classifyPredType"><a href="Type.html#classifyPredType"><span class="hs-identifier">classifyPredType</span></a></a><span> </span><a name="local-1627613074"><a href="#local-1627613074"><span class="hs-identifier">ev_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627613074"><span class="hs-identifier hs-var">ev_ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1765"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627613075"><a href="#local-1627613075"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627613076"><a href="#local-1627613076"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627613077"><a href="#local-1627613077"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1766"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627613075"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqReprPrimTyConKey"><span class="hs-identifier hs-var">eqReprPrimTyConKey</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#EqPred"><span class="hs-identifier hs-var">EqPred</span></a><span> </span><a href="Type.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a><span> </span><a href="#local-1627613076"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1627613077"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1767"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627613075"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqPrimTyConKey"><span class="hs-identifier hs-var">eqPrimTyConKey</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#EqPred"><span class="hs-identifier hs-var">EqPred</span></a><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span> </span><a href="#local-1627613076"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1627613077"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1768"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627613078"><a href="#local-1627613078"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627613079"><a href="#local-1627613079"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1769"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627613080"><a href="#local-1627613080"><span class="hs-identifier">clas</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#tyConClass_maybe"><span class="hs-identifier hs-var">tyConClass_maybe</span></a><span> </span><a href="#local-1627613078"><span class="hs-identifier hs-var">tc</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#ClassPred"><span class="hs-identifier hs-var">ClassPred</span></a><span> </span><a href="#local-1627613080"><span class="hs-identifier hs-var">clas</span></a><span> </span><a href="#local-1627613079"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1770"></a><span>    </span><span class="hs-identifier">_</span><span>                                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#IrredPred"><span class="hs-identifier hs-var">IrredPred</span></a><span> </span><a href="#local-1627613074"><span class="hs-identifier hs-var">ev_ty</span></a><span>
</span><a name="line-1771"></a><span>
</span><a name="line-1772"></a><span class="hs-identifier">getClassPredTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1773"></a><a name="getClassPredTys"><a href="Type.html#getClassPredTys"><span class="hs-identifier">getClassPredTys</span></a></a><span> </span><a name="local-1627613081"><a href="#local-1627613081"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#getClassPredTys_maybe"><span class="hs-identifier hs-var">getClassPredTys_maybe</span></a><span> </span><a href="#local-1627613081"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1774"></a><span>        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627613082"><a href="#local-1627613082"><span class="hs-identifier">clas</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627613083"><a href="#local-1627613083"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627613082"><span class="hs-identifier hs-var">clas</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613083"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1775"></a><span>        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;getClassPredTys&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627613081"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1776"></a><span>
</span><a name="line-1777"></a><span class="hs-identifier">getClassPredTys_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1778"></a><a name="getClassPredTys_maybe"><a href="Type.html#getClassPredTys_maybe"><span class="hs-identifier">getClassPredTys_maybe</span></a></a><span> </span><a name="local-1627613084"><a href="#local-1627613084"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627613084"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1779"></a><span>        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627613085"><a href="#local-1627613085"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627613086"><a href="#local-1627613086"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627613087"><a href="#local-1627613087"><span class="hs-identifier">clas</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#tyConClass_maybe"><span class="hs-identifier hs-var">tyConClass_maybe</span></a><span> </span><a href="#local-1627613085"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627613087"><span class="hs-identifier hs-var">clas</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613086"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1780"></a><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1781"></a><span>
</span><a name="line-1782"></a><span class="hs-identifier">getEqPredTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1783"></a><a name="getEqPredTys"><a href="Type.html#getEqPredTys"><span class="hs-identifier">getEqPredTys</span></a></a><span> </span><a name="local-1627613088"><a href="#local-1627613088"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1784"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627613088"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1785"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627613089"><a href="#local-1627613089"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627613090"><a href="#local-1627613090"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627613091"><a href="#local-1627613091"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1786"></a><span>        </span><span class="hs-glyph">|</span><span>  </span><a href="#local-1627613089"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqPrimTyConKey"><span class="hs-identifier hs-var">eqPrimTyConKey</span></a><span>
</span><a name="line-1787"></a><span>        </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-1627613089"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqReprPrimTyConKey"><span class="hs-identifier hs-var">eqReprPrimTyConKey</span></a><span>
</span><a name="line-1788"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627613090"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613091"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1789"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;getEqPredTys&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627613088"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1790"></a><span>
</span><a name="line-1791"></a><span class="hs-identifier">getEqPredTys_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1792"></a><a name="getEqPredTys_maybe"><a href="Type.html#getEqPredTys_maybe"><span class="hs-identifier">getEqPredTys_maybe</span></a></a><span> </span><a name="local-1627613092"><a href="#local-1627613092"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1793"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627613092"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1794"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627613093"><a href="#local-1627613093"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627613094"><a href="#local-1627613094"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627613095"><a href="#local-1627613095"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1795"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627613093"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqPrimTyConKey"><span class="hs-identifier hs-var">eqPrimTyConKey</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613094"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613095"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1796"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627613093"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqReprPrimTyConKey"><span class="hs-identifier hs-var">eqReprPrimTyConKey</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613094"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613095"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1797"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1798"></a><span>
</span><a name="line-1799"></a><span class="hs-identifier">getEqPredRole</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span>
</span><a name="line-1800"></a><a name="getEqPredRole"><a href="Type.html#getEqPredRole"><span class="hs-identifier">getEqPredRole</span></a></a><span> </span><a name="local-1627613096"><a href="#local-1627613096"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#eqRelRole"><span class="hs-identifier hs-var">eqRelRole</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#predTypeEqRel"><span class="hs-identifier hs-var">predTypeEqRel</span></a><span> </span><a href="#local-1627613096"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1801"></a><span>
</span><a name="line-1802"></a><span class="hs-comment">-- | Get the equality relation relevant for a pred type.</span><span>
</span><a name="line-1803"></a><span class="hs-identifier">predTypeEqRel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a><span>
</span><a name="line-1804"></a><a name="predTypeEqRel"><a href="Type.html#predTypeEqRel"><span class="hs-identifier">predTypeEqRel</span></a></a><span> </span><a name="local-1627613097"><a href="#local-1627613097"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1805"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627613098"><a href="#local-1627613098"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627613097"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1806"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="#local-1627613098"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqReprPrimTyConKey"><span class="hs-identifier hs-var">eqReprPrimTyConKey</span></a><span>
</span><a name="line-1807"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a><span>
</span><a name="line-1808"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1809"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span>
</span><a name="line-1810"></a><span>
</span><a name="line-1811"></a><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
                   Size
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1818"></a><span>
</span><a name="line-1819"></a><span class="hs-comment">-- NB: This function does not respect `eqType`, in that two types that</span><span>
</span><a name="line-1820"></a><span class="hs-comment">-- are `eqType` may return different sizes. This is OK, because this</span><span>
</span><a name="line-1821"></a><span class="hs-comment">-- function is used only in reporting, not decision-making.</span><span>
</span><a name="line-1822"></a><span class="hs-identifier">typeSize</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1823"></a><a name="typeSize"><a href="Type.html#typeSize"><span class="hs-identifier">typeSize</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1824"></a><span class="hs-identifier">typeSize</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1825"></a><span class="hs-identifier">typeSize</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1627613099"><a href="#local-1627613099"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627613100"><a href="#local-1627613100"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeSize"><span class="hs-identifier hs-var">typeSize</span></a><span> </span><a href="#local-1627613099"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Type.html#typeSize"><span class="hs-identifier hs-var">typeSize</span></a><span> </span><a href="#local-1627613100"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-1826"></a><span class="hs-identifier">typeSize</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><a name="local-1627613101"><a href="#local-1627613101"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1627613102"><a href="#local-1627613102"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeSize"><span class="hs-identifier hs-var">typeSize</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#binderType"><span class="hs-identifier hs-var">binderType</span></a><span> </span><a href="#local-1627613101"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Type.html#typeSize"><span class="hs-identifier hs-var">typeSize</span></a><span> </span><a href="#local-1627613102"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1827"></a><span class="hs-identifier">typeSize</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627613103"><a href="#local-1627613103"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#sum"><span class="hs-identifier hs-var">sum</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Type.html#typeSize"><span class="hs-identifier hs-var">typeSize</span></a><span> </span><a href="#local-1627613103"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span>
</span><a name="line-1828"></a><span class="hs-identifier">typeSize</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-1627613104"><a href="#local-1627613104"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627613105"><a href="#local-1627613105"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeSize"><span class="hs-identifier hs-var">typeSize</span></a><span> </span><a href="#local-1627613104"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Coercion.html#coercionSize"><span class="hs-identifier hs-var">coercionSize</span></a><span> </span><a href="#local-1627613105"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1829"></a><span class="hs-identifier">typeSize</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-1627613106"><a href="#local-1627613106"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#coercionSize"><span class="hs-identifier hs-var">coercionSize</span></a><span> </span><a href="#local-1627613106"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1830"></a><span>
</span><a name="line-1831"></a><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
         Well-scoped tyvars
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1838"></a><span>
</span><a name="line-1839"></a><span class="hs-comment">-- | Do a topological sort on a list of tyvars. This is a deterministic</span><span>
</span><a name="line-1840"></a><span class="hs-comment">-- sorting operation (that is, doesn't depend on Uniques).</span><span>
</span><a name="line-1841"></a><span class="hs-identifier">toposortTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-1842"></a><a name="toposortTyVars"><a href="Type.html#toposortTyVars"><span class="hs-identifier">toposortTyVars</span></a></a><span> </span><a name="local-1627613107"><a href="#local-1627613107"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1843"></a><span>                     </span><span class="hs-special">[</span><span> </span><a href="#local-1627613111"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-1627613111"><a href="#local-1627613111"><span class="hs-identifier">tv</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Digraph.html#topologicalSortG"><span class="hs-identifier hs-var">topologicalSortG</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1844"></a><span>                                          </span><a href="Digraph.html#graphFromEdgedVertices"><span class="hs-identifier hs-var">graphFromEdgedVertices</span></a><span> </span><a href="#local-1627613109"><span class="hs-identifier hs-var">nodes</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1845"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1846"></a><span>    </span><span class="hs-identifier">var_ids</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#VarEnv"><span class="hs-identifier hs-type">VarEnv</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1847"></a><span>    </span><a name="local-1627613108"><a href="#local-1627613108"><span class="hs-identifier">var_ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#mkVarEnv"><span class="hs-identifier hs-var">mkVarEnv</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span> </span><a href="#local-1627613107"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1848"></a><span>
</span><a name="line-1849"></a><span>    </span><a name="local-1627613109"><a href="#local-1627613109"><span class="hs-identifier">nodes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span> </span><a href="#local-1627613110"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1850"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="VarEnv.html#lookupVarEnv_NF"><span class="hs-identifier hs-var">lookupVarEnv_NF</span></a><span> </span><a href="#local-1627613108"><span class="hs-identifier hs-var">var_ids</span></a><span> </span><a href="#local-1627613110"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1851"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a><span> </span><a href="#local-1627613108"><span class="hs-identifier hs-var">var_ids</span></a><span class="hs-special">)</span><span>
</span><a name="line-1852"></a><span>                         </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfTypeList"><span class="hs-identifier hs-var">tyCoVarsOfTypeList</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1627613110"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1853"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="local-1627613110"><a href="#local-1627613110"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627613107"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1854"></a><span>
</span><a name="line-1855"></a><span class="hs-comment">-- | Extract a well-scoped list of variables from a set of variables.</span><span>
</span><a name="line-1856"></a><span class="hs-identifier">varSetElemsWellScoped</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span>
</span><a name="line-1857"></a><a name="varSetElemsWellScoped"><a href="Type.html#varSetElemsWellScoped"><span class="hs-identifier">varSetElemsWellScoped</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#toposortTyVars"><span class="hs-identifier hs-var">toposortTyVars</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="VarSet.html#varSetElems"><span class="hs-identifier hs-var">varSetElems</span></a><span>
</span><a name="line-1858"></a><span>
</span><a name="line-1859"></a><span class="hs-comment">-- | Get the free vars of a type in scoped order</span><span>
</span><a name="line-1860"></a><span class="hs-identifier">tyCoVarsOfTypeWellScoped</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-1861"></a><a name="tyCoVarsOfTypeWellScoped"><a href="Type.html#tyCoVarsOfTypeWellScoped"><span class="hs-identifier">tyCoVarsOfTypeWellScoped</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#toposortTyVars"><span class="hs-identifier hs-var">toposortTyVars</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TyCoRep.html#tyCoVarsOfTypeList"><span class="hs-identifier hs-var">tyCoVarsOfTypeList</span></a><span>
</span><a name="line-1862"></a><span>
</span><a name="line-1863"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Type families}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1870"></a><span>
</span><a name="line-1871"></a><span class="hs-identifier">mkFamilyTyConApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1872"></a><span class="hs-comment">-- ^ Given a family instance TyCon and its arg types, return the</span><span>
</span><a name="line-1873"></a><span class="hs-comment">-- corresponding family type.  E.g:</span><span>
</span><a name="line-1874"></a><span class="hs-comment">--</span><span>
</span><a name="line-1875"></a><span class="hs-comment">-- &gt; data family T a</span><span>
</span><a name="line-1876"></a><span class="hs-comment">-- &gt; data instance T (Maybe b) = MkT b</span><span>
</span><a name="line-1877"></a><span class="hs-comment">--</span><span>
</span><a name="line-1878"></a><span class="hs-comment">-- Where the instance tycon is :RTL, so:</span><span>
</span><a name="line-1879"></a><span class="hs-comment">--</span><span>
</span><a name="line-1880"></a><span class="hs-comment">-- &gt; mkFamilyTyConApp :RTL Int  =  T (Maybe Int)</span><span>
</span><a name="line-1881"></a><a name="mkFamilyTyConApp"><a href="Type.html#mkFamilyTyConApp"><span class="hs-identifier">mkFamilyTyConApp</span></a></a><span> </span><a name="local-1627613112"><a href="#local-1627613112"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627613113"><a href="#local-1627613113"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-1882"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627613114"><a href="#local-1627613114"><span class="hs-identifier">fam_tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627613115"><a href="#local-1627613115"><span class="hs-identifier">fam_tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#tyConFamInst_maybe"><span class="hs-identifier hs-var">tyConFamInst_maybe</span></a><span> </span><a href="#local-1627613112"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1883"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1627613116"><a href="#local-1627613116"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConTyVars</span><span> </span><a href="#local-1627613112"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1884"></a><span>        </span><a name="local-1627613117"><a href="#local-1627613117"><span class="hs-identifier">fam_subst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier hs-var">tvs</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1885"></a><span>                    </span><a href="TyCoRep.html#zipTvSubst"><span class="hs-identifier hs-var">zipTvSubst</span></a><span> </span><a href="#local-1627613116"><span class="hs-identifier hs-var">tvs</span></a><span> </span><a href="#local-1627613113"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1886"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><a href="#local-1627613114"><span class="hs-identifier hs-var">fam_tc</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTys"><span class="hs-identifier hs-var">substTys</span></a><span> </span><a href="#local-1627613117"><span class="hs-identifier hs-var">fam_subst</span></a><span> </span><a href="#local-1627613115"><span class="hs-identifier hs-var">fam_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1887"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1888"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><a href="#local-1627613112"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-1627613113"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1889"></a><span>
</span><a name="line-1890"></a><span class="hs-comment">-- | Get the type on the LHS of a coercion induced by a type/data</span><span>
</span><a name="line-1891"></a><span class="hs-comment">-- family instance.</span><span>
</span><a name="line-1892"></a><span class="hs-identifier">coAxNthLHS</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a><span> </span><a href="#local-1627612365"><span class="hs-identifier hs-type">br</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1893"></a><a name="coAxNthLHS"><a href="Type.html#coAxNthLHS"><span class="hs-identifier">coAxNthLHS</span></a></a><span> </span><a name="local-1627613118"><a href="#local-1627613118"><span class="hs-identifier">ax</span></a></a><span> </span><a name="local-1627613119"><a href="#local-1627613119"><span class="hs-identifier">ind</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1894"></a><span>  </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#coAxiomTyCon"><span class="hs-identifier hs-var">coAxiomTyCon</span></a><span> </span><a href="#local-1627613118"><span class="hs-identifier hs-var">ax</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#coAxBranchLHS"><span class="hs-identifier hs-var">coAxBranchLHS</span></a><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#coAxiomNthBranch"><span class="hs-identifier hs-var">coAxiomNthBranch</span></a><span> </span><a href="#local-1627613118"><span class="hs-identifier hs-var">ax</span></a><span> </span><a href="#local-1627613119"><span class="hs-identifier hs-var">ind</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1895"></a><span>
</span><a name="line-1896"></a><span class="hs-comment">-- | Pretty prints a 'TyCon', using the family instance in case of a</span><span>
</span><a name="line-1897"></a><span class="hs-comment">-- representation tycon.  For example:</span><span>
</span><a name="line-1898"></a><span class="hs-comment">--</span><span>
</span><a name="line-1899"></a><span class="hs-comment">-- &gt; data T [a] = ...</span><span>
</span><a name="line-1900"></a><span class="hs-comment">--</span><span>
</span><a name="line-1901"></a><span class="hs-comment">-- In that case we want to print @T [a]@, where @T@ is the family 'TyCon'</span><span>
</span><a name="line-1902"></a><span class="hs-identifier">pprSourceTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1903"></a><a name="pprSourceTyCon"><a href="Type.html#pprSourceTyCon"><span class="hs-identifier">pprSourceTyCon</span></a></a><span> </span><a name="local-1627613120"><a href="#local-1627613120"><span class="hs-identifier">tycon</span></a></a><span>
</span><a name="line-1904"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627613121"><a href="#local-1627613121"><span class="hs-identifier">fam_tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627613122"><a href="#local-1627613122"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#tyConFamInst_maybe"><span class="hs-identifier hs-var">tyConFamInst_maybe</span></a><span> </span><a href="#local-1627613120"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-1905"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1627613121"><span class="hs-identifier hs-var">fam_tc</span></a><span> </span><span class="hs-special">`</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613122"><span class="hs-identifier hs-var">tys</span></a><span>        </span><span class="hs-comment">-- can't be FunTyCon</span><span>
</span><a name="line-1906"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1907"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627613120"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-1908"></a><span>
</span><a name="line-1909"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Liftedness}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1916"></a><span>
</span><a name="line-1917"></a><span class="hs-comment">-- | See &quot;Type#type_classification&quot; for what an unlifted type is</span><span>
</span><a name="line-1918"></a><span class="hs-identifier">isUnliftedType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1919"></a><span>        </span><span class="hs-comment">-- isUnliftedType returns True for forall'd unlifted types:</span><span>
</span><a name="line-1920"></a><span>        </span><span class="hs-comment">--      x :: forall a. Int#</span><span>
</span><a name="line-1921"></a><span>        </span><span class="hs-comment">-- I found bindings like these were getting floated to the top level.</span><span>
</span><a name="line-1922"></a><span>        </span><span class="hs-comment">-- They are pretty bogus types, mind you.  It would be better never to</span><span>
</span><a name="line-1923"></a><span>        </span><span class="hs-comment">-- construct them</span><span>
</span><a name="line-1924"></a><span>
</span><a name="line-1925"></a><a name="isUnliftedType"><a href="Type.html#isUnliftedType"><span class="hs-identifier">isUnliftedType</span></a></a><span> </span><a name="local-1627613123"><a href="#local-1627613123"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627613124"><a href="#local-1627613124"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627613123"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a><span> </span><a href="#local-1627613124"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1926"></a><span class="hs-identifier">isUnliftedType</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-1627613125"><a href="#local-1627613125"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a><span> </span><a href="#local-1627613125"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1927"></a><span class="hs-identifier">isUnliftedType</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627613126"><a href="#local-1627613126"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#isUnliftedTyCon"><span class="hs-identifier hs-var">isUnliftedTyCon</span></a><span> </span><a href="#local-1627613126"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1928"></a><span class="hs-identifier">isUnliftedType</span><span> </span><span class="hs-identifier">_</span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1929"></a><span>
</span><a name="line-1930"></a><span class="hs-comment">-- | Extract the RuntimeRep classifier of a type. Panics if this is not possible.</span><span>
</span><a name="line-1931"></a><span class="hs-identifier">getRuntimeRep</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>   </span><span class="hs-comment">-- ^ Printed in case of an error</span><span>
</span><a name="line-1932"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1933"></a><a name="getRuntimeRep"><a href="Type.html#getRuntimeRep"><span class="hs-identifier">getRuntimeRep</span></a></a><span> </span><a name="local-1627613127"><a href="#local-1627613127"><span class="hs-identifier">err</span></a></a><span> </span><a name="local-1627613128"><a href="#local-1627613128"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getRuntimeRepFromKind"><span class="hs-identifier hs-var">getRuntimeRepFromKind</span></a><span> </span><a href="#local-1627613127"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1627613128"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1934"></a><span>
</span><a name="line-1935"></a><span class="hs-comment">-- | Extract the RuntimeRep classifier of a type from its kind.</span><span>
</span><a name="line-1936"></a><span class="hs-comment">-- For example, getRuntimeRepFromKind * = PtrRepLifted;</span><span>
</span><a name="line-1937"></a><span class="hs-comment">--              getRuntimeRepFromKind # = PtrRepUnlifted.</span><span>
</span><a name="line-1938"></a><span class="hs-comment">-- Panics if this is not possible.</span><span>
</span><a name="line-1939"></a><span class="hs-identifier">getRuntimeRepFromKind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>  </span><span class="hs-comment">-- ^ Printed in case of an error</span><span>
</span><a name="line-1940"></a><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1941"></a><a name="getRuntimeRepFromKind"><a href="Type.html#getRuntimeRepFromKind"><span class="hs-identifier">getRuntimeRepFromKind</span></a></a><span> </span><a name="local-1627613129"><a href="#local-1627613129"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613130"><span class="hs-identifier hs-var">go</span></a><span>
</span><a name="line-1942"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1943"></a><span>    </span><a name="local-1627613130"><a href="#local-1627613130"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-1627613131"><a href="#local-1627613131"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627613132"><a href="#local-1627613132"><span class="hs-identifier">k'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreViewOneStarKind"><span class="hs-identifier hs-var">coreViewOneStarKind</span></a><span> </span><a href="#local-1627613131"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613130"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613132"><span class="hs-identifier hs-var">k'</span></a><span>
</span><a name="line-1944"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627613133"><a href="#local-1627613133"><span class="hs-identifier">k</span></a></a><span>
</span><a name="line-1945"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627613134"><a href="#local-1627613134"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-1627613135"><a href="#local-1627613135"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627613133"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-1946"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="#local-1627613134"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#tYPETyConKey"><span class="hs-identifier hs-var">tYPETyConKey</span></a><span>
</span><a name="line-1947"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613135"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-1948"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627613136"><a href="#local-1627613136"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;getRuntimeRep&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-1627613129"><span class="hs-identifier hs-var">err</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-1949"></a><span>                                     </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627613136"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1627613136"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1950"></a><span>
</span><a name="line-1951"></a><span class="hs-identifier">isUnboxedTupleType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1952"></a><a name="isUnboxedTupleType"><a href="Type.html#isUnboxedTupleType"><span class="hs-identifier">isUnboxedTupleType</span></a></a><span> </span><a name="local-1627613137"><a href="#local-1627613137"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a><span> </span><a href="#local-1627613137"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1953"></a><span>                           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627613138"><a href="#local-1627613138"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#isUnboxedTupleTyCon"><span class="hs-identifier hs-var">isUnboxedTupleTyCon</span></a><span> </span><a href="#local-1627613138"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1954"></a><span>                           </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1955"></a><span>
</span><a name="line-1956"></a><span class="hs-comment">-- | See &quot;Type#type_classification&quot; for what an algebraic type is.</span><span>
</span><a name="line-1957"></a><span class="hs-comment">-- Should only be applied to /types/, as opposed to e.g. partially</span><span>
</span><a name="line-1958"></a><span class="hs-comment">-- saturated type constructors</span><span>
</span><a name="line-1959"></a><span class="hs-identifier">isAlgType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1960"></a><a name="isAlgType"><a href="Type.html#isAlgType"><span class="hs-identifier">isAlgType</span></a></a><span> </span><a name="local-1627613139"><a href="#local-1627613139"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1961"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627613139"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1962"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627613140"><a href="#local-1627613140"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627613141"><a href="#local-1627613141"><span class="hs-identifier">ty_args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">ty_args</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">lengthIs</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><a href="Util.html#lengthIs"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1963"></a><span>                            </span><a href="TyCon.html#isAlgTyCon"><span class="hs-identifier hs-var">isAlgTyCon</span></a><span> </span><a href="#local-1627613140"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1964"></a><span>      </span><a name="local-1627613142"><a href="#local-1627613142"><span class="hs-identifier">_other</span></a></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1965"></a><span>
</span><a name="line-1966"></a><span class="hs-comment">-- | See &quot;Type#type_classification&quot; for what an algebraic type is.</span><span>
</span><a name="line-1967"></a><span class="hs-comment">-- Should only be applied to /types/, as opposed to e.g. partially</span><span>
</span><a name="line-1968"></a><span class="hs-comment">-- saturated type constructors. Closed type constructors are those</span><span>
</span><a name="line-1969"></a><span class="hs-comment">-- with a fixed right hand side, as opposed to e.g. associated types</span><span>
</span><a name="line-1970"></a><span class="hs-identifier">isClosedAlgType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1971"></a><a name="isClosedAlgType"><a href="Type.html#isClosedAlgType"><span class="hs-identifier">isClosedAlgType</span></a></a><span> </span><a name="local-1627613143"><a href="#local-1627613143"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1972"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627613143"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1973"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627613144"><a href="#local-1627613144"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627613145"><a href="#local-1627613145"><span class="hs-identifier">ty_args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isAlgTyCon"><span class="hs-identifier hs-var">isAlgTyCon</span></a><span> </span><a href="#local-1627613144"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#isFamilyTyCon"><span class="hs-identifier hs-var">isFamilyTyCon</span></a><span> </span><a href="#local-1627613144"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1974"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">ty_args</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">lengthIs</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><span class="hs-identifier">tc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-identifier">True</span><span>
</span><a name="line-1975"></a><span>      </span><a name="local-1627613146"><a href="#local-1627613146"><span class="hs-identifier">_other</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1976"></a><span>
</span><a name="line-1977"></a><span class="hs-comment">-- | Computes whether an argument (or let right hand side) should</span><span>
</span><a name="line-1978"></a><span class="hs-comment">-- be computed strictly or lazily, based only on its type.</span><span>
</span><a name="line-1979"></a><span class="hs-comment">-- Currently, it's just 'isUnliftedType'.</span><span>
</span><a name="line-1980"></a><span>
</span><a name="line-1981"></a><span class="hs-identifier">isStrictType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1982"></a><a name="isStrictType"><a href="Type.html#isStrictType"><span class="hs-identifier">isStrictType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a><span>
</span><a name="line-1983"></a><span>
</span><a name="line-1984"></a><span class="hs-identifier">isPrimitiveType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1985"></a><span class="hs-comment">-- ^ Returns true of types that are opaque to Haskell.</span><span>
</span><a name="line-1986"></a><a name="isPrimitiveType"><a href="Type.html#isPrimitiveType"><span class="hs-identifier">isPrimitiveType</span></a></a><span> </span><a name="local-1627613147"><a href="#local-1627613147"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-1627613147"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1987"></a><span>                        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627613148"><a href="#local-1627613148"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627613149"><a href="#local-1627613149"><span class="hs-identifier">ty_args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">ty_args</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">lengthIs</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><a href="Util.html#lengthIs"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1988"></a><span>                                              </span><a href="TyCon.html#isPrimTyCon"><span class="hs-identifier hs-var">isPrimTyCon</span></a><span> </span><a href="#local-1627613148"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1989"></a><span>                        </span><span class="hs-identifier">_</span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1990"></a><span>
</span><a name="line-1991"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Sequencing on types}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1998"></a><span>
</span><a name="line-1999"></a><span class="hs-identifier">seqType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2000"></a><a name="seqType"><a href="Type.html#seqType"><span class="hs-identifier">seqType</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><a name="local-1627613150"><a href="#local-1627613150"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613150"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2001"></a><span class="hs-identifier">seqType</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-1627613151"><a href="#local-1627613151"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613151"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2002"></a><span class="hs-identifier">seqType</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1627613152"><a href="#local-1627613152"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627613153"><a href="#local-1627613153"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a><span> </span><a href="#local-1627613152"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a><span> </span><a href="#local-1627613153"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2003"></a><span class="hs-identifier">seqType</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627613154"><a href="#local-1627613154"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627613155"><a href="#local-1627613155"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613154"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="Type.html#seqTypes"><span class="hs-identifier hs-var">seqTypes</span></a><span> </span><a href="#local-1627613155"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-2004"></a><span class="hs-identifier">seqType</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><a name="local-1627613156"><a href="#local-1627613156"><span class="hs-identifier">bndr</span></a></a><span> </span><a name="local-1627613157"><a href="#local-1627613157"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#binderType"><span class="hs-identifier hs-var">binderType</span></a><span> </span><a href="#local-1627613156"><span class="hs-identifier hs-var">bndr</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a><span> </span><a href="#local-1627613157"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2005"></a><span class="hs-identifier">seqType</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-1627613158"><a href="#local-1627613158"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627613159"><a href="#local-1627613159"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a><span> </span><a href="#local-1627613158"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="Coercion.html#seqCo"><span class="hs-identifier hs-var">seqCo</span></a><span> </span><a href="#local-1627613159"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2006"></a><span class="hs-identifier">seqType</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-1627613160"><a href="#local-1627613160"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#seqCo"><span class="hs-identifier hs-var">seqCo</span></a><span> </span><a href="#local-1627613160"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2007"></a><span>
</span><a name="line-2008"></a><span class="hs-identifier">seqTypes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2009"></a><a name="seqTypes"><a href="Type.html#seqTypes"><span class="hs-identifier">seqTypes</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2010"></a><span class="hs-identifier">seqTypes</span><span> </span><span class="hs-special">(</span><a name="local-1627613161"><a href="#local-1627613161"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">:</span><a name="local-1627613162"><a href="#local-1627613162"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a><span> </span><a href="#local-1627613161"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="Type.html#seqTypes"><span class="hs-identifier hs-var">seqTypes</span></a><span> </span><a href="#local-1627613162"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-2011"></a><span>
</span><a name="line-2012"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Comparison for types
        (We don't use instances so that we know where it happens)
*                                                                      *
************************************************************************

Note [Equality on AppTys]
~~~~~~~~~~~~~~~~~~~~~~~~~
In our cast-ignoring equality, we want to say that the following two
are equal:

  (Maybe |&gt; co) (Int |&gt; co')   ~?       Maybe Int

But the left is an AppTy while the right is a TyConApp. The solution is
to use repSplitAppTy_maybe to break up the TyConApp into its pieces and
then continue. Easy to do, but also easy to forget to do.

-}</span><span>
</span><a name="line-2032"></a><span>
</span><a name="line-2033"></a><span class="hs-identifier">eqType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2034"></a><span class="hs-comment">-- ^ Type equality on source types. Does not look through @newtypes@ or</span><span>
</span><a name="line-2035"></a><span class="hs-comment">-- 'PredType's, but it does look through type synonyms.</span><span>
</span><a name="line-2036"></a><span class="hs-comment">-- This first checks that the kinds of the types are equal and then</span><span>
</span><a name="line-2037"></a><span class="hs-comment">-- checks whether the types are equal, ignoring casts and coercions.</span><span>
</span><a name="line-2038"></a><span class="hs-comment">-- (The kind check is a recursive call, but since all kinds have type</span><span>
</span><a name="line-2039"></a><span class="hs-comment">-- @Type@, there is no need to check the types of kinds.)</span><span>
</span><a name="line-2040"></a><span class="hs-comment">-- See also Note [Non-trivial definitional equality] in TyCoRep.</span><span>
</span><a name="line-2041"></a><a name="eqType"><a href="Type.html#eqType"><span class="hs-identifier">eqType</span></a></a><span> </span><a name="local-1627613163"><a href="#local-1627613163"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627613164"><a href="#local-1627613164"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#isEqual"><span class="hs-identifier hs-var">isEqual</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#cmpType"><span class="hs-identifier hs-var">cmpType</span></a><span> </span><a href="#local-1627613163"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1627613164"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2042"></a><span>
</span><a name="line-2043"></a><span class="hs-comment">-- | Compare types with respect to a (presumably) non-empty 'RnEnv2'.</span><span>
</span><a name="line-2044"></a><span class="hs-identifier">eqTypeX</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2045"></a><a name="eqTypeX"><a href="Type.html#eqTypeX"><span class="hs-identifier">eqTypeX</span></a></a><span> </span><a name="local-1627613165"><a href="#local-1627613165"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1627613166"><a href="#local-1627613166"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627613167"><a href="#local-1627613167"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#isEqual"><span class="hs-identifier hs-var">isEqual</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#cmpTypeX"><span class="hs-identifier hs-var">cmpTypeX</span></a><span> </span><a href="#local-1627613165"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613166"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1627613167"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2046"></a><span>
</span><a name="line-2047"></a><span class="hs-comment">-- | Type equality on lists of types, looking through type synonyms</span><span>
</span><a name="line-2048"></a><span class="hs-comment">-- but not newtypes.</span><span>
</span><a name="line-2049"></a><span class="hs-identifier">eqTypes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2050"></a><a name="eqTypes"><a href="Type.html#eqTypes"><span class="hs-identifier">eqTypes</span></a></a><span> </span><a name="local-1627613168"><a href="#local-1627613168"><span class="hs-identifier">tys1</span></a></a><span> </span><a name="local-1627613169"><a href="#local-1627613169"><span class="hs-identifier">tys2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#isEqual"><span class="hs-identifier hs-var">isEqual</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#cmpTypes"><span class="hs-identifier hs-var">cmpTypes</span></a><span> </span><a href="#local-1627613168"><span class="hs-identifier hs-var">tys1</span></a><span> </span><a href="#local-1627613169"><span class="hs-identifier hs-var">tys2</span></a><span>
</span><a name="line-2051"></a><span>
</span><a name="line-2052"></a><span class="hs-identifier">eqVarBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="VarEnv.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a><span>
</span><a name="line-2053"></a><span class="hs-comment">-- Check that the var lists are the same length</span><span>
</span><a name="line-2054"></a><span class="hs-comment">-- and have matching kinds; if so, extend the RnEnv2</span><span>
</span><a name="line-2055"></a><span class="hs-comment">-- Returns Nothing if they don't match</span><span>
</span><a name="line-2056"></a><a name="eqVarBndrs"><a href="Type.html#eqVarBndrs"><span class="hs-identifier">eqVarBndrs</span></a></a><span> </span><a name="local-1627613170"><a href="#local-1627613170"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2057"></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1627613170"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-2058"></a><span class="hs-identifier">eqVarBndrs</span><span> </span><a name="local-1627613171"><a href="#local-1627613171"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627613172"><a href="#local-1627613172"><span class="hs-identifier">tv1</span></a></a><span class="hs-glyph">:</span><a name="local-1627613173"><a href="#local-1627613173"><span class="hs-identifier">tvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-1627613174"><a href="#local-1627613174"><span class="hs-identifier">tv2</span></a></a><span class="hs-glyph">:</span><a name="local-1627613175"><a href="#local-1627613175"><span class="hs-identifier">tvs2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2059"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Type.html#eqTypeX"><span class="hs-identifier hs-var">eqTypeX</span></a><span> </span><a href="#local-1627613171"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1627613172"><span class="hs-identifier hs-var">tv1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1627613174"><span class="hs-identifier hs-var">tv2</span></a><span class="hs-special">)</span><span>
</span><a name="line-2060"></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#eqVarBndrs"><span class="hs-identifier hs-var">eqVarBndrs</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#rnBndr2"><span class="hs-identifier hs-var">rnBndr2</span></a><span> </span><a href="#local-1627613171"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613172"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="#local-1627613174"><span class="hs-identifier hs-var">tv2</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627613173"><span class="hs-identifier hs-var">tvs1</span></a><span> </span><a href="#local-1627613175"><span class="hs-identifier hs-var">tvs2</span></a><span>
</span><a name="line-2061"></a><span class="hs-identifier">eqVarBndrs</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-2062"></a><span>
</span><a name="line-2063"></a><span class="hs-comment">-- Now here comes the real worker</span><span>
</span><a name="line-2064"></a><span>
</span><a name="line-2065"></a><span class="hs-identifier">cmpType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-2066"></a><a name="cmpType"><a href="Type.html#cmpType"><span class="hs-identifier">cmpType</span></a></a><span> </span><a name="local-1627613176"><a href="#local-1627613176"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627613177"><a href="#local-1627613177"><span class="hs-identifier">t2</span></a></a><span>
</span><a name="line-2067"></a><span>  </span><span class="hs-comment">-- we know k1 and k2 have the same kind, because they both have kind *.</span><span>
</span><a name="line-2068"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#cmpTypeX"><span class="hs-identifier hs-var">cmpTypeX</span></a><span> </span><a href="#local-1627613178"><span class="hs-identifier hs-var">rn_env</span></a><span> </span><a href="#local-1627613176"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1627613177"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2069"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2070"></a><span>    </span><a name="local-1627613178"><a href="#local-1627613178"><span class="hs-identifier">rn_env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#mkRnEnv2"><span class="hs-identifier hs-var">mkRnEnv2</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627613176"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627613177"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2071"></a><span>
</span><a name="line-2072"></a><span class="hs-identifier">cmpTypes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-2073"></a><a name="cmpTypes"><a href="Type.html#cmpTypes"><span class="hs-identifier">cmpTypes</span></a></a><span> </span><a name="local-1627613179"><a href="#local-1627613179"><span class="hs-identifier">ts1</span></a></a><span> </span><a name="local-1627613180"><a href="#local-1627613180"><span class="hs-identifier">ts2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#cmpTypesX"><span class="hs-identifier hs-var">cmpTypesX</span></a><span> </span><a href="#local-1627613181"><span class="hs-identifier hs-var">rn_env</span></a><span> </span><a href="#local-1627613179"><span class="hs-identifier hs-var">ts1</span></a><span> </span><a href="#local-1627613180"><span class="hs-identifier hs-var">ts2</span></a><span>
</span><a name="line-2074"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2075"></a><span>    </span><a name="local-1627613181"><a href="#local-1627613181"><span class="hs-identifier">rn_env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#mkRnEnv2"><span class="hs-identifier hs-var">mkRnEnv2</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627613179"><span class="hs-identifier hs-var">ts1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1627613180"><span class="hs-identifier hs-var">ts2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2076"></a><span>
</span><a name="line-2077"></a><span class="hs-comment">-- | An ordering relation between two 'Type's (known below as @t1 :: k1@</span><span>
</span><a name="line-2078"></a><span class="hs-comment">-- and @t2 :: k2@)</span><span>
</span><a name="line-2079"></a><span class="hs-keyword">data</span><span> </span><a name="TypeOrdering"><a href="Type.html#TypeOrdering"><span class="hs-identifier">TypeOrdering</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TLT"><a href="Type.html#TLT"><span class="hs-identifier">TLT</span></a></a><span>  </span><span class="hs-comment">-- ^ @t1 &lt; t2@</span><span>
</span><a name="line-2080"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a name="TEQ"><a href="Type.html#TEQ"><span class="hs-identifier">TEQ</span></a></a><span>  </span><span class="hs-comment">-- ^ @t1 ~ t2@ and there are no casts in either,</span><span>
</span><a name="line-2081"></a><span>                         </span><span class="hs-comment">-- therefore we can conclude @k1 ~ k2@</span><span>
</span><a name="line-2082"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a name="TEQX"><a href="Type.html#TEQX"><span class="hs-identifier">TEQX</span></a></a><span> </span><span class="hs-comment">-- ^ @t1 ~ t2@ yet one of the types contains a cast so</span><span>
</span><a name="line-2083"></a><span>                         </span><span class="hs-comment">-- they may differ in kind.</span><span>
</span><a name="line-2084"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a name="TGT"><a href="Type.html#TGT"><span class="hs-identifier">TGT</span></a></a><span>  </span><span class="hs-comment">-- ^ @t1 &gt; t2@</span><span>
</span><a name="line-2085"></a><span>                  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Enum.html#Enum"><span class="hs-identifier hs-type">Enum</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Enum.html#Bounded"><span class="hs-identifier hs-type">Bounded</span></a><span class="hs-special">)</span><span>
</span><a name="line-2086"></a><span>
</span><a name="line-2087"></a><span class="hs-identifier">cmpTypeX</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>  </span><span class="hs-comment">-- Main workhorse</span><span>
</span><a name="line-2088"></a><span>    </span><span class="hs-comment">-- See Note [Non-trivial definitional equality] in TyCoRep</span><span>
</span><a name="line-2089"></a><a name="cmpTypeX"><a href="Type.html#cmpTypeX"><span class="hs-identifier">cmpTypeX</span></a></a><span> </span><a name="local-1627613182"><a href="#local-1627613182"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1627613183"><a href="#local-1627613183"><span class="hs-identifier">orig_t1</span></a></a><span> </span><a name="local-1627613184"><a href="#local-1627613184"><span class="hs-identifier">orig_t2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2090"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627613191"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613182"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613183"><span class="hs-identifier hs-var">orig_t1</span></a><span> </span><a href="#local-1627613184"><span class="hs-identifier hs-var">orig_t2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2091"></a><span>      </span><span class="hs-comment">-- If there are casts then we also need to do a comparison of the kinds of</span><span>
</span><a name="line-2092"></a><span>      </span><span class="hs-comment">-- the types being compared</span><span>
</span><a name="line-2093"></a><span>      </span><a href="Type.html#TEQX"><span class="hs-identifier hs-var">TEQX</span></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627613187"><span class="hs-identifier hs-var">toOrdering</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1627613191"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613182"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613185"><span class="hs-identifier hs-var">k1</span></a><span> </span><a href="#local-1627613186"><span class="hs-identifier hs-var">k2</span></a><span>
</span><a name="line-2094"></a><span>      </span><a name="local-1627613248"><a href="#local-1627613248"><span class="hs-identifier">ty_ordering</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627613187"><span class="hs-identifier hs-var">toOrdering</span></a><span> </span><a href="#local-1627613248"><span class="hs-identifier hs-var">ty_ordering</span></a><span>
</span><a name="line-2095"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2096"></a><span>    </span><a name="local-1627613185"><a href="#local-1627613185"><span class="hs-identifier">k1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1627613183"><span class="hs-identifier hs-var">orig_t1</span></a><span>
</span><a name="line-2097"></a><span>    </span><a name="local-1627613186"><a href="#local-1627613186"><span class="hs-identifier">k2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1627613184"><span class="hs-identifier hs-var">orig_t2</span></a><span>
</span><a name="line-2098"></a><span>
</span><a name="line-2099"></a><span>    </span><span class="hs-identifier">toOrdering</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-2100"></a><span>    </span><a name="local-1627613187"><a href="#local-1627613187"><span class="hs-identifier">toOrdering</span></a></a><span> </span><a href="Type.html#TLT"><span class="hs-identifier hs-var">TLT</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-2101"></a><span>    </span><span class="hs-identifier">toOrdering</span><span> </span><a href="Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-2102"></a><span>    </span><span class="hs-identifier">toOrdering</span><span> </span><a href="Type.html#TEQX"><span class="hs-identifier hs-var">TEQX</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-2103"></a><span>    </span><span class="hs-identifier">toOrdering</span><span> </span><a href="Type.html#TGT"><span class="hs-identifier hs-var">TGT</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-2104"></a><span>
</span><a name="line-2105"></a><span>    </span><span class="hs-identifier">liftOrdering</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a><span>
</span><a name="line-2106"></a><span>    </span><a name="local-1627613188"><a href="#local-1627613188"><span class="hs-identifier">liftOrdering</span></a></a><span> </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#TLT"><span class="hs-identifier hs-var">TLT</span></a><span>
</span><a name="line-2107"></a><span>    </span><span class="hs-identifier">liftOrdering</span><span> </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a><span>
</span><a name="line-2108"></a><span>    </span><span class="hs-identifier">liftOrdering</span><span> </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#TGT"><span class="hs-identifier hs-var">TGT</span></a><span>
</span><a name="line-2109"></a><span>
</span><a name="line-2110"></a><span>    </span><span class="hs-identifier">thenCmpTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a><span>
</span><a name="line-2111"></a><span>    </span><a name="local-1627613189"><a href="#local-1627613189"><span class="hs-identifier">thenCmpTy</span></a></a><span> </span><a href="Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a><span>  </span><a name="local-1627613193"><a href="#local-1627613193"><span class="hs-identifier">rel</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613193"><span class="hs-identifier hs-var">rel</span></a><span>
</span><a name="line-2112"></a><span>    </span><span class="hs-identifier">thenCmpTy</span><span> </span><a href="Type.html#TEQX"><span class="hs-identifier hs-var">TEQX</span></a><span> </span><a name="local-1627613194"><a href="#local-1627613194"><span class="hs-identifier">rel</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613190"><span class="hs-identifier hs-var">hasCast</span></a><span> </span><a href="#local-1627613194"><span class="hs-identifier hs-var">rel</span></a><span>
</span><a name="line-2113"></a><span>    </span><span class="hs-identifier">thenCmpTy</span><span> </span><a name="local-1627613195"><a href="#local-1627613195"><span class="hs-identifier">rel</span></a></a><span>  </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613195"><span class="hs-identifier hs-var">rel</span></a><span>
</span><a name="line-2114"></a><span>
</span><a name="line-2115"></a><span>    </span><span class="hs-identifier">hasCast</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a><span>
</span><a name="line-2116"></a><span>    </span><a name="local-1627613190"><a href="#local-1627613190"><span class="hs-identifier">hasCast</span></a></a><span> </span><a href="Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#TEQX"><span class="hs-identifier hs-var">TEQX</span></a><span>
</span><a name="line-2117"></a><span>    </span><span class="hs-identifier">hasCast</span><span> </span><a name="local-1627613196"><a href="#local-1627613196"><span class="hs-identifier">rel</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613196"><span class="hs-identifier hs-var">rel</span></a><span>
</span><a name="line-2118"></a><span>
</span><a name="line-2119"></a><span>    </span><span class="hs-comment">-- Returns both the resulting ordering relation between the two types</span><span>
</span><a name="line-2120"></a><span>    </span><span class="hs-comment">-- and whether either contains a cast.</span><span>
</span><a name="line-2121"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a><span>
</span><a name="line-2122"></a><span>    </span><a name="local-1627613191"><a href="#local-1627613191"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-1627613197"><a href="#local-1627613197"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1627613198"><a href="#local-1627613198"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627613199"><a href="#local-1627613199"><span class="hs-identifier">t2</span></a></a><span>
</span><a name="line-2123"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627613200"><a href="#local-1627613200"><span class="hs-identifier">t1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreViewOneStarKind"><span class="hs-identifier hs-var">coreViewOneStarKind</span></a><span> </span><a href="#local-1627613198"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613191"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613197"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613200"><span class="hs-identifier hs-var">t1'</span></a><span> </span><a href="#local-1627613199"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2124"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627613201"><a href="#local-1627613201"><span class="hs-identifier">t2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreViewOneStarKind"><span class="hs-identifier hs-var">coreViewOneStarKind</span></a><span> </span><a href="#local-1627613199"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613191"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613197"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613198"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1627613201"><span class="hs-identifier hs-var">t2'</span></a><span>
</span><a name="line-2125"></a><span>
</span><a name="line-2126"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627613202"><a href="#local-1627613202"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-1627613203"><a href="#local-1627613203"><span class="hs-identifier">tv1</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-1627613204"><a href="#local-1627613204"><span class="hs-identifier">tv2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2127"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613188"><span class="hs-identifier hs-var">liftOrdering</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="VarEnv.html#rnOccL"><span class="hs-identifier hs-var">rnOccL</span></a><span> </span><a href="#local-1627613202"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613203"><span class="hs-identifier hs-var">tv1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="VarEnv.html#rnOccR"><span class="hs-identifier hs-var">rnOccR</span></a><span> </span><a href="#local-1627613202"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613204"><span class="hs-identifier hs-var">tv2</span></a><span>
</span><a name="line-2128"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627613205"><a href="#local-1627613205"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1627613206"><a href="#local-1627613206"><span class="hs-identifier">tv1</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-1627613207"><a href="#local-1627613207"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1627613208"><a href="#local-1627613208"><span class="hs-identifier">tv2</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-1627613209"><a href="#local-1627613209"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2129"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613191"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613205"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1627613206"><span class="hs-identifier hs-var">tv1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1627613208"><span class="hs-identifier hs-var">tv2</span></a><span class="hs-special">)</span><span>
</span><a name="line-2130"></a><span>        </span><span class="hs-special">`</span><a href="#local-1627613189"><span class="hs-identifier hs-var">thenCmpTy</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613191"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#rnBndr2"><span class="hs-identifier hs-var">rnBndr2</span></a><span> </span><a href="#local-1627613205"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613206"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="#local-1627613208"><span class="hs-identifier hs-var">tv2</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627613207"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1627613209"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2131"></a><span>        </span><span class="hs-comment">-- See Note [Equality on AppTys]</span><span>
</span><a name="line-2132"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627613210"><a href="#local-1627613210"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1627613211"><a href="#local-1627613211"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-1627613212"><a href="#local-1627613212"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627613213"><a href="#local-1627613213"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-2133"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627613214"><a href="#local-1627613214"><span class="hs-identifier">s2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627613215"><a href="#local-1627613215"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#repSplitAppTy_maybe"><span class="hs-identifier hs-var">repSplitAppTy_maybe</span></a><span> </span><a href="#local-1627613213"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-2134"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613191"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613210"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613211"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="#local-1627613214"><span class="hs-identifier hs-var">s2</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627613189"><span class="hs-identifier hs-var">thenCmpTy</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613191"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613210"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613212"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1627613215"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2135"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627613216"><a href="#local-1627613216"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1627613217"><a href="#local-1627613217"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1627613218"><a href="#local-1627613218"><span class="hs-identifier">s2</span></a></a><span> </span><a name="local-1627613219"><a href="#local-1627613219"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2136"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627613220"><a href="#local-1627613220"><span class="hs-identifier">s1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627613221"><a href="#local-1627613221"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#repSplitAppTy_maybe"><span class="hs-identifier hs-var">repSplitAppTy_maybe</span></a><span> </span><a href="#local-1627613217"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-2137"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613191"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613216"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613220"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="#local-1627613218"><span class="hs-identifier hs-var">s2</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627613189"><span class="hs-identifier hs-var">thenCmpTy</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613191"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613216"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613221"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1627613219"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2138"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627613222"><a href="#local-1627613222"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627613223"><a href="#local-1627613223"><span class="hs-identifier">s1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627613224"><a href="#local-1627613224"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627613225"><a href="#local-1627613225"><span class="hs-identifier">s2</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627613226"><a href="#local-1627613226"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2139"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613191"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613222"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613223"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="#local-1627613225"><span class="hs-identifier hs-var">s2</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627613189"><span class="hs-identifier hs-var">thenCmpTy</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613191"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613222"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613224"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1627613226"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2140"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627613227"><a href="#local-1627613227"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627613228"><a href="#local-1627613228"><span class="hs-identifier">tc1</span></a></a><span> </span><a name="local-1627613229"><a href="#local-1627613229"><span class="hs-identifier">tys1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627613230"><a href="#local-1627613230"><span class="hs-identifier">tc2</span></a></a><span> </span><a name="local-1627613231"><a href="#local-1627613231"><span class="hs-identifier">tys2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2141"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613188"><span class="hs-identifier hs-var">liftOrdering</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627613228"><span class="hs-identifier hs-var">tc1</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#cmpTc"><span class="hs-identifier hs-var">cmpTc</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613230"><span class="hs-identifier hs-var">tc2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="#local-1627613189"><span class="hs-identifier hs-var">thenCmpTy</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613192"><span class="hs-identifier hs-var">gos</span></a><span> </span><a href="#local-1627613227"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613229"><span class="hs-identifier hs-var">tys1</span></a><span> </span><a href="#local-1627613231"><span class="hs-identifier hs-var">tys2</span></a><span>
</span><a name="line-2142"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><a name="local-1627613232"><a href="#local-1627613232"><span class="hs-identifier">l1</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><a name="local-1627613233"><a href="#local-1627613233"><span class="hs-identifier">l2</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613188"><span class="hs-identifier hs-var">liftOrdering</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-1627613232"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-1627613233"><span class="hs-identifier hs-var">l2</span></a><span class="hs-special">)</span><span>
</span><a name="line-2143"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627613234"><a href="#local-1627613234"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-1627613235"><a href="#local-1627613235"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><a name="local-1627613236"><a href="#local-1627613236"><span class="hs-identifier">t2</span></a></a><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613190"><span class="hs-identifier hs-var">hasCast</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1627613191"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613234"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613235"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1627613236"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2144"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-1627613237"><a href="#local-1627613237"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-1627613238"><a href="#local-1627613238"><span class="hs-identifier">t1</span></a></a><span>                  </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-1627613239"><a href="#local-1627613239"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613190"><span class="hs-identifier hs-var">hasCast</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1627613191"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613237"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613238"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1627613239"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2145"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a><span>
</span><a name="line-2146"></a><span>
</span><a name="line-2147"></a><span>        </span><span class="hs-comment">-- Deal with the rest: TyVarTy &lt; CoercionTy &lt; AppTy &lt; LitTy &lt; TyConApp &lt; ForAllTy</span><span>
</span><a name="line-2148"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627613240"><a href="#local-1627613240"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1627613241"><a href="#local-1627613241"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-2149"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613188"><span class="hs-identifier hs-var">liftOrdering</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627613242"><span class="hs-identifier hs-var">get_rank</span></a><span> </span><a href="#local-1627613240"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-1627613242"><span class="hs-identifier hs-var">get_rank</span></a><span> </span><a href="#local-1627613241"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-2150"></a><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">get_rank</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-2151"></a><span>            </span><a name="local-1627613242"><a href="#local-1627613242"><span class="hs-identifier">get_rank</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2152"></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;cmpTypeX.get_rank&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627613240"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><a href="#local-1627613241"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2153"></a><span>            </span><span class="hs-identifier">get_rank</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-2154"></a><span>            </span><span class="hs-identifier">get_rank</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-2155"></a><span>            </span><span class="hs-identifier">get_rank</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span>
</span><a name="line-2156"></a><span>            </span><span class="hs-identifier">get_rank</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-2157"></a><span>            </span><span class="hs-identifier">get_rank</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">5</span><span>
</span><a name="line-2158"></a><span>            </span><span class="hs-identifier">get_rank</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">6</span><span>
</span><a name="line-2159"></a><span>            </span><span class="hs-identifier">get_rank</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">7</span><span>
</span><a name="line-2160"></a><span>
</span><a name="line-2161"></a><span>    </span><span class="hs-identifier">gos</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a><span>
</span><a name="line-2162"></a><span>    </span><a name="local-1627613192"><a href="#local-1627613192"><span class="hs-identifier">gos</span></a></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a><span>
</span><a name="line-2163"></a><span>    </span><span class="hs-identifier">gos</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#TLT"><span class="hs-identifier hs-var">TLT</span></a><span>
</span><a name="line-2164"></a><span>    </span><span class="hs-identifier">gos</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-identifier">_</span><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#TGT"><span class="hs-identifier hs-var">TGT</span></a><span>
</span><a name="line-2165"></a><span>    </span><span class="hs-identifier">gos</span><span> </span><a name="local-1627613243"><a href="#local-1627613243"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627613244"><a href="#local-1627613244"><span class="hs-identifier">ty1</span></a></a><span class="hs-glyph">:</span><a name="local-1627613245"><a href="#local-1627613245"><span class="hs-identifier">tys1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-1627613246"><a href="#local-1627613246"><span class="hs-identifier">ty2</span></a></a><span class="hs-glyph">:</span><a name="local-1627613247"><a href="#local-1627613247"><span class="hs-identifier">tys2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613191"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613243"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613244"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-1627613246"><span class="hs-identifier hs-var">ty2</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627613189"><span class="hs-identifier hs-var">thenCmpTy</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613192"><span class="hs-identifier hs-var">gos</span></a><span> </span><a href="#local-1627613243"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613245"><span class="hs-identifier hs-var">tys1</span></a><span> </span><a href="#local-1627613247"><span class="hs-identifier hs-var">tys2</span></a><span>
</span><a name="line-2166"></a><span>
</span><a name="line-2167"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-2168"></a><span class="hs-identifier">cmpTypesX</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-2169"></a><a name="cmpTypesX"><a href="Type.html#cmpTypesX"><span class="hs-identifier">cmpTypesX</span></a></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-2170"></a><span class="hs-identifier">cmpTypesX</span><span> </span><a name="local-1627613249"><a href="#local-1627613249"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627613250"><a href="#local-1627613250"><span class="hs-identifier">t1</span></a></a><span class="hs-glyph">:</span><a name="local-1627613251"><a href="#local-1627613251"><span class="hs-identifier">tys1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-1627613252"><a href="#local-1627613252"><span class="hs-identifier">t2</span></a></a><span class="hs-glyph">:</span><a name="local-1627613253"><a href="#local-1627613253"><span class="hs-identifier">tys2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#cmpTypeX"><span class="hs-identifier hs-var">cmpTypeX</span></a><span> </span><a href="#local-1627613249"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613250"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-1627613252"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2171"></a><span>                                      </span><span class="hs-special">`</span><a href="Util.html#thenCmp"><span class="hs-identifier hs-var">thenCmp</span></a><span class="hs-special">`</span><span> </span><a href="Type.html#cmpTypesX"><span class="hs-identifier hs-var">cmpTypesX</span></a><span> </span><a href="#local-1627613249"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-1627613251"><span class="hs-identifier hs-var">tys1</span></a><span> </span><a href="#local-1627613253"><span class="hs-identifier hs-var">tys2</span></a><span>
</span><a name="line-2172"></a><span class="hs-identifier">cmpTypesX</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-2173"></a><span class="hs-identifier">cmpTypesX</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-identifier">_</span><span>         </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-2174"></a><span>
</span><a name="line-2175"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-2176"></a><span class="hs-comment">-- | Compare two 'TyCon's. NB: This should /never/ see the &quot;star synonyms&quot;,</span><span>
</span><a name="line-2177"></a><span class="hs-comment">-- as recognized by Kind.isStarKindSynonymTyCon. See Note</span><span>
</span><a name="line-2178"></a><span class="hs-comment">-- [Kind Constraint and kind *] in Kind.</span><span>
</span><a name="line-2179"></a><span class="hs-identifier">cmpTc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-2180"></a><a name="cmpTc"><a href="Type.html#cmpTc"><span class="hs-identifier">cmpTc</span></a></a><span> </span><a name="local-1627613254"><a href="#local-1627613254"><span class="hs-identifier">tc1</span></a></a><span> </span><a name="local-1627613255"><a href="#local-1627613255"><span class="hs-identifier">tc2</span></a></a><span>
</span><a name="line-2181"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">not</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">isStarKindSynonymTyCon</span><span> </span><a href="Kind.html#isStarKindSynonymTyCon"><span class="hs-identifier hs-var">tc1</span></a><span class="hs-special">)</span><span> </span><a href="Kind.html#isStarKindSynonymTyCon"><span class="hs-operator hs-var">&amp;&amp;</span></a><span> </span><a href="Kind.html#isStarKindSynonymTyCon"><span class="hs-identifier hs-var">not</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">isStarKindSynonymTyCon</span><span> </span><a href="Kind.html#isStarKindSynonymTyCon"><span class="hs-identifier hs-var">tc2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-2182"></a><span>    </span><a href="#local-1627613256"><span class="hs-identifier hs-var">u1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-1627613257"><span class="hs-identifier hs-var">u2</span></a><span>
</span><a name="line-2183"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2184"></a><span>    </span><a name="local-1627613256"><a href="#local-1627613256"><span class="hs-identifier">u1</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConUnique</span><span> </span><a href="#local-1627613254"><span class="hs-identifier hs-var">tc1</span></a><span>
</span><a name="line-2185"></a><span>    </span><a name="local-1627613257"><a href="#local-1627613257"><span class="hs-identifier">u2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConUnique</span><span> </span><a href="#local-1627613255"><span class="hs-identifier hs-var">tc2</span></a><span>
</span><a name="line-2186"></a><span>
</span><a name="line-2187"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        The kind of a type
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-2194"></a><span>
</span><a name="line-2195"></a><span class="hs-identifier">typeKind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>
</span><a name="line-2196"></a><a name="typeKind"><a href="Type.html#typeKind"><span class="hs-identifier">typeKind</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627613258"><a href="#local-1627613258"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627613259"><a href="#local-1627613259"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConKind</span><span> </span><a href="#local-1627613258"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627613259"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-2197"></a><span class="hs-identifier">typeKind</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1627613260"><a href="#local-1627613260"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-1627613261"><a href="#local-1627613261"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#piResultTy"><span class="hs-identifier hs-var">piResultTy</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1627613260"><span class="hs-identifier hs-var">fun</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627613261"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-2198"></a><span class="hs-identifier">typeKind</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><a name="local-1627613262"><a href="#local-1627613262"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeLiteralKind"><span class="hs-identifier hs-var">typeLiteralKind</span></a><span> </span><a href="#local-1627613262"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-2199"></a><span class="hs-identifier">typeKind</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span>
</span><a name="line-2200"></a><span class="hs-identifier">typeKind</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627613263"><a href="#local-1627613263"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-1627613263"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2201"></a><span class="hs-identifier">typeKind</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-1627613264"><a href="#local-1627613264"><span class="hs-identifier">tyvar</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1627613264"><span class="hs-identifier hs-var">tyvar</span></a><span>
</span><a name="line-2202"></a><span class="hs-identifier">typeKind</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-1627613265"><a href="#local-1627613265"><span class="hs-identifier">_ty</span></a></a><span> </span><a name="local-1627613266"><a href="#local-1627613266"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pSnd</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Coercion.html#coercionKind"><span class="hs-identifier hs-var">coercionKind</span></a><span> </span><a href="#local-1627613266"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2203"></a><span class="hs-identifier">typeKind</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-1627613267"><a href="#local-1627613267"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#coercionType"><span class="hs-identifier hs-var">coercionType</span></a><span> </span><a href="#local-1627613267"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2204"></a><span>
</span><a name="line-2205"></a><span class="hs-identifier">typeLiteralKind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyLit"><span class="hs-identifier hs-type">TyLit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>
</span><a name="line-2206"></a><a name="typeLiteralKind"><a href="Type.html#typeLiteralKind"><span class="hs-identifier">typeLiteralKind</span></a></a><span> </span><a name="local-1627613268"><a href="#local-1627613268"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2207"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627613268"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2208"></a><span>    </span><a href="TyCoRep.html#NumTyLit"><span class="hs-identifier hs-var">NumTyLit</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TysWiredIn.html#typeNatKind"><span class="hs-identifier hs-var">typeNatKind</span></a><span>
</span><a name="line-2209"></a><span>    </span><a href="TyCoRep.html#StrTyLit"><span class="hs-identifier hs-var">StrTyLit</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TysWiredIn.html#typeSymbolKind"><span class="hs-identifier hs-var">typeSymbolKind</span></a><span>
</span><a name="line-2210"></a><span>
</span><a name="line-2211"></a><span class="hs-comment">-- | Print a tyvar with its kind</span><span>
</span><a name="line-2212"></a><span class="hs-identifier">pprTyVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2213"></a><a name="pprTyVar"><a href="Type.html#pprTyVar"><span class="hs-identifier">pprTyVar</span></a></a><span> </span><a name="local-1627613269"><a href="#local-1627613269"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627613269"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1627613269"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-2214"></a><span>
</span><a name="line-2215"></a><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
        Miscellaneous functions
%*                                                                      *
%************************************************************************

-}</span><span>
</span><a name="line-2223"></a><span class="hs-comment">-- | All type constructors occurring in the type; looking through type</span><span>
</span><a name="line-2224"></a><span class="hs-comment">--   synonyms, but not newtypes.</span><span>
</span><a name="line-2225"></a><span class="hs-comment">--  When it finds a Class, it returns the class TyCon.</span><span>
</span><a name="line-2226"></a><span class="hs-identifier">tyConsOfType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameEnv.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-2227"></a><a name="tyConsOfType"><a href="Type.html#tyConsOfType"><span class="hs-identifier">tyConsOfType</span></a></a><span> </span><a name="local-1627613270"><a href="#local-1627613270"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-2228"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613271"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613270"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2229"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2230"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameEnv.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>  </span><span class="hs-comment">-- The NameEnv does duplicate elim</span><span>
</span><a name="line-2231"></a><span>     </span><a name="local-1627613271"><a href="#local-1627613271"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-1627613278"><a href="#local-1627613278"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627613279"><a href="#local-1627613279"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-1627613278"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613271"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613279"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-2232"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="NameEnv.html#emptyNameEnv"><span class="hs-identifier hs-var">emptyNameEnv</span></a><span>
</span><a name="line-2233"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="NameEnv.html#emptyNameEnv"><span class="hs-identifier hs-var">emptyNameEnv</span></a><span>
</span><a name="line-2234"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627613280"><a href="#local-1627613280"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627613281"><a href="#local-1627613281"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613276"><span class="hs-identifier hs-var">go_tc</span></a><span> </span><a href="#local-1627613280"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="NameEnv.html#plusNameEnv"><span class="hs-identifier hs-var">plusNameEnv</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613274"><span class="hs-identifier hs-var">go_s</span></a><span> </span><a href="#local-1627613281"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-2235"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1627613282"><a href="#local-1627613282"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627613283"><a href="#local-1627613283"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613271"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613282"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="NameEnv.html#plusNameEnv"><span class="hs-identifier hs-var">plusNameEnv</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613271"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613283"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2236"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627613284"><a href="#local-1627613284"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627613285"><a href="#local-1627613285"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613271"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613284"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="NameEnv.html#plusNameEnv"><span class="hs-identifier hs-var">plusNameEnv</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613271"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613285"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="NameEnv.html#plusNameEnv"><span class="hs-identifier hs-var">plusNameEnv</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613276"><span class="hs-identifier hs-var">go_tc</span></a><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span>
</span><a name="line-2237"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1627613286"><a href="#local-1627613286"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-1627613287"><a href="#local-1627613287"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613271"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613287"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><a href="NameEnv.html#plusNameEnv"><span class="hs-identifier hs-var">plusNameEnv</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613271"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1627613286"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-2238"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-1627613288"><a href="#local-1627613288"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627613289"><a href="#local-1627613289"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613271"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613288"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><a href="NameEnv.html#plusNameEnv"><span class="hs-identifier hs-var">plusNameEnv</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613289"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2239"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-1627613290"><a href="#local-1627613290"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613290"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2240"></a><span>
</span><a name="line-2241"></a><span>     </span><a name="local-1627613272"><a href="#local-1627613272"><span class="hs-identifier">go_co</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Refl"><span class="hs-identifier hs-var">Refl</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627613291"><a href="#local-1627613291"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613271"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613291"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2242"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConAppCo"><span class="hs-identifier hs-var">TyConAppCo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627613292"><a href="#local-1627613292"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627613293"><a href="#local-1627613293"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613276"><span class="hs-identifier hs-var">go_tc</span></a><span> </span><a href="#local-1627613292"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="NameEnv.html#plusNameEnv"><span class="hs-identifier hs-var">plusNameEnv</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613275"><span class="hs-identifier hs-var">go_cos</span></a><span> </span><a href="#local-1627613293"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-2243"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppCo"><span class="hs-identifier hs-var">AppCo</span></a><span> </span><a name="local-1627613294"><a href="#local-1627613294"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-1627613295"><a href="#local-1627613295"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613294"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-special">`</span><a href="NameEnv.html#plusNameEnv"><span class="hs-identifier hs-var">plusNameEnv</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613295"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-2244"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllCo"><span class="hs-identifier hs-var">ForAllCo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627613296"><a href="#local-1627613296"><span class="hs-identifier">kind_co</span></a></a><span> </span><a name="local-1627613297"><a href="#local-1627613297"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613296"><span class="hs-identifier hs-var">kind_co</span></a><span> </span><span class="hs-special">`</span><a href="NameEnv.html#plusNameEnv"><span class="hs-identifier hs-var">plusNameEnv</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613297"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2245"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoVarCo"><span class="hs-identifier hs-var">CoVarCo</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="NameEnv.html#emptyNameEnv"><span class="hs-identifier hs-var">emptyNameEnv</span></a><span>
</span><a name="line-2246"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AxiomInstCo"><span class="hs-identifier hs-var">AxiomInstCo</span></a><span> </span><a name="local-1627613298"><a href="#local-1627613298"><span class="hs-identifier">ax</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627613299"><a href="#local-1627613299"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613277"><span class="hs-identifier hs-var">go_ax</span></a><span> </span><a href="#local-1627613298"><span class="hs-identifier hs-var">ax</span></a><span> </span><span class="hs-special">`</span><a href="NameEnv.html#plusNameEnv"><span class="hs-identifier hs-var">plusNameEnv</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613275"><span class="hs-identifier hs-var">go_cos</span></a><span> </span><a href="#local-1627613299"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-2247"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#UnivCo"><span class="hs-identifier hs-var">UnivCo</span></a><span> </span><a name="local-1627613300"><a href="#local-1627613300"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627613301"><a href="#local-1627613301"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627613302"><a href="#local-1627613302"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613273"><span class="hs-identifier hs-var">go_prov</span></a><span> </span><a href="#local-1627613300"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">`</span><a href="NameEnv.html#plusNameEnv"><span class="hs-identifier hs-var">plusNameEnv</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613271"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613301"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-special">`</span><a href="NameEnv.html#plusNameEnv"><span class="hs-identifier hs-var">plusNameEnv</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613271"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613302"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2248"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#SymCo"><span class="hs-identifier hs-var">SymCo</span></a><span> </span><a name="local-1627613303"><a href="#local-1627613303"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613303"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2249"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TransCo"><span class="hs-identifier hs-var">TransCo</span></a><span> </span><a name="local-1627613304"><a href="#local-1627613304"><span class="hs-identifier">co1</span></a></a><span> </span><a name="local-1627613305"><a href="#local-1627613305"><span class="hs-identifier">co2</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613304"><span class="hs-identifier hs-var">co1</span></a><span> </span><span class="hs-special">`</span><a href="NameEnv.html#plusNameEnv"><span class="hs-identifier hs-var">plusNameEnv</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613305"><span class="hs-identifier hs-var">co2</span></a><span>
</span><a name="line-2250"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#NthCo"><span class="hs-identifier hs-var">NthCo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627613306"><a href="#local-1627613306"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613306"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2251"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LRCo"><span class="hs-identifier hs-var">LRCo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627613307"><a href="#local-1627613307"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613307"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2252"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#InstCo"><span class="hs-identifier hs-var">InstCo</span></a><span> </span><a name="local-1627613308"><a href="#local-1627613308"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-1627613309"><a href="#local-1627613309"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613308"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-special">`</span><a href="NameEnv.html#plusNameEnv"><span class="hs-identifier hs-var">plusNameEnv</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613309"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-2253"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoherenceCo"><span class="hs-identifier hs-var">CoherenceCo</span></a><span> </span><a name="local-1627613310"><a href="#local-1627613310"><span class="hs-identifier">co1</span></a></a><span> </span><a name="local-1627613311"><a href="#local-1627613311"><span class="hs-identifier">co2</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613310"><span class="hs-identifier hs-var">co1</span></a><span> </span><span class="hs-special">`</span><a href="NameEnv.html#plusNameEnv"><span class="hs-identifier hs-var">plusNameEnv</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613311"><span class="hs-identifier hs-var">co2</span></a><span>
</span><a name="line-2254"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#KindCo"><span class="hs-identifier hs-var">KindCo</span></a><span> </span><a name="local-1627613312"><a href="#local-1627613312"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613312"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2255"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#SubCo"><span class="hs-identifier hs-var">SubCo</span></a><span> </span><a name="local-1627613313"><a href="#local-1627613313"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613313"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2256"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AxiomRuleCo"><span class="hs-identifier hs-var">AxiomRuleCo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627613314"><a href="#local-1627613314"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613275"><span class="hs-identifier hs-var">go_cos</span></a><span> </span><a href="#local-1627613314"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-2257"></a><span>
</span><a name="line-2258"></a><span>     </span><a name="local-1627613273"><a href="#local-1627613273"><span class="hs-identifier">go_prov</span></a></a><span> </span><a href="TyCoRep.html#UnsafeCoerceProv"><span class="hs-identifier hs-var">UnsafeCoerceProv</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="NameEnv.html#emptyNameEnv"><span class="hs-identifier hs-var">emptyNameEnv</span></a><span>
</span><a name="line-2259"></a><span>     </span><span class="hs-identifier">go_prov</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#PhantomProv"><span class="hs-identifier hs-var">PhantomProv</span></a><span> </span><a name="local-1627613315"><a href="#local-1627613315"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613315"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2260"></a><span>     </span><span class="hs-identifier">go_prov</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ProofIrrelProv"><span class="hs-identifier hs-var">ProofIrrelProv</span></a><span> </span><a name="local-1627613316"><a href="#local-1627613316"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613316"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2261"></a><span>     </span><span class="hs-identifier">go_prov</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#PluginProv"><span class="hs-identifier hs-var">PluginProv</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="NameEnv.html#emptyNameEnv"><span class="hs-identifier hs-var">emptyNameEnv</span></a><span>
</span><a name="line-2262"></a><span>     </span><span class="hs-identifier">go_prov</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#HoleProv"><span class="hs-identifier hs-var">HoleProv</span></a><span> </span><a name="local-1627613317"><a href="#local-1627613317"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;tyConsOfType hit a hole&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1627613317"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span>
</span><a name="line-2263"></a><span>
</span><a name="line-2264"></a><span>     </span><a name="local-1627613274"><a href="#local-1627613274"><span class="hs-identifier">go_s</span></a></a><span> </span><a name="local-1627613318"><a href="#local-1627613318"><span class="hs-identifier">tys</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><a href="NameEnv.html#plusNameEnv"><span class="hs-identifier hs-var">plusNameEnv</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-1627613271"><span class="hs-identifier hs-var">go</span></a><span class="hs-special">)</span><span>     </span><a href="NameEnv.html#emptyNameEnv"><span class="hs-identifier hs-var">emptyNameEnv</span></a><span> </span><a href="#local-1627613318"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-2265"></a><span>     </span><a name="local-1627613275"><a href="#local-1627613275"><span class="hs-identifier">go_cos</span></a></a><span> </span><a name="local-1627613319"><a href="#local-1627613319"><span class="hs-identifier">cos</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><a href="NameEnv.html#plusNameEnv"><span class="hs-identifier hs-var">plusNameEnv</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-1627613272"><span class="hs-identifier hs-var">go_co</span></a><span class="hs-special">)</span><span>  </span><a href="NameEnv.html#emptyNameEnv"><span class="hs-identifier hs-var">emptyNameEnv</span></a><span> </span><a href="#local-1627613319"><span class="hs-identifier hs-var">cos</span></a><span>
</span><a name="line-2266"></a><span>
</span><a name="line-2267"></a><span>     </span><a name="local-1627613276"><a href="#local-1627613276"><span class="hs-identifier">go_tc</span></a></a><span> </span><a name="local-1627613320"><a href="#local-1627613320"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameEnv.html#unitNameEnv"><span class="hs-identifier hs-var">unitNameEnv</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-1627613320"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627613320"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-2268"></a><span>     </span><a name="local-1627613277"><a href="#local-1627613277"><span class="hs-identifier">go_ax</span></a></a><span> </span><a name="local-1627613321"><a href="#local-1627613321"><span class="hs-identifier">ax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613276"><span class="hs-identifier hs-var">go_tc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="CoAxiom.html#coAxiomTyCon"><span class="hs-identifier hs-var">coAxiomTyCon</span></a><span> </span><a href="#local-1627613321"><span class="hs-identifier hs-var">ax</span></a><span>
</span><a name="line-2269"></a><span>
</span><a name="line-2270"></a><span class="hs-comment">-- | Find the result 'Kind' of a type synonym,</span><span>
</span><a name="line-2271"></a><span class="hs-comment">-- after applying it to its 'arity' number of type variables</span><span>
</span><a name="line-2272"></a><span class="hs-comment">-- Actually this function works fine on data types too,</span><span>
</span><a name="line-2273"></a><span class="hs-comment">-- but they'd always return '*', so we never need to ask</span><span>
</span><a name="line-2274"></a><span class="hs-identifier">synTyConResKind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>
</span><a name="line-2275"></a><a name="synTyConResKind"><a href="Type.html#synTyConResKind"><span class="hs-identifier">synTyConResKind</span></a></a><span> </span><a name="local-1627613322"><a href="#local-1627613322"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConKind</span><span> </span><a href="#local-1627613322"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyVarTys"><span class="hs-identifier hs-var">mkTyVarTys</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConTyVars</span><span> </span><a href="#local-1627613322"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2276"></a><span>
</span><a name="line-2277"></a><span class="hs-comment">-- | Retrieve the free variables in this type, splitting them based</span><span>
</span><a name="line-2278"></a><span class="hs-comment">-- on whether the variable was used in a dependent context. It's possible</span><span>
</span><a name="line-2279"></a><span class="hs-comment">-- for a variable to be reported twice, if it's used both dependently</span><span>
</span><a name="line-2280"></a><span class="hs-comment">-- and non-dependently. (This isn't the most precise analysis, because</span><span>
</span><a name="line-2281"></a><span class="hs-comment">-- it's used in the typechecking knot. It might list some dependent</span><span>
</span><a name="line-2282"></a><span class="hs-comment">-- variables as also non-dependent.)</span><span>
</span><a name="line-2283"></a><span class="hs-identifier">splitDepVarsOfType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a><span> </span><a href="VarSet.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a><span>
</span><a name="line-2284"></a><a name="splitDepVarsOfType"><a href="Type.html#splitDepVarsOfType"><span class="hs-identifier">splitDepVarsOfType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613323"><span class="hs-identifier hs-var">go</span></a><span>
</span><a name="line-2285"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2286"></a><span>    </span><a name="local-1627613323"><a href="#local-1627613323"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-1627613325"><a href="#local-1627613325"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1627613325"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-2287"></a><span>                                        </span><span class="hs-special">(</span><a href="VarSet.html#unitVarSet"><span class="hs-identifier hs-var">unitVarSet</span></a><span> </span><a href="#local-1627613325"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-2288"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1627613326"><a href="#local-1627613326"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627613327"><a href="#local-1627613327"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613323"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613326"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613323"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613327"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2289"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627613328"><a href="#local-1627613328"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a><span> </span><a href="#local-1627613323"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613328"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-2290"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627613329"><a href="#local-1627613329"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627613330"><a href="#local-1627613330"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613323"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613329"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613323"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613330"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-2291"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1627613331"><a href="#local-1627613331"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-1627613332"><a href="#local-1627613332"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2292"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-1627613333"><a href="#local-1627613333"><span class="hs-identifier">kvs</span></a></a><span> </span><a name="local-1627613334"><a href="#local-1627613334"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613323"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613332"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-2293"></a><span>        </span><a href="Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627613333"><span class="hs-identifier hs-var">kvs</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#delVarSet"><span class="hs-identifier hs-var">delVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613331"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#unionVarSet"><span class="hs-identifier hs-var">unionVarSet</span></a><span class="hs-special">`</span><span> </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1627613331"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2294"></a><span>             </span><span class="hs-special">(</span><a href="#local-1627613334"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#delVarSet"><span class="hs-identifier hs-var">delVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613331"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-2295"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span>
</span><a name="line-2296"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-1627613335"><a href="#local-1627613335"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627613336"><a href="#local-1627613336"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613323"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613335"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfCo"><span class="hs-identifier hs-var">tyCoVarsOfCo</span></a><span> </span><a href="#local-1627613336"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-2297"></a><span>                                                        </span><a href="VarSet.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a><span>
</span><a name="line-2298"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-1627613337"><a href="#local-1627613337"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613324"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-1627613337"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2299"></a><span>
</span><a name="line-2300"></a><span>    </span><a name="local-1627613324"><a href="#local-1627613324"><span class="hs-identifier">go_co</span></a></a><span> </span><a name="local-1627613338"><a href="#local-1627613338"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-1627613339"><a href="#local-1627613339"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-1627613340"><a href="#local-1627613340"><span class="hs-identifier">ty2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#coercionKind"><span class="hs-identifier hs-var">coercionKind</span></a><span> </span><a href="#local-1627613338"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-2301"></a><span>               </span><a href="#local-1627613323"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613339"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613323"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613340"><span class="hs-identifier hs-var">ty2</span></a><span>  </span><span class="hs-comment">-- NB: the Pairs separate along different</span><span>
</span><a name="line-2302"></a><span>                                        </span><span class="hs-comment">-- dimensions here. Be careful!</span><span>
</span><a name="line-2303"></a><span>
</span><a name="line-2304"></a><span class="hs-comment">-- | Like 'splitDepVarsOfType', but over a list of types</span><span>
</span><a name="line-2305"></a><span class="hs-identifier">splitDepVarsOfTypes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a><span> </span><a href="VarSet.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a><span>
</span><a name="line-2306"></a><a name="splitDepVarsOfTypes"><a href="Type.html#splitDepVarsOfTypes"><span class="hs-identifier">splitDepVarsOfTypes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a><span> </span><a href="Type.html#splitDepVarsOfType"><span class="hs-identifier hs-var">splitDepVarsOfType</span></a><span>
</span><a name="line-2307"></a><span>
</span><a name="line-2308"></a><span class="hs-comment">-- | Retrieve the free variables in this type, splitting them based</span><span>
</span><a name="line-2309"></a><span class="hs-comment">-- on whether they are used visibly or invisibly. Invisible ones come</span><span>
</span><a name="line-2310"></a><span class="hs-comment">-- first.</span><span>
</span><a name="line-2311"></a><span class="hs-identifier">splitVisVarsOfType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a><span> </span><a href="VarSet.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a><span>
</span><a name="line-2312"></a><a name="splitVisVarsOfType"><a href="Type.html#splitVisVarsOfType"><span class="hs-identifier">splitVisVarsOfType</span></a></a><span> </span><a name="local-1627613341"><a href="#local-1627613341"><span class="hs-identifier">orig_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a href="#local-1627613344"><span class="hs-identifier hs-var">invis_vars</span></a><span> </span><a href="#local-1627613343"><span class="hs-identifier hs-var">vis_vars</span></a><span>
</span><a name="line-2313"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2314"></a><span>    </span><a href="Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-1627613342"><a href="#local-1627613342"><span class="hs-identifier">invis_vars1</span></a></a><span> </span><a name="local-1627613343"><a href="#local-1627613343"><span class="hs-identifier">vis_vars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613345"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613341"><span class="hs-identifier hs-var">orig_ty</span></a><span>
</span><a name="line-2315"></a><span>    </span><a name="local-1627613344"><a href="#local-1627613344"><span class="hs-identifier">invis_vars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613342"><span class="hs-identifier hs-var">invis_vars1</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#minusVarSet"><span class="hs-identifier hs-var">minusVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613343"><span class="hs-identifier hs-var">vis_vars</span></a><span>
</span><a name="line-2316"></a><span>
</span><a name="line-2317"></a><span>    </span><a name="local-1627613345"><a href="#local-1627613345"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-1627613348"><a href="#local-1627613348"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1627613348"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VarSet.html#unitVarSet"><span class="hs-identifier hs-var">unitVarSet</span></a><span> </span><a href="#local-1627613348"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-2318"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-1627613349"><a href="#local-1627613349"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627613350"><a href="#local-1627613350"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613345"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613349"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613345"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613350"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2319"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-1627613351"><a href="#local-1627613351"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627613352"><a href="#local-1627613352"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613347"><span class="hs-identifier hs-var">go_tc</span></a><span> </span><a href="#local-1627613351"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-1627613352"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-2320"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-1627613353"><a href="#local-1627613353"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627613354"><a href="#local-1627613354"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613345"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613353"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613345"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613354"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2321"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-1627613355"><a href="#local-1627613355"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-1627613356"><a href="#local-1627613356"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2322"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">`</span><a href="VarSet.html#delVarSet"><span class="hs-identifier hs-var">delVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613355"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1627613345"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613356"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span>
</span><a name="line-2323"></a><span>        </span><span class="hs-special">(</span><a href="#local-1627613346"><span class="hs-identifier hs-var">invisible</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1627613355"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2324"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span>
</span><a name="line-2325"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-1627613357"><a href="#local-1627613357"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1627613358"><a href="#local-1627613358"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613345"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613357"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627613346"><span class="hs-identifier hs-var">invisible</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfCo"><span class="hs-identifier hs-var">tyCoVarsOfCo</span></a><span> </span><a href="#local-1627613358"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-2326"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-1627613359"><a href="#local-1627613359"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627613346"><span class="hs-identifier hs-var">invisible</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TyCoRep.html#tyCoVarsOfCo"><span class="hs-identifier hs-var">tyCoVarsOfCo</span></a><span> </span><a href="#local-1627613359"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2327"></a><span>
</span><a name="line-2328"></a><span>    </span><a name="local-1627613346"><a href="#local-1627613346"><span class="hs-identifier">invisible</span></a></a><span> </span><a name="local-1627613360"><a href="#local-1627613360"><span class="hs-identifier">vs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a href="#local-1627613360"><span class="hs-identifier hs-var">vs</span></a><span> </span><a href="VarSet.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a><span>
</span><a name="line-2329"></a><span>
</span><a name="line-2330"></a><span>    </span><a name="local-1627613347"><a href="#local-1627613347"><span class="hs-identifier">go_tc</span></a></a><span> </span><a name="local-1627613361"><a href="#local-1627613361"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-1627613362"><a href="#local-1627613362"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1627613363"><a href="#local-1627613363"><span class="hs-identifier">invis</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627613364"><a href="#local-1627613364"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#partitionInvisibles"><span class="hs-identifier hs-var">partitionInvisibles</span></a><span> </span><a href="#local-1627613361"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-1627613362"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-2331"></a><span>                   </span><a href="#local-1627613346"><span class="hs-identifier hs-var">invisible</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a><span> </span><a href="#local-1627613363"><span class="hs-identifier hs-var">invis</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a><span> </span><a href="#local-1627613345"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627613364"><span class="hs-identifier hs-var">vis</span></a><span>
</span><a name="line-2332"></a><span>
</span><a name="line-2333"></a><span class="hs-identifier">splitVisVarsOfTypes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a><span> </span><a href="VarSet.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a><span>
</span><a name="line-2334"></a><a name="splitVisVarsOfTypes"><a href="Type.html#splitVisVarsOfTypes"><span class="hs-identifier">splitVisVarsOfTypes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a><span> </span><a href="Type.html#splitVisVarsOfType"><span class="hs-identifier hs-var">splitVisVarsOfType</span></a><span>
</span><a name="line-2335"></a></pre></body></html>