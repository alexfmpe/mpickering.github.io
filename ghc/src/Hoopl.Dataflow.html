<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses  #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# OPTIONS_GHC -fprof-auto-top #-}</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-comment">--</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Copyright (c) 2010, Jo&#227;o Dias, Simon Marlow, Simon Peyton Jones,</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- and Norman Ramsey</span><span>
</span><a name="line-12"></a><span class="hs-comment">--</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- Modifications copyright (c) The University of Glasgow 2012</span><span>
</span><a name="line-14"></a><span class="hs-comment">--</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- This module is a specialised and optimised version of</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- Compiler.Hoopl.Dataflow in the hoopl package.  In particular it is</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- specialised to the UniqSM monad.</span><span>
</span><a name="line-18"></a><span class="hs-comment">--</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hoopl</span><span class="hs-operator">.</span><span class="hs-identifier">Dataflow</span><span>
</span><a name="line-21"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#DataflowLattice"><span class="hs-identifier hs-type">DataflowLattice</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-type">OldFact</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-type">NewFact</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkFactBase"><span class="hs-identifier hs-var">mkFactBase</span></a><span>
</span><a name="line-22"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#ChangeFlag"><span class="hs-identifier hs-type">ChangeFlag</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdPass"><span class="hs-identifier hs-type">FwdPass</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdTransfer"><span class="hs-identifier hs-type">FwdTransfer</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkFTransfer"><span class="hs-identifier hs-var">mkFTransfer</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkFTransfer3"><span class="hs-identifier hs-var">mkFTransfer3</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#getFTransfer3"><span class="hs-identifier hs-var">getFTransfer3</span></a><span>
</span><a name="line-24"></a><span>  </span><span class="hs-comment">-- * Respecting Fuel</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span>  </span><span class="hs-comment">-- $fuel</span><span>
</span><a name="line-27"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span class="hs-special">,</span><span>  </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkFRewrite"><span class="hs-identifier hs-var">mkFRewrite</span></a><span class="hs-special">,</span><span>  </span><a href="Hoopl.Dataflow.html#mkFRewrite3"><span class="hs-identifier hs-var">mkFRewrite3</span></a><span class="hs-special">,</span><span>  </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#getFRewrite3"><span class="hs-identifier hs-var">getFRewrite3</span></a><span class="hs-special">,</span><span> </span><a href="Hoopl.Dataflow.html#noFwdRewrite"><span class="hs-identifier hs-var">noFwdRewrite</span></a><span>
</span><a name="line-28"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#wrapFR"><span class="hs-identifier hs-var">wrapFR</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#wrapFR2"><span class="hs-identifier hs-var">wrapFR2</span></a><span>
</span><a name="line-29"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdPass"><span class="hs-identifier hs-type">BwdPass</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdTransfer"><span class="hs-identifier hs-type">BwdTransfer</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkBTransfer"><span class="hs-identifier hs-var">mkBTransfer</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkBTransfer3"><span class="hs-identifier hs-var">mkBTransfer3</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#getBTransfer3"><span class="hs-identifier hs-var">getBTransfer3</span></a><span>
</span><a name="line-30"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#wrapBR"><span class="hs-identifier hs-var">wrapBR</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#wrapBR2"><span class="hs-identifier hs-var">wrapBR2</span></a><span>
</span><a name="line-31"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span class="hs-special">,</span><span>  </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkBRewrite"><span class="hs-identifier hs-var">mkBRewrite</span></a><span class="hs-special">,</span><span>  </span><a href="Hoopl.Dataflow.html#mkBRewrite3"><span class="hs-identifier hs-var">mkBRewrite3</span></a><span class="hs-special">,</span><span>  </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#getBRewrite3"><span class="hs-identifier hs-var">getBRewrite3</span></a><span class="hs-special">,</span><span> </span><a href="Hoopl.Dataflow.html#noBwdRewrite"><span class="hs-identifier hs-var">noBwdRewrite</span></a><span>
</span><a name="line-32"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Hoopl.Dataflow.html#analyzeAndRewriteFwd"><span class="hs-identifier hs-var">analyzeAndRewriteFwd</span></a><span class="hs-special">,</span><span>  </span><a href="Hoopl.Dataflow.html#analyzeAndRewriteBwd"><span class="hs-identifier hs-var">analyzeAndRewriteBwd</span></a><span>
</span><a name="line-33"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Hoopl.Dataflow.html#analyzeFwd"><span class="hs-identifier hs-var">analyzeFwd</span></a><span class="hs-special">,</span><span> </span><a href="Hoopl.Dataflow.html#analyzeFwdBlocks"><span class="hs-identifier hs-var">analyzeFwdBlocks</span></a><span class="hs-special">,</span><span> </span><a href="Hoopl.Dataflow.html#analyzeBwd"><span class="hs-identifier hs-var">analyzeBwd</span></a><span>
</span><a name="line-34"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span class="hs-keyword">where</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="UniqSupply.html"><span class="hs-identifier">UniqSupply</span></a><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span></a><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><a href="../array-0.5.1.0/src/%{MODULE/./-}.html#%{NAME}/Data.Array.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Array</span></a><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.html"><span class="hs-identifier">Compiler</span><span class="hs-operator">.</span><span class="hs-identifier">Hoopl</span></a><span> </span><span class="hs-keyword">hiding</span><span>
</span><a name="line-43"></a><span>   </span><span class="hs-special">(</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkBRewrite3"><span class="hs-identifier hs-var">mkBRewrite3</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkFRewrite3"><span class="hs-identifier hs-var">mkFRewrite3</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#noFwdRewrite"><span class="hs-identifier hs-var">noFwdRewrite</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#noBwdRewrite"><span class="hs-identifier hs-var">noBwdRewrite</span></a><span>
</span><a name="line-44"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#analyzeAndRewriteBwd"><span class="hs-identifier hs-var">analyzeAndRewriteBwd</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#analyzeAndRewriteFwd"><span class="hs-identifier hs-var">analyzeAndRewriteFwd</span></a><span>
</span><a name="line-45"></a><span>   </span><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Internals.html"><span class="hs-identifier">Compiler</span><span class="hs-operator">.</span><span class="hs-identifier">Hoopl</span><span class="hs-operator">.</span><span class="hs-identifier">Internals</span></a><span>
</span><a name="line-47"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#wrapFR"><span class="hs-identifier hs-var">wrapFR</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#wrapFR2"><span class="hs-identifier hs-var">wrapFR2</span></a><span>
</span><a name="line-48"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#wrapBR"><span class="hs-identifier hs-var">wrapBR</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#wrapBR2"><span class="hs-identifier hs-var">wrapBR2</span></a><span>
</span><a name="line-49"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#splice"><span class="hs-identifier hs-var">splice</span></a><span>
</span><a name="line-50"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span class="hs-identifier">noRewrite</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-1627500135"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500136"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-1627500137"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-56"></a><a name="noRewrite"><a href="Hoopl.Dataflow.html#noRewrite"><span class="hs-identifier">noRewrite</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-identifier">noFwdRewrite</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627500133"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500134"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-59"></a><a name="noFwdRewrite"><a href="Hoopl.Dataflow.html#noFwdRewrite"><span class="hs-identifier">noFwdRewrite</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite3"><span class="hs-identifier hs-var">FwdRewrite3</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#noRewrite"><span class="hs-identifier hs-var">noRewrite</span></a><span class="hs-special">,</span><span> </span><a href="Hoopl.Dataflow.html#noRewrite"><span class="hs-identifier hs-var">noRewrite</span></a><span class="hs-special">,</span><span> </span><a href="Hoopl.Dataflow.html#noRewrite"><span class="hs-identifier hs-var">noRewrite</span></a><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span class="hs-comment">-- | Functions passed to 'mkFRewrite3' should not be aware of the fuel supply.</span><span>
</span><a name="line-62"></a><span class="hs-comment">-- The result returned by 'mkFRewrite3' respects fuel.</span><span>
</span><a name="line-63"></a><span class="hs-identifier">mkFRewrite3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500131"><a href="#local-1627500131"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500132"><a href="#local-1627500132"><span class="hs-identifier">f</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-64"></a><span>               </span><span class="hs-special">(</span><a href="#local-1627500131"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500132"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500131"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-65"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627500131"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500132"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500131"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627500131"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500132"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500131"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627500131"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500132"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-68"></a><a name="mkFRewrite3"><a href="Hoopl.Dataflow.html#mkFRewrite3"><span class="hs-identifier">mkFRewrite3</span></a></a><span> </span><a name="local-1627500138"><a href="#local-1627500138"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627500139"><a href="#local-1627500139"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-1627500140"><a href="#local-1627500140"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite3"><span class="hs-identifier hs-var">FwdRewrite3</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627500141"><span class="hs-identifier hs-var">lift</span></a><span> </span><a href="#local-1627500138"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500141"><span class="hs-identifier hs-var">lift</span></a><span> </span><a href="#local-1627500139"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500141"><span class="hs-identifier hs-var">lift</span></a><span> </span><a href="#local-1627500140"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">lift</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500142"><a href="#local-1627500142"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-1627500143"><a href="#local-1627500143"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627500144"><a href="#local-1627500144"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="#local-1627500142"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500143"><span class="hs-identifier hs-type">t1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-1627500144"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500142"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500143"><span class="hs-identifier hs-type">t1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627500144"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627500131"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500132"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span>        </span><span class="hs-pragma">{-# INLINE lift #-}</span><span>
</span><a name="line-72"></a><span>        </span><a name="local-1627500141"><a href="#local-1627500141"><span class="hs-identifier">lift</span></a></a><span> </span><a name="local-1627500145"><a href="#local-1627500145"><span class="hs-identifier">rw</span></a></a><span> </span><a name="local-1627500146"><a href="#local-1627500146"><span class="hs-identifier">node</span></a></a><span> </span><a name="local-1627500147"><a href="#local-1627500147"><span class="hs-identifier">fact</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-73"></a><span>             </span><a name="local-1627500148"><a href="#local-1627500148"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627500145"><span class="hs-identifier hs-var">rw</span></a><span> </span><a href="#local-1627500146"><span class="hs-identifier hs-var">node</span></a><span> </span><a href="#local-1627500147"><span class="hs-identifier hs-var">fact</span></a><span>
</span><a name="line-74"></a><span>             </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627500148"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-75"></a><span>               </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-76"></a><span>               </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627500149"><a href="#local-1627500149"><span class="hs-identifier">a</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627500149"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="Hoopl.Dataflow.html#noFwdRewrite"><span class="hs-identifier hs-var">noFwdRewrite</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-identifier">noBwdRewrite</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627500129"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500130"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-79"></a><a name="noBwdRewrite"><a href="Hoopl.Dataflow.html#noBwdRewrite"><span class="hs-identifier">noBwdRewrite</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite3"><span class="hs-identifier hs-var">BwdRewrite3</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#noRewrite"><span class="hs-identifier hs-var">noRewrite</span></a><span class="hs-special">,</span><span> </span><a href="Hoopl.Dataflow.html#noRewrite"><span class="hs-identifier hs-var">noRewrite</span></a><span class="hs-special">,</span><span> </span><a href="Hoopl.Dataflow.html#noRewrite"><span class="hs-identifier hs-var">noRewrite</span></a><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-identifier">mkBRewrite3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500127"><a href="#local-1627500127"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500128"><a href="#local-1627500128"><span class="hs-identifier">f</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-82"></a><span>               </span><span class="hs-special">(</span><a href="#local-1627500127"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500128"><span class="hs-identifier hs-type">f</span></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500127"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627500127"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500128"><span class="hs-identifier hs-type">f</span></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500127"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627500127"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500128"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500127"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627500127"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500128"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-86"></a><a name="mkBRewrite3"><a href="Hoopl.Dataflow.html#mkBRewrite3"><span class="hs-identifier">mkBRewrite3</span></a></a><span> </span><a name="local-1627500150"><a href="#local-1627500150"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627500151"><a href="#local-1627500151"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-1627500152"><a href="#local-1627500152"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite3"><span class="hs-identifier hs-var">BwdRewrite3</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627500153"><span class="hs-identifier hs-var">lift</span></a><span> </span><a href="#local-1627500150"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500153"><span class="hs-identifier hs-var">lift</span></a><span> </span><a href="#local-1627500151"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500153"><span class="hs-identifier hs-var">lift</span></a><span> </span><a href="#local-1627500152"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">lift</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500154"><a href="#local-1627500154"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-1627500155"><a href="#local-1627500155"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-1627500156"><a href="#local-1627500156"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="#local-1627500154"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500155"><span class="hs-identifier hs-type">t1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-1627500156"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500154"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500155"><span class="hs-identifier hs-type">t1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627500156"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627500127"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500128"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-89"></a><span>        </span><span class="hs-pragma">{-# INLINE lift #-}</span><span>
</span><a name="line-90"></a><span>        </span><a name="local-1627500153"><a href="#local-1627500153"><span class="hs-identifier">lift</span></a></a><span> </span><a name="local-1627500157"><a href="#local-1627500157"><span class="hs-identifier">rw</span></a></a><span> </span><a name="local-1627500158"><a href="#local-1627500158"><span class="hs-identifier">node</span></a></a><span> </span><a name="local-1627500159"><a href="#local-1627500159"><span class="hs-identifier">fact</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-91"></a><span>             </span><a name="local-1627500160"><a href="#local-1627500160"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627500157"><span class="hs-identifier hs-var">rw</span></a><span> </span><a href="#local-1627500158"><span class="hs-identifier hs-var">node</span></a><span> </span><a href="#local-1627500159"><span class="hs-identifier hs-var">fact</span></a><span>
</span><a name="line-92"></a><span>             </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627500160"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-93"></a><span>               </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-94"></a><span>               </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627500161"><a href="#local-1627500161"><span class="hs-identifier">a</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627500161"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="Hoopl.Dataflow.html#noBwdRewrite"><span class="hs-identifier hs-var">noBwdRewrite</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-97"></a><span class="hs-comment">--              Analyze and rewrite forward: the interface</span><span>
</span><a name="line-98"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span class="hs-comment">-- | if the graph being analyzed is open at the entry, there must</span><span>
</span><a name="line-101"></a><span class="hs-comment">--   be no other entry point, or all goes horribly wrong...</span><span>
</span><a name="line-102"></a><span class="hs-identifier">analyzeAndRewriteFwd</span><span>
</span><a name="line-103"></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500123"><a href="#local-1627500123"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500124"><a href="#local-1627500124"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627500125"><a href="#local-1627500125"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500126"><a href="#local-1627500126"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span>  </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><a href="#local-1627500123"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-104"></a><span>      </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdPass"><span class="hs-identifier hs-type">FwdPass</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627500123"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500124"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-105"></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeC"><span class="hs-identifier hs-type">MaybeC</span></a><span> </span><a href="#local-1627500125"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span>
</span><a name="line-106"></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500123"><span class="hs-identifier hs-type">n</span></a><span>  </span><a href="#local-1627500125"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500126"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500125"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500124"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-107"></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500123"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500125"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500126"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500124"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeO"><span class="hs-identifier hs-type">MaybeO</span></a><span> </span><a href="#local-1627500126"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500124"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-108"></a><a name="analyzeAndRewriteFwd"><a href="Hoopl.Dataflow.html#analyzeAndRewriteFwd"><span class="hs-identifier">analyzeAndRewriteFwd</span></a></a><span> </span><a name="local-1627500162"><a href="#local-1627500162"><span class="hs-identifier">pass</span></a></a><span> </span><a name="local-1627500163"><a href="#local-1627500163"><span class="hs-identifier">entries</span></a></a><span> </span><a name="local-1627500164"><a href="#local-1627500164"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-1627500165"><a href="#local-1627500165"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-109"></a><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-1627500166"><a href="#local-1627500166"><span class="hs-identifier">rg</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500167"><a href="#local-1627500167"><span class="hs-identifier">fout</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Hoopl.Dataflow.html#arfGraph"><span class="hs-identifier hs-var">arfGraph</span></a><span> </span><a href="#local-1627500162"><span class="hs-identifier hs-var">pass</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#targetLabels"><span class="hs-identifier hs-var">targetLabels</span></a><span> </span><a href="#local-1627500163"><span class="hs-identifier hs-var">entries</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500164"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-1627500165"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-110"></a><span>     </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1627500168"><a href="#local-1627500168"><span class="hs-identifier">g'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500169"><a href="#local-1627500169"><span class="hs-identifier">fb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Dataflow.html#normalizeGraph"><span class="hs-identifier hs-var">normalizeGraph</span></a><span> </span><a href="#local-1627500166"><span class="hs-identifier hs-var">rg</span></a><span>
</span><a name="line-111"></a><span>     </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627500168"><span class="hs-identifier hs-var">g'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500169"><span class="hs-identifier hs-var">fb</span></a><span class="hs-special">,</span><span> </span><a href="Hoopl.Dataflow.html#distinguishedExitFact"><span class="hs-identifier hs-var">distinguishedExitFact</span></a><span> </span><a href="#local-1627500168"><span class="hs-identifier hs-var">g'</span></a><span> </span><a href="#local-1627500167"><span class="hs-identifier hs-var">fout</span></a><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-identifier">distinguishedExitFact</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500119"><a href="#local-1627500119"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500120"><a href="#local-1627500120"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500121"><a href="#local-1627500121"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1627500122"><a href="#local-1627500122"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500119"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500120"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500121"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500121"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500122"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeO"><span class="hs-identifier hs-type">MaybeO</span></a><span> </span><a href="#local-1627500121"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500122"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-114"></a><a name="distinguishedExitFact"><a href="Hoopl.Dataflow.html#distinguishedExitFact"><span class="hs-identifier">distinguishedExitFact</span></a></a><span> </span><a name="local-1627500170"><a href="#local-1627500170"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-1627500171"><a href="#local-1627500171"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500172"><span class="hs-identifier hs-var">maybe</span></a><span> </span><a href="#local-1627500170"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-115"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500119"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500120"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500121"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeO"><span class="hs-identifier hs-type">MaybeO</span></a><span> </span><a href="#local-1627500121"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500122"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-116"></a><span>          </span><a name="local-1627500172"><a href="#local-1627500172"><span class="hs-identifier">maybe</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GNil"><span class="hs-identifier hs-var">GNil</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustO"><span class="hs-identifier hs-var">JustO</span></a><span> </span><a href="#local-1627500171"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-117"></a><span>          </span><span class="hs-identifier">maybe</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GUnit"><span class="hs-identifier hs-var">GUnit</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustO"><span class="hs-identifier hs-var">JustO</span></a><span> </span><a href="#local-1627500171"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-118"></a><span>          </span><span class="hs-identifier">maybe</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GMany"><span class="hs-identifier hs-var">GMany</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627500173"><a href="#local-1627500173"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627500173"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span>
</span><a name="line-119"></a><span>                                          </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustO"><span class="hs-identifier hs-var">JustO</span></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustO"><span class="hs-identifier hs-var">JustO</span></a><span> </span><a href="#local-1627500171"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><a name="line-122"></a><span class="hs-comment">--       Forward Implementation</span><span>
</span><a name="line-123"></a><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-keyword">type</span><span> </span><a name="Entries"><a href="Hoopl.Dataflow.html#Entries"><span class="hs-identifier">Entries</span></a></a><span> </span><a name="local-1627500070"><a href="#local-1627500070"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeC"><span class="hs-identifier hs-type">MaybeC</span></a><span> </span><a href="#local-1627500070"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-identifier">arfGraph</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500115"><a href="#local-1627500115"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500116"><a href="#local-1627500116"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627500117"><a href="#local-1627500117"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500118"><a href="#local-1627500118"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span>  </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-128"></a><span>            </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdPass"><span class="hs-identifier hs-type">FwdPass</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-129"></a><span>            </span><a href="Hoopl.Dataflow.html#Entries"><span class="hs-identifier hs-type">Entries</span></a><span> </span><a href="#local-1627500117"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500117"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500118"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500117"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500117"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500118"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500118"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-130"></a><a name="arfGraph"><a href="Hoopl.Dataflow.html#arfGraph"><span class="hs-identifier">arfGraph</span></a></a><span> </span><a name="local-1627500174"><a href="#local-1627500174"><span class="hs-identifier">pass</span></a></a><span class="hs-glyph">@</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdPass"><span class="hs-identifier hs-var">FwdPass</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fp_lattice</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627500175"><a href="#local-1627500175"><span class="hs-identifier">lattice</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-131"></a><span>                        </span><span class="hs-identifier">fp_transfer</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627500176"><a href="#local-1627500176"><span class="hs-identifier">transfer</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-132"></a><span>                        </span><span class="hs-identifier">fp_rewrite</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-1627500177"><a href="#local-1627500177"><span class="hs-identifier">rewrite</span></a></a><span> </span><span class="hs-special">}</span><span> </span><a name="local-1627500178"><a href="#local-1627500178"><span class="hs-identifier">entries</span></a></a><span> </span><a name="local-1627500179"><a href="#local-1627500179"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-1627500180"><a href="#local-1627500180"><span class="hs-identifier">in_fact</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500181"><span class="hs-identifier hs-var">graph</span></a><span> </span><a href="#local-1627500179"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-1627500180"><span class="hs-identifier hs-var">in_fact</span></a><span>
</span><a name="line-133"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-134"></a><span>    </span><span class="hs-comment">{- nested type synonyms would be so lovely here
    type ARF  thing = forall e x . thing e x -&gt; f        -&gt; m (DG f n e x, Fact x f)
    type ARFX thing = forall e x . thing e x -&gt; Fact e f -&gt; m (DG f n e x, Fact x f)
    -}</span><span>
</span><a name="line-138"></a><span>    </span><span class="hs-identifier">graph</span><span> </span><span class="hs-glyph">::</span><span>              </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500117"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500118"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500117"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500117"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500118"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500118"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500187"><a href="#local-1627500187"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500188"><a href="#local-1627500188"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span>
</span><a name="line-140"></a><span>             </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500187"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500188"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500187"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500188"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500188"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-141"></a><span>
</span><a name="line-142"></a><span>    </span><span class="hs-identifier">body</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>                    </span><span class="hs-comment">-- Outgoing factbase is restricted to Labels *not* in</span><span>
</span><a name="line-145"></a><span>                    </span><span class="hs-comment">-- in the Body; the facts for Labels *in*</span><span>
</span><a name="line-146"></a><span>                    </span><span class="hs-comment">-- the Body are in the 'DG f n C C'</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span>    </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500189"><a href="#local-1627500189"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500190"><a href="#local-1627500190"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627500191"><a href="#local-1627500191"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1627500192"><a href="#local-1627500192"><span class="hs-identifier">f1</span></a></a><span> </span><a name="local-1627500193"><a href="#local-1627500193"><span class="hs-identifier">f2</span></a></a><span> </span><a name="local-1627500194"><a href="#local-1627500194"><span class="hs-identifier">f3</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-149"></a><span>           </span><span class="hs-special">(</span><a href="#local-1627500192"><span class="hs-identifier hs-type">f1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500189"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500190"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500193"><span class="hs-identifier hs-type">f2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627500193"><span class="hs-identifier hs-type">f2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500190"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627500191"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500194"><span class="hs-identifier hs-type">f3</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627500192"><span class="hs-identifier hs-type">f1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500189"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500191"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500194"><span class="hs-identifier hs-type">f3</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span>    </span><a name="local-1627500181"><a href="#local-1627500181"><span class="hs-identifier">graph</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GNil"><span class="hs-identifier hs-var">GNil</span></a><span>            </span><a name="local-1627500198"><a href="#local-1627500198"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#dgnil"><span class="hs-identifier hs-var">dgnil</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500198"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>    </span><span class="hs-identifier">graph</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GUnit"><span class="hs-identifier hs-var">GUnit</span></a><span> </span><a name="local-1627500199"><a href="#local-1627500199"><span class="hs-identifier">blk</span></a></a><span class="hs-special">)</span><span>     </span><a name="local-1627500200"><a href="#local-1627500200"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500182"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500199"><span class="hs-identifier hs-var">blk</span></a><span> </span><a href="#local-1627500200"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-155"></a><span>    </span><span class="hs-identifier">graph</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GMany"><span class="hs-identifier hs-var">GMany</span></a><span> </span><a name="local-1627500201"><a href="#local-1627500201"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500202"><a href="#local-1627500202"><span class="hs-identifier">bdy</span></a></a><span> </span><a name="local-1627500203"><a href="#local-1627500203"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627500204"><a href="#local-1627500204"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-1627500201"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500206"><span class="hs-identifier hs-var">ebcat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500202"><span class="hs-identifier hs-var">bdy</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="#local-1627500184"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500205"><span class="hs-identifier hs-var">exit</span></a><span> </span><a href="#local-1627500203"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500204"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-156"></a><span>     </span><span class="hs-keyword">where</span><span>
</span><a name="line-157"></a><span>      </span><span class="hs-identifier">ebcat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeO"><span class="hs-identifier hs-type">MaybeO</span></a><span> </span><a href="#local-1627500117"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Body"><span class="hs-identifier hs-type">Body</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500117"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500117"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span>      </span><span class="hs-identifier">exit</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeO"><span class="hs-identifier hs-type">MaybeO</span></a><span> </span><a href="#local-1627500118"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500118"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500118"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-159"></a><span>      </span><a name="local-1627500205"><a href="#local-1627500205"><span class="hs-identifier">exit</span></a></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustO"><span class="hs-identifier hs-var">JustO</span></a><span> </span><a name="local-1627500207"><a href="#local-1627500207"><span class="hs-identifier">blk</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627500208"><a href="#local-1627500208"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500185"><span class="hs-identifier hs-var">arfx</span></a><span> </span><a href="#local-1627500182"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500207"><span class="hs-identifier hs-var">blk</span></a><span> </span><a href="#local-1627500208"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-160"></a><span>      </span><span class="hs-identifier">exit</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span>    </span><a name="local-1627500209"><a href="#local-1627500209"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#dgnilC"><span class="hs-identifier hs-var">dgnilC</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500209"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span>      </span><a name="local-1627500206"><a href="#local-1627500206"><span class="hs-identifier">ebcat</span></a></a><span> </span><a name="local-1627500210"><a href="#local-1627500210"><span class="hs-identifier">entry</span></a></a><span> </span><a name="local-1627500211"><a href="#local-1627500211"><span class="hs-identifier">bdy</span></a></a><span> </span><a name="local-1627500212"><a href="#local-1627500212"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500213"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-1627500178"><span class="hs-identifier hs-var">entries</span></a><span> </span><a href="#local-1627500210"><span class="hs-identifier hs-var">entry</span></a><span> </span><a href="#local-1627500212"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-162"></a><span>       </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeC"><span class="hs-identifier hs-type">MaybeC</span></a><span> </span><a href="#local-1627500117"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeO"><span class="hs-identifier hs-type">MaybeO</span></a><span> </span><a href="#local-1627500117"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">)</span><span>
</span><a name="line-163"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500117"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500117"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-164"></a><span>             </span><a name="local-1627500213"><a href="#local-1627500213"><span class="hs-identifier">c</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingC"><span class="hs-identifier hs-var">NothingC</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustO"><span class="hs-identifier hs-var">JustO</span></a><span> </span><a name="local-1627500214"><a href="#local-1627500214"><span class="hs-identifier">entry</span></a></a><span class="hs-special">)</span><span>   </span><a name="local-1627500215"><a href="#local-1627500215"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500182"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500214"><span class="hs-identifier hs-var">entry</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500184"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500186"><span class="hs-identifier hs-var">body</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#successors"><span class="hs-identifier hs-var">successors</span></a><span> </span><a href="#local-1627500214"><span class="hs-identifier hs-var">entry</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500211"><span class="hs-identifier hs-var">bdy</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500215"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-165"></a><span>             </span><span class="hs-identifier">c</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustC"><span class="hs-identifier hs-var">JustC</span></a><span> </span><a name="local-1627500216"><a href="#local-1627500216"><span class="hs-identifier">entries</span></a></a><span class="hs-special">)</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span> </span><a name="local-1627500217"><a href="#local-1627500217"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500186"><span class="hs-identifier hs-var">body</span></a><span> </span><a href="#local-1627500216"><span class="hs-identifier hs-var">entries</span></a><span> </span><a href="#local-1627500211"><span class="hs-identifier hs-var">bdy</span></a><span> </span><a href="#local-1627500217"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span>    </span><span class="hs-comment">-- Lift from nodes to blocks</span><span>
</span><a name="line-168"></a><span>    </span><a name="local-1627500182"><a href="#local-1627500182"><span class="hs-identifier">block</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BNil"><span class="hs-identifier hs-var">BNil</span></a><span>            </span><a name="local-1627500218"><a href="#local-1627500218"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#dgnil"><span class="hs-identifier hs-var">dgnil</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500218"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-169"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BlockCO"><span class="hs-identifier hs-var">BlockCO</span></a><span> </span><a name="local-1627500219"><a href="#local-1627500219"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500220"><a href="#local-1627500220"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>   </span><a name="local-1627500221"><a href="#local-1627500221"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500183"><span class="hs-identifier hs-var">node</span></a><span> </span><a href="#local-1627500219"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500184"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500182"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500220"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500221"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-170"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BlockCC"><span class="hs-identifier hs-var">BlockCC</span></a><span> </span><a name="local-1627500222"><a href="#local-1627500222"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1627500223"><a href="#local-1627500223"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1627500224"><a href="#local-1627500224"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627500225"><a href="#local-1627500225"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500183"><span class="hs-identifier hs-var">node</span></a><span> </span><a href="#local-1627500222"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500184"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500182"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500223"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500184"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500183"><span class="hs-identifier hs-var">node</span></a><span> </span><a href="#local-1627500224"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500225"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-171"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BlockOC"><span class="hs-identifier hs-var">BlockOC</span></a><span>   </span><a name="local-1627500226"><a href="#local-1627500226"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1627500227"><a href="#local-1627500227"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627500228"><a href="#local-1627500228"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>              </span><span class="hs-special">(</span><a href="#local-1627500182"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500226"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500184"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500183"><span class="hs-identifier hs-var">node</span></a><span> </span><a href="#local-1627500227"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500228"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BMiddle"><span class="hs-identifier hs-var">BMiddle</span></a><span> </span><a name="local-1627500229"><a href="#local-1627500229"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>     </span><a name="local-1627500230"><a href="#local-1627500230"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500183"><span class="hs-identifier hs-var">node</span></a><span> </span><a href="#local-1627500229"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500230"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-174"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BCat"><span class="hs-identifier hs-var">BCat</span></a><span> </span><a name="local-1627500231"><a href="#local-1627500231"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-1627500232"><a href="#local-1627500232"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span>    </span><a name="local-1627500233"><a href="#local-1627500233"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500182"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500231"><span class="hs-identifier hs-var">b1</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500184"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500182"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500232"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500233"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-175"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BSnoc"><span class="hs-identifier hs-var">BSnoc</span></a><span> </span><a name="local-1627500234"><a href="#local-1627500234"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-1627500235"><a href="#local-1627500235"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>     </span><a name="local-1627500236"><a href="#local-1627500236"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500182"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500234"><span class="hs-identifier hs-var">h</span></a><span>  </span><span class="hs-special">`</span><a href="#local-1627500184"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500183"><span class="hs-identifier hs-var">node</span></a><span> </span><a href="#local-1627500235"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500236"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-176"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BCons"><span class="hs-identifier hs-var">BCons</span></a><span> </span><a name="local-1627500237"><a href="#local-1627500237"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500238"><a href="#local-1627500238"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>     </span><a name="local-1627500239"><a href="#local-1627500239"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500183"><span class="hs-identifier hs-var">node</span></a><span>  </span><a href="#local-1627500237"><span class="hs-identifier hs-var">n</span></a><span>  </span><span class="hs-special">`</span><a href="#local-1627500184"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500182"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500238"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500239"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span>    </span><span class="hs-pragma">{-# INLINE node #-}</span><span>
</span><a name="line-179"></a><span>    </span><span class="hs-identifier">node</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500195"><a href="#local-1627500195"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500196"><a href="#local-1627500196"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#ShapeLifter"><span class="hs-identifier hs-type">ShapeLifter</span></a><span> </span><a href="#local-1627500195"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500196"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-180"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500195"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500196"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500195"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500196"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500196"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-181"></a><span>    </span><a name="local-1627500183"><a href="#local-1627500183"><span class="hs-identifier">node</span></a></a><span> </span><a name="local-1627500240"><a href="#local-1627500240"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500241"><a href="#local-1627500241"><span class="hs-identifier">f</span></a></a><span>
</span><a name="line-182"></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1627500242"><a href="#local-1627500242"><span class="hs-identifier">grw</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Hoopl.Dataflow.html#frewrite"><span class="hs-identifier hs-var">frewrite</span></a><span> </span><a href="#local-1627500177"><span class="hs-identifier hs-var">rewrite</span></a><span> </span><a href="#local-1627500240"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500241"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-183"></a><span>          </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627500242"><span class="hs-identifier hs-var">grw</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-184"></a><span>              </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="Hoopl.Dataflow.html#singletonDG"><span class="hs-identifier hs-var">singletonDG</span></a><span> </span><a href="#local-1627500241"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627500240"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-185"></a><span>                                </span><span class="hs-special">,</span><span> </span><a href="Hoopl.Dataflow.html#ftransfer"><span class="hs-identifier hs-var">ftransfer</span></a><span> </span><a href="#local-1627500176"><span class="hs-identifier hs-var">transfer</span></a><span> </span><a href="#local-1627500240"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500241"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-186"></a><span>              </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627500243"><a href="#local-1627500243"><span class="hs-identifier">g</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500244"><a href="#local-1627500244"><span class="hs-identifier">rw</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-187"></a><span>                  </span><span class="hs-keyword">let</span><span> </span><a name="local-1627500245"><a href="#local-1627500245"><span class="hs-identifier">pass'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500174"><span class="hs-identifier hs-var">pass</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fp_rewrite</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500244"><span class="hs-identifier hs-var">rw</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-188"></a><span>                      </span><a name="local-1627500246"><a href="#local-1627500246"><span class="hs-identifier">f'</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Dataflow.html#fwdEntryFact"><span class="hs-identifier hs-var">fwdEntryFact</span></a><span> </span><a href="#local-1627500240"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500241"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-189"></a><span>                  </span><span class="hs-keyword">in</span><span>  </span><a href="Hoopl.Dataflow.html#arfGraph"><span class="hs-identifier hs-var">arfGraph</span></a><span> </span><a href="#local-1627500245"><span class="hs-identifier hs-var">pass'</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#fwdEntryLabel"><span class="hs-identifier hs-var">fwdEntryLabel</span></a><span> </span><a href="#local-1627500240"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500243"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-1627500246"><span class="hs-identifier hs-var">f'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span>    </span><span class="hs-comment">-- | Compose fact transformers and concatenate the resulting</span><span>
</span><a name="line-192"></a><span>    </span><span class="hs-comment">-- rewritten graphs.</span><span>
</span><a name="line-193"></a><span>    </span><span class="hs-pragma">{-# INLINE cat #-}</span><span>
</span><a name="line-194"></a><span>    </span><a name="local-1627500184"><a href="#local-1627500184"><span class="hs-identifier">cat</span></a></a><span> </span><a name="local-1627500247"><a href="#local-1627500247"><span class="hs-identifier">ft1</span></a></a><span> </span><a name="local-1627500248"><a href="#local-1627500248"><span class="hs-identifier">ft2</span></a></a><span> </span><a name="local-1627500249"><a href="#local-1627500249"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1627500250"><a href="#local-1627500250"><span class="hs-identifier">g1</span></a></a><span class="hs-special">,</span><a name="local-1627500251"><a href="#local-1627500251"><span class="hs-identifier">f1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627500247"><span class="hs-identifier hs-var">ft1</span></a><span> </span><a href="#local-1627500249"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-195"></a><span>                       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1627500252"><a href="#local-1627500252"><span class="hs-identifier">g2</span></a></a><span class="hs-special">,</span><a name="local-1627500253"><a href="#local-1627500253"><span class="hs-identifier">f2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627500248"><span class="hs-identifier hs-var">ft2</span></a><span> </span><a href="#local-1627500251"><span class="hs-identifier hs-var">f1</span></a><span>
</span><a name="line-196"></a><span>                       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-1627500254"><a href="#local-1627500254"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500250"><span class="hs-identifier hs-var">g1</span></a><span> </span><span class="hs-special">`</span><a href="Hoopl.Dataflow.html#dgSplice"><span class="hs-identifier hs-var">dgSplice</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500252"><span class="hs-identifier hs-var">g2</span></a><span>
</span><a name="line-197"></a><span>                       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627500254"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500253"><span class="hs-identifier hs-var">f2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span>    </span><span class="hs-identifier">arfx</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500197"><a href="#local-1627500197"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span>
</span><a name="line-200"></a><span>            </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500197"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>        </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500197"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500197"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-201"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500197"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500197"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500197"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-202"></a><span>    </span><a name="local-1627500185"><a href="#local-1627500185"><span class="hs-identifier">arfx</span></a></a><span> </span><a name="local-1627500255"><a href="#local-1627500255"><span class="hs-identifier">arf</span></a></a><span> </span><a name="local-1627500256"><a href="#local-1627500256"><span class="hs-identifier">thing</span></a></a><span> </span><a name="local-1627500257"><a href="#local-1627500257"><span class="hs-identifier">fb</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-203"></a><span>      </span><a href="#local-1627500255"><span class="hs-identifier hs-var">arf</span></a><span> </span><a href="#local-1627500256"><span class="hs-identifier hs-var">thing</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#lookupFact"><span class="hs-identifier hs-var">lookupFact</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a><span> </span><a href="#local-1627500256"><span class="hs-identifier hs-var">thing</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Hoopl.Dataflow.html#joinInFacts"><span class="hs-identifier hs-var">joinInFacts</span></a><span> </span><a href="#local-1627500175"><span class="hs-identifier hs-var">lattice</span></a><span> </span><a href="#local-1627500257"><span class="hs-identifier hs-var">fb</span></a><span>
</span><a name="line-204"></a><span>     </span><span class="hs-comment">-- joinInFacts adds debugging information</span><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span>                    </span><span class="hs-comment">-- Outgoing factbase is restricted to Labels *not* in</span><span>
</span><a name="line-208"></a><span>                    </span><span class="hs-comment">-- in the Body; the facts for Labels *in*</span><span>
</span><a name="line-209"></a><span>                    </span><span class="hs-comment">-- the Body are in the 'DG f n C C'</span><span>
</span><a name="line-210"></a><span>    </span><a name="local-1627500186"><a href="#local-1627500186"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-1627500258"><a href="#local-1627500258"><span class="hs-identifier">entries</span></a></a><span> </span><a name="local-1627500259"><a href="#local-1627500259"><span class="hs-identifier">blockmap</span></a></a><span> </span><a name="local-1627500260"><a href="#local-1627500260"><span class="hs-identifier">init_fbase</span></a></a><span>
</span><a name="line-211"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Dataflow.html#fixpoint"><span class="hs-identifier hs-var">fixpoint</span></a><span> </span><a href="Hoopl.Dataflow.html#Fwd"><span class="hs-identifier hs-var">Fwd</span></a><span> </span><a href="#local-1627500261"><span class="hs-identifier hs-var">lattice</span></a><span> </span><a href="#local-1627500262"><span class="hs-identifier hs-var">do_block</span></a><span> </span><a href="#local-1627500258"><span class="hs-identifier hs-var">entries</span></a><span> </span><a href="#local-1627500259"><span class="hs-identifier hs-var">blockmap</span></a><span> </span><a href="#local-1627500260"><span class="hs-identifier hs-var">init_fbase</span></a><span>
</span><a name="line-212"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-213"></a><span>        </span><a name="local-1627500261"><a href="#local-1627500261"><span class="hs-identifier">lattice</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fp_lattice</span><span> </span><a href="#local-1627500174"><span class="hs-identifier hs-var">pass</span></a><span>
</span><a name="line-214"></a><span>        </span><span class="hs-identifier">do_block</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500263"><a href="#local-1627500263"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500263"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-215"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500115"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500263"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500263"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500116"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-216"></a><span>        </span><a name="local-1627500262"><a href="#local-1627500262"><span class="hs-identifier">do_block</span></a></a><span> </span><a name="local-1627500264"><a href="#local-1627500264"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1627500265"><a href="#local-1627500265"><span class="hs-identifier">fb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500182"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500264"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-1627500266"><span class="hs-identifier hs-var">entryFact</span></a><span>
</span><a name="line-217"></a><span>          </span><span class="hs-keyword">where</span><span> </span><a name="local-1627500266"><a href="#local-1627500266"><span class="hs-identifier">entryFact</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Dataflow.html#getFact"><span class="hs-identifier hs-var">getFact</span></a><span> </span><a href="#local-1627500261"><span class="hs-identifier hs-var">lattice</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a><span> </span><a href="#local-1627500264"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500265"><span class="hs-identifier hs-var">fb</span></a><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span>
</span><a name="line-220"></a><span class="hs-comment">-- Join all the incoming facts with bottom.</span><span>
</span><a name="line-221"></a><span class="hs-comment">-- We know the results _shouldn't change_, but the transfer</span><span>
</span><a name="line-222"></a><span class="hs-comment">-- functions might, for example, generate some debugging traces.</span><span>
</span><a name="line-223"></a><span class="hs-identifier">joinInFacts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#DataflowLattice"><span class="hs-identifier hs-type">DataflowLattice</span></a><span> </span><a href="#local-1627500114"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500114"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500114"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-224"></a><a name="joinInFacts"><a href="Hoopl.Dataflow.html#joinInFacts"><span class="hs-identifier">joinInFacts</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627500267"><a href="#local-1627500267"><span class="hs-identifier">lattice</span></a></a><span> </span><span class="hs-glyph">@</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#DataflowLattice"><span class="hs-identifier hs-var">DataflowLattice</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">fact_bot</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627500268"><a href="#local-1627500268"><span class="hs-identifier">bot</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fact_join</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627500269"><a href="#local-1627500269"><span class="hs-identifier">fj</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-1627500270"><a href="#local-1627500270"><span class="hs-identifier">fb</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-225"></a><span>  </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#mkFactBase"><span class="hs-identifier hs-var">mkFactBase</span></a><span> </span><a href="#local-1627500267"><span class="hs-identifier hs-var">lattice</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1627500271"><span class="hs-identifier hs-var">botJoin</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapToList"><span class="hs-identifier hs-var">mapToList</span></a><span> </span><a href="#local-1627500270"><span class="hs-identifier hs-var">fb</span></a><span>
</span><a name="line-226"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-1627500271"><a href="#local-1627500271"><span class="hs-identifier">botJoin</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627500272"><a href="#local-1627500272"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500273"><a href="#local-1627500273"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500272"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1627500269"><span class="hs-identifier hs-var">fj</span></a><span> </span><a href="#local-1627500272"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-var">OldFact</span></a><span> </span><a href="#local-1627500268"><span class="hs-identifier hs-var">bot</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-var">NewFact</span></a><span> </span><a href="#local-1627500273"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-227"></a><span>
</span><a name="line-228"></a><span class="hs-identifier">forwardBlockList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><a href="#local-1627500113"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-229"></a><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Body"><span class="hs-identifier hs-type">Body</span></a><span> </span><a href="#local-1627500113"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500113"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">]</span><span>
</span><a name="line-230"></a><span class="hs-comment">-- This produces a list of blocks in order suitable for forward analysis,</span><span>
</span><a name="line-231"></a><span class="hs-comment">-- along with the list of Labels it may depend on for facts.</span><span>
</span><a name="line-232"></a><a name="forwardBlockList"><a href="Hoopl.Dataflow.html#forwardBlockList"><span class="hs-identifier">forwardBlockList</span></a></a><span> </span><a name="local-1627500308"><a href="#local-1627500308"><span class="hs-identifier">entries</span></a></a><span> </span><a name="local-1627500309"><a href="#local-1627500309"><span class="hs-identifier">blks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#postorder_dfs_from"><span class="hs-identifier hs-var">postorder_dfs_from</span></a><span> </span><a href="#local-1627500309"><span class="hs-identifier hs-var">blks</span></a><span> </span><a href="#local-1627500308"><span class="hs-identifier hs-var">entries</span></a><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><a name="line-235"></a><span class="hs-comment">--       Forward Analysis only</span><span>
</span><a name="line-236"></a><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><a name="line-237"></a><span>
</span><a name="line-238"></a><span class="hs-comment">-- | if the graph being analyzed is open at the entry, there must</span><span>
</span><a name="line-239"></a><span class="hs-comment">--   be no other entry point, or all goes horribly wrong...</span><span>
</span><a name="line-240"></a><span class="hs-identifier">analyzeFwd</span><span>
</span><a name="line-241"></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500110"><a href="#local-1627500110"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500111"><a href="#local-1627500111"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627500112"><a href="#local-1627500112"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-operator">.</span><span>  </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><a href="#local-1627500110"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-242"></a><span>      </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdPass"><span class="hs-identifier hs-type">FwdPass</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627500110"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500111"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-243"></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeC"><span class="hs-identifier hs-type">MaybeC</span></a><span> </span><a href="#local-1627500112"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span>
</span><a name="line-244"></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500110"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500112"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500112"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500111"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-245"></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500111"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-246"></a><a name="analyzeFwd"><a href="Hoopl.Dataflow.html#analyzeFwd"><span class="hs-identifier">analyzeFwd</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdPass"><span class="hs-identifier hs-var">FwdPass</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fp_lattice</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627500310"><a href="#local-1627500310"><span class="hs-identifier">lattice</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-247"></a><span>                     </span><span class="hs-identifier">fp_transfer</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdTransfer3"><span class="hs-identifier hs-var">FwdTransfer3</span></a><span> </span><span class="hs-special">(</span><a name="local-1627500311"><a href="#local-1627500311"><span class="hs-identifier">ftr</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500312"><a href="#local-1627500312"><span class="hs-identifier">mtr</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500313"><a href="#local-1627500313"><span class="hs-identifier">ltr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-248"></a><span>  </span><a name="local-1627500314"><a href="#local-1627500314"><span class="hs-identifier">entries</span></a></a><span> </span><a name="local-1627500315"><a href="#local-1627500315"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-1627500316"><a href="#local-1627500316"><span class="hs-identifier">in_fact</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500317"><span class="hs-identifier hs-var">graph</span></a><span> </span><a href="#local-1627500315"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-1627500316"><span class="hs-identifier hs-var">in_fact</span></a><span>
</span><a name="line-249"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-250"></a><span>    </span><span class="hs-identifier">graph</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500110"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500112"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500112"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500111"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500111"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-251"></a><span>    </span><a name="local-1627500317"><a href="#local-1627500317"><span class="hs-identifier">graph</span></a></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GMany"><span class="hs-identifier hs-var">GMany</span></a><span> </span><a name="local-1627500325"><a href="#local-1627500325"><span class="hs-identifier">entry</span></a></a><span> </span><a name="local-1627500326"><a href="#local-1627500326"><span class="hs-identifier">blockmap</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span class="hs-special">)</span><span>
</span><a name="line-252"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-1627500314"><span class="hs-identifier hs-var">entries</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500325"><span class="hs-identifier hs-var">entry</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-253"></a><span>         </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingC"><span class="hs-identifier hs-var">NothingC</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustO"><span class="hs-identifier hs-var">JustO</span></a><span> </span><a name="local-1627500335"><a href="#local-1627500335"><span class="hs-identifier">entry</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500318"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500335"><span class="hs-identifier hs-var">entry</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500319"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500327"><span class="hs-identifier hs-var">body</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#successors"><span class="hs-identifier hs-var">successors</span></a><span> </span><a href="#local-1627500335"><span class="hs-identifier hs-var">entry</span></a><span class="hs-special">)</span><span>
</span><a name="line-254"></a><span>         </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustC"><span class="hs-identifier hs-var">JustC</span></a><span> </span><a name="local-1627500336"><a href="#local-1627500336"><span class="hs-identifier">entries</span></a></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500327"><span class="hs-identifier hs-var">body</span></a><span> </span><a href="#local-1627500336"><span class="hs-identifier hs-var">entries</span></a><span>
</span><a name="line-255"></a><span>     </span><span class="hs-keyword">where</span><span>
</span><a name="line-256"></a><span>       </span><span class="hs-identifier">body</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500111"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500111"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-257"></a><span>       </span><a name="local-1627500327"><a href="#local-1627500327"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-1627500328"><a href="#local-1627500328"><span class="hs-identifier">entries</span></a></a><span> </span><a name="local-1627500329"><a href="#local-1627500329"><span class="hs-identifier">f</span></a></a><span>
</span><a name="line-258"></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Dataflow.html#fixpointAnal"><span class="hs-identifier hs-var">fixpointAnal</span></a><span> </span><a href="Hoopl.Dataflow.html#Fwd"><span class="hs-identifier hs-var">Fwd</span></a><span> </span><a href="#local-1627500310"><span class="hs-identifier hs-var">lattice</span></a><span> </span><a href="#local-1627500330"><span class="hs-identifier hs-var">do_block</span></a><span> </span><a href="#local-1627500328"><span class="hs-identifier hs-var">entries</span></a><span> </span><a href="#local-1627500326"><span class="hs-identifier hs-var">blockmap</span></a><span> </span><a href="#local-1627500329"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-259"></a><span>         </span><span class="hs-keyword">where</span><span>
</span><a name="line-260"></a><span>           </span><span class="hs-identifier">do_block</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500331"><a href="#local-1627500331"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500110"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500331"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500111"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500331"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500111"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-261"></a><span>           </span><a name="local-1627500330"><a href="#local-1627500330"><span class="hs-identifier">do_block</span></a></a><span> </span><a name="local-1627500332"><a href="#local-1627500332"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1627500333"><a href="#local-1627500333"><span class="hs-identifier">fb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500318"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500332"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-1627500334"><span class="hs-identifier hs-var">entryFact</span></a><span>
</span><a name="line-262"></a><span>             </span><span class="hs-keyword">where</span><span> </span><a name="local-1627500334"><a href="#local-1627500334"><span class="hs-identifier">entryFact</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Dataflow.html#getFact"><span class="hs-identifier hs-var">getFact</span></a><span> </span><a href="#local-1627500310"><span class="hs-identifier hs-var">lattice</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a><span> </span><a href="#local-1627500332"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500333"><span class="hs-identifier hs-var">fb</span></a><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span>    </span><span class="hs-comment">-- NB. eta-expand block, GHC can't do this by itself.  See #5809.</span><span>
</span><a name="line-265"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500320"><a href="#local-1627500320"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500321"><a href="#local-1627500321"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500110"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500320"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500321"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500111"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500321"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500111"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-266"></a><span>    </span><a name="local-1627500318"><a href="#local-1627500318"><span class="hs-identifier">block</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BNil"><span class="hs-identifier hs-var">BNil</span></a><span>            </span><a name="local-1627500337"><a href="#local-1627500337"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500337"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-267"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BlockCO"><span class="hs-identifier hs-var">BlockCO</span></a><span> </span><a name="local-1627500338"><a href="#local-1627500338"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500339"><a href="#local-1627500339"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>   </span><a name="local-1627500340"><a href="#local-1627500340"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500311"><span class="hs-identifier hs-var">ftr</span></a><span> </span><a href="#local-1627500338"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500319"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span>  </span><a href="#local-1627500318"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500339"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500340"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-268"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BlockCC"><span class="hs-identifier hs-var">BlockCC</span></a><span> </span><a name="local-1627500341"><a href="#local-1627500341"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1627500342"><a href="#local-1627500342"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1627500343"><a href="#local-1627500343"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627500344"><a href="#local-1627500344"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500311"><span class="hs-identifier hs-var">ftr</span></a><span> </span><a href="#local-1627500341"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500319"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-1627500318"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500342"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500319"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500313"><span class="hs-identifier hs-var">ltr</span></a><span> </span><a href="#local-1627500343"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1627500344"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-269"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BlockOC"><span class="hs-identifier hs-var">BlockOC</span></a><span>   </span><a name="local-1627500345"><a href="#local-1627500345"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1627500346"><a href="#local-1627500346"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627500347"><a href="#local-1627500347"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>              </span><span class="hs-special">(</span><a href="#local-1627500318"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500345"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500319"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500313"><span class="hs-identifier hs-var">ltr</span></a><span> </span><a href="#local-1627500346"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500347"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BMiddle"><span class="hs-identifier hs-var">BMiddle</span></a><span> </span><a name="local-1627500348"><a href="#local-1627500348"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>     </span><a name="local-1627500349"><a href="#local-1627500349"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500312"><span class="hs-identifier hs-var">mtr</span></a><span> </span><a href="#local-1627500348"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500349"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-272"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BCat"><span class="hs-identifier hs-var">BCat</span></a><span> </span><a name="local-1627500350"><a href="#local-1627500350"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-1627500351"><a href="#local-1627500351"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span>    </span><a name="local-1627500352"><a href="#local-1627500352"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500318"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500350"><span class="hs-identifier hs-var">b1</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500319"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500318"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500351"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500352"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-273"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BSnoc"><span class="hs-identifier hs-var">BSnoc</span></a><span> </span><a name="local-1627500353"><a href="#local-1627500353"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-1627500354"><a href="#local-1627500354"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>     </span><a name="local-1627500355"><a href="#local-1627500355"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500318"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500353"><span class="hs-identifier hs-var">h</span></a><span>  </span><span class="hs-special">`</span><a href="#local-1627500319"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500312"><span class="hs-identifier hs-var">mtr</span></a><span> </span><a href="#local-1627500354"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500355"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-274"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BCons"><span class="hs-identifier hs-var">BCons</span></a><span> </span><a name="local-1627500356"><a href="#local-1627500356"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500357"><a href="#local-1627500357"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>     </span><a name="local-1627500358"><a href="#local-1627500358"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500312"><span class="hs-identifier hs-var">mtr</span></a><span>  </span><a href="#local-1627500356"><span class="hs-identifier hs-var">n</span></a><span>   </span><span class="hs-special">`</span><a href="#local-1627500319"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500318"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500357"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500358"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-275"></a><span>
</span><a name="line-276"></a><span>    </span><span class="hs-pragma">{-# INLINE cat #-}</span><span>
</span><a name="line-277"></a><span>    </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500322"><a href="#local-1627500322"><span class="hs-identifier">f1</span></a></a><span> </span><a name="local-1627500323"><a href="#local-1627500323"><span class="hs-identifier">f2</span></a></a><span> </span><a name="local-1627500324"><a href="#local-1627500324"><span class="hs-identifier">f3</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="#local-1627500322"><span class="hs-identifier hs-type">f1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500323"><span class="hs-identifier hs-type">f2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627500323"><span class="hs-identifier hs-type">f2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500324"><span class="hs-identifier hs-type">f3</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627500322"><span class="hs-identifier hs-type">f1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500324"><span class="hs-identifier hs-type">f3</span></a><span class="hs-special">)</span><span>
</span><a name="line-278"></a><span>    </span><a name="local-1627500319"><a href="#local-1627500319"><span class="hs-identifier">cat</span></a></a><span> </span><a name="local-1627500359"><a href="#local-1627500359"><span class="hs-identifier">ft1</span></a></a><span> </span><a name="local-1627500360"><a href="#local-1627500360"><span class="hs-identifier">ft2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-1627500361"><a href="#local-1627500361"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500360"><span class="hs-identifier hs-var">ft2</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a><span> </span><a href="#local-1627500359"><span class="hs-identifier hs-var">ft1</span></a><span> </span><a href="#local-1627500361"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span class="hs-comment">-- | if the graph being analyzed is open at the entry, there must</span><span>
</span><a name="line-281"></a><span class="hs-comment">--   be no other entry point, or all goes horribly wrong...</span><span>
</span><a name="line-282"></a><span class="hs-identifier">analyzeFwdBlocks</span><span>
</span><a name="line-283"></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500107"><a href="#local-1627500107"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500108"><a href="#local-1627500108"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627500109"><a href="#local-1627500109"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-operator">.</span><span>  </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><a href="#local-1627500107"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-284"></a><span>      </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdPass"><span class="hs-identifier hs-type">FwdPass</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627500107"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500108"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-285"></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeC"><span class="hs-identifier hs-type">MaybeC</span></a><span> </span><a href="#local-1627500109"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span>
</span><a name="line-286"></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500107"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500109"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500109"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500108"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-287"></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500108"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-288"></a><a name="analyzeFwdBlocks"><a href="Hoopl.Dataflow.html#analyzeFwdBlocks"><span class="hs-identifier">analyzeFwdBlocks</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdPass"><span class="hs-identifier hs-var">FwdPass</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fp_lattice</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627500362"><a href="#local-1627500362"><span class="hs-identifier">lattice</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-289"></a><span>                           </span><span class="hs-identifier">fp_transfer</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdTransfer3"><span class="hs-identifier hs-var">FwdTransfer3</span></a><span> </span><span class="hs-special">(</span><a name="local-1627500363"><a href="#local-1627500363"><span class="hs-identifier">ftr</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627500364"><a href="#local-1627500364"><span class="hs-identifier">ltr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-290"></a><span>  </span><a name="local-1627500365"><a href="#local-1627500365"><span class="hs-identifier">entries</span></a></a><span> </span><a name="local-1627500366"><a href="#local-1627500366"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-1627500367"><a href="#local-1627500367"><span class="hs-identifier">in_fact</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500368"><span class="hs-identifier hs-var">graph</span></a><span> </span><a href="#local-1627500366"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-1627500367"><span class="hs-identifier hs-var">in_fact</span></a><span>
</span><a name="line-291"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-292"></a><span>    </span><span class="hs-identifier">graph</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500107"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500109"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500109"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500108"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500108"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-293"></a><span>    </span><a name="local-1627500368"><a href="#local-1627500368"><span class="hs-identifier">graph</span></a></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GMany"><span class="hs-identifier hs-var">GMany</span></a><span> </span><a name="local-1627500376"><a href="#local-1627500376"><span class="hs-identifier">entry</span></a></a><span> </span><a name="local-1627500377"><a href="#local-1627500377"><span class="hs-identifier">blockmap</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span class="hs-special">)</span><span>
</span><a name="line-294"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-1627500365"><span class="hs-identifier hs-var">entries</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500376"><span class="hs-identifier hs-var">entry</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-295"></a><span>         </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingC"><span class="hs-identifier hs-var">NothingC</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustO"><span class="hs-identifier hs-var">JustO</span></a><span> </span><a name="local-1627500386"><a href="#local-1627500386"><span class="hs-identifier">entry</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500369"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500386"><span class="hs-identifier hs-var">entry</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500370"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500378"><span class="hs-identifier hs-var">body</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#successors"><span class="hs-identifier hs-var">successors</span></a><span> </span><a href="#local-1627500386"><span class="hs-identifier hs-var">entry</span></a><span class="hs-special">)</span><span>
</span><a name="line-296"></a><span>         </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustC"><span class="hs-identifier hs-var">JustC</span></a><span> </span><a name="local-1627500387"><a href="#local-1627500387"><span class="hs-identifier">entries</span></a></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500378"><span class="hs-identifier hs-var">body</span></a><span> </span><a href="#local-1627500387"><span class="hs-identifier hs-var">entries</span></a><span>
</span><a name="line-297"></a><span>     </span><span class="hs-keyword">where</span><span>
</span><a name="line-298"></a><span>       </span><span class="hs-identifier">body</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500108"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500108"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-299"></a><span>       </span><a name="local-1627500378"><a href="#local-1627500378"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-1627500379"><a href="#local-1627500379"><span class="hs-identifier">entries</span></a></a><span> </span><a name="local-1627500380"><a href="#local-1627500380"><span class="hs-identifier">f</span></a></a><span>
</span><a name="line-300"></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Dataflow.html#fixpointAnal"><span class="hs-identifier hs-var">fixpointAnal</span></a><span> </span><a href="Hoopl.Dataflow.html#Fwd"><span class="hs-identifier hs-var">Fwd</span></a><span> </span><a href="#local-1627500362"><span class="hs-identifier hs-var">lattice</span></a><span> </span><a href="#local-1627500381"><span class="hs-identifier hs-var">do_block</span></a><span> </span><a href="#local-1627500379"><span class="hs-identifier hs-var">entries</span></a><span> </span><a href="#local-1627500377"><span class="hs-identifier hs-var">blockmap</span></a><span> </span><a href="#local-1627500380"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-301"></a><span>         </span><span class="hs-keyword">where</span><span>
</span><a name="line-302"></a><span>           </span><span class="hs-identifier">do_block</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500382"><a href="#local-1627500382"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500107"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500382"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500108"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500382"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500108"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-303"></a><span>           </span><a name="local-1627500381"><a href="#local-1627500381"><span class="hs-identifier">do_block</span></a></a><span> </span><a name="local-1627500383"><a href="#local-1627500383"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1627500384"><a href="#local-1627500384"><span class="hs-identifier">fb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500369"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500383"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-1627500385"><span class="hs-identifier hs-var">entryFact</span></a><span>
</span><a name="line-304"></a><span>             </span><span class="hs-keyword">where</span><span> </span><a name="local-1627500385"><a href="#local-1627500385"><span class="hs-identifier">entryFact</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Dataflow.html#getFact"><span class="hs-identifier hs-var">getFact</span></a><span> </span><a href="#local-1627500362"><span class="hs-identifier hs-var">lattice</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a><span> </span><a href="#local-1627500383"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500384"><span class="hs-identifier hs-var">fb</span></a><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span>    </span><span class="hs-comment">-- NB. eta-expand block, GHC can't do this by itself.  See #5809.</span><span>
</span><a name="line-307"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500371"><a href="#local-1627500371"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500372"><a href="#local-1627500372"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500107"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500371"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500372"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500108"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500372"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500108"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-308"></a><span>    </span><a name="local-1627500369"><a href="#local-1627500369"><span class="hs-identifier">block</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BNil"><span class="hs-identifier hs-var">BNil</span></a><span>            </span><a name="local-1627500388"><a href="#local-1627500388"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500388"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-309"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BlockCO"><span class="hs-identifier hs-var">BlockCO</span></a><span> </span><a name="local-1627500389"><a href="#local-1627500389"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><a name="local-1627500390"><a href="#local-1627500390"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500363"><span class="hs-identifier hs-var">ftr</span></a><span> </span><a href="#local-1627500389"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500390"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-310"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BlockCC"><span class="hs-identifier hs-var">BlockCC</span></a><span> </span><a name="local-1627500391"><a href="#local-1627500391"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627500392"><a href="#local-1627500392"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627500393"><a href="#local-1627500393"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500363"><span class="hs-identifier hs-var">ftr</span></a><span> </span><a href="#local-1627500391"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500370"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500364"><span class="hs-identifier hs-var">ltr</span></a><span> </span><a href="#local-1627500392"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500393"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-311"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BlockOC"><span class="hs-identifier hs-var">BlockOC</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-1627500394"><a href="#local-1627500394"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627500395"><a href="#local-1627500395"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500364"><span class="hs-identifier hs-var">ltr</span></a><span> </span><a href="#local-1627500394"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500395"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-312"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a><span> </span><span class="hs-string">&quot;analyzeFwdBlocks&quot;</span><span>
</span><a name="line-313"></a><span>
</span><a name="line-314"></a><span>    </span><span class="hs-pragma">{-# INLINE cat #-}</span><span>
</span><a name="line-315"></a><span>    </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500373"><a href="#local-1627500373"><span class="hs-identifier">f1</span></a></a><span> </span><a name="local-1627500374"><a href="#local-1627500374"><span class="hs-identifier">f2</span></a></a><span> </span><a name="local-1627500375"><a href="#local-1627500375"><span class="hs-identifier">f3</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="#local-1627500373"><span class="hs-identifier hs-type">f1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500374"><span class="hs-identifier hs-type">f2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627500374"><span class="hs-identifier hs-type">f2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500375"><span class="hs-identifier hs-type">f3</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627500373"><span class="hs-identifier hs-type">f1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500375"><span class="hs-identifier hs-type">f3</span></a><span class="hs-special">)</span><span>
</span><a name="line-316"></a><span>    </span><a name="local-1627500370"><a href="#local-1627500370"><span class="hs-identifier">cat</span></a></a><span> </span><a name="local-1627500396"><a href="#local-1627500396"><span class="hs-identifier">ft1</span></a></a><span> </span><a name="local-1627500397"><a href="#local-1627500397"><span class="hs-identifier">ft2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-1627500398"><a href="#local-1627500398"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500397"><span class="hs-identifier hs-var">ft2</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a><span> </span><a href="#local-1627500396"><span class="hs-identifier hs-var">ft1</span></a><span> </span><a href="#local-1627500398"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-317"></a><span>
</span><a name="line-318"></a><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><a name="line-319"></a><span class="hs-comment">--       Backward Analysis only</span><span>
</span><a name="line-320"></a><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a><span class="hs-comment">-- | if the graph being analyzed is open at the entry, there must</span><span>
</span><a name="line-323"></a><span class="hs-comment">--   be no other entry point, or all goes horribly wrong...</span><span>
</span><a name="line-324"></a><span class="hs-identifier">analyzeBwd</span><span>
</span><a name="line-325"></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500104"><a href="#local-1627500104"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500105"><a href="#local-1627500105"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627500106"><a href="#local-1627500106"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-operator">.</span><span>  </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><a href="#local-1627500104"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-326"></a><span>      </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdPass"><span class="hs-identifier hs-type">BwdPass</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627500104"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500105"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-327"></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeC"><span class="hs-identifier hs-type">MaybeC</span></a><span> </span><a href="#local-1627500106"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span>
</span><a name="line-328"></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500104"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500106"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500105"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-329"></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500105"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-330"></a><a name="analyzeBwd"><a href="Hoopl.Dataflow.html#analyzeBwd"><span class="hs-identifier">analyzeBwd</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdPass"><span class="hs-identifier hs-var">BwdPass</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">bp_lattice</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627500399"><a href="#local-1627500399"><span class="hs-identifier">lattice</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-331"></a><span>                     </span><span class="hs-identifier">bp_transfer</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdTransfer3"><span class="hs-identifier hs-var">BwdTransfer3</span></a><span> </span><span class="hs-special">(</span><a name="local-1627500400"><a href="#local-1627500400"><span class="hs-identifier">ftr</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500401"><a href="#local-1627500401"><span class="hs-identifier">mtr</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500402"><a href="#local-1627500402"><span class="hs-identifier">ltr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-332"></a><span>   </span><a name="local-1627500403"><a href="#local-1627500403"><span class="hs-identifier">entries</span></a></a><span> </span><a name="local-1627500404"><a href="#local-1627500404"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-1627500405"><a href="#local-1627500405"><span class="hs-identifier">in_fact</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500406"><span class="hs-identifier hs-var">graph</span></a><span> </span><a href="#local-1627500404"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-1627500405"><span class="hs-identifier hs-var">in_fact</span></a><span>
</span><a name="line-333"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-334"></a><span>    </span><span class="hs-identifier">graph</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500104"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500106"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500105"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500105"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-335"></a><span>    </span><a name="local-1627500406"><a href="#local-1627500406"><span class="hs-identifier">graph</span></a></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GMany"><span class="hs-identifier hs-var">GMany</span></a><span> </span><a name="local-1627500414"><a href="#local-1627500414"><span class="hs-identifier">entry</span></a></a><span> </span><a name="local-1627500415"><a href="#local-1627500415"><span class="hs-identifier">blockmap</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span class="hs-special">)</span><span>
</span><a name="line-336"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-1627500403"><span class="hs-identifier hs-var">entries</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500414"><span class="hs-identifier hs-var">entry</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-337"></a><span>         </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingC"><span class="hs-identifier hs-var">NothingC</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustO"><span class="hs-identifier hs-var">JustO</span></a><span> </span><a name="local-1627500423"><a href="#local-1627500423"><span class="hs-identifier">entry</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500416"><span class="hs-identifier hs-var">body</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#successors"><span class="hs-identifier hs-var">successors</span></a><span> </span><a href="#local-1627500423"><span class="hs-identifier hs-var">entry</span></a><span class="hs-special">)</span><span>
</span><a name="line-338"></a><span>         </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustC"><span class="hs-identifier hs-var">JustC</span></a><span> </span><a name="local-1627500424"><a href="#local-1627500424"><span class="hs-identifier">entries</span></a></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500416"><span class="hs-identifier hs-var">body</span></a><span> </span><a href="#local-1627500424"><span class="hs-identifier hs-var">entries</span></a><span>
</span><a name="line-339"></a><span>     </span><span class="hs-keyword">where</span><span>
</span><a name="line-340"></a><span>       </span><span class="hs-identifier">body</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500105"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500105"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-341"></a><span>       </span><a name="local-1627500416"><a href="#local-1627500416"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-1627500417"><a href="#local-1627500417"><span class="hs-identifier">entries</span></a></a><span> </span><a name="local-1627500418"><a href="#local-1627500418"><span class="hs-identifier">f</span></a></a><span>
</span><a name="line-342"></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Dataflow.html#fixpointAnal"><span class="hs-identifier hs-var">fixpointAnal</span></a><span> </span><a href="Hoopl.Dataflow.html#Bwd"><span class="hs-identifier hs-var">Bwd</span></a><span> </span><a href="#local-1627500399"><span class="hs-identifier hs-var">lattice</span></a><span> </span><a href="#local-1627500419"><span class="hs-identifier hs-var">do_block</span></a><span> </span><a href="#local-1627500417"><span class="hs-identifier hs-var">entries</span></a><span> </span><a href="#local-1627500415"><span class="hs-identifier hs-var">blockmap</span></a><span> </span><a href="#local-1627500418"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-343"></a><span>         </span><span class="hs-keyword">where</span><span>
</span><a name="line-344"></a><span>           </span><span class="hs-identifier">do_block</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500420"><a href="#local-1627500420"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500104"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500420"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500420"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500105"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500105"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-345"></a><span>           </span><a name="local-1627500419"><a href="#local-1627500419"><span class="hs-identifier">do_block</span></a></a><span> </span><a name="local-1627500421"><a href="#local-1627500421"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1627500422"><a href="#local-1627500422"><span class="hs-identifier">fb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapSingleton"><span class="hs-identifier hs-var">mapSingleton</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a><span> </span><a href="#local-1627500421"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627500407"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500421"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-1627500422"><span class="hs-identifier hs-var">fb</span></a><span class="hs-special">)</span><span>
</span><a name="line-346"></a><span>
</span><a name="line-347"></a><span>    </span><span class="hs-comment">-- NB. eta-expand block, GHC can't do this by itself.  See #5809.</span><span>
</span><a name="line-348"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500409"><a href="#local-1627500409"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500410"><a href="#local-1627500410"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500104"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500409"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500410"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500410"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500105"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500105"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-349"></a><span>    </span><a name="local-1627500407"><a href="#local-1627500407"><span class="hs-identifier">block</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BNil"><span class="hs-identifier hs-var">BNil</span></a><span>            </span><a name="local-1627500425"><a href="#local-1627500425"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500425"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-350"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BlockCO"><span class="hs-identifier hs-var">BlockCO</span></a><span> </span><a name="local-1627500426"><a href="#local-1627500426"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500427"><a href="#local-1627500427"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>   </span><a name="local-1627500428"><a href="#local-1627500428"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500400"><span class="hs-identifier hs-var">ftr</span></a><span> </span><a href="#local-1627500426"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500408"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span>  </span><a href="#local-1627500407"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500427"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500428"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-351"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BlockCC"><span class="hs-identifier hs-var">BlockCC</span></a><span> </span><a name="local-1627500429"><a href="#local-1627500429"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1627500430"><a href="#local-1627500430"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1627500431"><a href="#local-1627500431"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627500432"><a href="#local-1627500432"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-1627500400"><span class="hs-identifier hs-var">ftr</span></a><span> </span><a href="#local-1627500429"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500408"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500407"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500430"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="#local-1627500408"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500402"><span class="hs-identifier hs-var">ltr</span></a><span> </span><a href="#local-1627500431"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500432"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-352"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BlockOC"><span class="hs-identifier hs-var">BlockOC</span></a><span>   </span><a name="local-1627500433"><a href="#local-1627500433"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1627500434"><a href="#local-1627500434"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627500435"><a href="#local-1627500435"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>              </span><span class="hs-special">(</span><a href="#local-1627500407"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500433"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500408"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500402"><span class="hs-identifier hs-var">ltr</span></a><span> </span><a href="#local-1627500434"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500435"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-353"></a><span>
</span><a name="line-354"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BMiddle"><span class="hs-identifier hs-var">BMiddle</span></a><span> </span><a name="local-1627500436"><a href="#local-1627500436"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>     </span><a name="local-1627500437"><a href="#local-1627500437"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500401"><span class="hs-identifier hs-var">mtr</span></a><span> </span><a href="#local-1627500436"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500437"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-355"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BCat"><span class="hs-identifier hs-var">BCat</span></a><span> </span><a name="local-1627500438"><a href="#local-1627500438"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-1627500439"><a href="#local-1627500439"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span>    </span><a name="local-1627500440"><a href="#local-1627500440"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500407"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500438"><span class="hs-identifier hs-var">b1</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500408"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500407"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500439"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500440"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-356"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BSnoc"><span class="hs-identifier hs-var">BSnoc</span></a><span> </span><a name="local-1627500441"><a href="#local-1627500441"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-1627500442"><a href="#local-1627500442"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>     </span><a name="local-1627500443"><a href="#local-1627500443"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500407"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500441"><span class="hs-identifier hs-var">h</span></a><span>  </span><span class="hs-special">`</span><a href="#local-1627500408"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500401"><span class="hs-identifier hs-var">mtr</span></a><span> </span><a href="#local-1627500442"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500443"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-357"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BCons"><span class="hs-identifier hs-var">BCons</span></a><span> </span><a name="local-1627500444"><a href="#local-1627500444"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500445"><a href="#local-1627500445"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>     </span><a name="local-1627500446"><a href="#local-1627500446"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500401"><span class="hs-identifier hs-var">mtr</span></a><span>  </span><a href="#local-1627500444"><span class="hs-identifier hs-var">n</span></a><span>   </span><span class="hs-special">`</span><a href="#local-1627500408"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500407"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500445"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500446"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-358"></a><span>
</span><a name="line-359"></a><span>    </span><span class="hs-pragma">{-# INLINE cat #-}</span><span>
</span><a name="line-360"></a><span>    </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500411"><a href="#local-1627500411"><span class="hs-identifier">f1</span></a></a><span> </span><a name="local-1627500412"><a href="#local-1627500412"><span class="hs-identifier">f2</span></a></a><span> </span><a name="local-1627500413"><a href="#local-1627500413"><span class="hs-identifier">f3</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="#local-1627500412"><span class="hs-identifier hs-type">f2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500413"><span class="hs-identifier hs-type">f3</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627500411"><span class="hs-identifier hs-type">f1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500412"><span class="hs-identifier hs-type">f2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627500411"><span class="hs-identifier hs-type">f1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500413"><span class="hs-identifier hs-type">f3</span></a><span class="hs-special">)</span><span>
</span><a name="line-361"></a><span>    </span><a name="local-1627500408"><a href="#local-1627500408"><span class="hs-identifier">cat</span></a></a><span> </span><a name="local-1627500447"><a href="#local-1627500447"><span class="hs-identifier">ft1</span></a></a><span> </span><a name="local-1627500448"><a href="#local-1627500448"><span class="hs-identifier">ft2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-1627500449"><a href="#local-1627500449"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500447"><span class="hs-identifier hs-var">ft1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a><span> </span><a href="#local-1627500448"><span class="hs-identifier hs-var">ft2</span></a><span> </span><a href="#local-1627500449"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-362"></a><span>
</span><a name="line-363"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-364"></a><span class="hs-comment">--              Backward analysis and rewriting: the interface</span><span>
</span><a name="line-365"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-366"></a><span>
</span><a name="line-367"></a><span>
</span><a name="line-368"></a><span class="hs-comment">-- | if the graph being analyzed is open at the exit, I don't</span><span>
</span><a name="line-369"></a><span class="hs-comment">--   quite understand the implications of possible other exits</span><span>
</span><a name="line-370"></a><span class="hs-identifier">analyzeAndRewriteBwd</span><span>
</span><a name="line-371"></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><a href="#local-1627500100"><span class="hs-identifier hs-type">n</span></a><span>
</span><a name="line-372"></a><span>   </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdPass"><span class="hs-identifier hs-type">BwdPass</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627500100"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500101"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-373"></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeC"><span class="hs-identifier hs-type">MaybeC</span></a><span> </span><a href="#local-1627500102"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500100"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500102"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500103"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500103"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500101"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-374"></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500100"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500102"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500103"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500101"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeO"><span class="hs-identifier hs-type">MaybeO</span></a><span> </span><a href="#local-1627500102"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500101"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-375"></a><a name="analyzeAndRewriteBwd"><a href="Hoopl.Dataflow.html#analyzeAndRewriteBwd"><span class="hs-identifier">analyzeAndRewriteBwd</span></a></a><span> </span><a name="local-1627500450"><a href="#local-1627500450"><span class="hs-identifier">pass</span></a></a><span> </span><a name="local-1627500451"><a href="#local-1627500451"><span class="hs-identifier">entries</span></a></a><span> </span><a name="local-1627500452"><a href="#local-1627500452"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-1627500453"><a href="#local-1627500453"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-376"></a><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-1627500454"><a href="#local-1627500454"><span class="hs-identifier">rg</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500455"><a href="#local-1627500455"><span class="hs-identifier">fout</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Hoopl.Dataflow.html#arbGraph"><span class="hs-identifier hs-var">arbGraph</span></a><span> </span><a href="#local-1627500450"><span class="hs-identifier hs-var">pass</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#targetLabels"><span class="hs-identifier hs-var">targetLabels</span></a><span> </span><a href="#local-1627500451"><span class="hs-identifier hs-var">entries</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500452"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-1627500453"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-377"></a><span>     </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1627500456"><a href="#local-1627500456"><span class="hs-identifier">g'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500457"><a href="#local-1627500457"><span class="hs-identifier">fb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Dataflow.html#normalizeGraph"><span class="hs-identifier hs-var">normalizeGraph</span></a><span> </span><a href="#local-1627500454"><span class="hs-identifier hs-var">rg</span></a><span>
</span><a name="line-378"></a><span>     </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627500456"><span class="hs-identifier hs-var">g'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500457"><span class="hs-identifier hs-var">fb</span></a><span class="hs-special">,</span><span> </span><a href="Hoopl.Dataflow.html#distinguishedEntryFact"><span class="hs-identifier hs-var">distinguishedEntryFact</span></a><span> </span><a href="#local-1627500456"><span class="hs-identifier hs-var">g'</span></a><span> </span><a href="#local-1627500455"><span class="hs-identifier hs-var">fout</span></a><span class="hs-special">)</span><span>
</span><a name="line-379"></a><span>
</span><a name="line-380"></a><span class="hs-identifier">distinguishedEntryFact</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500096"><a href="#local-1627500096"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500097"><a href="#local-1627500097"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500098"><a href="#local-1627500098"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1627500099"><a href="#local-1627500099"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500096"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500097"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500098"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500097"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500099"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeO"><span class="hs-identifier hs-type">MaybeO</span></a><span> </span><a href="#local-1627500097"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500099"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-381"></a><a name="distinguishedEntryFact"><a href="Hoopl.Dataflow.html#distinguishedEntryFact"><span class="hs-identifier">distinguishedEntryFact</span></a></a><span> </span><a name="local-1627500458"><a href="#local-1627500458"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-1627500459"><a href="#local-1627500459"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500460"><span class="hs-identifier hs-var">maybe</span></a><span> </span><a href="#local-1627500458"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-382"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500096"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500097"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500098"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeO"><span class="hs-identifier hs-type">MaybeO</span></a><span> </span><a href="#local-1627500097"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500099"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-383"></a><span>          </span><a name="local-1627500460"><a href="#local-1627500460"><span class="hs-identifier">maybe</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GNil"><span class="hs-identifier hs-var">GNil</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustO"><span class="hs-identifier hs-var">JustO</span></a><span> </span><a href="#local-1627500459"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-384"></a><span>          </span><span class="hs-identifier">maybe</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GUnit"><span class="hs-identifier hs-var">GUnit</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustO"><span class="hs-identifier hs-var">JustO</span></a><span> </span><a href="#local-1627500459"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-385"></a><span>          </span><span class="hs-identifier">maybe</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GMany"><span class="hs-identifier hs-var">GMany</span></a><span> </span><a name="local-1627500461"><a href="#local-1627500461"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627500461"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">of</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span>
</span><a name="line-386"></a><span>                                          </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustO"><span class="hs-identifier hs-var">JustO</span></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustO"><span class="hs-identifier hs-var">JustO</span></a><span> </span><a href="#local-1627500459"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span>
</span><a name="line-389"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-390"></a><span class="hs-comment">--              Backward implementation</span><span>
</span><a name="line-391"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-392"></a><span>
</span><a name="line-393"></a><span class="hs-identifier">arbGraph</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500092"><a href="#local-1627500092"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500093"><a href="#local-1627500093"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627500094"><a href="#local-1627500094"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500095"><a href="#local-1627500095"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span>
</span><a name="line-394"></a><span>            </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-395"></a><span>            </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdPass"><span class="hs-identifier hs-type">BwdPass</span></a><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-396"></a><span>            </span><a href="Hoopl.Dataflow.html#Entries"><span class="hs-identifier hs-type">Entries</span></a><span> </span><a href="#local-1627500094"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500094"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500095"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500095"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500094"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500095"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500094"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-397"></a><a name="arbGraph"><a href="Hoopl.Dataflow.html#arbGraph"><span class="hs-identifier">arbGraph</span></a></a><span> </span><a name="local-1627500462"><a href="#local-1627500462"><span class="hs-identifier">pass</span></a></a><span class="hs-glyph">@</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdPass"><span class="hs-identifier hs-var">BwdPass</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">bp_lattice</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-1627500463"><a href="#local-1627500463"><span class="hs-identifier">lattice</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-398"></a><span>                        </span><span class="hs-identifier">bp_transfer</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627500464"><a href="#local-1627500464"><span class="hs-identifier">transfer</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-399"></a><span>                        </span><span class="hs-identifier">bp_rewrite</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-1627500465"><a href="#local-1627500465"><span class="hs-identifier">rewrite</span></a></a><span> </span><span class="hs-special">}</span><span> </span><a name="local-1627500466"><a href="#local-1627500466"><span class="hs-identifier">entries</span></a></a><span> </span><a name="local-1627500467"><a href="#local-1627500467"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-1627500468"><a href="#local-1627500468"><span class="hs-identifier">in_fact</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500469"><span class="hs-identifier hs-var">graph</span></a><span> </span><a href="#local-1627500467"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-1627500468"><span class="hs-identifier hs-var">in_fact</span></a><span>
</span><a name="line-400"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-401"></a><span>    </span><span class="hs-comment">{- nested type synonyms would be so lovely here
    type ARB  thing = forall e x . thing e x -&gt; Fact x f -&gt; m (DG f n e x, f)
    type ARBX thing = forall e x . thing e x -&gt; Fact x f -&gt; m (DG f n e x, Fact e f)
    -}</span><span>
</span><a name="line-405"></a><span>    </span><span class="hs-identifier">graph</span><span> </span><span class="hs-glyph">::</span><span>              </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500094"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500095"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500095"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500094"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500095"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500094"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-406"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500475"><a href="#local-1627500475"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500476"><a href="#local-1627500476"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500475"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500476"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500476"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500475"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500476"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-407"></a><span>    </span><span class="hs-identifier">body</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Body"><span class="hs-identifier hs-type">Body</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-408"></a><span>    </span><span class="hs-identifier">node</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500477"><a href="#local-1627500477"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500478"><a href="#local-1627500478"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#ShapeLifter"><span class="hs-identifier hs-type">ShapeLifter</span></a><span> </span><a href="#local-1627500477"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500478"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-409"></a><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500477"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500478"><span class="hs-identifier hs-type">x</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500478"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500477"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500478"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-410"></a><span>    </span><span class="hs-identifier">cat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500479"><a href="#local-1627500479"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500480"><a href="#local-1627500480"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627500481"><a href="#local-1627500481"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1627500482"><a href="#local-1627500482"><span class="hs-identifier">info</span></a></a><span> </span><a name="local-1627500483"><a href="#local-1627500483"><span class="hs-identifier">info'</span></a></a><span> </span><a name="local-1627500484"><a href="#local-1627500484"><span class="hs-identifier">info''</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-411"></a><span>           </span><span class="hs-special">(</span><a href="#local-1627500483"><span class="hs-identifier hs-type">info'</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500479"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500480"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500484"><span class="hs-identifier hs-type">info''</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-412"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627500482"><span class="hs-identifier hs-type">info</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500480"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627500481"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500483"><span class="hs-identifier hs-type">info'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-413"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627500482"><span class="hs-identifier hs-type">info</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500479"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500481"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500484"><span class="hs-identifier hs-type">info''</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-414"></a><span>
</span><a name="line-415"></a><span>    </span><a name="local-1627500469"><a href="#local-1627500469"><span class="hs-identifier">graph</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GNil"><span class="hs-identifier hs-var">GNil</span></a><span>            </span><a name="local-1627500486"><a href="#local-1627500486"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#dgnil"><span class="hs-identifier hs-var">dgnil</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500486"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-416"></a><span>    </span><span class="hs-identifier">graph</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GUnit"><span class="hs-identifier hs-var">GUnit</span></a><span> </span><a name="local-1627500487"><a href="#local-1627500487"><span class="hs-identifier">blk</span></a></a><span class="hs-special">)</span><span>     </span><a name="local-1627500488"><a href="#local-1627500488"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500470"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500487"><span class="hs-identifier hs-var">blk</span></a><span> </span><a href="#local-1627500488"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-417"></a><span>    </span><span class="hs-identifier">graph</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GMany"><span class="hs-identifier hs-var">GMany</span></a><span> </span><a name="local-1627500489"><a href="#local-1627500489"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500490"><a href="#local-1627500490"><span class="hs-identifier">bdy</span></a></a><span> </span><a name="local-1627500491"><a href="#local-1627500491"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627500492"><a href="#local-1627500492"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-1627500489"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500494"><span class="hs-identifier hs-var">ebcat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500490"><span class="hs-identifier hs-var">bdy</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="#local-1627500472"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500493"><span class="hs-identifier hs-var">exit</span></a><span> </span><a href="#local-1627500491"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500492"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-418"></a><span>     </span><span class="hs-keyword">where</span><span>
</span><a name="line-419"></a><span>      </span><span class="hs-identifier">ebcat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeO"><span class="hs-identifier hs-type">MaybeO</span></a><span> </span><a href="#local-1627500094"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Body"><span class="hs-identifier hs-type">Body</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500094"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500094"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-420"></a><span>      </span><span class="hs-identifier">exit</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeO"><span class="hs-identifier hs-type">MaybeO</span></a><span> </span><a href="#local-1627500095"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500095"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500095"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-421"></a><span>      </span><a name="local-1627500493"><a href="#local-1627500493"><span class="hs-identifier">exit</span></a></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustO"><span class="hs-identifier hs-var">JustO</span></a><span> </span><a name="local-1627500495"><a href="#local-1627500495"><span class="hs-identifier">blk</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627500496"><a href="#local-1627500496"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500473"><span class="hs-identifier hs-var">arbx</span></a><span> </span><a href="#local-1627500470"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500495"><span class="hs-identifier hs-var">blk</span></a><span> </span><a href="#local-1627500496"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-422"></a><span>      </span><span class="hs-identifier">exit</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span>    </span><a name="local-1627500497"><a href="#local-1627500497"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#dgnilC"><span class="hs-identifier hs-var">dgnilC</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500497"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-423"></a><span>      </span><a name="local-1627500494"><a href="#local-1627500494"><span class="hs-identifier">ebcat</span></a></a><span> </span><a name="local-1627500498"><a href="#local-1627500498"><span class="hs-identifier">entry</span></a></a><span> </span><a name="local-1627500499"><a href="#local-1627500499"><span class="hs-identifier">bdy</span></a></a><span> </span><a name="local-1627500500"><a href="#local-1627500500"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500501"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-1627500466"><span class="hs-identifier hs-var">entries</span></a><span> </span><a href="#local-1627500498"><span class="hs-identifier hs-var">entry</span></a><span> </span><a href="#local-1627500500"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-424"></a><span>       </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeC"><span class="hs-identifier hs-type">MaybeC</span></a><span> </span><a href="#local-1627500094"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeO"><span class="hs-identifier hs-type">MaybeO</span></a><span> </span><a href="#local-1627500094"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">)</span><span>
</span><a name="line-425"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500094"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500094"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-426"></a><span>             </span><a name="local-1627500501"><a href="#local-1627500501"><span class="hs-identifier">c</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingC"><span class="hs-identifier hs-var">NothingC</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustO"><span class="hs-identifier hs-var">JustO</span></a><span> </span><a name="local-1627500502"><a href="#local-1627500502"><span class="hs-identifier">entry</span></a></a><span class="hs-special">)</span><span>   </span><a name="local-1627500503"><a href="#local-1627500503"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500470"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500502"><span class="hs-identifier hs-var">entry</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500472"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500474"><span class="hs-identifier hs-var">body</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#successors"><span class="hs-identifier hs-var">successors</span></a><span> </span><a href="#local-1627500502"><span class="hs-identifier hs-var">entry</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500499"><span class="hs-identifier hs-var">bdy</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500503"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-427"></a><span>             </span><span class="hs-identifier">c</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustC"><span class="hs-identifier hs-var">JustC</span></a><span> </span><a name="local-1627500504"><a href="#local-1627500504"><span class="hs-identifier">entries</span></a></a><span class="hs-special">)</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span> </span><a name="local-1627500505"><a href="#local-1627500505"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500474"><span class="hs-identifier hs-var">body</span></a><span> </span><a href="#local-1627500504"><span class="hs-identifier hs-var">entries</span></a><span> </span><a href="#local-1627500499"><span class="hs-identifier hs-var">bdy</span></a><span> </span><a href="#local-1627500505"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-428"></a><span>
</span><a name="line-429"></a><span>    </span><span class="hs-comment">-- Lift from nodes to blocks</span><span>
</span><a name="line-430"></a><span>    </span><a name="local-1627500470"><a href="#local-1627500470"><span class="hs-identifier">block</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BNil"><span class="hs-identifier hs-var">BNil</span></a><span>            </span><a name="local-1627500506"><a href="#local-1627500506"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#dgnil"><span class="hs-identifier hs-var">dgnil</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500506"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-431"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BlockCO"><span class="hs-identifier hs-var">BlockCO</span></a><span> </span><a name="local-1627500507"><a href="#local-1627500507"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500508"><a href="#local-1627500508"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>   </span><a name="local-1627500509"><a href="#local-1627500509"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500471"><span class="hs-identifier hs-var">node</span></a><span> </span><a href="#local-1627500507"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500472"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500470"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500508"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500509"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-432"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BlockCC"><span class="hs-identifier hs-var">BlockCC</span></a><span> </span><a name="local-1627500510"><a href="#local-1627500510"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1627500511"><a href="#local-1627500511"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1627500512"><a href="#local-1627500512"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627500513"><a href="#local-1627500513"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500471"><span class="hs-identifier hs-var">node</span></a><span> </span><a href="#local-1627500510"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500472"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500470"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500511"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500472"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500471"><span class="hs-identifier hs-var">node</span></a><span> </span><a href="#local-1627500512"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500513"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-433"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BlockOC"><span class="hs-identifier hs-var">BlockOC</span></a><span>   </span><a name="local-1627500514"><a href="#local-1627500514"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1627500515"><a href="#local-1627500515"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627500516"><a href="#local-1627500516"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>              </span><span class="hs-special">(</span><a href="#local-1627500470"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500514"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500472"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500471"><span class="hs-identifier hs-var">node</span></a><span> </span><a href="#local-1627500515"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500516"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-434"></a><span>
</span><a name="line-435"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BMiddle"><span class="hs-identifier hs-var">BMiddle</span></a><span> </span><a name="local-1627500517"><a href="#local-1627500517"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>     </span><a name="local-1627500518"><a href="#local-1627500518"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500471"><span class="hs-identifier hs-var">node</span></a><span> </span><a href="#local-1627500517"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500518"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-436"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BCat"><span class="hs-identifier hs-var">BCat</span></a><span> </span><a name="local-1627500519"><a href="#local-1627500519"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-1627500520"><a href="#local-1627500520"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span>    </span><a name="local-1627500521"><a href="#local-1627500521"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500470"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500519"><span class="hs-identifier hs-var">b1</span></a><span> </span><span class="hs-special">`</span><a href="#local-1627500472"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500470"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500520"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500521"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-437"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BSnoc"><span class="hs-identifier hs-var">BSnoc</span></a><span> </span><a name="local-1627500522"><a href="#local-1627500522"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-1627500523"><a href="#local-1627500523"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>     </span><a name="local-1627500524"><a href="#local-1627500524"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500470"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500522"><span class="hs-identifier hs-var">h</span></a><span>  </span><span class="hs-special">`</span><a href="#local-1627500472"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500471"><span class="hs-identifier hs-var">node</span></a><span> </span><a href="#local-1627500523"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500524"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-438"></a><span>    </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BCons"><span class="hs-identifier hs-var">BCons</span></a><span> </span><a name="local-1627500525"><a href="#local-1627500525"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500526"><a href="#local-1627500526"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>     </span><a name="local-1627500527"><a href="#local-1627500527"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627500471"><span class="hs-identifier hs-var">node</span></a><span>  </span><a href="#local-1627500525"><span class="hs-identifier hs-var">n</span></a><span>  </span><span class="hs-special">`</span><a href="#local-1627500472"><span class="hs-identifier hs-var">cat</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500470"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500526"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500527"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-439"></a><span>
</span><a name="line-440"></a><span>    </span><span class="hs-pragma">{-# INLINE node #-}</span><span>
</span><a name="line-441"></a><span>    </span><a name="local-1627500471"><a href="#local-1627500471"><span class="hs-identifier">node</span></a></a><span> </span><a name="local-1627500528"><a href="#local-1627500528"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500529"><a href="#local-1627500529"><span class="hs-identifier">f</span></a></a><span>
</span><a name="line-442"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1627500530"><a href="#local-1627500530"><span class="hs-identifier">bwdres</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Hoopl.Dataflow.html#brewrite"><span class="hs-identifier hs-var">brewrite</span></a><span> </span><a href="#local-1627500465"><span class="hs-identifier hs-var">rewrite</span></a><span> </span><a href="#local-1627500528"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500529"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-443"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627500530"><span class="hs-identifier hs-var">bwdres</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-444"></a><span>               </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#singletonDG"><span class="hs-identifier hs-var">singletonDG</span></a><span> </span><a href="#local-1627500531"><span class="hs-identifier hs-var">entry_f</span></a><span> </span><a href="#local-1627500528"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500531"><span class="hs-identifier hs-var">entry_f</span></a><span class="hs-special">)</span><span>
</span><a name="line-445"></a><span>                            </span><span class="hs-keyword">where</span><span> </span><a name="local-1627500531"><a href="#local-1627500531"><span class="hs-identifier">entry_f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Dataflow.html#btransfer"><span class="hs-identifier hs-var">btransfer</span></a><span> </span><a href="#local-1627500464"><span class="hs-identifier hs-var">transfer</span></a><span> </span><a href="#local-1627500528"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500529"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-446"></a><span>               </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1627500532"><a href="#local-1627500532"><span class="hs-identifier">g</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500533"><a href="#local-1627500533"><span class="hs-identifier">rw</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-447"></a><span>                          </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1627500534"><a href="#local-1627500534"><span class="hs-identifier">pass'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500462"><span class="hs-identifier hs-var">pass</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">bp_rewrite</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500533"><span class="hs-identifier hs-var">rw</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-448"></a><span>                             </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1627500535"><a href="#local-1627500535"><span class="hs-identifier">g</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500536"><a href="#local-1627500536"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Hoopl.Dataflow.html#arbGraph"><span class="hs-identifier hs-var">arbGraph</span></a><span> </span><a href="#local-1627500534"><span class="hs-identifier hs-var">pass'</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#fwdEntryLabel"><span class="hs-identifier hs-var">fwdEntryLabel</span></a><span> </span><a href="#local-1627500528"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500532"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-1627500529"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-449"></a><span>                             </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627500535"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">,</span><span> </span><a href="Hoopl.Dataflow.html#bwdEntryFact"><span class="hs-identifier hs-var">bwdEntryFact</span></a><span> </span><a href="#local-1627500463"><span class="hs-identifier hs-var">lattice</span></a><span> </span><a href="#local-1627500528"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500536"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-450"></a><span>
</span><a name="line-451"></a><span>    </span><span class="hs-comment">-- | Compose fact transformers and concatenate the resulting</span><span>
</span><a name="line-452"></a><span>    </span><span class="hs-comment">-- rewritten graphs.</span><span>
</span><a name="line-453"></a><span>    </span><span class="hs-pragma">{-# INLINE cat #-}</span><span>
</span><a name="line-454"></a><span>    </span><a name="local-1627500472"><a href="#local-1627500472"><span class="hs-identifier">cat</span></a></a><span> </span><a name="local-1627500537"><a href="#local-1627500537"><span class="hs-identifier">ft1</span></a></a><span> </span><a name="local-1627500538"><a href="#local-1627500538"><span class="hs-identifier">ft2</span></a></a><span> </span><a name="local-1627500539"><a href="#local-1627500539"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1627500540"><a href="#local-1627500540"><span class="hs-identifier">g2</span></a></a><span class="hs-special">,</span><a name="local-1627500541"><a href="#local-1627500541"><span class="hs-identifier">f2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627500538"><span class="hs-identifier hs-var">ft2</span></a><span> </span><a href="#local-1627500539"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-455"></a><span>                       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1627500542"><a href="#local-1627500542"><span class="hs-identifier">g1</span></a></a><span class="hs-special">,</span><a name="local-1627500543"><a href="#local-1627500543"><span class="hs-identifier">f1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627500537"><span class="hs-identifier hs-var">ft1</span></a><span> </span><a href="#local-1627500541"><span class="hs-identifier hs-var">f2</span></a><span>
</span><a name="line-456"></a><span>                       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-1627500544"><a href="#local-1627500544"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500542"><span class="hs-identifier hs-var">g1</span></a><span> </span><span class="hs-special">`</span><a href="Hoopl.Dataflow.html#dgSplice"><span class="hs-identifier hs-var">dgSplice</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500540"><span class="hs-identifier hs-var">g2</span></a><span>
</span><a name="line-457"></a><span>                       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627500544"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500543"><span class="hs-identifier hs-var">f1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-458"></a><span>
</span><a name="line-459"></a><span>    </span><span class="hs-identifier">arbx</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500485"><a href="#local-1627500485"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span>
</span><a name="line-460"></a><span>            </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500485"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500485"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500485"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-461"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500485"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500485"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500485"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-462"></a><span>
</span><a name="line-463"></a><span>    </span><a name="local-1627500473"><a href="#local-1627500473"><span class="hs-identifier">arbx</span></a></a><span> </span><a name="local-1627500545"><a href="#local-1627500545"><span class="hs-identifier">arb</span></a></a><span> </span><a name="local-1627500546"><a href="#local-1627500546"><span class="hs-identifier">thing</span></a></a><span> </span><a name="local-1627500547"><a href="#local-1627500547"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1627500548"><a href="#local-1627500548"><span class="hs-identifier">rg</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500549"><a href="#local-1627500549"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627500545"><span class="hs-identifier hs-var">arb</span></a><span> </span><a href="#local-1627500546"><span class="hs-identifier hs-var">thing</span></a><span> </span><a href="#local-1627500547"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-464"></a><span>                          </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1627500550"><a href="#local-1627500550"><span class="hs-identifier">fb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Dataflow.html#joinInFacts"><span class="hs-identifier hs-var">joinInFacts</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">bp_lattice</span><span> </span><a href="#local-1627500462"><span class="hs-identifier hs-var">pass</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-465"></a><span>                                     </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapSingleton"><span class="hs-identifier hs-var">mapSingleton</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a><span> </span><a href="#local-1627500546"><span class="hs-identifier hs-var">thing</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500549"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-466"></a><span>                          </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627500548"><span class="hs-identifier hs-var">rg</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500550"><span class="hs-identifier hs-var">fb</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-467"></a><span>     </span><span class="hs-comment">-- joinInFacts adds debugging information</span><span>
</span><a name="line-468"></a><span>
</span><a name="line-469"></a><span>                    </span><span class="hs-comment">-- Outgoing factbase is restricted to Labels *not* in</span><span>
</span><a name="line-470"></a><span>                    </span><span class="hs-comment">-- in the Body; the facts for Labels *in*</span><span>
</span><a name="line-471"></a><span>                    </span><span class="hs-comment">-- the Body are in the 'DG f n C C'</span><span>
</span><a name="line-472"></a><span>    </span><a name="local-1627500474"><a href="#local-1627500474"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-1627500551"><a href="#local-1627500551"><span class="hs-identifier">entries</span></a></a><span> </span><a name="local-1627500552"><a href="#local-1627500552"><span class="hs-identifier">blockmap</span></a></a><span> </span><a name="local-1627500553"><a href="#local-1627500553"><span class="hs-identifier">init_fbase</span></a></a><span>
</span><a name="line-473"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Dataflow.html#fixpoint"><span class="hs-identifier hs-var">fixpoint</span></a><span> </span><a href="Hoopl.Dataflow.html#Bwd"><span class="hs-identifier hs-var">Bwd</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">bp_lattice</span><span> </span><a href="#local-1627500462"><span class="hs-identifier hs-var">pass</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500554"><span class="hs-identifier hs-var">do_block</span></a><span> </span><a href="#local-1627500551"><span class="hs-identifier hs-var">entries</span></a><span> </span><a href="#local-1627500552"><span class="hs-identifier hs-var">blockmap</span></a><span> </span><a href="#local-1627500553"><span class="hs-identifier hs-var">init_fbase</span></a><span>
</span><a name="line-474"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-475"></a><span>        </span><span class="hs-identifier">do_block</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500555"><a href="#local-1627500555"><span class="hs-identifier">x</span></a></a><span class="hs-operator">.</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500555"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500555"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500092"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500555"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a><span> </span><a href="#local-1627500093"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-476"></a><span>        </span><a name="local-1627500554"><a href="#local-1627500554"><span class="hs-identifier">do_block</span></a></a><span> </span><a name="local-1627500556"><a href="#local-1627500556"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-1627500557"><a href="#local-1627500557"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-1627500558"><a href="#local-1627500558"><span class="hs-identifier">g</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500559"><a href="#local-1627500559"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627500470"><span class="hs-identifier hs-var">block</span></a><span> </span><a href="#local-1627500556"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-1627500557"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-477"></a><span>                          </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627500558"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapSingleton"><span class="hs-identifier hs-var">mapSingleton</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a><span> </span><a href="#local-1627500556"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500559"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-478"></a><span>
</span><a name="line-479"></a><span>
</span><a name="line-480"></a><span class="hs-comment">{-

The forward and backward cases are not dual.  In the forward case, the
entry points are known, and one simply traverses the body blocks from
those points.  In the backward case, something is known about the exit
points, but this information is essentially useless, because we don't
actually have a dual graph (that is, one with edges reversed) to
compute with.  (Even if we did have a dual graph, it would not avail
us---a backward analysis must include reachable blocks that don't
reach the exit, as in a procedure that loops forever and has side
effects.)

-}</span><span>
</span><a name="line-493"></a><span>
</span><a name="line-494"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-495"></a><span class="hs-comment">--      fixpoint</span><span>
</span><a name="line-496"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-497"></a><span>
</span><a name="line-498"></a><span class="hs-keyword">data</span><span> </span><a name="Direction"><a href="Hoopl.Dataflow.html#Direction"><span class="hs-identifier">Direction</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Fwd"><a href="Hoopl.Dataflow.html#Fwd"><span class="hs-identifier">Fwd</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Bwd"><a href="Hoopl.Dataflow.html#Bwd"><span class="hs-identifier">Bwd</span></a></a><span>
</span><a name="line-499"></a><span>
</span><a name="line-500"></a><span class="hs-comment">-- | fixpointing for analysis-only</span><span>
</span><a name="line-501"></a><span class="hs-comment">--</span><span>
</span><a name="line-502"></a><span class="hs-identifier">fixpointAnal</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500090"><a href="#local-1627500090"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500091"><a href="#local-1627500091"><span class="hs-identifier">f</span></a></a><span class="hs-operator">.</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><a href="#local-1627500090"><span class="hs-identifier hs-type">n</span></a><span>
</span><a name="line-503"></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Hoopl.Dataflow.html#Direction"><span class="hs-identifier hs-type">Direction</span></a><span>
</span><a name="line-504"></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#DataflowLattice"><span class="hs-identifier hs-type">DataflowLattice</span></a><span> </span><a href="#local-1627500091"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-505"></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500090"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500091"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500091"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-506"></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span>
</span><a name="line-507"></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500090"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">)</span><span>
</span><a name="line-508"></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500091"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500091"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><a name="fixpointAnal"><a href="Hoopl.Dataflow.html#fixpointAnal"><span class="hs-identifier">fixpointAnal</span></a></a><span> </span><a name="local-1627500560"><a href="#local-1627500560"><span class="hs-identifier">direction</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#DataflowLattice"><span class="hs-identifier hs-var">DataflowLattice</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">fact_bot</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fact_join</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627500561"><a href="#local-1627500561"><span class="hs-identifier">join</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-511"></a><span>              </span><a name="local-1627500562"><a href="#local-1627500562"><span class="hs-identifier">do_block</span></a></a><span> </span><a name="local-1627500563"><a href="#local-1627500563"><span class="hs-identifier">entries</span></a></a><span> </span><a name="local-1627500564"><a href="#local-1627500564"><span class="hs-identifier">blockmap</span></a></a><span> </span><a name="local-1627500565"><a href="#local-1627500565"><span class="hs-identifier">init_fbase</span></a></a><span>
</span><a name="line-512"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500571"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-1627500569"><span class="hs-identifier hs-var">start</span></a><span> </span><a href="#local-1627500565"><span class="hs-identifier hs-var">init_fbase</span></a><span>
</span><a name="line-513"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-514"></a><span>    </span><a name="local-1627500566"><a href="#local-1627500566"><span class="hs-identifier">blocks</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Dataflow.html#sortBlocks"><span class="hs-identifier hs-var">sortBlocks</span></a><span> </span><a href="#local-1627500560"><span class="hs-identifier hs-var">direction</span></a><span> </span><a href="#local-1627500563"><span class="hs-identifier hs-var">entries</span></a><span> </span><a href="#local-1627500564"><span class="hs-identifier hs-var">blockmap</span></a><span>
</span><a name="line-515"></a><span>    </span><a name="local-1627500567"><a href="#local-1627500567"><span class="hs-identifier">n</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1627500566"><span class="hs-identifier hs-var">blocks</span></a><span>
</span><a name="line-516"></a><span>    </span><a name="local-1627500568"><a href="#local-1627500568"><span class="hs-identifier">block_arr</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-pragma">{-# SCC &quot;block_arr&quot; #-}</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Arr.html#listArray"><span class="hs-identifier hs-var">listArray</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><a href="#local-1627500567"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-1627500566"><span class="hs-identifier hs-var">blocks</span></a><span>
</span><a name="line-517"></a><span>    </span><a name="local-1627500569"><a href="#local-1627500569"><span class="hs-identifier">start</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-pragma">{-# SCC &quot;start&quot; #-}</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="#local-1627500567"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span>
</span><a name="line-518"></a><span>    </span><a name="local-1627500570"><a href="#local-1627500570"><span class="hs-identifier">dep_blocks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-pragma">{-# SCC &quot;dep_blocks&quot; #-}</span><span> </span><a href="Hoopl.Dataflow.html#mkDepBlocks"><span class="hs-identifier hs-var">mkDepBlocks</span></a><span> </span><a href="#local-1627500560"><span class="hs-identifier hs-var">direction</span></a><span> </span><a href="#local-1627500566"><span class="hs-identifier hs-var">blocks</span></a><span>
</span><a name="line-519"></a><span>
</span><a name="line-520"></a><span>    </span><span class="hs-identifier">loop</span><span>
</span><a name="line-521"></a><span>       </span><span class="hs-glyph">::</span><span> </span><a href="Hoopl.Dataflow.html#IntHeap"><span class="hs-identifier hs-type">IntHeap</span></a><span>      </span><span class="hs-comment">-- blocks still to analyse</span><span>
</span><a name="line-522"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500091"><span class="hs-identifier hs-type">f</span></a><span>  </span><span class="hs-comment">-- current factbase (increases monotonically)</span><span>
</span><a name="line-523"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500091"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-524"></a><span>
</span><a name="line-525"></a><span>    </span><a name="local-1627500571"><a href="#local-1627500571"><span class="hs-identifier">loop</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><a name="local-1627500572"><a href="#local-1627500572"><span class="hs-identifier">fbase</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500572"><span class="hs-identifier hs-var">fbase</span></a><span>
</span><a name="line-526"></a><span>    </span><span class="hs-identifier">loop</span><span> </span><span class="hs-special">(</span><a name="local-1627500573"><a href="#local-1627500573"><span class="hs-identifier">ix</span></a></a><span class="hs-glyph">:</span><a name="local-1627500574"><a href="#local-1627500574"><span class="hs-identifier">todo</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627500575"><a href="#local-1627500575"><span class="hs-identifier">fbase</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-527"></a><span>           </span><span class="hs-keyword">let</span><span>
</span><a name="line-528"></a><span>               </span><a name="local-1627500576"><a href="#local-1627500576"><span class="hs-identifier">blk</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500568"><span class="hs-identifier hs-var">block_arr</span></a><span> </span><span class="hs-glyph">!</span><span> </span><a href="#local-1627500573"><span class="hs-identifier hs-var">ix</span></a><span>
</span><a name="line-529"></a><span>
</span><a name="line-530"></a><span>               </span><a name="local-1627500577"><a href="#local-1627500577"><span class="hs-identifier">out_facts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-pragma">{-# SCC &quot;do_block&quot; #-}</span><span> </span><a href="#local-1627500562"><span class="hs-identifier hs-var">do_block</span></a><span> </span><a href="#local-1627500576"><span class="hs-identifier hs-var">blk</span></a><span> </span><a href="#local-1627500575"><span class="hs-identifier hs-var">fbase</span></a><span>
</span><a name="line-531"></a><span>
</span><a name="line-532"></a><span>               </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a name="local-1627500578"><a href="#local-1627500578"><span class="hs-identifier">todo'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500579"><a href="#local-1627500579"><span class="hs-identifier">fbase'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-pragma">{-# SCC &quot;mapFoldWithKey&quot; #-}</span><span>
</span><a name="line-533"></a><span>                     </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapFoldWithKey"><span class="hs-identifier hs-var">mapFoldWithKey</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#updateFact"><span class="hs-identifier hs-var">updateFact</span></a><span> </span><a href="#local-1627500561"><span class="hs-identifier hs-var">join</span></a><span> </span><a href="#local-1627500570"><span class="hs-identifier hs-var">dep_blocks</span></a><span class="hs-special">)</span><span>
</span><a name="line-534"></a><span>                                    </span><span class="hs-special">(</span><a href="#local-1627500574"><span class="hs-identifier hs-var">todo</span></a><span class="hs-special">,</span><a href="#local-1627500575"><span class="hs-identifier hs-var">fbase</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500577"><span class="hs-identifier hs-var">out_facts</span></a><span>
</span><a name="line-535"></a><span>           </span><span class="hs-keyword">in</span><span>
</span><a name="line-536"></a><span>           </span><span class="hs-comment">-- trace (&quot;analysing: &quot; ++ show (entryLabel blk)) $</span><span>
</span><a name="line-537"></a><span>           </span><span class="hs-comment">-- trace (&quot;fbase': &quot; ++ show (mapKeys fbase')) $ return ()</span><span>
</span><a name="line-538"></a><span>           </span><span class="hs-comment">-- trace (&quot;changed: &quot; ++ show changed) $ return ()</span><span>
</span><a name="line-539"></a><span>           </span><span class="hs-comment">-- trace (&quot;to analyse: &quot; ++ show to_analyse) $ return ()</span><span>
</span><a name="line-540"></a><span>
</span><a name="line-541"></a><span>           </span><a href="#local-1627500571"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-1627500578"><span class="hs-identifier hs-var">todo'</span></a><span> </span><a href="#local-1627500579"><span class="hs-identifier hs-var">fbase'</span></a><span>
</span><a name="line-542"></a><span>
</span><a name="line-543"></a><span>
</span><a name="line-544"></a><span class="hs-comment">-- | fixpointing for combined analysis/rewriting</span><span>
</span><a name="line-545"></a><span class="hs-comment">--</span><span>
</span><a name="line-546"></a><span class="hs-identifier">fixpoint</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500088"><a href="#local-1627500088"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500089"><a href="#local-1627500089"><span class="hs-identifier">f</span></a></a><span class="hs-operator">.</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><a href="#local-1627500088"><span class="hs-identifier hs-type">n</span></a><span>
</span><a name="line-547"></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Hoopl.Dataflow.html#Direction"><span class="hs-identifier hs-type">Direction</span></a><span>
</span><a name="line-548"></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#DataflowLattice"><span class="hs-identifier hs-type">DataflowLattice</span></a><span> </span><a href="#local-1627500089"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-549"></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500088"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500089"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500089"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500088"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500089"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-550"></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span>
</span><a name="line-551"></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500088"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">)</span><span>
</span><a name="line-552"></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500089"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500089"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500088"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500089"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-553"></a><span>
</span><a name="line-554"></a><a name="fixpoint"><a href="Hoopl.Dataflow.html#fixpoint"><span class="hs-identifier">fixpoint</span></a></a><span> </span><a name="local-1627500580"><a href="#local-1627500580"><span class="hs-identifier">direction</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#DataflowLattice"><span class="hs-identifier hs-var">DataflowLattice</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">fact_bot</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fact_join</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1627500581"><a href="#local-1627500581"><span class="hs-identifier">join</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-555"></a><span>         </span><a name="local-1627500582"><a href="#local-1627500582"><span class="hs-identifier">do_block</span></a></a><span> </span><a name="local-1627500583"><a href="#local-1627500583"><span class="hs-identifier">entries</span></a></a><span> </span><a name="local-1627500584"><a href="#local-1627500584"><span class="hs-identifier">blockmap</span></a></a><span> </span><a name="local-1627500585"><a href="#local-1627500585"><span class="hs-identifier">init_fbase</span></a></a><span>
</span><a name="line-556"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-557"></a><span>        </span><span class="hs-comment">-- trace (&quot;fixpoint: &quot; ++ show (case direction of Fwd -&gt; True; Bwd -&gt; False) ++ &quot; &quot; ++ show (mapKeys blockmap) ++ show entries ++ &quot; &quot; ++ show (mapKeys init_fbase)) $ return()</span><span>
</span><a name="line-558"></a><span>        </span><span class="hs-special">(</span><a name="local-1627500605"><a href="#local-1627500605"><span class="hs-identifier">fbase</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500606"><a href="#local-1627500606"><span class="hs-identifier">newblocks</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627500591"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-1627500589"><span class="hs-identifier hs-var">start</span></a><span> </span><a href="#local-1627500585"><span class="hs-identifier hs-var">init_fbase</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapEmpty"><span class="hs-identifier hs-var">mapEmpty</span></a><span>
</span><a name="line-559"></a><span>        </span><span class="hs-comment">-- trace (&quot;fixpoint DONE: &quot; ++ show (mapKeys fbase) ++ show (mapKeys newblocks)) $ return()</span><span>
</span><a name="line-560"></a><span>        </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GMany"><span class="hs-identifier hs-var">GMany</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span> </span><a href="#local-1627500606"><span class="hs-identifier hs-var">newblocks</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span class="hs-special">,</span><span>
</span><a name="line-561"></a><span>                </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapDeleteList"><span class="hs-identifier hs-var">mapDeleteList</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapKeys"><span class="hs-identifier hs-var">mapKeys</span></a><span> </span><a href="#local-1627500584"><span class="hs-identifier hs-var">blockmap</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500605"><span class="hs-identifier hs-var">fbase</span></a><span class="hs-special">)</span><span>
</span><a name="line-562"></a><span>    </span><span class="hs-comment">-- The successors of the Graph are the the Labels</span><span>
</span><a name="line-563"></a><span>    </span><span class="hs-comment">-- for which we have facts and which are *not* in</span><span>
</span><a name="line-564"></a><span>    </span><span class="hs-comment">-- the blocks of the graph</span><span>
</span><a name="line-565"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-566"></a><span>    </span><a name="local-1627500586"><a href="#local-1627500586"><span class="hs-identifier">blocks</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Dataflow.html#sortBlocks"><span class="hs-identifier hs-var">sortBlocks</span></a><span> </span><a href="#local-1627500580"><span class="hs-identifier hs-var">direction</span></a><span> </span><a href="#local-1627500583"><span class="hs-identifier hs-var">entries</span></a><span> </span><a href="#local-1627500584"><span class="hs-identifier hs-var">blockmap</span></a><span>
</span><a name="line-567"></a><span>    </span><a name="local-1627500587"><a href="#local-1627500587"><span class="hs-identifier">n</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1627500586"><span class="hs-identifier hs-var">blocks</span></a><span>
</span><a name="line-568"></a><span>    </span><a name="local-1627500588"><a href="#local-1627500588"><span class="hs-identifier">block_arr</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-pragma">{-# SCC &quot;block_arr&quot; #-}</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Arr.html#listArray"><span class="hs-identifier hs-var">listArray</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><a href="#local-1627500587"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-1627500586"><span class="hs-identifier hs-var">blocks</span></a><span>
</span><a name="line-569"></a><span>    </span><a name="local-1627500589"><a href="#local-1627500589"><span class="hs-identifier">start</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-pragma">{-# SCC &quot;start&quot; #-}</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><a href="#local-1627500587"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">]</span><span>
</span><a name="line-570"></a><span>    </span><a name="local-1627500590"><a href="#local-1627500590"><span class="hs-identifier">dep_blocks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-pragma">{-# SCC &quot;dep_blocks&quot; #-}</span><span> </span><a href="Hoopl.Dataflow.html#mkDepBlocks"><span class="hs-identifier hs-var">mkDepBlocks</span></a><span> </span><a href="#local-1627500580"><span class="hs-identifier hs-var">direction</span></a><span> </span><a href="#local-1627500586"><span class="hs-identifier hs-var">blocks</span></a><span>
</span><a name="line-571"></a><span>
</span><a name="line-572"></a><span>    </span><span class="hs-identifier">loop</span><span>
</span><a name="line-573"></a><span>       </span><span class="hs-glyph">::</span><span> </span><a href="Hoopl.Dataflow.html#IntHeap"><span class="hs-identifier hs-type">IntHeap</span></a><span>
</span><a name="line-574"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500089"><span class="hs-identifier hs-type">f</span></a><span>  </span><span class="hs-comment">-- current factbase (increases monotonically)</span><span>
</span><a name="line-575"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-type">DBlock</span></a><span> </span><a href="#local-1627500089"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500088"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- transformed graph</span><span>
</span><a name="line-576"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSupply.html#UniqSM"><span class="hs-identifier hs-type">UniqSM</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500089"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-type">DBlock</span></a><span> </span><a href="#local-1627500089"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500088"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-577"></a><span>
</span><a name="line-578"></a><span>    </span><a name="local-1627500591"><a href="#local-1627500591"><span class="hs-identifier">loop</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-1627500592"><a href="#local-1627500592"><span class="hs-identifier">fbase</span></a></a><span> </span><a name="local-1627500593"><a href="#local-1627500593"><span class="hs-identifier">newblocks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627500592"><span class="hs-identifier hs-var">fbase</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500593"><span class="hs-identifier hs-var">newblocks</span></a><span class="hs-special">)</span><span>
</span><a name="line-579"></a><span>    </span><span class="hs-identifier">loop</span><span> </span><span class="hs-special">(</span><a name="local-1627500594"><a href="#local-1627500594"><span class="hs-identifier">ix</span></a></a><span class="hs-glyph">:</span><a name="local-1627500595"><a href="#local-1627500595"><span class="hs-identifier">todo</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627500596"><a href="#local-1627500596"><span class="hs-identifier">fbase</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-1627500597"><a href="#local-1627500597"><span class="hs-identifier">newblocks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-580"></a><span>           </span><span class="hs-keyword">let</span><span> </span><a name="local-1627500598"><a href="#local-1627500598"><span class="hs-identifier">blk</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500588"><span class="hs-identifier hs-var">block_arr</span></a><span> </span><span class="hs-glyph">!</span><span> </span><a href="#local-1627500594"><span class="hs-identifier hs-var">ix</span></a><span>
</span><a name="line-581"></a><span>
</span><a name="line-582"></a><span>           </span><span class="hs-comment">-- trace (&quot;analysing: &quot; ++ show (entryLabel blk)) $ return ()</span><span>
</span><a name="line-583"></a><span>           </span><span class="hs-special">(</span><a name="local-1627500599"><a href="#local-1627500599"><span class="hs-identifier">rg</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500600"><a href="#local-1627500600"><span class="hs-identifier">out_facts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627500582"><span class="hs-identifier hs-var">do_block</span></a><span> </span><a href="#local-1627500598"><span class="hs-identifier hs-var">blk</span></a><span> </span><a href="#local-1627500596"><span class="hs-identifier hs-var">fbase</span></a><span>
</span><a name="line-584"></a><span>           </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a name="local-1627500601"><a href="#local-1627500601"><span class="hs-identifier">todo'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500602"><a href="#local-1627500602"><span class="hs-identifier">fbase'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-585"></a><span>                  </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapFoldWithKey"><span class="hs-identifier hs-var">mapFoldWithKey</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#updateFact"><span class="hs-identifier hs-var">updateFact</span></a><span> </span><a href="#local-1627500581"><span class="hs-identifier hs-var">join</span></a><span> </span><a href="#local-1627500590"><span class="hs-identifier hs-var">dep_blocks</span></a><span class="hs-special">)</span><span>
</span><a name="line-586"></a><span>                                 </span><span class="hs-special">(</span><a href="#local-1627500595"><span class="hs-identifier hs-var">todo</span></a><span class="hs-special">,</span><a href="#local-1627500596"><span class="hs-identifier hs-var">fbase</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500600"><span class="hs-identifier hs-var">out_facts</span></a><span>
</span><a name="line-587"></a><span>
</span><a name="line-588"></a><span>           </span><span class="hs-comment">-- trace (&quot;fbase': &quot; ++ show (mapKeys fbase')) $ return ()</span><span>
</span><a name="line-589"></a><span>           </span><span class="hs-comment">-- trace (&quot;changed: &quot; ++ show changed) $ return ()</span><span>
</span><a name="line-590"></a><span>           </span><span class="hs-comment">-- trace (&quot;to analyse: &quot; ++ show to_analyse) $ return ()</span><span>
</span><a name="line-591"></a><span>
</span><a name="line-592"></a><span>           </span><span class="hs-keyword">let</span><span> </span><a name="local-1627500603"><a href="#local-1627500603"><span class="hs-identifier">newblocks'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627500599"><span class="hs-identifier hs-var">rg</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-593"></a><span>                              </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GMany"><span class="hs-identifier hs-var">GMany</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627500604"><a href="#local-1627500604"><span class="hs-identifier">blks</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapUnion"><span class="hs-identifier hs-var">mapUnion</span></a><span> </span><a href="#local-1627500604"><span class="hs-identifier hs-var">blks</span></a><span> </span><a href="#local-1627500597"><span class="hs-identifier hs-var">newblocks</span></a><span>
</span><a name="line-594"></a><span>
</span><a name="line-595"></a><span>           </span><a href="#local-1627500591"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-1627500601"><span class="hs-identifier hs-var">todo'</span></a><span> </span><a href="#local-1627500602"><span class="hs-identifier hs-var">fbase'</span></a><span> </span><a href="#local-1627500603"><span class="hs-identifier hs-var">newblocks'</span></a><span>
</span><a name="line-596"></a><span>
</span><a name="line-597"></a><span>
</span><a name="line-598"></a><span class="hs-comment">{-  Note [TxFactBase invariants]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The TxFactBase is used only during a fixpoint iteration (or &quot;sweep&quot;),
and accumulates facts (and the transformed code) during the fixpoint
iteration.

* tfb_fbase increases monotonically, across all sweeps

* At the beginning of each sweep
      tfb_cha  = NoChange
      tfb_lbls = {}

* During each sweep we process each block in turn.  Processing a block
  is done thus:
    1.  Read from tfb_fbase the facts for its entry label (forward)
        or successors labels (backward)
    2.  Transform those facts into new facts for its successors (forward)
        or entry label (backward)
    3.  Augment tfb_fbase with that info
  We call the labels read in step (1) the &quot;in-labels&quot; of the sweep

* The field tfb_lbls is the set of in-labels of all blocks that have
  been processed so far this sweep, including the block that is
  currently being processed.  tfb_lbls is initialised to {}.  It is a
  subset of the Labels of the *original* (not transformed) blocks.

* The tfb_cha field is set to SomeChange iff we decide we need to
  perform another iteration of the fixpoint loop. It is initialsed to NoChange.

  Specifically, we set tfb_cha to SomeChange in step (3) iff
    (a) The fact in tfb_fbase for a block L changes
    (b) L is in tfb_lbls
  Reason: until a label enters the in-labels its accumuated fact in tfb_fbase
  has not been read, hence cannot affect the outcome

Note [Unreachable blocks]
~~~~~~~~~~~~~~~~~~~~~~~~~
A block that is not in the domain of tfb_fbase is &quot;currently unreachable&quot;.
A currently-unreachable block is not even analyzed.  Reason: consider
constant prop and this graph, with entry point L1:
  L1: x:=3; goto L4
  L2: x:=4; goto L4
  L4: if x&gt;3 goto L2 else goto L5
Here L2 is actually unreachable, but if we process it with bottom input fact,
we'll propagate (x=4) to L4, and nuke the otherwise-good rewriting of L4.

* If a currently-unreachable block is not analyzed, then its rewritten
  graph will not be accumulated in tfb_rg.  And that is good:
  unreachable blocks simply do not appear in the output.

* Note that clients must be careful to provide a fact (even if bottom)
  for each entry point. Otherwise useful blocks may be garbage collected.

* Note that updateFact must set the change-flag if a label goes from
  not-in-fbase to in-fbase, even if its fact is bottom.  In effect the
  real fact lattice is
       UNR
       bottom
       the points above bottom

* Even if the fact is going from UNR to bottom, we still call the
  client's fact_join function because it might give the client
  some useful debugging information.

* All of this only applies for *forward* ixpoints.  For the backward
  case we must treat every block as reachable; it might finish with a
  'return', and therefore have no successors, for example.
-}</span><span>
</span><a name="line-666"></a><span>
</span><a name="line-667"></a><span>
</span><a name="line-668"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-669"></a><span class="hs-comment">--  Pieces that are shared by fixpoint and fixpoint_anal</span><span>
</span><a name="line-670"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-671"></a><span>
</span><a name="line-672"></a><span class="hs-comment">-- | Sort the blocks into the right order for analysis.</span><span>
</span><a name="line-673"></a><span class="hs-identifier">sortBlocks</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><a href="#local-1627500087"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Hoopl.Dataflow.html#Direction"><span class="hs-identifier hs-type">Direction</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500087"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">)</span><span>
</span><a name="line-674"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500087"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">]</span><span>
</span><a name="line-675"></a><a name="sortBlocks"><a href="Hoopl.Dataflow.html#sortBlocks"><span class="hs-identifier">sortBlocks</span></a></a><span> </span><a name="local-1627500607"><a href="#local-1627500607"><span class="hs-identifier">direction</span></a></a><span> </span><a name="local-1627500608"><a href="#local-1627500608"><span class="hs-identifier">entries</span></a></a><span> </span><a name="local-1627500609"><a href="#local-1627500609"><span class="hs-identifier">blockmap</span></a></a><span>
</span><a name="line-676"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627500607"><span class="hs-identifier hs-var">direction</span></a><span> </span><span class="hs-keyword">of</span><span> </span><a href="Hoopl.Dataflow.html#Fwd"><span class="hs-identifier hs-var">Fwd</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500610"><span class="hs-identifier hs-var">fwd</span></a><span>
</span><a name="line-677"></a><span>                       </span><a href="Hoopl.Dataflow.html#Bwd"><span class="hs-identifier hs-var">Bwd</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-1627500610"><span class="hs-identifier hs-var">fwd</span></a><span>
</span><a name="line-678"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-1627500610"><a href="#local-1627500610"><span class="hs-identifier">fwd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Dataflow.html#forwardBlockList"><span class="hs-identifier hs-var">forwardBlockList</span></a><span> </span><a href="#local-1627500608"><span class="hs-identifier hs-var">entries</span></a><span> </span><a href="#local-1627500609"><span class="hs-identifier hs-var">blockmap</span></a><span>
</span><a name="line-679"></a><span>
</span><a name="line-680"></a><span class="hs-comment">-- | construct a mapping from L -&gt; block indices.  If the fact for L</span><span>
</span><a name="line-681"></a><span class="hs-comment">-- changes, re-analyse the given blocks.</span><span>
</span><a name="line-682"></a><span class="hs-identifier">mkDepBlocks</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><a href="#local-1627500086"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Hoopl.Dataflow.html#Direction"><span class="hs-identifier hs-type">Direction</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500086"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-683"></a><a name="mkDepBlocks"><a href="Hoopl.Dataflow.html#mkDepBlocks"><span class="hs-identifier">mkDepBlocks</span></a></a><span> </span><a href="Hoopl.Dataflow.html#Fwd"><span class="hs-identifier hs-var">Fwd</span></a><span> </span><a name="local-1627500611"><a href="#local-1627500611"><span class="hs-identifier">blocks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500612"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627500611"><span class="hs-identifier hs-var">blocks</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapEmpty"><span class="hs-identifier hs-var">mapEmpty</span></a><span>
</span><a name="line-684"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-1627500612"><a href="#local-1627500612"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span>  </span><a name="local-1627500613"><a href="#local-1627500613"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500613"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-685"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a name="local-1627500614"><a href="#local-1627500614"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-1627500615"><a href="#local-1627500615"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-1627500616"><a href="#local-1627500616"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500617"><a href="#local-1627500617"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500612"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627500615"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627500616"><span class="hs-identifier hs-var">n</span></a><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapInsert"><span class="hs-identifier hs-var">mapInsert</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a><span> </span><a href="#local-1627500614"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-1627500616"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span> </span><a href="#local-1627500617"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-686"></a><span class="hs-identifier">mkDepBlocks</span><span> </span><a href="Hoopl.Dataflow.html#Bwd"><span class="hs-identifier hs-var">Bwd</span></a><span> </span><a name="local-1627500618"><a href="#local-1627500618"><span class="hs-identifier">blocks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500619"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627500618"><span class="hs-identifier hs-var">blocks</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapEmpty"><span class="hs-identifier hs-var">mapEmpty</span></a><span>
</span><a name="line-687"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-1627500619"><a href="#local-1627500619"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span> </span><a name="local-1627500620"><a href="#local-1627500620"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500620"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-688"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a name="local-1627500621"><a href="#local-1627500621"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-1627500622"><a href="#local-1627500622"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-1627500623"><a href="#local-1627500623"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500624"><a href="#local-1627500624"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500619"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1627500622"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627500623"><span class="hs-identifier hs-var">n</span></a><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a><span> </span><a href="#local-1627500625"><span class="hs-identifier hs-var">go'</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#successors"><span class="hs-identifier hs-var">successors</span></a><span> </span><a href="#local-1627500621"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500624"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-689"></a><span>            </span><span class="hs-keyword">where</span><span> </span><a name="local-1627500625"><a href="#local-1627500625"><span class="hs-identifier">go'</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-1627500626"><a href="#local-1627500626"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500626"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-690"></a><span>                  </span><span class="hs-identifier">go'</span><span> </span><span class="hs-special">(</span><a name="local-1627500627"><a href="#local-1627500627"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">:</span><a name="local-1627500628"><a href="#local-1627500628"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627500629"><a href="#local-1627500629"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500625"><span class="hs-identifier hs-var">go'</span></a><span> </span><a href="#local-1627500628"><span class="hs-identifier hs-var">ls</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapInsertWith"><span class="hs-identifier hs-var">mapInsertWith</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500627"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627500623"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span> </span><a href="#local-1627500629"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-691"></a><span>
</span><a name="line-692"></a><span>
</span><a name="line-693"></a><span class="hs-comment">-- | After some new facts have been generated by analysing a block, we</span><span>
</span><a name="line-694"></a><span class="hs-comment">-- fold this function over them to generate (a) a list of block</span><span>
</span><a name="line-695"></a><span class="hs-comment">-- indices to (re-)analyse, and (b) the new FactBase.</span><span>
</span><a name="line-696"></a><span class="hs-comment">--</span><span>
</span><a name="line-697"></a><span class="hs-identifier">updateFact</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#JoinFun"><span class="hs-identifier hs-type">JoinFun</span></a><span> </span><a href="#local-1627500085"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-698"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500085"><span class="hs-identifier hs-type">f</span></a><span>       </span><span class="hs-comment">-- out fact</span><span>
</span><a name="line-699"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#IntHeap"><span class="hs-identifier hs-type">IntHeap</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500085"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-700"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#IntHeap"><span class="hs-identifier hs-type">IntHeap</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500085"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-701"></a><span>
</span><a name="line-702"></a><a name="updateFact"><a href="Hoopl.Dataflow.html#updateFact"><span class="hs-identifier">updateFact</span></a></a><span> </span><a name="local-1627500630"><a href="#local-1627500630"><span class="hs-identifier">fact_join</span></a></a><span> </span><a name="local-1627500631"><a href="#local-1627500631"><span class="hs-identifier">dep_blocks</span></a></a><span> </span><a name="local-1627500632"><a href="#local-1627500632"><span class="hs-identifier">lbl</span></a></a><span> </span><a name="local-1627500633"><a href="#local-1627500633"><span class="hs-identifier">new_fact</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627500634"><a href="#local-1627500634"><span class="hs-identifier">todo</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627500635"><a href="#local-1627500635"><span class="hs-identifier">fbase</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-703"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#lookupFact"><span class="hs-identifier hs-var">lookupFact</span></a><span> </span><a href="#local-1627500632"><span class="hs-identifier hs-var">lbl</span></a><span> </span><a href="#local-1627500635"><span class="hs-identifier hs-var">fbase</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-704"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-1627500637"><a href="#local-1627500637"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapInsert"><span class="hs-identifier hs-var">mapInsert</span></a><span> </span><a href="#local-1627500632"><span class="hs-identifier hs-var">lbl</span></a><span> </span><a href="#local-1627500633"><span class="hs-identifier hs-var">new_fact</span></a><span> </span><a href="#local-1627500635"><span class="hs-identifier hs-var">fbase</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-1627500636"><span class="hs-identifier hs-var">changed</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500637"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-705"></a><span>                           </span><span class="hs-comment">-- Note [no old fact]</span><span>
</span><a name="line-706"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1627500638"><a href="#local-1627500638"><span class="hs-identifier">old_fact</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-707"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-1627500630"><span class="hs-identifier hs-var">fact_join</span></a><span> </span><a href="#local-1627500632"><span class="hs-identifier hs-var">lbl</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-var">OldFact</span></a><span> </span><a href="#local-1627500638"><span class="hs-identifier hs-var">old_fact</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-var">NewFact</span></a><span> </span><a href="#local-1627500633"><span class="hs-identifier hs-var">new_fact</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-708"></a><span>          </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#NoChange"><span class="hs-identifier hs-var">NoChange</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627500634"><span class="hs-identifier hs-var">todo</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500635"><span class="hs-identifier hs-var">fbase</span></a><span class="hs-special">)</span><span>
</span><a name="line-709"></a><span>          </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span>        </span><a name="local-1627500639"><a href="#local-1627500639"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-1627500640"><a href="#local-1627500640"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapInsert"><span class="hs-identifier hs-var">mapInsert</span></a><span> </span><a href="#local-1627500632"><span class="hs-identifier hs-var">lbl</span></a><span> </span><a href="#local-1627500639"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627500635"><span class="hs-identifier hs-var">fbase</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-1627500636"><span class="hs-identifier hs-var">changed</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500640"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-710"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-711"></a><span>     </span><a name="local-1627500636"><a href="#local-1627500636"><span class="hs-identifier">changed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="Hoopl.Dataflow.html#insertIntHeap"><span class="hs-identifier hs-var">insertIntHeap</span></a><span> </span><a href="#local-1627500634"><span class="hs-identifier hs-var">todo</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-712"></a><span>                 </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapFindWithDefault"><span class="hs-identifier hs-var">mapFindWithDefault</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-1627500632"><span class="hs-identifier hs-var">lbl</span></a><span> </span><a href="#local-1627500631"><span class="hs-identifier hs-var">dep_blocks</span></a><span>
</span><a name="line-713"></a><span>
</span><a name="line-714"></a><span class="hs-comment">{-
Note [no old fact]

We know that the new_fact is &gt;= _|_, so we don't need to join.  However,
if the new fact is also _|_, and we have already analysed its block,
we don't need to record a change.  So there's a tradeoff here.  It turns
out that always recording a change is faster.
-}</span><span>
</span><a name="line-722"></a><span>
</span><a name="line-723"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-724"></a><span class="hs-comment">--      DG: an internal data type for 'decorated graphs'</span><span>
</span><a name="line-725"></a><span class="hs-comment">--          TOTALLY internal to Hoopl; each block is decorated with a fact</span><span>
</span><a name="line-726"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-727"></a><span>
</span><a name="line-728"></a><span class="hs-keyword">type</span><span> </span><a name="DG"><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier">DG</span></a></a><span> </span><a name="local-1627500069"><a href="#local-1627500069"><span class="hs-identifier">f</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph%27"><span class="hs-identifier hs-type">Graph'</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-type">DBlock</span></a><span> </span><a href="#local-1627500069"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-729"></a><span class="hs-keyword">data</span><span> </span><a name="DBlock"><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier">DBlock</span></a></a><span> </span><a name="local-1627500065"><a href="#local-1627500065"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627500066"><a href="#local-1627500066"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500067"><a href="#local-1627500067"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500068"><a href="#local-1627500068"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="DBlock"><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier">DBlock</span></a></a><span> </span><a href="#local-1627500065"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500066"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500067"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500068"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ block decorated with fact</span><span>
</span><a name="line-730"></a><span>
</span><a name="line-731"></a><span class="hs-keyword">instance</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><a href="#local-1627500731"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-type">DBlock</span></a><span> </span><a href="#local-1627500732"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500731"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-732"></a><span>  </span><a name="local-1912611951"><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#entryLabel"><span class="hs-identifier">entryLabel</span></a></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-var">DBlock</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627500733"><a href="#local-1627500733"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a><span> </span><a href="#local-1627500733"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-733"></a><span>  </span><a name="local-1912611950"><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#successors"><span class="hs-identifier">successors</span></a></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-var">DBlock</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627500734"><a href="#local-1627500734"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#successors"><span class="hs-identifier hs-var">successors</span></a><span> </span><a href="#local-1627500734"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-734"></a><span>
</span><a name="line-735"></a><span class="hs-comment">--- constructors</span><span>
</span><a name="line-736"></a><span>
</span><a name="line-737"></a><span class="hs-identifier">dgnil</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500083"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500084"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span>
</span><a name="line-738"></a><span class="hs-identifier">dgnilC</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500081"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500082"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span>
</span><a name="line-739"></a><span class="hs-identifier">dgSplice</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><a href="#local-1627500076"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500077"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500076"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500078"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500079"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500077"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500076"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500079"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627500080"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500077"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500076"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500078"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500080"><span class="hs-identifier hs-type">x</span></a><span>
</span><a name="line-740"></a><span>
</span><a name="line-741"></a><span class="hs-comment">---- observers</span><span>
</span><a name="line-742"></a><span>
</span><a name="line-743"></a><span class="hs-identifier">normalizeGraph</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500072"><a href="#local-1627500072"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500073"><a href="#local-1627500073"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627500074"><a href="#local-1627500074"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500075"><a href="#local-1627500075"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span>
</span><a name="line-744"></a><span>                  </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><a href="#local-1627500072"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500073"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500072"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500074"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500075"><span class="hs-identifier hs-type">x</span></a><span>
</span><a name="line-745"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500072"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500074"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500075"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500073"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-746"></a><span>                 </span><span class="hs-comment">-- A Graph together with the facts for that graph</span><span>
</span><a name="line-747"></a><span>                 </span><span class="hs-comment">-- The domains of the two maps should be identical</span><span>
</span><a name="line-748"></a><span>
</span><a name="line-749"></a><a name="normalizeGraph"><a href="Hoopl.Dataflow.html#normalizeGraph"><span class="hs-identifier">normalizeGraph</span></a></a><span> </span><a name="local-1627500641"><a href="#local-1627500641"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#mapGraphBlocks"><span class="hs-identifier hs-var">mapGraphBlocks</span></a><span> </span><a href="#local-1627500642"><span class="hs-identifier hs-var">dropFact</span></a><span> </span><a href="#local-1627500641"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627500643"><span class="hs-identifier hs-var">facts</span></a><span> </span><a href="#local-1627500641"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-750"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">dropFact</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-type">DBlock</span></a><span> </span><a href="#local-1627500646"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-1627500647"><span class="hs-identifier hs-type">t1</span></a><span> </span><a href="#local-1627500648"><span class="hs-identifier hs-type">t2</span></a><span> </span><a href="#local-1627500649"><span class="hs-identifier hs-type">t3</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span> </span><a href="#local-1627500647"><span class="hs-identifier hs-type">t1</span></a><span> </span><a href="#local-1627500648"><span class="hs-identifier hs-type">t2</span></a><span> </span><a href="#local-1627500649"><span class="hs-identifier hs-type">t3</span></a><span>
</span><a name="line-751"></a><span>          </span><a name="local-1627500642"><a href="#local-1627500642"><span class="hs-identifier">dropFact</span></a></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-var">DBlock</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627500650"><a href="#local-1627500650"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500650"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-752"></a><span>          </span><span class="hs-identifier">facts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500073"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500072"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500074"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500075"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500073"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-753"></a><span>          </span><a name="local-1627500643"><a href="#local-1627500643"><span class="hs-identifier">facts</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GNil"><span class="hs-identifier hs-var">GNil</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#noFacts"><span class="hs-identifier hs-var">noFacts</span></a><span>
</span><a name="line-754"></a><span>          </span><span class="hs-identifier">facts</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GUnit"><span class="hs-identifier hs-var">GUnit</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#noFacts"><span class="hs-identifier hs-var">noFacts</span></a><span>
</span><a name="line-755"></a><span>          </span><span class="hs-identifier">facts</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GMany"><span class="hs-identifier hs-var">GMany</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627500651"><a href="#local-1627500651"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-1627500652"><a href="#local-1627500652"><span class="hs-identifier">exit</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500645"><span class="hs-identifier hs-var">bodyFacts</span></a><span> </span><a href="#local-1627500651"><span class="hs-identifier hs-var">body</span></a><span> </span><span class="hs-special">`</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapUnion"><span class="hs-identifier hs-var">mapUnion</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500644"><span class="hs-identifier hs-var">exitFacts</span></a><span> </span><a href="#local-1627500652"><span class="hs-identifier hs-var">exit</span></a><span>
</span><a name="line-756"></a><span>          </span><span class="hs-identifier">exitFacts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeO"><span class="hs-identifier hs-type">MaybeO</span></a><span> </span><a href="#local-1627500075"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-type">DBlock</span></a><span> </span><a href="#local-1627500073"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500072"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500073"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-757"></a><span>          </span><a name="local-1627500644"><a href="#local-1627500644"><span class="hs-identifier">exitFacts</span></a></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#noFacts"><span class="hs-identifier hs-var">noFacts</span></a><span>
</span><a name="line-758"></a><span>          </span><span class="hs-identifier">exitFacts</span><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustO"><span class="hs-identifier hs-var">JustO</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-var">DBlock</span></a><span> </span><a name="local-1627500653"><a href="#local-1627500653"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627500654"><a href="#local-1627500654"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapSingleton"><span class="hs-identifier hs-var">mapSingleton</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a><span> </span><a href="#local-1627500654"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500653"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-759"></a><span>          </span><span class="hs-identifier">bodyFacts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-type">DBlock</span></a><span> </span><a href="#local-1627500073"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500072"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500073"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-760"></a><span>          </span><a name="local-1627500645"><a href="#local-1627500645"><span class="hs-identifier">bodyFacts</span></a></a><span> </span><a name="local-1627500655"><a href="#local-1627500655"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapFoldWithKey"><span class="hs-identifier hs-var">mapFoldWithKey</span></a><span> </span><a href="#local-1627500656"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#noFacts"><span class="hs-identifier hs-var">noFacts</span></a><span> </span><a href="#local-1627500655"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-761"></a><span>            </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627500657"><a href="#local-1627500657"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-1627500658"><a href="#local-1627500658"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627500659"><a href="#local-1627500659"><span class="hs-identifier">x</span></a></a><span class="hs-operator">.</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-type">DBlock</span></a><span> </span><a href="#local-1627500658"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1627500657"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-1627500659"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a><span> </span><a href="#local-1627500658"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#LabelMap"><span class="hs-identifier hs-type">LabelMap</span></a><span> </span><a href="#local-1627500658"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-762"></a><span>                  </span><a name="local-1627500656"><a href="#local-1627500656"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627500660"><a href="#local-1627500660"><span class="hs-identifier">lbl</span></a></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-var">DBlock</span></a><span> </span><a name="local-1627500661"><a href="#local-1627500661"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-1627500662"><a href="#local-1627500662"><span class="hs-identifier">fb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapInsert"><span class="hs-identifier hs-var">mapInsert</span></a><span> </span><a href="#local-1627500660"><span class="hs-identifier hs-var">lbl</span></a><span> </span><a href="#local-1627500661"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627500662"><span class="hs-identifier hs-var">fb</span></a><span>
</span><a name="line-763"></a><span>
</span><a name="line-764"></a><span class="hs-comment">--- implementation of the constructors (boring)</span><span>
</span><a name="line-765"></a><span>
</span><a name="line-766"></a><a name="dgnil"><a href="Hoopl.Dataflow.html#dgnil"><span class="hs-identifier">dgnil</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GNil"><span class="hs-identifier hs-var">GNil</span></a><span>
</span><a name="line-767"></a><a name="dgnilC"><a href="Hoopl.Dataflow.html#dgnilC"><span class="hs-identifier">dgnilC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#GMany"><span class="hs-identifier hs-var">GMany</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#emptyBody"><span class="hs-identifier hs-var">emptyBody</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingO"><span class="hs-identifier hs-var">NothingO</span></a><span>
</span><a name="line-768"></a><span>
</span><a name="line-769"></a><a name="dgSplice"><a href="Hoopl.Dataflow.html#dgSplice"><span class="hs-identifier">dgSplice</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#splice"><span class="hs-identifier hs-var">splice</span></a><span> </span><a href="#local-1627500663"><span class="hs-identifier hs-var">fzCat</span></a><span>
</span><a name="line-770"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">fzCat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-type">DBlock</span></a><span> </span><a href="#local-1627500664"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500665"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500666"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-type">DBlock</span></a><span> </span><a href="#local-1627500667"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-1627500665"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="#local-1627500668"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-type">DBlock</span></a><span> </span><a href="#local-1627500664"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500665"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500666"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500668"><span class="hs-identifier hs-type">x</span></a><span>
</span><a name="line-771"></a><span>        </span><a name="local-1627500663"><a href="#local-1627500663"><span class="hs-identifier">fzCat</span></a></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-var">DBlock</span></a><span> </span><a name="local-1627500669"><a href="#local-1627500669"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627500670"><a href="#local-1627500670"><span class="hs-identifier">b1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-var">DBlock</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627500671"><a href="#local-1627500671"><span class="hs-identifier">b2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-var">DBlock</span></a><span> </span><a href="#local-1627500669"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a><span> </span><a href="#local-1627500670"><span class="hs-identifier hs-var">b1</span></a><span> </span><span class="hs-special">`</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#blockAppend"><span class="hs-identifier hs-var">blockAppend</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627500671"><span class="hs-identifier hs-var">b2</span></a><span>
</span><a name="line-772"></a><span>        </span><span class="hs-comment">-- NB. strictness, this function is hammered.</span><span>
</span><a name="line-773"></a><span>
</span><a name="line-774"></a><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><a name="line-775"></a><span class="hs-comment">--       Utilities</span><span>
</span><a name="line-776"></a><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><a name="line-777"></a><span>
</span><a name="line-778"></a><span class="hs-comment">-- Lifting based on shape:</span><span>
</span><a name="line-779"></a><span class="hs-comment">--  - from nodes to blocks</span><span>
</span><a name="line-780"></a><span class="hs-comment">--  - from facts to fact-like things</span><span>
</span><a name="line-781"></a><span class="hs-comment">-- Lowering back:</span><span>
</span><a name="line-782"></a><span class="hs-comment">--  - from fact-like things to facts</span><span>
</span><a name="line-783"></a><span class="hs-comment">-- Note that the latter two functions depend only on the entry shape.</span><span>
</span><a name="line-784"></a><span class="hs-keyword">class</span><span> </span><a name="ShapeLifter"><a href="Hoopl.Dataflow.html#ShapeLifter"><span class="hs-identifier">ShapeLifter</span></a></a><span> </span><a name="local-1627500046"><a href="#local-1627500046"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-1627500047"><a href="#local-1627500047"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-785"></a><span> </span><span class="hs-identifier">singletonDG</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="#local-1627500048"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500049"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500046"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500047"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hoopl.Dataflow.html#DG"><span class="hs-identifier hs-type">DG</span></a><span> </span><a href="#local-1627500048"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627500049"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500046"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500047"><span class="hs-identifier hs-type">x</span></a><span>
</span><a name="line-786"></a><span> </span><span class="hs-identifier">fwdEntryFact</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><a href="#local-1627500050"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627500050"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500046"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500047"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500051"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500046"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500051"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-787"></a><span> </span><span class="hs-identifier">fwdEntryLabel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><a href="#local-1627500052"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627500052"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500046"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500047"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#MaybeC"><span class="hs-identifier hs-type">MaybeC</span></a><span> </span><a href="#local-1627500046"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">]</span><span>
</span><a name="line-788"></a><span> </span><span class="hs-identifier">ftransfer</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdTransfer"><span class="hs-identifier hs-type">FwdTransfer</span></a><span> </span><a href="#local-1627500053"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500054"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500053"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500046"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500047"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500054"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500047"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500054"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-789"></a><span> </span><span class="hs-identifier">frewrite</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="#local-1627500055"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-1627500056"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500057"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500056"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500046"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500047"><span class="hs-identifier hs-type">x</span></a><span>
</span><a name="line-790"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500057"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500055"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500056"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500046"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500047"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite"><span class="hs-identifier hs-type">FwdRewrite</span></a><span> </span><a href="#local-1627500055"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-1627500056"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500057"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-791"></a><span class="hs-comment">-- @ end node.tex</span><span>
</span><a name="line-792"></a><span> </span><span class="hs-identifier">bwdEntryFact</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#NonLocal"><span class="hs-identifier hs-type">NonLocal</span></a><span> </span><a href="#local-1627500058"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#DataflowLattice"><span class="hs-identifier hs-type">DataflowLattice</span></a><span> </span><a href="#local-1627500059"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500058"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500046"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500047"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500046"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500059"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500059"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-793"></a><span> </span><span class="hs-identifier">btransfer</span><span>    </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdTransfer"><span class="hs-identifier hs-type">BwdTransfer</span></a><span> </span><a href="#local-1627500060"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500061"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500060"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500046"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500047"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500047"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500061"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500061"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-794"></a><span> </span><span class="hs-identifier">brewrite</span><span>     </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="#local-1627500062"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-1627500063"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500064"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500063"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500046"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500047"><span class="hs-identifier hs-type">x</span></a><span>
</span><a name="line-795"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#Fact"><span class="hs-identifier hs-type">Fact</span></a><span> </span><a href="#local-1627500047"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-1627500064"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500062"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="#local-1627500063"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500046"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-1627500047"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite"><span class="hs-identifier hs-type">BwdRewrite</span></a><span> </span><a href="#local-1627500062"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-1627500063"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-1627500064"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-796"></a><span>
</span><a name="line-797"></a><span class="hs-keyword">instance</span><span> </span><a href="Hoopl.Dataflow.html#ShapeLifter"><span class="hs-identifier hs-type">ShapeLifter</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-798"></a><span>  </span><a name="local-1912712516"><a href="Hoopl.Dataflow.html#singletonDG"><span class="hs-identifier">singletonDG</span></a></a><span> </span><a name="local-1627500711"><a href="#local-1627500711"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627500712"><a href="#local-1627500712"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#gUnitCO"><span class="hs-identifier hs-var">gUnitCO</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-var">DBlock</span></a><span> </span><a href="#local-1627500711"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BlockCO"><span class="hs-identifier hs-var">BlockCO</span></a><span> </span><a href="#local-1627500712"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BNil"><span class="hs-identifier hs-var">BNil</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-799"></a><span>  </span><a name="local-1912712517"><a href="Hoopl.Dataflow.html#fwdEntryFact"><span class="hs-identifier">fwdEntryFact</span></a></a><span>     </span><a name="local-1627500713"><a href="#local-1627500713"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500714"><a href="#local-1627500714"><span class="hs-identifier">f</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Collections.html#mapSingleton"><span class="hs-identifier hs-var">mapSingleton</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a><span> </span><a href="#local-1627500713"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500714"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-800"></a><span>  </span><a name="local-1912712521"><a href="Hoopl.Dataflow.html#bwdEntryFact"><span class="hs-identifier">bwdEntryFact</span></a></a><span> </span><a name="local-1627500715"><a href="#local-1627500715"><span class="hs-identifier">lat</span></a></a><span> </span><a name="local-1627500716"><a href="#local-1627500716"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500717"><a href="#local-1627500717"><span class="hs-identifier">fb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Hoopl.Dataflow.html#getFact"><span class="hs-identifier hs-var">getFact</span></a><span> </span><a href="#local-1627500715"><span class="hs-identifier hs-var">lat</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a><span> </span><a href="#local-1627500716"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627500717"><span class="hs-identifier hs-var">fb</span></a><span>
</span><a name="line-801"></a><span>  </span><a name="local-1912712519"><a href="Hoopl.Dataflow.html#ftransfer"><span class="hs-identifier">ftransfer</span></a></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdTransfer3"><span class="hs-identifier hs-var">FwdTransfer3</span></a><span> </span><span class="hs-special">(</span><a name="local-1627500718"><a href="#local-1627500718"><span class="hs-identifier">ft</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-1627500719"><a href="#local-1627500719"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500720"><a href="#local-1627500720"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500718"><span class="hs-identifier hs-var">ft</span></a><span> </span><a href="#local-1627500719"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500720"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-802"></a><span>  </span><a name="local-1912712522"><a href="Hoopl.Dataflow.html#btransfer"><span class="hs-identifier">btransfer</span></a></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdTransfer3"><span class="hs-identifier hs-var">BwdTransfer3</span></a><span> </span><span class="hs-special">(</span><a name="local-1627500721"><a href="#local-1627500721"><span class="hs-identifier">bt</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-1627500722"><a href="#local-1627500722"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500723"><a href="#local-1627500723"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500721"><span class="hs-identifier hs-var">bt</span></a><span> </span><a href="#local-1627500722"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500723"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-803"></a><span>  </span><a name="local-1912712520"><a href="Hoopl.Dataflow.html#frewrite"><span class="hs-identifier">frewrite</span></a></a><span>  </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite3"><span class="hs-identifier hs-var">FwdRewrite3</span></a><span>  </span><span class="hs-special">(</span><a name="local-1627500724"><a href="#local-1627500724"><span class="hs-identifier">fr</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-1627500725"><a href="#local-1627500725"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500726"><a href="#local-1627500726"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500724"><span class="hs-identifier hs-var">fr</span></a><span> </span><a href="#local-1627500725"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500726"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-804"></a><span>  </span><a name="local-1912712523"><a href="Hoopl.Dataflow.html#brewrite"><span class="hs-identifier">brewrite</span></a></a><span>  </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite3"><span class="hs-identifier hs-var">BwdRewrite3</span></a><span>  </span><span class="hs-special">(</span><a name="local-1627500727"><a href="#local-1627500727"><span class="hs-identifier">br</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-1627500728"><a href="#local-1627500728"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500729"><a href="#local-1627500729"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500727"><span class="hs-identifier hs-var">br</span></a><span> </span><a href="#local-1627500728"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500729"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-805"></a><span>  </span><a name="local-1912712518"><a href="Hoopl.Dataflow.html#fwdEntryLabel"><span class="hs-identifier">fwdEntryLabel</span></a></a><span> </span><a name="local-1627500730"><a href="#local-1627500730"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#JustC"><span class="hs-identifier hs-var">JustC</span></a><span> </span><span class="hs-special">[</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#entryLabel"><span class="hs-identifier hs-var">entryLabel</span></a><span> </span><a href="#local-1627500730"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-806"></a><span>
</span><a name="line-807"></a><span class="hs-keyword">instance</span><span> </span><a href="Hoopl.Dataflow.html#ShapeLifter"><span class="hs-identifier hs-type">ShapeLifter</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-808"></a><span>  </span><a name="local-1912712516"><a href="Hoopl.Dataflow.html#singletonDG"><span class="hs-identifier">singletonDG</span></a></a><span> </span><a name="local-1627500696"><a href="#local-1627500696"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#gUnitOO"><span class="hs-identifier hs-var">gUnitOO</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-var">DBlock</span></a><span> </span><a href="#local-1627500696"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BMiddle"><span class="hs-identifier hs-var">BMiddle</span></a><span>
</span><a name="line-809"></a><span>  </span><a name="local-1912712517"><a href="Hoopl.Dataflow.html#fwdEntryFact"><span class="hs-identifier">fwdEntryFact</span></a></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-1627500697"><a href="#local-1627500697"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500697"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-810"></a><span>  </span><a name="local-1912712521"><a href="Hoopl.Dataflow.html#bwdEntryFact"><span class="hs-identifier">bwdEntryFact</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627500698"><a href="#local-1627500698"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500698"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-811"></a><span>  </span><a name="local-1912712519"><a href="Hoopl.Dataflow.html#ftransfer"><span class="hs-identifier">ftransfer</span></a></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdTransfer3"><span class="hs-identifier hs-var">FwdTransfer3</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627500699"><a href="#local-1627500699"><span class="hs-identifier">ft</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-1627500700"><a href="#local-1627500700"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500701"><a href="#local-1627500701"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500699"><span class="hs-identifier hs-var">ft</span></a><span> </span><a href="#local-1627500700"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500701"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-812"></a><span>  </span><a name="local-1912712522"><a href="Hoopl.Dataflow.html#btransfer"><span class="hs-identifier">btransfer</span></a></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdTransfer3"><span class="hs-identifier hs-var">BwdTransfer3</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627500702"><a href="#local-1627500702"><span class="hs-identifier">bt</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-1627500703"><a href="#local-1627500703"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500704"><a href="#local-1627500704"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500702"><span class="hs-identifier hs-var">bt</span></a><span> </span><a href="#local-1627500703"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500704"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-813"></a><span>  </span><a name="local-1912712520"><a href="Hoopl.Dataflow.html#frewrite"><span class="hs-identifier">frewrite</span></a></a><span>  </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite3"><span class="hs-identifier hs-var">FwdRewrite3</span></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627500705"><a href="#local-1627500705"><span class="hs-identifier">fr</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-1627500706"><a href="#local-1627500706"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500707"><a href="#local-1627500707"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500705"><span class="hs-identifier hs-var">fr</span></a><span> </span><a href="#local-1627500706"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500707"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-814"></a><span>  </span><a name="local-1912712523"><a href="Hoopl.Dataflow.html#brewrite"><span class="hs-identifier">brewrite</span></a></a><span>  </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite3"><span class="hs-identifier hs-var">BwdRewrite3</span></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627500708"><a href="#local-1627500708"><span class="hs-identifier">br</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-1627500709"><a href="#local-1627500709"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500710"><a href="#local-1627500710"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500708"><span class="hs-identifier hs-var">br</span></a><span> </span><a href="#local-1627500709"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500710"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-815"></a><span>  </span><a name="local-1912712518"><a href="Hoopl.Dataflow.html#fwdEntryLabel"><span class="hs-identifier">fwdEntryLabel</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingC"><span class="hs-identifier hs-var">NothingC</span></a><span>
</span><a name="line-816"></a><span>
</span><a name="line-817"></a><span class="hs-keyword">instance</span><span> </span><a href="Hoopl.Dataflow.html#ShapeLifter"><span class="hs-identifier hs-type">ShapeLifter</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-818"></a><span>  </span><a name="local-1912712516"><a href="Hoopl.Dataflow.html#singletonDG"><span class="hs-identifier">singletonDG</span></a></a><span> </span><a name="local-1627500680"><a href="#local-1627500680"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627500681"><a href="#local-1627500681"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Graph.html#gUnitOC"><span class="hs-identifier hs-var">gUnitOC</span></a><span> </span><span class="hs-special">(</span><a href="Hoopl.Dataflow.html#DBlock"><span class="hs-identifier hs-var">DBlock</span></a><span> </span><a href="#local-1627500680"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BlockOC"><span class="hs-identifier hs-var">BlockOC</span></a><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#BNil"><span class="hs-identifier hs-var">BNil</span></a><span> </span><a href="#local-1627500681"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-819"></a><span>  </span><a name="local-1912712517"><a href="Hoopl.Dataflow.html#fwdEntryFact"><span class="hs-identifier">fwdEntryFact</span></a></a><span>   </span><span class="hs-identifier">_</span><span> </span><a name="local-1627500682"><a href="#local-1627500682"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500682"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-820"></a><span>  </span><a name="local-1912712521"><a href="Hoopl.Dataflow.html#bwdEntryFact"><span class="hs-identifier">bwdEntryFact</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1627500683"><a href="#local-1627500683"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500683"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-821"></a><span>  </span><a name="local-1912712519"><a href="Hoopl.Dataflow.html#ftransfer"><span class="hs-identifier">ftransfer</span></a></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdTransfer3"><span class="hs-identifier hs-var">FwdTransfer3</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627500684"><a href="#local-1627500684"><span class="hs-identifier">ft</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-1627500685"><a href="#local-1627500685"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500686"><a href="#local-1627500686"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500684"><span class="hs-identifier hs-var">ft</span></a><span> </span><a href="#local-1627500685"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500686"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-822"></a><span>  </span><a name="local-1912712522"><a href="Hoopl.Dataflow.html#btransfer"><span class="hs-identifier">btransfer</span></a></a><span> </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdTransfer3"><span class="hs-identifier hs-var">BwdTransfer3</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627500687"><a href="#local-1627500687"><span class="hs-identifier">bt</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-1627500688"><a href="#local-1627500688"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500689"><a href="#local-1627500689"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500687"><span class="hs-identifier hs-var">bt</span></a><span> </span><a href="#local-1627500688"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500689"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-823"></a><span>  </span><a name="local-1912712520"><a href="Hoopl.Dataflow.html#frewrite"><span class="hs-identifier">frewrite</span></a></a><span>  </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#FwdRewrite3"><span class="hs-identifier hs-var">FwdRewrite3</span></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627500690"><a href="#local-1627500690"><span class="hs-identifier">fr</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-1627500691"><a href="#local-1627500691"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500692"><a href="#local-1627500692"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500690"><span class="hs-identifier hs-var">fr</span></a><span> </span><a href="#local-1627500691"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500692"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-824"></a><span>  </span><a name="local-1912712523"><a href="Hoopl.Dataflow.html#brewrite"><span class="hs-identifier">brewrite</span></a></a><span>  </span><span class="hs-special">(</span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#BwdRewrite3"><span class="hs-identifier hs-var">BwdRewrite3</span></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627500693"><a href="#local-1627500693"><span class="hs-identifier">br</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-1627500694"><a href="#local-1627500694"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1627500695"><a href="#local-1627500695"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500693"><span class="hs-identifier hs-var">br</span></a><span> </span><a href="#local-1627500694"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-1627500695"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-825"></a><span>  </span><a name="local-1912712518"><a href="Hoopl.Dataflow.html#fwdEntryLabel"><span class="hs-identifier">fwdEntryLabel</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Block.html#NothingC"><span class="hs-identifier hs-var">NothingC</span></a><span>
</span><a name="line-826"></a><span>
</span><a name="line-827"></a><span class="hs-comment">{-
class ShapeLifter e x where
  singletonDG   :: f -&gt; n e x -&gt; DG f n e x

instance ShapeLifter C O where
  singletonDG f n = gUnitCO (DBlock f (BlockCO n BNil))

instance ShapeLifter O O where
  singletonDG f = gUnitOO . DBlock f . BMiddle

instance ShapeLifter O C where
  singletonDG f n = gUnitOC (DBlock f (BlockOC BNil n))
-}</span><span>
</span><a name="line-840"></a><span>
</span><a name="line-841"></a><span class="hs-comment">-- Fact lookup: the fact `orelse` bottom</span><span>
</span><a name="line-842"></a><span class="hs-identifier">getFact</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Dataflow.html#DataflowLattice"><span class="hs-identifier hs-type">DataflowLattice</span></a><span> </span><a href="#local-1627500071"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#FactBase"><span class="hs-identifier hs-type">FactBase</span></a><span> </span><a href="#local-1627500071"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500071"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-843"></a><a name="getFact"><a href="Hoopl.Dataflow.html#getFact"><span class="hs-identifier">getFact</span></a></a><span> </span><a name="local-1627500672"><a href="#local-1627500672"><span class="hs-identifier">lat</span></a></a><span> </span><a name="local-1627500673"><a href="#local-1627500673"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1627500674"><a href="#local-1627500674"><span class="hs-identifier">fb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="../hoopl-3.10.2.1/src/%{MODULE/./-}.html#%{NAME}/Compiler.Hoopl.Label.html#lookupFact"><span class="hs-identifier hs-var">lookupFact</span></a><span> </span><a href="#local-1627500673"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1627500674"><span class="hs-identifier hs-var">fb</span></a><span> </span><span class="hs-keyword">of</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span>  </span><a name="local-1627500675"><a href="#local-1627500675"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627500675"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-844"></a><span>                                           </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">fact_bot</span><span> </span><a href="#local-1627500672"><span class="hs-identifier hs-var">lat</span></a><span>
</span><a name="line-845"></a><span>
</span><a name="line-846"></a><span>
</span><a name="line-847"></a><span>
</span><a name="line-848"></a><span class="hs-comment">{-  Note [Respects fuel]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
-}</span><span>
</span><a name="line-851"></a><span class="hs-comment">-- $fuel</span><span>
</span><a name="line-852"></a><span class="hs-comment">-- A value of type 'FwdRewrite' or 'BwdRewrite' /respects fuel/ if</span><span>
</span><a name="line-853"></a><span class="hs-comment">-- any function contained within the value satisfies the following properties:</span><span>
</span><a name="line-854"></a><span class="hs-comment">--</span><span>
</span><a name="line-855"></a><span class="hs-comment">--   * When fuel is exhausted, it always returns 'Nothing'.</span><span>
</span><a name="line-856"></a><span class="hs-comment">--</span><span>
</span><a name="line-857"></a><span class="hs-comment">--   * When it returns @Just g rw@, it consumes /exactly/ one unit</span><span>
</span><a name="line-858"></a><span class="hs-comment">--     of fuel, and new rewrite 'rw' also respects fuel.</span><span>
</span><a name="line-859"></a><span class="hs-comment">--</span><span>
</span><a name="line-860"></a><span class="hs-comment">-- Provided that functions passed to 'mkFRewrite', 'mkFRewrite3',</span><span>
</span><a name="line-861"></a><span class="hs-comment">-- 'mkBRewrite', and 'mkBRewrite3' are not aware of the fuel supply,</span><span>
</span><a name="line-862"></a><span class="hs-comment">-- the results respect fuel.</span><span>
</span><a name="line-863"></a><span class="hs-comment">--</span><span>
</span><a name="line-864"></a><span class="hs-comment">-- It is an /unchecked/ run-time error for the argument passed to 'wrapFR',</span><span>
</span><a name="line-865"></a><span class="hs-comment">-- 'wrapFR2', 'wrapBR', or 'warpBR2' to return a function that does not respect fuel.</span><span>
</span><a name="line-866"></a><span>
</span><a name="line-867"></a><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><a name="line-868"></a><span class="hs-comment">-- a Heap of Int</span><span>
</span><a name="line-869"></a><span>
</span><a name="line-870"></a><span class="hs-comment">-- We should really use a proper Heap here, but my attempts to make</span><span>
</span><a name="line-871"></a><span class="hs-comment">-- one have not succeeded in beating the simple ordered list.  Another</span><span>
</span><a name="line-872"></a><span class="hs-comment">-- alternative is IntSet (using deleteFindMin), but that was also</span><span>
</span><a name="line-873"></a><span class="hs-comment">-- slower than the ordered list in my experiments --SDM 25/1/2012</span><span>
</span><a name="line-874"></a><span>
</span><a name="line-875"></a><span class="hs-keyword">type</span><span> </span><a name="IntHeap"><a href="Hoopl.Dataflow.html#IntHeap"><span class="hs-identifier">IntHeap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ordered</span><span>
</span><a name="line-876"></a><span>
</span><a name="line-877"></a><span class="hs-identifier">insertIntHeap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-878"></a><a name="insertIntHeap"><a href="Hoopl.Dataflow.html#insertIntHeap"><span class="hs-identifier">insertIntHeap</span></a></a><span> </span><a name="local-1627500676"><a href="#local-1627500676"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1627500676"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-879"></a><span class="hs-identifier">insertIntHeap</span><span> </span><a name="local-1627500677"><a href="#local-1627500677"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627500678"><a href="#local-1627500678"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-1627500679"><a href="#local-1627500679"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-880"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627500677"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-1627500678"><span class="hs-identifier hs-var">y</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500677"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1627500678"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1627500679"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-881"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-1627500677"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1627500678"><span class="hs-identifier hs-var">y</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500677"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1627500679"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-882"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627500678"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Hoopl.Dataflow.html#insertIntHeap"><span class="hs-identifier hs-var">insertIntHeap</span></a><span> </span><a href="#local-1627500677"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627500679"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-883"></a></pre></body></html>