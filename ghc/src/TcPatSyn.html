<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998

\section[TcPatSyn]{Typechecking pattern synonym declarations}
-}</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TcPatSyn</span><span> </span><span class="hs-special">(</span><span> </span><a href="TcPatSyn.html#tcPatSynSig"><span class="hs-identifier hs-var">tcPatSynSig</span></a><span class="hs-special">,</span><span> </span><a href="TcPatSyn.html#tcInferPatSynDecl"><span class="hs-identifier hs-var">tcInferPatSynDecl</span></a><span class="hs-special">,</span><span> </span><a href="TcPatSyn.html#tcCheckPatSynDecl"><span class="hs-identifier hs-var">tcCheckPatSynDecl</span></a><span>
</span><a name="line-11"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="TcPatSyn.html#tcPatSynBuilderBind"><span class="hs-identifier hs-var">tcPatSynBuilderBind</span></a><span class="hs-special">,</span><span> </span><a href="TcPatSyn.html#tcPatSynBuilderOcc"><span class="hs-identifier hs-var">tcPatSynBuilderOcc</span></a><span class="hs-special">,</span><span> </span><a href="TcPatSyn.html#nonBidirectionalErr"><span class="hs-identifier hs-var">nonBidirectionalErr</span></a><span>
</span><a name="line-12"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><a href="HsSyn.html"><span class="hs-identifier">HsSyn</span></a><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><a href="TcPat.html"><span class="hs-identifier">TcPat</span></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><a href="TcHsType.html"><span class="hs-identifier">TcHsType</span></a><span class="hs-special">(</span><span> </span><a href="TcHsType.html#tcImplicitTKBndrs"><span class="hs-identifier hs-var">tcImplicitTKBndrs</span></a><span class="hs-special">,</span><span> </span><a href="TcHsType.html#tcExplicitTKBndrs"><span class="hs-identifier hs-var">tcExplicitTKBndrs</span></a><span>
</span><a name="line-17"></a><span>               </span><span class="hs-special">,</span><span> </span><a href="TcHsType.html#tcHsContext"><span class="hs-identifier hs-var">tcHsContext</span></a><span class="hs-special">,</span><span> </span><a href="TcHsType.html#tcHsLiftedType"><span class="hs-identifier hs-var">tcHsLiftedType</span></a><span class="hs-special">,</span><span> </span><a href="TcHsType.html#tcHsOpenType"><span class="hs-identifier hs-var">tcHsOpenType</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><a href="TcRnMonad.html"><span class="hs-identifier">TcRnMonad</span></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><a href="TcEnv.html"><span class="hs-identifier">TcEnv</span></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><a href="TcMType.html"><span class="hs-identifier">TcMType</span></a><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><a href="TysPrim.html"><span class="hs-identifier">TysPrim</span></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><a href="TysWiredIn.html"><span class="hs-identifier">TysWiredIn</span></a><span>  </span><span class="hs-special">(</span><span> </span><a href="TysWiredIn.html#runtimeRepTy"><span class="hs-identifier hs-var">runtimeRepTy</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="SrcLoc.html"><span class="hs-identifier">SrcLoc</span></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="PatSyn.html"><span class="hs-identifier">PatSyn</span></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="NameSet.html"><span class="hs-identifier">NameSet</span></a><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><a href="Panic.html"><span class="hs-identifier">Panic</span></a><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="Id.html"><span class="hs-identifier">Id</span></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><a href="IdInfo.html"><span class="hs-identifier">IdInfo</span></a><span class="hs-special">(</span><span> </span><a href="IdInfo.html#RecSelParent"><span class="hs-identifier hs-type">RecSelParent</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><a href="TcBinds.html"><span class="hs-identifier">TcBinds</span></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><a href="TcSimplify.html"><span class="hs-identifier">TcSimplify</span></a><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><a href="TcUnify.html"><span class="hs-identifier">TcUnify</span></a><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="TcType.html"><span class="hs-identifier">TcType</span></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><a href="TcEvidence.html"><span class="hs-identifier">TcEvidence</span></a><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><a href="BuildTyCl.html"><span class="hs-identifier">BuildTyCl</span></a><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><a href="VarSet.html"><span class="hs-identifier">VarSet</span></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><a href="MkId.html"><span class="hs-identifier">MkId</span></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><a href="TcTyDecls.html"><span class="hs-identifier">TcTyDecls</span></a><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><a href="ConLike.html"><span class="hs-identifier">ConLike</span></a><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><a href="FieldLabel.html"><span class="hs-identifier">FieldLabel</span></a><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><a href="Bag.html"><span class="hs-identifier">Bag</span></a><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span></a><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#zipWithM"><span class="hs-identifier hs-var">zipWithM</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.List.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span></a><span class="hs-special">(</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><a href="Pair.html"><span class="hs-identifier">Pair</span></a><span class="hs-special">(</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-comment">{- *********************************************************************
*                                                                      *
        Type checking a pattern synonym signature
*                                                                      *
************************************************************************

Note [Pattern synonym signatures]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Pattern synonym signatures are surprisingly tricky (see Trac #11224 for example).
In general they look like this:

   pattern P :: forall univ_tvs. req
             =&gt; forall ex_tvs. prov
             =&gt; arg1 -&gt; .. -&gt; argn -&gt; body_ty

For parsing and renaming we treat the signature as an ordinary LHsSigType.

Once we get to type checking, we decompose it into its parts, in tcPatSynSig.

* Note that 'forall univ_tvs' and 'req =&gt;'
        and 'forall ex_tvs'   and 'prov =&gt;'
  are all optional.  We gather the pieces at the the top of tcPatSynSig

* Initially the implicitly-bound tyvars (added by the renamer) include both
  universal and existential vars.

* After we kind-check the pieces and convert to Types, we do kind generalisation.

* Note [Splitting the implicit tyvars in a pattern synonym]
  Now the tricky bit: we must split
     the implicitly-bound variables, and
     the kind-generalised variables
  into universal and existential.  We do so as follows:

     Note [The pattern-synonym signature splitting rule]
     the universals are the ones mentioned in
          - univ_tvs (and the kinds thereof)
          - req
          - body_ty
     the existentials are the rest

* Moreover see Note x
-}</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-identifier">tcPatSynSig</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TcRnTypes.html#TcPatSynInfo"><span class="hs-identifier hs-type">TcPatSynInfo</span></a><span>
</span><a name="line-99"></a><a name="tcPatSynSig"><a href="TcPatSyn.html#tcPatSynSig"><span class="hs-identifier">tcPatSynSig</span></a></a><span> </span><a name="local-1628263909"><a href="#local-1628263909"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-1628263910"><a href="#local-1628263910"><span class="hs-identifier">sig_ty</span></a></a><span>
</span><a name="line-100"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="HsTypes.html#HsIB"><span class="hs-identifier hs-var">HsIB</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsib_vars</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628263911"><a href="#local-1628263911"><span class="hs-identifier">implicit_hs_tvs</span></a></a><span>
</span><a name="line-101"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsib_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628263912"><a href="#local-1628263912"><span class="hs-identifier">hs_ty</span></a></a><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628263910"><span class="hs-identifier hs-var">sig_ty</span></a><span>
</span><a name="line-102"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-1628263913"><a href="#local-1628263913"><span class="hs-identifier">univ_hs_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628263914"><a href="#local-1628263914"><span class="hs-identifier">hs_req</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-1628263915"><a href="#local-1628263915"><span class="hs-identifier">hs_ty1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HsTypes.html#splitLHsSigmaTy"><span class="hs-identifier hs-var">splitLHsSigmaTy</span></a><span> </span><a href="#local-1628263912"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-103"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-1628263916"><a href="#local-1628263916"><span class="hs-identifier">ex_hs_tvs</span></a></a><span class="hs-special">,</span><span>   </span><a name="local-1628263917"><a href="#local-1628263917"><span class="hs-identifier">hs_prov</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628263918"><a href="#local-1628263918"><span class="hs-identifier">hs_ty2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HsTypes.html#splitLHsSigmaTy"><span class="hs-identifier hs-var">splitLHsSigmaTy</span></a><span> </span><a href="#local-1628263915"><span class="hs-identifier hs-var">hs_ty1</span></a><span>
</span><a name="line-104"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-1628263919"><a href="#local-1628263919"><span class="hs-identifier">hs_arg_tys</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628263920"><a href="#local-1628263920"><span class="hs-identifier">hs_body_ty</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HsTypes.html#splitHsFunType"><span class="hs-identifier hs-var">splitHsFunType</span></a><span>  </span><a href="#local-1628263918"><span class="hs-identifier hs-var">hs_ty2</span></a><span>
</span><a name="line-105"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628263928"><a href="#local-1628263928"><span class="hs-identifier">implicit_tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-1628263929"><a href="#local-1628263929"><span class="hs-identifier">univ_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628263930"><a href="#local-1628263930"><span class="hs-identifier">req</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628263931"><a href="#local-1628263931"><span class="hs-identifier">ex_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628263932"><a href="#local-1628263932"><span class="hs-identifier">prov</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628263933"><a href="#local-1628263933"><span class="hs-identifier">arg_tys</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628263934"><a href="#local-1628263934"><span class="hs-identifier">body_ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-106"></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcSimplify.html#solveEqualities"><span class="hs-identifier hs-var">solveEqualities</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-107"></a><span>              </span><a href="TcHsType.html#tcImplicitTKBndrs"><span class="hs-identifier hs-var">tcImplicitTKBndrs</span></a><span> </span><a href="#local-1628263911"><span class="hs-identifier hs-var">implicit_hs_tvs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-108"></a><span>              </span><a href="TcHsType.html#tcExplicitTKBndrs"><span class="hs-identifier hs-var">tcExplicitTKBndrs</span></a><span> </span><a href="#local-1628263913"><span class="hs-identifier hs-var">univ_hs_tvs</span></a><span>  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628263921"><a href="#local-1628263921"><span class="hs-identifier">univ_tvs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-109"></a><span>              </span><a href="TcHsType.html#tcExplicitTKBndrs"><span class="hs-identifier hs-var">tcExplicitTKBndrs</span></a><span> </span><a href="#local-1628263916"><span class="hs-identifier hs-var">ex_hs_tvs</span></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-1628263922"><a href="#local-1628263922"><span class="hs-identifier">ex_tvs</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-110"></a><span>              </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628263923"><a href="#local-1628263923"><span class="hs-identifier">req</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsType.html#tcHsContext"><span class="hs-identifier hs-var">tcHsContext</span></a><span> </span><a href="#local-1628263914"><span class="hs-identifier hs-var">hs_req</span></a><span>
</span><a name="line-111"></a><span>                 </span><span class="hs-special">;</span><span> </span><a name="local-1628263924"><a href="#local-1628263924"><span class="hs-identifier">prov</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsType.html#tcHsContext"><span class="hs-identifier hs-var">tcHsContext</span></a><span> </span><a href="#local-1628263917"><span class="hs-identifier hs-var">hs_prov</span></a><span>
</span><a name="line-112"></a><span>                 </span><span class="hs-special">;</span><span> </span><a name="local-1628263925"><a href="#local-1628263925"><span class="hs-identifier">arg_tys</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="TcHsType.html#tcHsOpenType"><span class="hs-identifier hs-var">tcHsOpenType</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628263919"><span class="hs-identifier hs-var">hs_arg_tys</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>                 </span><span class="hs-special">;</span><span> </span><a name="local-1628263926"><a href="#local-1628263926"><span class="hs-identifier">body_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcHsType.html#tcHsLiftedType"><span class="hs-identifier hs-var">tcHsLiftedType</span></a><span> </span><a href="#local-1628263920"><span class="hs-identifier hs-var">hs_body_ty</span></a><span>
</span><a name="line-114"></a><span>                 </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628263927"><a href="#local-1628263927"><span class="hs-identifier">bound_tvs</span></a></a><span>
</span><a name="line-115"></a><span>                         </span><span class="hs-glyph">=</span><span> </span><a href="VarSet.html#unionVarSets"><span class="hs-identifier hs-var">unionVarSets</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="TcType.html#allBoundVariabless"><span class="hs-identifier hs-var">allBoundVariabless</span></a><span> </span><a href="#local-1628263923"><span class="hs-identifier hs-var">req</span></a><span>
</span><a name="line-116"></a><span>                                        </span><span class="hs-special">,</span><span> </span><a href="TcType.html#allBoundVariabless"><span class="hs-identifier hs-var">allBoundVariabless</span></a><span> </span><a href="#local-1628263924"><span class="hs-identifier hs-var">prov</span></a><span>
</span><a name="line-117"></a><span>                                        </span><span class="hs-special">,</span><span> </span><a href="TcType.html#allBoundVariabless"><span class="hs-identifier hs-var">allBoundVariabless</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628263926"><span class="hs-identifier hs-var">body_ty</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1628263925"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span>                                        </span><span class="hs-special">]</span><span>
</span><a name="line-119"></a><span>                 </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><a href="#local-1628263921"><span class="hs-identifier hs-var">univ_tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628263923"><span class="hs-identifier hs-var">req</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628263922"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628263924"><span class="hs-identifier hs-var">prov</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628263925"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628263926"><span class="hs-identifier hs-var">body_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>                          </span><span class="hs-special">,</span><span> </span><a href="#local-1628263927"><span class="hs-identifier hs-var">bound_tvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span>       </span><span class="hs-comment">-- Kind generalisation; c.f. kindGeneralise</span><span>
</span><a name="line-123"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628263935"><a href="#local-1628263935"><span class="hs-identifier">free_kvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tyCoVarsOfTelescope"><span class="hs-identifier hs-var">tyCoVarsOfTelescope</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628263928"><span class="hs-identifier hs-var">implicit_tvs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628263929"><span class="hs-identifier hs-var">univ_tvs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628263931"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-124"></a><span>                        </span><a href="TyCoRep.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628263934"><span class="hs-identifier hs-var">body_ty</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1628263930"><span class="hs-identifier hs-var">req</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628263932"><span class="hs-identifier hs-var">prov</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628263933"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628263936"><a href="#local-1628263936"><span class="hs-identifier">kvs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#quantifyTyVars"><span class="hs-identifier hs-var">quantifyTyVars</span></a><span> </span><a href="VarSet.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a><span> </span><span class="hs-special">(</span><a href="Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a href="#local-1628263935"><span class="hs-identifier hs-var">free_kvs</span></a><span> </span><a href="VarSet.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span>       </span><span class="hs-comment">-- These are /signatures/ so we zonk to squeeze out any kind</span><span>
</span><a name="line-129"></a><span>       </span><span class="hs-comment">-- unification variables.  Do this after quantifyTyVars which may</span><span>
</span><a name="line-130"></a><span>       </span><span class="hs-comment">-- default kind variables to *.</span><span>
</span><a name="line-131"></a><span>       </span><span class="hs-comment">-- ToDo: checkValidType?</span><span>
</span><a name="line-132"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;about zonk&quot;</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-133"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628263937"><a href="#local-1628263937"><span class="hs-identifier">implicit_tvs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="TcMType.html#zonkTcTyCoVarBndr"><span class="hs-identifier hs-var">zonkTcTyCoVarBndr</span></a><span> </span><a href="#local-1628263928"><span class="hs-identifier hs-var">implicit_tvs</span></a><span>
</span><a name="line-134"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628263938"><a href="#local-1628263938"><span class="hs-identifier">univ_tvs</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="TcMType.html#zonkTcTyCoVarBndr"><span class="hs-identifier hs-var">zonkTcTyCoVarBndr</span></a><span> </span><a href="#local-1628263929"><span class="hs-identifier hs-var">univ_tvs</span></a><span>
</span><a name="line-135"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628263939"><a href="#local-1628263939"><span class="hs-identifier">ex_tvs</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="TcMType.html#zonkTcTyCoVarBndr"><span class="hs-identifier hs-var">zonkTcTyCoVarBndr</span></a><span> </span><a href="#local-1628263931"><span class="hs-identifier hs-var">ex_tvs</span></a><span>
</span><a name="line-136"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628263940"><a href="#local-1628263940"><span class="hs-identifier">req</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#zonkTcTypes"><span class="hs-identifier hs-var">zonkTcTypes</span></a><span> </span><a href="#local-1628263930"><span class="hs-identifier hs-var">req</span></a><span>
</span><a name="line-137"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628263941"><a href="#local-1628263941"><span class="hs-identifier">prov</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#zonkTcTypes"><span class="hs-identifier hs-var">zonkTcTypes</span></a><span> </span><a href="#local-1628263932"><span class="hs-identifier hs-var">prov</span></a><span>
</span><a name="line-138"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628263942"><a href="#local-1628263942"><span class="hs-identifier">arg_tys</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#zonkTcTypes"><span class="hs-identifier hs-var">zonkTcTypes</span></a><span> </span><a href="#local-1628263933"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-139"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628263943"><a href="#local-1628263943"><span class="hs-identifier">body_ty</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#zonkTcType"><span class="hs-identifier hs-var">zonkTcType</span></a><span>  </span><a href="#local-1628263934"><span class="hs-identifier hs-var">body_ty</span></a><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span>       </span><span class="hs-comment">-- Complain about:  pattern P :: () =&gt; forall x. x -&gt; P x</span><span>
</span><a name="line-142"></a><span>       </span><span class="hs-comment">-- The renamer thought it was fine, but the existential 'x'</span><span>
</span><a name="line-143"></a><span>       </span><span class="hs-comment">-- should not appear in the result type</span><span>
</span><a name="line-144"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628263944"><a href="#local-1628263944"><span class="hs-identifier">bad_tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="VarSet.html#elemVarSet"><span class="hs-identifier hs-var">elemVarSet</span></a><span class="hs-special">`</span><span> </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="#local-1628263943"><span class="hs-identifier hs-var">body_ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628263939"><span class="hs-identifier hs-var">ex_tvs</span></a><span>
</span><a name="line-145"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628263944"><span class="hs-identifier hs-var">bad_tvs</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-146"></a><span>         </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;The result type&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628263943"><span class="hs-identifier hs-var">body_ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>            </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;mentions existential type variable&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#plural"><span class="hs-identifier hs-var">plural</span></a><span> </span><a href="#local-1628263944"><span class="hs-identifier hs-var">bad_tvs</span></a><span>
</span><a name="line-148"></a><span>               </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#pprQuotedList"><span class="hs-identifier hs-var">pprQuotedList</span></a><span> </span><a href="#local-1628263944"><span class="hs-identifier hs-var">bad_tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span>         </span><span class="hs-comment">-- Split [Splitting the implicit tyvars in a pattern synonym]</span><span>
</span><a name="line-151"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628263945"><a href="#local-1628263945"><span class="hs-identifier">univ_fvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#closeOverKinds"><span class="hs-identifier hs-var">closeOverKinds</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-152"></a><span>                        </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628263943"><span class="hs-identifier hs-var">body_ty</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-1628263940"><span class="hs-identifier hs-var">req</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="VarSet.html#extendVarSetList"><span class="hs-identifier hs-var">extendVarSetList</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628263938"><span class="hs-identifier hs-var">univ_tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span>             </span><span class="hs-special">(</span><a name="local-1628263946"><a href="#local-1628263946"><span class="hs-identifier">extra_univ</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628263947"><a href="#local-1628263947"><span class="hs-identifier">extra_ex</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="VarSet.html#elemVarSet"><span class="hs-identifier hs-var">elemVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628263945"><span class="hs-identifier hs-var">univ_fvs</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-154"></a><span>                                      </span><a href="#local-1628263936"><span class="hs-identifier hs-var">kvs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628263937"><span class="hs-identifier hs-var">implicit_tvs</span></a><span>
</span><a name="line-155"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;tcTySig }&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-156"></a><span>         </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;implicit_tvs&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TcPatSyn.html#ppr_tvs"><span class="hs-identifier hs-var">ppr_tvs</span></a><span> </span><a href="#local-1628263937"><span class="hs-identifier hs-var">implicit_tvs</span></a><span>
</span><a name="line-157"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;kvs&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TcPatSyn.html#ppr_tvs"><span class="hs-identifier hs-var">ppr_tvs</span></a><span> </span><a href="#local-1628263936"><span class="hs-identifier hs-var">kvs</span></a><span>
</span><a name="line-158"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;extra_univ&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TcPatSyn.html#ppr_tvs"><span class="hs-identifier hs-var">ppr_tvs</span></a><span> </span><a href="#local-1628263946"><span class="hs-identifier hs-var">extra_univ</span></a><span>
</span><a name="line-159"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;univ_tvs&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TcPatSyn.html#ppr_tvs"><span class="hs-identifier hs-var">ppr_tvs</span></a><span> </span><a href="#local-1628263938"><span class="hs-identifier hs-var">univ_tvs</span></a><span>
</span><a name="line-160"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;req&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628263940"><span class="hs-identifier hs-var">req</span></a><span>
</span><a name="line-161"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;extra_ex&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TcPatSyn.html#ppr_tvs"><span class="hs-identifier hs-var">ppr_tvs</span></a><span> </span><a href="#local-1628263947"><span class="hs-identifier hs-var">extra_ex</span></a><span>
</span><a name="line-162"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;ex_tvs&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TcPatSyn.html#ppr_tvs"><span class="hs-identifier hs-var">ppr_tvs</span></a><span> </span><a href="#local-1628263939"><span class="hs-identifier hs-var">ex_tvs</span></a><span>
</span><a name="line-163"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;prov&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628263941"><span class="hs-identifier hs-var">prov</span></a><span>
</span><a name="line-164"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;arg_tys&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628263942"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-165"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;body_ty&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628263943"><span class="hs-identifier hs-var">body_ty</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-166"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TPSI"><span class="hs-identifier hs-var">TPSI</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">patsig_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628263909"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-167"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">patsig_univ_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628263946"><span class="hs-identifier hs-var">extra_univ</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628263938"><span class="hs-identifier hs-var">univ_tvs</span></a><span>
</span><a name="line-168"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">patsig_req</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628263940"><span class="hs-identifier hs-var">req</span></a><span>
</span><a name="line-169"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">patsig_ex_tvs</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628263947"><span class="hs-identifier hs-var">extra_ex</span></a><span>   </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628263939"><span class="hs-identifier hs-var">ex_tvs</span></a><span>
</span><a name="line-170"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">patsig_prov</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628263941"><span class="hs-identifier hs-var">prov</span></a><span>
</span><a name="line-171"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">patsig_arg_tys</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628263942"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-172"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">patsig_body_ty</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628263943"><span class="hs-identifier hs-var">body_ty</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-173"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span class="hs-identifier">ppr_tvs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-176"></a><a name="ppr_tvs"><a href="TcPatSyn.html#ppr_tvs"><span class="hs-identifier">ppr_tvs</span></a></a><span> </span><a name="local-1628263948"><a href="#local-1628263948"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628263949"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628263949"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span>                           </span><span class="hs-glyph">|</span><span> </span><a name="local-1628263949"><a href="#local-1628263949"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628263948"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                    Type checking a pattern synonym
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-identifier">tcInferPatSynDecl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-type">PatSynBind</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-189"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a><span class="hs-special">)</span><span>
</span><a name="line-190"></a><a name="tcInferPatSynDecl"><a href="TcPatSyn.html#tcInferPatSynDecl"><span class="hs-identifier">tcInferPatSynDecl</span></a></a><span> </span><a href="HsBinds.html#PSB"><span class="hs-identifier hs-var">PSB</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">psb_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628263950"><a href="#local-1628263950"><span class="hs-identifier">lname</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628263951"><a href="#local-1628263951"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628263952"><a href="#local-1628263952"><span class="hs-identifier">details</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-191"></a><span>                       </span><span class="hs-identifier">psb_def</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628263953"><a href="#local-1628263953"><span class="hs-identifier">lpat</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_dir</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628263954"><a href="#local-1628263954"><span class="hs-identifier">dir</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-192"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcPatSyn.html#addPatSynCtxt"><span class="hs-identifier hs-var">addPatSynCtxt</span></a><span> </span><a href="#local-1628263950"><span class="hs-identifier hs-var">lname</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-193"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;tcInferPatSynDecl {&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628263951"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-194"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcPatSyn.html#tcCheckPatSynPat"><span class="hs-identifier hs-var">tcCheckPatSynPat</span></a><span> </span><a href="#local-1628263953"><span class="hs-identifier hs-var">lpat</span></a><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1628263955"><a href="#local-1628263955"><span class="hs-identifier">arg_names</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628263956"><a href="#local-1628263956"><span class="hs-identifier">rec_fields</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628263957"><a href="#local-1628263957"><span class="hs-identifier">is_infix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcPatSyn.html#collectPatSynArgInfo"><span class="hs-identifier hs-var">collectPatSynArgInfo</span></a><span> </span><a href="#local-1628263952"><span class="hs-identifier hs-var">details</span></a><span>
</span><a name="line-197"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628263961"><a href="#local-1628263961"><span class="hs-identifier">tclvl</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628263962"><a href="#local-1628263962"><span class="hs-identifier">wanted</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-1628263963"><a href="#local-1628263963"><span class="hs-identifier">lpat'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628263964"><a href="#local-1628263964"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-1628263965"><a href="#local-1628263965"><span class="hs-identifier">pat_ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-198"></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#pushLevelAndCaptureConstraints"><span class="hs-identifier hs-var">pushLevelAndCaptureConstraints</span></a><span>  </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-199"></a><span>               </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628263958"><a href="#local-1628263958"><span class="hs-identifier">pat_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#newOpenInferExpType"><span class="hs-identifier hs-var">newOpenInferExpType</span></a><span>
</span><a name="line-200"></a><span>                  </span><span class="hs-special">;</span><span> </span><a name="local-1628263959"><a href="#local-1628263959"><span class="hs-identifier">stuff</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcPat.html#tcPat"><span class="hs-identifier hs-var">tcPat</span></a><span> </span><a href="HsExpr.html#PatSyn"><span class="hs-identifier hs-var">PatSyn</span></a><span> </span><a href="#local-1628263953"><span class="hs-identifier hs-var">lpat</span></a><span> </span><a href="#local-1628263958"><span class="hs-identifier hs-var">pat_ty</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-201"></a><span>                             </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="TcEnv.html#tcLookupId"><span class="hs-identifier hs-var">tcLookupId</span></a><span> </span><a href="#local-1628263955"><span class="hs-identifier hs-var">arg_names</span></a><span>
</span><a name="line-202"></a><span>                  </span><span class="hs-special">;</span><span> </span><a name="local-1628263960"><a href="#local-1628263960"><span class="hs-identifier">pat_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#readExpType"><span class="hs-identifier hs-var">readExpType</span></a><span> </span><a href="#local-1628263958"><span class="hs-identifier hs-var">pat_ty</span></a><span>
</span><a name="line-203"></a><span>                  </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628263959"><span class="hs-identifier hs-var">stuff</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628263960"><span class="hs-identifier hs-var">pat_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628263966"><a href="#local-1628263966"><span class="hs-identifier">named_taus</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628263951"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628263965"><span class="hs-identifier hs-var">pat_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1628263967"><a href="#local-1628263967"><span class="hs-identifier">arg</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-1628263967"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">varType</span><span> </span><a href="#local-1628263967"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628263964"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628263968"><a href="#local-1628263968"><span class="hs-identifier">qtvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628263969"><a href="#local-1628263969"><span class="hs-identifier">req_dicts</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628263970"><a href="#local-1628263970"><span class="hs-identifier">ev_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcSimplify.html#simplifyInfer"><span class="hs-identifier hs-var">simplifyInfer</span></a><span> </span><a href="#local-1628263961"><span class="hs-identifier hs-var">tclvl</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-1628263966"><span class="hs-identifier hs-var">named_taus</span></a><span> </span><a href="#local-1628263962"><span class="hs-identifier hs-var">wanted</span></a><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1628263971"><a href="#local-1628263971"><span class="hs-identifier">ex_vars</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628263972"><a href="#local-1628263972"><span class="hs-identifier">prov_dicts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcPatSyn.html#tcCollectEx"><span class="hs-identifier hs-var">tcCollectEx</span></a><span> </span><a href="#local-1628263963"><span class="hs-identifier hs-var">lpat'</span></a><span>
</span><a name="line-210"></a><span>             </span><a name="local-1628263973"><a href="#local-1628263973"><span class="hs-identifier">univ_tvs</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="VarSet.html#elemVarSet"><span class="hs-identifier hs-var">elemVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628263971"><span class="hs-identifier hs-var">ex_vars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628263968"><span class="hs-identifier hs-var">qtvs</span></a><span>
</span><a name="line-211"></a><span>             </span><a name="local-1628263974"><a href="#local-1628263974"><span class="hs-identifier">ex_tvs</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="VarSet.html#varSetElems"><span class="hs-identifier hs-var">varSetElems</span></a><span> </span><a href="#local-1628263971"><span class="hs-identifier hs-var">ex_vars</span></a><span>
</span><a name="line-212"></a><span>             </span><a name="local-1628263975"><a href="#local-1628263975"><span class="hs-identifier">prov_theta</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="TcType.html#evVarPred"><span class="hs-identifier hs-var">evVarPred</span></a><span> </span><a href="#local-1628263972"><span class="hs-identifier hs-var">prov_dicts</span></a><span>
</span><a name="line-213"></a><span>             </span><a name="local-1628263976"><a href="#local-1628263976"><span class="hs-identifier">req_theta</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="TcType.html#evVarPred"><span class="hs-identifier hs-var">evVarPred</span></a><span> </span><a href="#local-1628263969"><span class="hs-identifier hs-var">req_dicts</span></a><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;tcInferPatSynDecl }&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628263951"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-216"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcPatSyn.html#tc_patsyn_finish"><span class="hs-identifier hs-var">tc_patsyn_finish</span></a><span> </span><a href="#local-1628263950"><span class="hs-identifier hs-var">lname</span></a><span> </span><a href="#local-1628263954"><span class="hs-identifier hs-var">dir</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-comment">{- no sig -}</span><span> </span><a href="#local-1628263957"><span class="hs-identifier hs-var">is_infix</span></a><span> </span><a href="#local-1628263963"><span class="hs-identifier hs-var">lpat'</span></a><span>
</span><a name="line-217"></a><span>                          </span><span class="hs-special">(</span><a href="#local-1628263973"><span class="hs-identifier hs-var">univ_tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628263976"><span class="hs-identifier hs-var">req_theta</span></a><span class="hs-special">,</span><span>  </span><a href="#local-1628263970"><span class="hs-identifier hs-var">ev_binds</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628263969"><span class="hs-identifier hs-var">req_dicts</span></a><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span>                          </span><span class="hs-special">(</span><a href="#local-1628263974"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">,</span><span>   </span><a href="TyCoRep.html#mkTyVarTys"><span class="hs-identifier hs-var">mkTyVarTys</span></a><span> </span><a href="#local-1628263974"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628263975"><span class="hs-identifier hs-var">prov_theta</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="TcEvidence.html#EvId"><span class="hs-identifier hs-var">EvId</span></a><span> </span><a href="#local-1628263972"><span class="hs-identifier hs-var">prov_dicts</span></a><span class="hs-special">)</span><span>
</span><a name="line-219"></a><span>                          </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628263964"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628263964"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-220"></a><span>                          </span><a href="#local-1628263965"><span class="hs-identifier hs-var">pat_ty</span></a><span> </span><a href="#local-1628263956"><span class="hs-identifier hs-var">rec_fields</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-identifier">tcCheckPatSynDecl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-type">PatSynBind</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-224"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcPatSynInfo"><span class="hs-identifier hs-type">TcPatSynInfo</span></a><span>
</span><a name="line-225"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a><span class="hs-special">)</span><span>
</span><a name="line-226"></a><a name="tcCheckPatSynDecl"><a href="TcPatSyn.html#tcCheckPatSynDecl"><span class="hs-identifier">tcCheckPatSynDecl</span></a></a><span> </span><a name="local-1628263977"><a href="#local-1628263977"><span class="hs-identifier">psb</span></a></a><span class="hs-glyph">@</span><a href="HsBinds.html#PSB"><span class="hs-identifier hs-var">PSB</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">psb_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628263978"><a href="#local-1628263978"><span class="hs-identifier">lname</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628263979"><a href="#local-1628263979"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628263980"><a href="#local-1628263980"><span class="hs-identifier">details</span></a></a><span>
</span><a name="line-227"></a><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_def</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628263981"><a href="#local-1628263981"><span class="hs-identifier">lpat</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_dir</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628263982"><a href="#local-1628263982"><span class="hs-identifier">dir</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-228"></a><span>                  </span><a href="TcRnTypes.html#TPSI"><span class="hs-identifier hs-var">TPSI</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">patsig_univ_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628263983"><a href="#local-1628263983"><span class="hs-identifier">univ_tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">patsig_prov</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628263984"><a href="#local-1628263984"><span class="hs-identifier">prov_theta</span></a></a><span>
</span><a name="line-229"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">patsig_ex_tvs</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-1628263985"><a href="#local-1628263985"><span class="hs-identifier">ex_tvs</span></a></a><span class="hs-special">,</span><span>   </span><span class="hs-identifier">patsig_req</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-1628263986"><a href="#local-1628263986"><span class="hs-identifier">req_theta</span></a></a><span>
</span><a name="line-230"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">patsig_arg_tys</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-1628263987"><a href="#local-1628263987"><span class="hs-identifier">arg_tys</span></a></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier">patsig_body_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628263988"><a href="#local-1628263988"><span class="hs-identifier">pat_ty</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-231"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcPatSyn.html#addPatSynCtxt"><span class="hs-identifier hs-var">addPatSynCtxt</span></a><span> </span><a href="#local-1628263978"><span class="hs-identifier hs-var">lname</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-232"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628263995"><a href="#local-1628263995"><span class="hs-identifier">origin</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#ProvCtxtOrigin"><span class="hs-identifier hs-var">ProvCtxtOrigin</span></a><span> </span><a href="#local-1628263977"><span class="hs-identifier hs-var">psb</span></a><span>
</span><a name="line-233"></a><span>             </span><a name="local-1628263996"><a href="#local-1628263996"><span class="hs-identifier">skol_info</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#SigSkol"><span class="hs-identifier hs-var">SigSkol</span></a><span> </span><span class="hs-special">(</span><a href="TcType.html#PatSynCtxt"><span class="hs-identifier hs-var">PatSynCtxt</span></a><span> </span><a href="#local-1628263979"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcType.html#mkCheckExpType"><span class="hs-identifier hs-var">mkCheckExpType</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-234"></a><span>                                                     </span><a href="TyCoRep.html#mkFunTys"><span class="hs-identifier hs-var">mkFunTys</span></a><span> </span><a href="#local-1628263987"><span class="hs-identifier hs-var">arg_tys</span></a><span> </span><a href="#local-1628263988"><span class="hs-identifier hs-var">pat_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-235"></a><span>             </span><a name="local-1628263997"><a href="#local-1628263997"><span class="hs-identifier">decl_arity</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628263999"><span class="hs-identifier hs-var">arg_names</span></a><span>
</span><a name="line-236"></a><span>             </span><a name="local-1628263998"><a href="#local-1628263998"><span class="hs-identifier">ty_arity</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-1628263987"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-237"></a><span>             </span><span class="hs-special">(</span><a name="local-1628263999"><a href="#local-1628263999"><span class="hs-identifier">arg_names</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264000"><a href="#local-1628264000"><span class="hs-identifier">rec_fields</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264001"><a href="#local-1628264001"><span class="hs-identifier">is_infix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcPatSyn.html#collectPatSynArgInfo"><span class="hs-identifier hs-var">collectPatSynArgInfo</span></a><span> </span><a href="#local-1628263980"><span class="hs-identifier hs-var">details</span></a><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;tcCheckPatSynDecl&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-240"></a><span>         </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628263983"><span class="hs-identifier hs-var">univ_tvs</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628263986"><span class="hs-identifier hs-var">req_theta</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628263985"><span class="hs-identifier hs-var">ex_tvs</span></a><span>
</span><a name="line-241"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628263984"><span class="hs-identifier hs-var">prov_theta</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628263987"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628263988"><span class="hs-identifier hs-var">pat_ty</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#checkTc"><span class="hs-identifier hs-var">checkTc</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628263997"><span class="hs-identifier hs-var">decl_arity</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-1628263998"><span class="hs-identifier hs-var">ty_arity</span></a><span class="hs-special">)</span><span>
</span><a name="line-244"></a><span>                 </span><span class="hs-special">(</span><a href="TcPatSyn.html#wrongNumberOfParmsErr"><span class="hs-identifier hs-var">wrongNumberOfParmsErr</span></a><span> </span><a href="#local-1628263979"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-1628263997"><span class="hs-identifier hs-var">decl_arity</span></a><span> </span><a href="#local-1628263998"><span class="hs-identifier hs-var">ty_arity</span></a><span class="hs-special">)</span><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcPatSyn.html#tcCheckPatSynPat"><span class="hs-identifier hs-var">tcCheckPatSynPat</span></a><span> </span><a href="#local-1628263981"><span class="hs-identifier hs-var">lpat</span></a><span>
</span><a name="line-247"></a><span>
</span><a name="line-248"></a><span>       </span><span class="hs-comment">-- Right!  Let's check the pattern against the signature</span><span>
</span><a name="line-249"></a><span>       </span><span class="hs-comment">-- See Note [Checking against a pattern signature]</span><span>
</span><a name="line-250"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628264002"><a href="#local-1628264002"><span class="hs-identifier">req_dicts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#newEvVars"><span class="hs-identifier hs-var">newEvVars</span></a><span> </span><a href="#local-1628263986"><span class="hs-identifier hs-var">req_theta</span></a><span>
</span><a name="line-251"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628264009"><a href="#local-1628264009"><span class="hs-identifier">tclvl</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264010"><a href="#local-1628264010"><span class="hs-identifier">wanted</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-1628264011"><a href="#local-1628264011"><span class="hs-identifier">lpat'</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-1628264012"><a href="#local-1628264012"><span class="hs-identifier">ex_tvs'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264013"><a href="#local-1628264013"><span class="hs-identifier">prov_dicts</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264014"><a href="#local-1628264014"><span class="hs-identifier">args'</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-252"></a><span>           </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">equalLength</span><span> </span><span class="hs-identifier">arg_names</span><span> </span><span class="hs-identifier">arg_tys</span><span class="hs-special">,</span><span> </span><a href="#local-1628263999"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628263987"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-1628263987"><span class="hs-operator hs-var">$$</span></a><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">arg_names</span><span> </span><a href="Outputable.html#assertPprPanic"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#assertPprPanic"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-identifier">arg_tys</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-253"></a><span>           </span><a href="TcRnMonad.html#pushLevelAndCaptureConstraints"><span class="hs-identifier hs-var">pushLevelAndCaptureConstraints</span></a><span>            </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-254"></a><span>           </span><a href="TcEnv.html#tcExtendTyVarEnv"><span class="hs-identifier hs-var">tcExtendTyVarEnv</span></a><span> </span><a href="#local-1628263983"><span class="hs-identifier hs-var">univ_tvs</span></a><span>                 </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-255"></a><span>           </span><a href="TcPat.html#tcPat"><span class="hs-identifier hs-var">tcPat</span></a><span> </span><a href="HsExpr.html#PatSyn"><span class="hs-identifier hs-var">PatSyn</span></a><span> </span><a href="#local-1628263981"><span class="hs-identifier hs-var">lpat</span></a><span> </span><span class="hs-special">(</span><a href="TcType.html#mkCheckExpType"><span class="hs-identifier hs-var">mkCheckExpType</span></a><span> </span><a href="#local-1628263988"><span class="hs-identifier hs-var">pat_ty</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-256"></a><span>           </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-1628264003"><a href="#local-1628264003"><span class="hs-identifier">subst</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264004"><a href="#local-1628264004"><span class="hs-identifier">ex_tvs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span>   </span><a href="TcPatSyn.html#isUnidirectional"><span class="hs-identifier hs-var">isUnidirectional</span></a><span> </span><a href="#local-1628263982"><span class="hs-identifier hs-var">dir</span></a><span>
</span><a name="line-257"></a><span>                                    </span><span class="hs-keyword">then</span><span> </span><a href="TcMType.html#newMetaTyVars"><span class="hs-identifier hs-var">newMetaTyVars</span></a><span>    </span><a href="#local-1628263985"><span class="hs-identifier hs-var">ex_tvs</span></a><span>
</span><a name="line-258"></a><span>                                    </span><span class="hs-keyword">else</span><span> </span><a href="TcMType.html#newMetaSigTyVars"><span class="hs-identifier hs-var">newMetaSigTyVars</span></a><span> </span><a href="#local-1628263985"><span class="hs-identifier hs-var">ex_tvs</span></a><span>
</span><a name="line-259"></a><span>                    </span><span class="hs-comment">-- See the &quot;Existential type variables&quot; part of</span><span>
</span><a name="line-260"></a><span>                    </span><span class="hs-comment">-- Note [Checking against a pattern signature]</span><span>
</span><a name="line-261"></a><span>              </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;tcpatsyn1&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264005"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628264005"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1628264005"><a href="#local-1628264005"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628263985"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-262"></a><span>              </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;tcpatsyn2&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264006"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-1628264006"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1628264006"><a href="#local-1628264006"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628264004"><span class="hs-identifier hs-var">ex_tvs'</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-263"></a><span>              </span><span class="hs-special">;</span><span> </span><a name="local-1628264007"><a href="#local-1628264007"><span class="hs-identifier">prov_dicts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="TcMType.html#emitWanted"><span class="hs-identifier hs-var">emitWanted</span></a><span> </span><a href="#local-1628263995"><span class="hs-identifier hs-var">origin</span></a><span class="hs-special">)</span><span>
</span><a name="line-264"></a><span>                  </span><span class="hs-special">(</span><a href="TyCoRep.html#substTheta"><span class="hs-identifier hs-var">substTheta</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#extendTCvInScopeList"><span class="hs-identifier hs-var">extendTCvInScopeList</span></a><span> </span><a href="#local-1628264003"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1628263983"><span class="hs-identifier hs-var">univ_tvs</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628263984"><span class="hs-identifier hs-var">prov_theta</span></a><span class="hs-special">)</span><span>
</span><a name="line-265"></a><span>                  </span><span class="hs-comment">-- Add the free vars of 'prov_theta' to the in_scope set to</span><span>
</span><a name="line-266"></a><span>                  </span><span class="hs-comment">-- satisfy the substition invariant. There's no need to</span><span>
</span><a name="line-267"></a><span>                  </span><span class="hs-comment">-- add 'ex_tvs' as they are already in the domain of the</span><span>
</span><a name="line-268"></a><span>                  </span><span class="hs-comment">-- substitution.</span><span>
</span><a name="line-269"></a><span>                  </span><span class="hs-comment">-- See also Note [The substitution invariant] in TyCoRep.</span><span>
</span><a name="line-270"></a><span>              </span><span class="hs-special">;</span><span> </span><a name="local-1628264008"><a href="#local-1628264008"><span class="hs-identifier">args'</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#zipWithM"><span class="hs-identifier hs-var">zipWithM</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628263989"><span class="hs-identifier hs-var">tc_arg</span></a><span> </span><a href="#local-1628264003"><span class="hs-identifier hs-var">subst</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628263999"><span class="hs-identifier hs-var">arg_names</span></a><span> </span><a href="#local-1628263987"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-271"></a><span>              </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628264004"><span class="hs-identifier hs-var">ex_tvs'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264007"><span class="hs-identifier hs-var">prov_dicts</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264008"><span class="hs-identifier hs-var">args'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-272"></a><span>
</span><a name="line-273"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628264015"><a href="#local-1628264015"><span class="hs-identifier">implics</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264016"><a href="#local-1628264016"><span class="hs-identifier">ev_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcUnify.html#buildImplicationFor"><span class="hs-identifier hs-var">buildImplicationFor</span></a><span> </span><a href="#local-1628264009"><span class="hs-identifier hs-var">tclvl</span></a><span> </span><a href="#local-1628263996"><span class="hs-identifier hs-var">skol_info</span></a><span> </span><a href="#local-1628263983"><span class="hs-identifier hs-var">univ_tvs</span></a><span> </span><a href="#local-1628264002"><span class="hs-identifier hs-var">req_dicts</span></a><span> </span><a href="#local-1628264010"><span class="hs-identifier hs-var">wanted</span></a><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span>       </span><span class="hs-comment">-- Solve the constraints now, because we are about to make a PatSyn,</span><span>
</span><a name="line-276"></a><span>       </span><span class="hs-comment">-- which should not contain unification variables and the like (Trac #10997)</span><span>
</span><a name="line-277"></a><span>       </span><span class="hs-comment">-- Since all the inputs are implications the returned bindings will be empty</span><span>
</span><a name="line-278"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcSimplify.html#simplifyTop"><span class="hs-identifier hs-var">simplifyTop</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#mkImplicWC"><span class="hs-identifier hs-var">mkImplicWC</span></a><span> </span><a href="#local-1628264015"><span class="hs-identifier hs-var">implics</span></a><span class="hs-special">)</span><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span>       </span><span class="hs-comment">-- ToDo: in the bidirectional case, check that the ex_tvs' are all distinct</span><span>
</span><a name="line-281"></a><span>       </span><span class="hs-comment">-- Otherwise we may get a type error when typechecking the builder,</span><span>
</span><a name="line-282"></a><span>       </span><span class="hs-comment">-- when that should be impossible</span><span>
</span><a name="line-283"></a><span>
</span><a name="line-284"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;tcCheckPatSynDecl }&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628263979"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-285"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcPatSyn.html#tc_patsyn_finish"><span class="hs-identifier hs-var">tc_patsyn_finish</span></a><span> </span><a href="#local-1628263978"><span class="hs-identifier hs-var">lname</span></a><span> </span><a href="#local-1628263982"><span class="hs-identifier hs-var">dir</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-comment">{- has a sig -}</span><span> </span><a href="#local-1628264001"><span class="hs-identifier hs-var">is_infix</span></a><span> </span><a href="#local-1628264011"><span class="hs-identifier hs-var">lpat'</span></a><span>
</span><a name="line-286"></a><span>                          </span><span class="hs-special">(</span><a href="#local-1628263983"><span class="hs-identifier hs-var">univ_tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628263986"><span class="hs-identifier hs-var">req_theta</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264016"><span class="hs-identifier hs-var">ev_binds</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264002"><span class="hs-identifier hs-var">req_dicts</span></a><span class="hs-special">)</span><span>
</span><a name="line-287"></a><span>                          </span><span class="hs-special">(</span><a href="#local-1628263985"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkTyVarTys"><span class="hs-identifier hs-var">mkTyVarTys</span></a><span> </span><a href="#local-1628264012"><span class="hs-identifier hs-var">ex_tvs'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628263984"><span class="hs-identifier hs-var">prov_theta</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264013"><span class="hs-identifier hs-var">prov_dicts</span></a><span class="hs-special">)</span><span>
</span><a name="line-288"></a><span>                          </span><span class="hs-special">(</span><a href="#local-1628264014"><span class="hs-identifier hs-var">args'</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628263987"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span>                          </span><a href="#local-1628263988"><span class="hs-identifier hs-var">pat_ty</span></a><span> </span><a href="#local-1628264000"><span class="hs-identifier hs-var">rec_fields</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-290"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-291"></a><span>    </span><span class="hs-identifier">tc_arg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">)</span><span>
</span><a name="line-292"></a><span>    </span><a name="local-1628263989"><a href="#local-1628263989"><span class="hs-identifier">tc_arg</span></a></a><span> </span><a name="local-1628263990"><a href="#local-1628263990"><span class="hs-identifier">subst</span></a></a><span> </span><a name="local-1628263991"><a href="#local-1628263991"><span class="hs-identifier">arg_name</span></a></a><span> </span><a name="local-1628263992"><a href="#local-1628263992"><span class="hs-identifier">arg_ty</span></a></a><span>
</span><a name="line-293"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>   </span><span class="hs-comment">-- Look up the variable actually bound by lpat</span><span>
</span><a name="line-294"></a><span>               </span><span class="hs-comment">-- and check that it has the expected type</span><span>
</span><a name="line-295"></a><span>             </span><a name="local-1628263993"><a href="#local-1628263993"><span class="hs-identifier">arg_id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcEnv.html#tcLookupId"><span class="hs-identifier hs-var">tcLookupId</span></a><span> </span><a href="#local-1628263991"><span class="hs-identifier hs-var">arg_name</span></a><span>
</span><a name="line-296"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-1628263994"><a href="#local-1628263994"><span class="hs-identifier">coi</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcUnify.html#unifyType"><span class="hs-identifier hs-var">unifyType</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628263993"><span class="hs-identifier hs-var">arg_id</span></a><span class="hs-special">)</span><span>
</span><a name="line-297"></a><span>                              </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628263993"><span class="hs-identifier hs-var">arg_id</span></a><span class="hs-special">)</span><span>
</span><a name="line-298"></a><span>                              </span><span class="hs-special">(</span><a href="TyCoRep.html#substTyUnchecked"><span class="hs-identifier hs-var">substTyUnchecked</span></a><span> </span><a href="#local-1628263990"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-1628263992"><span class="hs-identifier hs-var">arg_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-299"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkLHsWrapCo"><span class="hs-identifier hs-var">mkLHsWrapCo</span></a><span> </span><a href="#local-1628263994"><span class="hs-identifier hs-var">coi</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628263993"><span class="hs-identifier hs-var">arg_id</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-300"></a><span>
</span><a name="line-301"></a><span class="hs-comment">{- Note [Checking against a pattern signature]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When checking the actual supplied pattern against the pattern synonym
signature, we need to be quite careful.

----- Provided constraints
Example

    data T a where
      MkT :: Ord a =&gt; a -&gt; T a

    pattern P :: () =&gt; Eq a =&gt; a -&gt; [T a]
    pattern P x = [MkT x]

We must check that the (Eq a) that P claims to bind (and to
make available to matches against P), is derivable from the
actual pattern.  For example:
    f (P (x::a)) = ...here (Eq a) should be available...
And yes, (Eq a) is derivable from the (Ord a) bound by P's rhs.

----- Existential type variables
Unusually, we instantiate the existential tyvars of the pattern with
*meta* type variables.  For example

    data S where
      MkS :: Eq a =&gt; [a] -&gt; S

    pattern P :: () =&gt; Eq x =&gt; x -&gt; S
    pattern P x &lt;- MkS x

The pattern synonym conceals from its client the fact that MkS has a
list inside it.  The client just thinks it's a type 'x'.  So we must
unify x := [a] during type checking, and then use the instantiating type
[a] (called ex_tys) when building the matcher.  In this case we'll get

   $mP :: S -&gt; (forall x. Ex x =&gt; x -&gt; r) -&gt; r -&gt; r
   $mP x k = case x of
               MkS a (d:Eq a) (ys:[a]) -&gt; let dl :: Eq [a]
                                              dl = $dfunEqList d
                                          in k [a] dl ys

This &quot;concealing&quot; story works for /uni-directional/ pattern synonmys,
but obviously not for bidirectional ones.  So in the bidirectional case
we use SigTv, rather than a generic TauTv, meta-tyvar so that.  And
we should really check that those SigTvs don't get unified with each
other.

-}</span><span>
</span><a name="line-349"></a><span>
</span><a name="line-350"></a><span class="hs-identifier">collectPatSynArgInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#HsPatSynDetails"><span class="hs-identifier hs-type">HsPatSynDetails</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-351"></a><a name="collectPatSynArgInfo"><a href="TcPatSyn.html#collectPatSynArgInfo"><span class="hs-identifier">collectPatSynArgInfo</span></a></a><span> </span><a name="local-1628264017"><a href="#local-1628264017"><span class="hs-identifier">details</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-352"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628264017"><span class="hs-identifier hs-var">details</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-353"></a><span>    </span><a href="HsBinds.html#PrefixPatSyn"><span class="hs-identifier hs-var">PrefixPatSyn</span></a><span> </span><a name="local-1628264021"><a href="#local-1628264021"><span class="hs-identifier">names</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-1628264021"><span class="hs-identifier hs-var">names</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>
</span><a name="line-354"></a><span>    </span><a href="HsBinds.html#InfixPatSyn"><span class="hs-identifier hs-var">InfixPatSyn</span></a><span> </span><a name="local-1628264022"><a href="#local-1628264022"><span class="hs-identifier">name1</span></a></a><span> </span><a name="local-1628264023"><a href="#local-1628264023"><span class="hs-identifier">name2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628264022"><span class="hs-identifier hs-var">name1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264023"><span class="hs-identifier hs-var">name2</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span>
</span><a name="line-355"></a><span>    </span><a href="HsBinds.html#RecordPatSyn"><span class="hs-identifier hs-var">RecordPatSyn</span></a><span> </span><a name="local-1628264024"><a href="#local-1628264024"><span class="hs-identifier">names</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-356"></a><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1628264025"><a href="#local-1628264025"><span class="hs-identifier">vars</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264026"><a href="#local-1628264026"><span class="hs-identifier">sels</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628264018"><span class="hs-identifier hs-var">splitRecordPatSyn</span></a><span> </span><a href="#local-1628264024"><span class="hs-identifier hs-var">names</span></a><span class="hs-special">)</span><span>
</span><a name="line-357"></a><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-1628264025"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264026"><span class="hs-identifier hs-var">sels</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>
</span><a name="line-358"></a><span>
</span><a name="line-359"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-360"></a><span>    </span><span class="hs-identifier">splitRecordPatSyn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#RecordPatSynField"><span class="hs-identifier hs-type">RecordPatSynField</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-361"></a><span>    </span><a name="local-1628264018"><a href="#local-1628264018"><span class="hs-identifier">splitRecordPatSyn</span></a></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#RecordPatSynField"><span class="hs-identifier hs-var">RecordPatSynField</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">recordPatSynPatVar</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628264019"><a href="#local-1628264019"><span class="hs-identifier">patVar</span></a></a><span>
</span><a name="line-362"></a><span>                                         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recordPatSynSelectorId</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628264020"><a href="#local-1628264020"><span class="hs-identifier">selId</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-363"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628264019"><span class="hs-identifier hs-var">patVar</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264020"><span class="hs-identifier hs-var">selId</span></a><span class="hs-special">)</span><span>
</span><a name="line-364"></a><span>
</span><a name="line-365"></a><span class="hs-identifier">addPatSynCtxt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="#local-1628263908"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="#local-1628263908"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-366"></a><a name="addPatSynCtxt"><a href="TcPatSyn.html#addPatSynCtxt"><span class="hs-identifier">addPatSynCtxt</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628264027"><a href="#local-1628264027"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628264028"><a href="#local-1628264028"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628264029"><a href="#local-1628264029"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-367"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a><span> </span><a href="#local-1628264027"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-368"></a><span>    </span><a href="TcRnMonad.html#addErrCtxt"><span class="hs-identifier hs-var">addErrCtxt</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In the declaration for pattern synonym&quot;</span><span>
</span><a name="line-369"></a><span>                </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264028"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-370"></a><span>    </span><a href="#local-1628264029"><span class="hs-identifier hs-var">thing_inside</span></a><span>
</span><a name="line-371"></a><span>
</span><a name="line-372"></a><span class="hs-identifier">wrongNumberOfParmsErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Arity"><span class="hs-identifier hs-type">Arity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-373"></a><a name="wrongNumberOfParmsErr"><a href="TcPatSyn.html#wrongNumberOfParmsErr"><span class="hs-identifier">wrongNumberOfParmsErr</span></a></a><span> </span><a name="local-1628264030"><a href="#local-1628264030"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-1628264031"><a href="#local-1628264031"><span class="hs-identifier">decl_arity</span></a></a><span> </span><a name="local-1628264032"><a href="#local-1628264032"><span class="hs-identifier">ty_arity</span></a></a><span>
</span><a name="line-374"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Pattern synonym&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264030"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;has&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-375"></a><span>          </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#speakNOf"><span class="hs-identifier hs-var">speakNOf</span></a><span> </span><a href="#local-1628264031"><span class="hs-identifier hs-var">decl_arity</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;argument&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-376"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;but its type signature has&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#speakN"><span class="hs-identifier hs-var">speakN</span></a><span> </span><a href="#local-1628264032"><span class="hs-identifier hs-var">ty_arity</span></a><span class="hs-special">)</span><span>
</span><a name="line-377"></a><span>
</span><a name="line-378"></a><span class="hs-comment">-------------------------</span><span>
</span><a name="line-379"></a><span class="hs-comment">-- Shared by both tcInferPatSyn and tcCheckPatSyn</span><span>
</span><a name="line-380"></a><span class="hs-identifier">tc_patsyn_finish</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>  </span><span class="hs-comment">-- ^ PatSyn Name</span><span>
</span><a name="line-381"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsPatSynDir"><span class="hs-identifier hs-type">HsPatSynDir</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>  </span><span class="hs-comment">-- ^ PatSyn type (Uni/Bidir/ExplicitBidir)</span><span>
</span><a name="line-382"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>              </span><span class="hs-comment">-- ^ True &lt;=&gt; signature provided</span><span>
</span><a name="line-383"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>              </span><span class="hs-comment">-- ^ Whether infix</span><span>
</span><a name="line-384"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>           </span><span class="hs-comment">-- ^ Pattern of the PatSyn</span><span>
</span><a name="line-385"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-386"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-387"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- ^ Pattern arguments and types</span><span>
</span><a name="line-388"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span>              </span><span class="hs-comment">-- ^ Pattern type</span><span>
</span><a name="line-389"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>              </span><span class="hs-comment">-- ^ Selector names</span><span>
</span><a name="line-390"></a><span>                 </span><span class="hs-comment">-- ^ Whether fields, empty if not record PatSyn</span><span>
</span><a name="line-391"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a><span class="hs-special">)</span><span>
</span><a name="line-392"></a><a name="tc_patsyn_finish"><a href="TcPatSyn.html#tc_patsyn_finish"><span class="hs-identifier">tc_patsyn_finish</span></a></a><span> </span><a name="local-1628264033"><a href="#local-1628264033"><span class="hs-identifier">lname</span></a></a><span> </span><a name="local-1628264034"><a href="#local-1628264034"><span class="hs-identifier">dir</span></a></a><span> </span><a name="local-1628264035"><a href="#local-1628264035"><span class="hs-identifier">has_sig</span></a></a><span> </span><a name="local-1628264036"><a href="#local-1628264036"><span class="hs-identifier">is_infix</span></a></a><span> </span><a name="local-1628264037"><a href="#local-1628264037"><span class="hs-identifier">lpat'</span></a></a><span>
</span><a name="line-393"></a><span>                 </span><span class="hs-special">(</span><a name="local-1628264038"><a href="#local-1628264038"><span class="hs-identifier">univ_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264039"><a href="#local-1628264039"><span class="hs-identifier">req_theta</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264040"><a href="#local-1628264040"><span class="hs-identifier">req_ev_binds</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264041"><a href="#local-1628264041"><span class="hs-identifier">req_dicts</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-394"></a><span>                 </span><span class="hs-special">(</span><a name="local-1628264042"><a href="#local-1628264042"><span class="hs-identifier">ex_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264043"><a href="#local-1628264043"><span class="hs-identifier">ex_tys</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264044"><a href="#local-1628264044"><span class="hs-identifier">prov_theta</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264045"><a href="#local-1628264045"><span class="hs-identifier">prov_dicts</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-395"></a><span>                 </span><span class="hs-special">(</span><a name="local-1628264046"><a href="#local-1628264046"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264047"><a href="#local-1628264047"><span class="hs-identifier">arg_tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-396"></a><span>                 </span><a name="local-1628264048"><a href="#local-1628264048"><span class="hs-identifier">pat_ty</span></a></a><span> </span><a name="local-1628264049"><a href="#local-1628264049"><span class="hs-identifier">field_labels</span></a></a><span>
</span><a name="line-397"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Zonk everything.  We are about to build a final PatSyn</span><span>
</span><a name="line-398"></a><span>         </span><span class="hs-comment">-- so there had better be no unification variables in there</span><span>
</span><a name="line-399"></a><span>         </span><a name="local-1628264050"><a href="#local-1628264050"><span class="hs-identifier">univ_tvs</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MonadUtils.html#mapMaybeM"><span class="hs-identifier hs-var">mapMaybeM</span></a><span> </span><a href="TcMType.html#zonkQuantifiedTyVar"><span class="hs-identifier hs-var">zonkQuantifiedTyVar</span></a><span> </span><a href="#local-1628264038"><span class="hs-identifier hs-var">univ_tvs</span></a><span>
</span><a name="line-400"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628264051"><a href="#local-1628264051"><span class="hs-identifier">ex_tvs</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MonadUtils.html#mapMaybeM"><span class="hs-identifier hs-var">mapMaybeM</span></a><span> </span><a href="TcMType.html#zonkQuantifiedTyVar"><span class="hs-identifier hs-var">zonkQuantifiedTyVar</span></a><span> </span><a href="#local-1628264042"><span class="hs-identifier hs-var">ex_tvs</span></a><span>
</span><a name="line-401"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628264052"><a href="#local-1628264052"><span class="hs-identifier">prov_theta</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#zonkTcTypes"><span class="hs-identifier hs-var">zonkTcTypes</span></a><span> </span><a href="#local-1628264044"><span class="hs-identifier hs-var">prov_theta</span></a><span>
</span><a name="line-402"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628264053"><a href="#local-1628264053"><span class="hs-identifier">req_theta</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#zonkTcTypes"><span class="hs-identifier hs-var">zonkTcTypes</span></a><span> </span><a href="#local-1628264039"><span class="hs-identifier hs-var">req_theta</span></a><span>
</span><a name="line-403"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628264054"><a href="#local-1628264054"><span class="hs-identifier">pat_ty</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#zonkTcType"><span class="hs-identifier hs-var">zonkTcType</span></a><span> </span><a href="#local-1628264048"><span class="hs-identifier hs-var">pat_ty</span></a><span>
</span><a name="line-404"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628264055"><a href="#local-1628264055"><span class="hs-identifier">arg_tys</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcMType.html#zonkTcTypes"><span class="hs-identifier hs-var">zonkTcTypes</span></a><span> </span><a href="#local-1628264047"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-405"></a><span>
</span><a name="line-406"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;tc_patsyn_finish {&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-407"></a><span>           </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-1628264033"><span class="hs-identifier hs-var">lname</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-1628264037"><span class="hs-identifier hs-var">lpat'</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-408"></a><span>           </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628264050"><span class="hs-identifier hs-var">univ_tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264053"><span class="hs-identifier hs-var">req_theta</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264040"><span class="hs-identifier hs-var">req_ev_binds</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264041"><span class="hs-identifier hs-var">req_dicts</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-409"></a><span>           </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628264051"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264052"><span class="hs-identifier hs-var">prov_theta</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264045"><span class="hs-identifier hs-var">prov_dicts</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-410"></a><span>           </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264046"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-411"></a><span>           </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264055"><span class="hs-identifier hs-var">arg_tys</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-412"></a><span>           </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264054"><span class="hs-identifier hs-var">pat_ty</span></a><span>
</span><a name="line-413"></a><span>
</span><a name="line-414"></a><span>       </span><span class="hs-comment">-- Make the 'matcher'</span><span>
</span><a name="line-415"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628264056"><a href="#local-1628264056"><span class="hs-identifier">matcher_id</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264057"><a href="#local-1628264057"><span class="hs-identifier">matcher_bind</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcPatSyn.html#tcPatSynMatcher"><span class="hs-identifier hs-var">tcPatSynMatcher</span></a><span> </span><a href="#local-1628264035"><span class="hs-identifier hs-var">has_sig</span></a><span> </span><a href="#local-1628264033"><span class="hs-identifier hs-var">lname</span></a><span> </span><a href="#local-1628264037"><span class="hs-identifier hs-var">lpat'</span></a><span>
</span><a name="line-416"></a><span>                                         </span><span class="hs-special">(</span><a href="#local-1628264050"><span class="hs-identifier hs-var">univ_tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264053"><span class="hs-identifier hs-var">req_theta</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264040"><span class="hs-identifier hs-var">req_ev_binds</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264041"><span class="hs-identifier hs-var">req_dicts</span></a><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span>                                         </span><span class="hs-special">(</span><a href="#local-1628264051"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264043"><span class="hs-identifier hs-var">ex_tys</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264052"><span class="hs-identifier hs-var">prov_theta</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264045"><span class="hs-identifier hs-var">prov_dicts</span></a><span class="hs-special">)</span><span>
</span><a name="line-418"></a><span>                                         </span><span class="hs-special">(</span><a href="#local-1628264046"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264055"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-419"></a><span>                                         </span><a href="#local-1628264054"><span class="hs-identifier hs-var">pat_ty</span></a><span>
</span><a name="line-420"></a><span>
</span><a name="line-421"></a><span>
</span><a name="line-422"></a><span>       </span><span class="hs-comment">-- Make the 'builder'</span><span>
</span><a name="line-423"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628264058"><a href="#local-1628264058"><span class="hs-identifier">builder_id</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcPatSyn.html#mkPatSynBuilderId"><span class="hs-identifier hs-var">mkPatSynBuilderId</span></a><span> </span><a href="#local-1628264035"><span class="hs-identifier hs-var">has_sig</span></a><span> </span><a href="#local-1628264034"><span class="hs-identifier hs-var">dir</span></a><span> </span><a href="#local-1628264033"><span class="hs-identifier hs-var">lname</span></a><span>
</span><a name="line-424"></a><span>                                         </span><a href="#local-1628264050"><span class="hs-identifier hs-var">univ_tvs</span></a><span> </span><a href="#local-1628264053"><span class="hs-identifier hs-var">req_theta</span></a><span>
</span><a name="line-425"></a><span>                                         </span><a href="#local-1628264051"><span class="hs-identifier hs-var">ex_tvs</span></a><span>   </span><a href="#local-1628264052"><span class="hs-identifier hs-var">prov_theta</span></a><span>
</span><a name="line-426"></a><span>                                         </span><a href="#local-1628264055"><span class="hs-identifier hs-var">arg_tys</span></a><span> </span><a href="#local-1628264054"><span class="hs-identifier hs-var">pat_ty</span></a><span>
</span><a name="line-427"></a><span>
</span><a name="line-428"></a><span>         </span><span class="hs-comment">-- TODO: Make this have the proper information</span><span>
</span><a name="line-429"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628264059"><a href="#local-1628264059"><span class="hs-identifier">mkFieldLabel</span></a></a><span> </span><a name="local-1628264061"><a href="#local-1628264061"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="FieldLabel.html#FieldLabel"><span class="hs-identifier hs-var">FieldLabel</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">occNameFS</span><span> </span><span class="hs-special">(</span><a href="Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a><span> </span><a href="#local-1628264061"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-1628264061"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-430"></a><span>             </span><a name="local-1628264060"><a href="#local-1628264060"><span class="hs-identifier">field_labels'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628264059"><span class="hs-identifier hs-var">mkFieldLabel</span></a><span> </span><a href="#local-1628264049"><span class="hs-identifier hs-var">field_labels</span></a><span class="hs-special">)</span><span>
</span><a name="line-431"></a><span>
</span><a name="line-432"></a><span>
</span><a name="line-433"></a><span>       </span><span class="hs-comment">-- Make the PatSyn itself</span><span>
</span><a name="line-434"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628264062"><a href="#local-1628264062"><span class="hs-identifier">patSyn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="PatSyn.html#mkPatSyn"><span class="hs-identifier hs-var">mkPatSyn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-1628264033"><span class="hs-identifier hs-var">lname</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628264036"><span class="hs-identifier hs-var">is_infix</span></a><span>
</span><a name="line-435"></a><span>                        </span><span class="hs-special">(</span><a href="#local-1628264050"><span class="hs-identifier hs-var">univ_tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264053"><span class="hs-identifier hs-var">req_theta</span></a><span class="hs-special">)</span><span>
</span><a name="line-436"></a><span>                        </span><span class="hs-special">(</span><a href="#local-1628264051"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264052"><span class="hs-identifier hs-var">prov_theta</span></a><span class="hs-special">)</span><span>
</span><a name="line-437"></a><span>                        </span><a href="#local-1628264055"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-438"></a><span>                        </span><a href="#local-1628264054"><span class="hs-identifier hs-var">pat_ty</span></a><span>
</span><a name="line-439"></a><span>                        </span><a href="#local-1628264056"><span class="hs-identifier hs-var">matcher_id</span></a><span> </span><a href="#local-1628264058"><span class="hs-identifier hs-var">builder_id</span></a><span>
</span><a name="line-440"></a><span>                        </span><a href="#local-1628264060"><span class="hs-identifier hs-var">field_labels'</span></a><span>
</span><a name="line-441"></a><span>
</span><a name="line-442"></a><span>       </span><span class="hs-comment">-- Selectors</span><span>
</span><a name="line-443"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1628264063"><a href="#local-1628264063"><span class="hs-identifier">sigs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264064"><a href="#local-1628264064"><span class="hs-identifier">selector_binds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-444"></a><span>                </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a><span> </span><span class="hs-special">(</span><a href="TcPatSyn.html#mkPatSynRecSelBinds"><span class="hs-identifier hs-var">mkPatSynRecSelBinds</span></a><span> </span><a href="#local-1628264062"><span class="hs-identifier hs-var">patSyn</span></a><span> </span><span class="hs-special">(</span><a href="PatSyn.html#patSynFieldLabels"><span class="hs-identifier hs-var">patSynFieldLabels</span></a><span> </span><a href="#local-1628264062"><span class="hs-identifier hs-var">patSyn</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-445"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628264065"><a href="#local-1628264065"><span class="hs-identifier">tything</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#AConLike"><span class="hs-identifier hs-var">AConLike</span></a><span> </span><span class="hs-special">(</span><a href="ConLike.html#PatSynCon"><span class="hs-identifier hs-var">PatSynCon</span></a><span> </span><a href="#local-1628264062"><span class="hs-identifier hs-var">patSyn</span></a><span class="hs-special">)</span><span>
</span><a name="line-446"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628264066"><a href="#local-1628264066"><span class="hs-identifier">tcg_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-447"></a><span>          </span><a href="TcEnv.html#tcExtendGlobalEnv"><span class="hs-identifier hs-var">tcExtendGlobalEnv</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628264065"><span class="hs-identifier hs-var">tything</span></a><span class="hs-special">]</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-448"></a><span>            </span><a href="TcBinds.html#tcRecSelBinds"><span class="hs-identifier hs-var">tcRecSelBinds</span></a><span>
</span><a name="line-449"></a><span>              </span><span class="hs-special">(</span><a href="HsBinds.html#ValBindsOut"><span class="hs-identifier hs-var">ValBindsOut</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#repeat"><span class="hs-identifier hs-var">repeat</span></a><span> </span><a href="BasicTypes.html#NonRecursive"><span class="hs-identifier hs-var">NonRecursive</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628264064"><span class="hs-identifier hs-var">selector_binds</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628264063"><span class="hs-identifier hs-var">sigs</span></a><span class="hs-special">)</span><span>
</span><a name="line-450"></a><span>
</span><a name="line-451"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;tc_patsyn_finish }&quot;</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-452"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628264057"><span class="hs-identifier hs-var">matcher_bind</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264066"><span class="hs-identifier hs-var">tcg_env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-453"></a><span>
</span><a name="line-454"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
         Constructing the &quot;matcher&quot; Id and its binding
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-461"></a><span>
</span><a name="line-462"></a><span class="hs-identifier">tcPatSynMatcher</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>  </span><span class="hs-comment">-- True &lt;=&gt; signature provided</span><span>
</span><a name="line-463"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-464"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-465"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span class="hs-special">,</span><span> </span><a href="TcEvidence.html#TcEvBinds"><span class="hs-identifier hs-type">TcEvBinds</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-466"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TcType.html#TcTyVar"><span class="hs-identifier hs-type">TcTyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TcEvidence.html#EvTerm"><span class="hs-identifier hs-type">EvTerm</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-467"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-468"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcType.html#TcType"><span class="hs-identifier hs-type">TcType</span></a><span>
</span><a name="line-469"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-470"></a><span class="hs-comment">-- See Note [Matchers and builders for pattern synonyms] in PatSyn</span><span>
</span><a name="line-471"></a><a name="tcPatSynMatcher"><a href="TcPatSyn.html#tcPatSynMatcher"><span class="hs-identifier">tcPatSynMatcher</span></a></a><span> </span><a name="local-1628264067"><a href="#local-1628264067"><span class="hs-identifier">has_sig</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628264068"><a href="#local-1628264068"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628264069"><a href="#local-1628264069"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628264070"><a href="#local-1628264070"><span class="hs-identifier">lpat</span></a></a><span>
</span><a name="line-472"></a><span>                </span><span class="hs-special">(</span><a name="local-1628264071"><a href="#local-1628264071"><span class="hs-identifier">univ_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264072"><a href="#local-1628264072"><span class="hs-identifier">req_theta</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264073"><a href="#local-1628264073"><span class="hs-identifier">req_ev_binds</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264074"><a href="#local-1628264074"><span class="hs-identifier">req_dicts</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-473"></a><span>                </span><span class="hs-special">(</span><a name="local-1628264075"><a href="#local-1628264075"><span class="hs-identifier">ex_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264076"><a href="#local-1628264076"><span class="hs-identifier">ex_tys</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264077"><a href="#local-1628264077"><span class="hs-identifier">prov_theta</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264078"><a href="#local-1628264078"><span class="hs-identifier">prov_dicts</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-474"></a><span>                </span><span class="hs-special">(</span><a name="local-1628264079"><a href="#local-1628264079"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264080"><a href="#local-1628264080"><span class="hs-identifier">arg_tys</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1628264081"><a href="#local-1628264081"><span class="hs-identifier">pat_ty</span></a></a><span>
</span><a name="line-475"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628264082"><a href="#local-1628264082"><span class="hs-identifier">rr_uniq</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#newUnique"><span class="hs-identifier hs-var">newUnique</span></a><span>
</span><a name="line-476"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628264083"><a href="#local-1628264083"><span class="hs-identifier">tv_uniq</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#newUnique"><span class="hs-identifier hs-var">newUnique</span></a><span>
</span><a name="line-477"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628264084"><a href="#local-1628264084"><span class="hs-identifier">rr_name</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#mkInternalName"><span class="hs-identifier hs-var">mkInternalName</span></a><span> </span><a href="#local-1628264082"><span class="hs-identifier hs-var">rr_uniq</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#mkTyVarOcc"><span class="hs-identifier hs-var">mkTyVarOcc</span></a><span> </span><span class="hs-string">&quot;rep&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1628264068"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-478"></a><span>             </span><a name="local-1628264085"><a href="#local-1628264085"><span class="hs-identifier">tv_name</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#mkInternalName"><span class="hs-identifier hs-var">mkInternalName</span></a><span> </span><a href="#local-1628264083"><span class="hs-identifier hs-var">tv_uniq</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#mkTyVarOcc"><span class="hs-identifier hs-var">mkTyVarOcc</span></a><span> </span><span class="hs-string">&quot;r&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1628264068"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-479"></a><span>             </span><a name="local-1628264086"><a href="#local-1628264086"><span class="hs-identifier">rr_tv</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#mkTcTyVar"><span class="hs-identifier hs-var">mkTcTyVar</span></a><span> </span><a href="#local-1628264084"><span class="hs-identifier hs-var">rr_name</span></a><span> </span><a href="TysWiredIn.html#runtimeRepTy"><span class="hs-identifier hs-var">runtimeRepTy</span></a><span> </span><span class="hs-special">(</span><a href="TcType.html#SkolemTv"><span class="hs-identifier hs-var">SkolemTv</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>
</span><a name="line-480"></a><span>             </span><a name="local-1628264087"><a href="#local-1628264087"><span class="hs-identifier">rr</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span> </span><a href="#local-1628264086"><span class="hs-identifier hs-var">rr_tv</span></a><span>
</span><a name="line-481"></a><span>             </span><a name="local-1628264088"><a href="#local-1628264088"><span class="hs-identifier">res_tv</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#mkTcTyVar"><span class="hs-identifier hs-var">mkTcTyVar</span></a><span> </span><a href="#local-1628264085"><span class="hs-identifier hs-var">tv_name</span></a><span>  </span><span class="hs-special">(</span><a href="TysPrim.html#tYPE"><span class="hs-identifier hs-var">tYPE</span></a><span> </span><a href="#local-1628264087"><span class="hs-identifier hs-var">rr</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcType.html#SkolemTv"><span class="hs-identifier hs-var">SkolemTv</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>
</span><a name="line-482"></a><span>             </span><a name="local-1628264089"><a href="#local-1628264089"><span class="hs-identifier">is_unlifted</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628264079"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628264078"><span class="hs-identifier hs-var">prov_dicts</span></a><span>
</span><a name="line-483"></a><span>             </span><a name="local-1628264090"><a href="#local-1628264090"><span class="hs-identifier">res_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span> </span><a href="#local-1628264088"><span class="hs-identifier hs-var">res_tv</span></a><span>
</span><a name="line-484"></a><span>             </span><span class="hs-special">(</span><a name="local-1628264091"><a href="#local-1628264091"><span class="hs-identifier">cont_args</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264092"><a href="#local-1628264092"><span class="hs-identifier">cont_arg_tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-485"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628264089"><span class="hs-identifier hs-var">is_unlifted</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="MkId.html#voidPrimId"><span class="hs-identifier hs-var">voidPrimId</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TysPrim.html#voidPrimTy"><span class="hs-identifier hs-var">voidPrimTy</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-486"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1628264079"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">,</span><span>                 </span><a href="#local-1628264080"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-487"></a><span>             </span><a name="local-1628264093"><a href="#local-1628264093"><span class="hs-identifier">mk_sigma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628264067"><span class="hs-identifier hs-var">has_sig</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="TcType.html#mkSpecSigmaTy"><span class="hs-identifier hs-var">mkSpecSigmaTy</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="TcType.html#mkInvSigmaTy"><span class="hs-identifier hs-var">mkInvSigmaTy</span></a><span>
</span><a name="line-488"></a><span>             </span><a name="local-1628264094"><a href="#local-1628264094"><span class="hs-identifier">cont_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264093"><span class="hs-identifier hs-var">mk_sigma</span></a><span> </span><a href="#local-1628264075"><span class="hs-identifier hs-var">ex_tvs</span></a><span> </span><a href="#local-1628264077"><span class="hs-identifier hs-var">prov_theta</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-489"></a><span>                       </span><a href="TyCoRep.html#mkFunTys"><span class="hs-identifier hs-var">mkFunTys</span></a><span> </span><a href="#local-1628264092"><span class="hs-identifier hs-var">cont_arg_tys</span></a><span> </span><a href="#local-1628264090"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-490"></a><span>
</span><a name="line-491"></a><span>             </span><a name="local-1628264095"><a href="#local-1628264095"><span class="hs-identifier">fail_ty</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a><span> </span><a href="TysPrim.html#voidPrimTy"><span class="hs-identifier hs-var">voidPrimTy</span></a><span> </span><a href="#local-1628264090"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-492"></a><span>
</span><a name="line-493"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628264096"><a href="#local-1628264096"><span class="hs-identifier">matcher_name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="BuildTyCl.html#newImplicitBinder"><span class="hs-identifier hs-var">newImplicitBinder</span></a><span> </span><a href="#local-1628264069"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="OccName.html#mkMatcherOcc"><span class="hs-identifier hs-var">mkMatcherOcc</span></a><span>
</span><a name="line-494"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628264097"><a href="#local-1628264097"><span class="hs-identifier">scrutinee</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#newSysLocalId"><span class="hs-identifier hs-var">newSysLocalId</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;scrut&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-1628264081"><span class="hs-identifier hs-var">pat_ty</span></a><span>
</span><a name="line-495"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628264098"><a href="#local-1628264098"><span class="hs-identifier">cont</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#newSysLocalId"><span class="hs-identifier hs-var">newSysLocalId</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;cont&quot;</span><span class="hs-special">)</span><span>  </span><a href="#local-1628264094"><span class="hs-identifier hs-var">cont_ty</span></a><span>
</span><a name="line-496"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628264099"><a href="#local-1628264099"><span class="hs-identifier">fail</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#newSysLocalId"><span class="hs-identifier hs-var">newSysLocalId</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;fail&quot;</span><span class="hs-special">)</span><span>  </span><a href="#local-1628264095"><span class="hs-identifier hs-var">fail_ty</span></a><span>
</span><a name="line-497"></a><span>
</span><a name="line-498"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628264100"><a href="#local-1628264100"><span class="hs-identifier">matcher_tau</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkFunTys"><span class="hs-identifier hs-var">mkFunTys</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628264081"><span class="hs-identifier hs-var">pat_ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264094"><span class="hs-identifier hs-var">cont_ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264095"><span class="hs-identifier hs-var">fail_ty</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628264090"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-499"></a><span>             </span><a name="local-1628264101"><a href="#local-1628264101"><span class="hs-identifier">matcher_sigma</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcType.html#mkInvSigmaTy"><span class="hs-identifier hs-var">mkInvSigmaTy</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628264086"><span class="hs-identifier hs-var">rr_tv</span></a><span class="hs-glyph">:</span><a href="#local-1628264088"><span class="hs-identifier hs-var">res_tv</span></a><span class="hs-glyph">:</span><a href="#local-1628264071"><span class="hs-identifier hs-var">univ_tvs</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628264072"><span class="hs-identifier hs-var">req_theta</span></a><span> </span><a href="#local-1628264100"><span class="hs-identifier hs-var">matcher_tau</span></a><span>
</span><a name="line-500"></a><span>             </span><a name="local-1628264102"><a href="#local-1628264102"><span class="hs-identifier">matcher_id</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#mkExportedVanillaId"><span class="hs-identifier hs-var">mkExportedVanillaId</span></a><span> </span><a href="#local-1628264096"><span class="hs-identifier hs-var">matcher_name</span></a><span> </span><a href="#local-1628264101"><span class="hs-identifier hs-var">matcher_sigma</span></a><span>
</span><a name="line-501"></a><span>                             </span><span class="hs-comment">-- See Note [Exported LocalIds] in Id</span><span>
</span><a name="line-502"></a><span>
</span><a name="line-503"></a><span>             </span><a name="local-1628264103"><a href="#local-1628264103"><span class="hs-identifier">inst_wrap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#mkWpEvApps"><span class="hs-identifier hs-var">mkWpEvApps</span></a><span> </span><a href="#local-1628264078"><span class="hs-identifier hs-var">prov_dicts</span></a><span> </span><a href="TcEvidence.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a><span> </span><a href="TcEvidence.html#mkWpTyApps"><span class="hs-identifier hs-var">mkWpTyApps</span></a><span> </span><a href="#local-1628264076"><span class="hs-identifier hs-var">ex_tys</span></a><span>
</span><a name="line-504"></a><span>             </span><a name="local-1628264104"><a href="#local-1628264104"><span class="hs-identifier">cont'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="HsUtils.html#nlHsApp"><span class="hs-identifier hs-var">nlHsApp</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkLHsWrap"><span class="hs-identifier hs-var">mkLHsWrap</span></a><span> </span><a href="#local-1628264103"><span class="hs-identifier hs-var">inst_wrap</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628264098"><span class="hs-identifier hs-var">cont</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1628264091"><span class="hs-identifier hs-var">cont_args</span></a><span>
</span><a name="line-505"></a><span>
</span><a name="line-506"></a><span>             </span><a name="local-1628264105"><a href="#local-1628264105"><span class="hs-identifier">fail'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#nlHsApps"><span class="hs-identifier hs-var">nlHsApps</span></a><span> </span><a href="#local-1628264099"><span class="hs-identifier hs-var">fail</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="MkId.html#voidPrimId"><span class="hs-identifier hs-var">voidPrimId</span></a><span class="hs-special">]</span><span>
</span><a name="line-507"></a><span>
</span><a name="line-508"></a><span>             </span><a name="local-1628264106"><a href="#local-1628264106"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="HsUtils.html#nlVarPat"><span class="hs-identifier hs-var">nlVarPat</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628264097"><span class="hs-identifier hs-var">scrutinee</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264098"><span class="hs-identifier hs-var">cont</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264099"><span class="hs-identifier hs-var">fail</span></a><span class="hs-special">]</span><span>
</span><a name="line-509"></a><span>             </span><a name="local-1628264107"><a href="#local-1628264107"><span class="hs-identifier">lwpat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsPat.html#WildPat"><span class="hs-identifier hs-var">WildPat</span></a><span> </span><a href="#local-1628264081"><span class="hs-identifier hs-var">pat_ty</span></a><span>
</span><a name="line-510"></a><span>             </span><a name="local-1628264108"><a href="#local-1628264108"><span class="hs-identifier">cases</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="HsPat.html#isIrrefutableHsPat"><span class="hs-identifier hs-var">isIrrefutableHsPat</span></a><span> </span><a href="#local-1628264070"><span class="hs-identifier hs-var">lpat</span></a><span>
</span><a name="line-511"></a><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><a href="#local-1628264070"><span class="hs-identifier hs-var">lpat</span></a><span>  </span><a href="#local-1628264104"><span class="hs-identifier hs-var">cont'</span></a><span class="hs-special">]</span><span>
</span><a name="line-512"></a><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><a href="#local-1628264070"><span class="hs-identifier hs-var">lpat</span></a><span>  </span><a href="#local-1628264104"><span class="hs-identifier hs-var">cont'</span></a><span class="hs-special">,</span><span>
</span><a name="line-513"></a><span>                           </span><a href="HsUtils.html#mkSimpleHsAlt"><span class="hs-identifier hs-var">mkSimpleHsAlt</span></a><span> </span><a href="#local-1628264107"><span class="hs-identifier hs-var">lwpat</span></a><span> </span><a href="#local-1628264105"><span class="hs-identifier hs-var">fail'</span></a><span class="hs-special">]</span><span>
</span><a name="line-514"></a><span>             </span><a name="local-1628264109"><a href="#local-1628264109"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkLHsWrap"><span class="hs-identifier hs-var">mkLHsWrap</span></a><span> </span><span class="hs-special">(</span><a href="TcEvidence.html#mkWpLet"><span class="hs-identifier hs-var">mkWpLet</span></a><span> </span><a href="#local-1628264073"><span class="hs-identifier hs-var">req_ev_binds</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-515"></a><span>                    </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-1628264070"><span class="hs-identifier hs-var">lpat</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-516"></a><span>                    </span><a href="HsExpr.html#HsCase"><span class="hs-identifier hs-var">HsCase</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="#local-1628264097"><span class="hs-identifier hs-var">scrutinee</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-517"></a><span>                    </span><a href="HsExpr.html#MG"><span class="hs-identifier hs-var">MG</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-1628264070"><span class="hs-identifier hs-var">lpat</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628264108"><span class="hs-identifier hs-var">cases</span></a><span>
</span><a name="line-518"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628264081"><span class="hs-identifier hs-var">pat_ty</span></a><span class="hs-special">]</span><span>
</span><a name="line-519"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_res_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264090"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-520"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_origin</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#Generated"><span class="hs-identifier hs-var">Generated</span></a><span>
</span><a name="line-521"></a><span>                      </span><span class="hs-special">}</span><span>
</span><a name="line-522"></a><span>             </span><a name="local-1628264110"><a href="#local-1628264110"><span class="hs-identifier">body'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-523"></a><span>                     </span><a href="HsExpr.html#HsLam"><span class="hs-identifier hs-var">HsLam</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-524"></a><span>                     </span><a href="HsExpr.html#MG"><span class="hs-identifier hs-var">MG</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#mkSimpleMatch"><span class="hs-identifier hs-var">mkSimpleMatch</span></a><span> </span><a href="#local-1628264106"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-1628264109"><span class="hs-identifier hs-var">body</span></a><span class="hs-special">]</span><span>
</span><a name="line-525"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1628264081"><span class="hs-identifier hs-var">pat_ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264094"><span class="hs-identifier hs-var">cont_ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264090"><span class="hs-identifier hs-var">res_ty</span></a><span class="hs-special">]</span><span>
</span><a name="line-526"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_res_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264090"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-527"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_origin</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#Generated"><span class="hs-identifier hs-var">Generated</span></a><span>
</span><a name="line-528"></a><span>                       </span><span class="hs-special">}</span><span>
</span><a name="line-529"></a><span>             </span><a name="local-1628264111"><a href="#local-1628264111"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkMatch"><span class="hs-identifier hs-var">mkMatch</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsLams"><span class="hs-identifier hs-var">mkHsLams</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628264086"><span class="hs-identifier hs-var">rr_tv</span></a><span class="hs-glyph">:</span><a href="#local-1628264088"><span class="hs-identifier hs-var">res_tv</span></a><span class="hs-glyph">:</span><a href="#local-1628264071"><span class="hs-identifier hs-var">univ_tvs</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628264074"><span class="hs-identifier hs-var">req_dicts</span></a><span> </span><a href="#local-1628264110"><span class="hs-identifier hs-var">body'</span></a><span class="hs-special">)</span><span>
</span><a name="line-530"></a><span>                             </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="HsBinds.html#EmptyLocalBinds"><span class="hs-identifier hs-var">EmptyLocalBinds</span></a><span class="hs-special">)</span><span>
</span><a name="line-531"></a><span>             </span><a name="local-1628264112"><a href="#local-1628264112"><span class="hs-identifier">mg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#MG"><span class="hs-identifier hs-var">MG</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-1628264111"><span class="hs-identifier hs-var">match</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-1628264111"><span class="hs-identifier hs-var">match</span></a><span class="hs-special">]</span><span>
</span><a name="line-532"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-533"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_res_ty</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264090"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-534"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mg_origin</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#Generated"><span class="hs-identifier hs-var">Generated</span></a><span>
</span><a name="line-535"></a><span>                    </span><span class="hs-special">}</span><span>
</span><a name="line-536"></a><span>
</span><a name="line-537"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628264113"><a href="#local-1628264113"><span class="hs-identifier">bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628264068"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628264102"><span class="hs-identifier hs-var">matcher_id</span></a><span>
</span><a name="line-538"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264112"><span class="hs-identifier hs-var">mg</span></a><span>
</span><a name="line-539"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_co_fn</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#idHsWrapper"><span class="hs-identifier hs-var">idHsWrapper</span></a><span>
</span><a name="line-540"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">bind_fvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-541"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_tick</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-542"></a><span>             </span><a name="local-1628264114"><a href="#local-1628264114"><span class="hs-identifier">matcher_bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#unitBag"><span class="hs-identifier hs-var">unitBag</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-1628264113"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">)</span><span>
</span><a name="line-543"></a><span>
</span><a name="line-544"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;tcPatSynMatcher&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264069"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628264102"><span class="hs-identifier hs-var">matcher_id</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-545"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;tcPatSynMatcher&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264114"><span class="hs-identifier hs-var">matcher_bind</span></a><span class="hs-special">)</span><span>
</span><a name="line-546"></a><span>
</span><a name="line-547"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-1628264102"><span class="hs-identifier hs-var">matcher_id</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264089"><span class="hs-identifier hs-var">is_unlifted</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-1628264114"><span class="hs-identifier hs-var">matcher_bind</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-548"></a><span>
</span><a name="line-549"></a><span class="hs-identifier">mkPatSynRecSelBinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span>
</span><a name="line-550"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span class="hs-special">]</span><span>
</span><a name="line-551"></a><span>                    </span><span class="hs-comment">-- ^ Visible field labels</span><span>
</span><a name="line-552"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="HsBinds.html#LSig"><span class="hs-identifier hs-type">LSig</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-553"></a><a name="mkPatSynRecSelBinds"><a href="TcPatSyn.html#mkPatSynRecSelBinds"><span class="hs-identifier">mkPatSynRecSelBinds</span></a></a><span> </span><a name="local-1628264115"><a href="#local-1628264115"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-1628264116"><a href="#local-1628264116"><span class="hs-identifier">fields</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628264117"><span class="hs-identifier hs-var">mkRecSel</span></a><span> </span><a href="#local-1628264116"><span class="hs-identifier hs-var">fields</span></a><span>
</span><a name="line-554"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-555"></a><span>    </span><a name="local-1628264117"><a href="#local-1628264117"><span class="hs-identifier">mkRecSel</span></a></a><span> </span><a name="local-1628264118"><a href="#local-1628264118"><span class="hs-identifier">fld_lbl</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-556"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="TcTyDecls.html#mkOneRecordSelector"><span class="hs-identifier hs-var">mkOneRecordSelector</span></a><span> </span><span class="hs-special">[</span><a href="ConLike.html#PatSynCon"><span class="hs-identifier hs-var">PatSynCon</span></a><span> </span><a href="#local-1628264115"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="IdInfo.html#RecSelPatSyn"><span class="hs-identifier hs-var">RecSelPatSyn</span></a><span> </span><a href="#local-1628264115"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628264118"><span class="hs-identifier hs-var">fld_lbl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-557"></a><span>        </span><span class="hs-special">(</span><a name="local-1628264119"><a href="#local-1628264119"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-1628264120"><a href="#local-1628264120"><span class="hs-identifier">_rec_flag</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264121"><a href="#local-1628264121"><span class="hs-identifier">binds</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1628264119"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264121"><span class="hs-identifier hs-var">binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-558"></a><span>
</span><a name="line-559"></a><span class="hs-identifier">isUnidirectional</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#HsPatSynDir"><span class="hs-identifier hs-type">HsPatSynDir</span></a><span> </span><a href="#local-1628263907"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-560"></a><a name="isUnidirectional"><a href="TcPatSyn.html#isUnidirectional"><span class="hs-identifier">isUnidirectional</span></a></a><span> </span><a href="HsBinds.html#Unidirectional"><span class="hs-identifier hs-var">Unidirectional</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-561"></a><span class="hs-identifier">isUnidirectional</span><span> </span><a href="HsBinds.html#ImplicitBidirectional"><span class="hs-identifier hs-var">ImplicitBidirectional</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-562"></a><span class="hs-identifier">isUnidirectional</span><span> </span><a href="HsBinds.html#ExplicitBidirectional"><span class="hs-identifier hs-var">ExplicitBidirectional</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-563"></a><span>
</span><a name="line-564"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
         Constructing the &quot;builder&quot; Id
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-571"></a><span>
</span><a name="line-572"></a><span class="hs-identifier">mkPatSynBuilderId</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>  </span><span class="hs-comment">-- True &lt;=&gt; signature provided</span><span>
</span><a name="line-573"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#HsPatSynDir"><span class="hs-identifier hs-type">HsPatSynDir</span></a><span> </span><a href="#local-1628263906"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-574"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span>
</span><a name="line-575"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span>
</span><a name="line-576"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-577"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-578"></a><a name="mkPatSynBuilderId"><a href="TcPatSyn.html#mkPatSynBuilderId"><span class="hs-identifier">mkPatSynBuilderId</span></a></a><span> </span><a name="local-1628264122"><a href="#local-1628264122"><span class="hs-identifier">has_sig</span></a></a><span> </span><a name="local-1628264123"><a href="#local-1628264123"><span class="hs-identifier">dir</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628264124"><a href="#local-1628264124"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-579"></a><span>                  </span><a name="local-1628264125"><a href="#local-1628264125"><span class="hs-identifier">univ_tvs</span></a></a><span> </span><a name="local-1628264126"><a href="#local-1628264126"><span class="hs-identifier">req_theta</span></a></a><span> </span><a name="local-1628264127"><a href="#local-1628264127"><span class="hs-identifier">ex_tvs</span></a></a><span> </span><a name="local-1628264128"><a href="#local-1628264128"><span class="hs-identifier">prov_theta</span></a></a><span>
</span><a name="line-580"></a><span>                  </span><a name="local-1628264129"><a href="#local-1628264129"><span class="hs-identifier">arg_tys</span></a></a><span> </span><a name="local-1628264130"><a href="#local-1628264130"><span class="hs-identifier">pat_ty</span></a></a><span>
</span><a name="line-581"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcPatSyn.html#isUnidirectional"><span class="hs-identifier hs-var">isUnidirectional</span></a><span> </span><a href="#local-1628264123"><span class="hs-identifier hs-var">dir</span></a><span>
</span><a name="line-582"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-583"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-584"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628264131"><a href="#local-1628264131"><span class="hs-identifier">builder_name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="BuildTyCl.html#newImplicitBinder"><span class="hs-identifier hs-var">newImplicitBinder</span></a><span> </span><a href="#local-1628264124"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="OccName.html#mkBuilderOcc"><span class="hs-identifier hs-var">mkBuilderOcc</span></a><span>
</span><a name="line-585"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628264132"><a href="#local-1628264132"><span class="hs-identifier">qtvs</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264125"><span class="hs-identifier hs-var">univ_tvs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628264127"><span class="hs-identifier hs-var">ex_tvs</span></a><span>
</span><a name="line-586"></a><span>             </span><a name="local-1628264133"><a href="#local-1628264133"><span class="hs-identifier">theta</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264126"><span class="hs-identifier hs-var">req_theta</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628264128"><span class="hs-identifier hs-var">prov_theta</span></a><span>
</span><a name="line-587"></a><span>             </span><a name="local-1628264134"><a href="#local-1628264134"><span class="hs-identifier">mk_sigma</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628264122"><span class="hs-identifier hs-var">has_sig</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="TcType.html#mkSpecSigmaTy"><span class="hs-identifier hs-var">mkSpecSigmaTy</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="TcType.html#mkInvSigmaTy"><span class="hs-identifier hs-var">mkInvSigmaTy</span></a><span>
</span><a name="line-588"></a><span>             </span><a name="local-1628264135"><a href="#local-1628264135"><span class="hs-identifier">need_dummy_arg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a><span> </span><a href="#local-1628264130"><span class="hs-identifier hs-var">pat_ty</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628264129"><span class="hs-identifier hs-var">arg_tys</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1628264133"><span class="hs-identifier hs-var">theta</span></a><span>
</span><a name="line-589"></a><span>             </span><a name="local-1628264136"><a href="#local-1628264136"><span class="hs-identifier">builder_sigma</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcPatSyn.html#add_void"><span class="hs-identifier hs-var">add_void</span></a><span> </span><a href="#local-1628264135"><span class="hs-identifier hs-var">need_dummy_arg</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-590"></a><span>                              </span><a href="#local-1628264134"><span class="hs-identifier hs-var">mk_sigma</span></a><span> </span><a href="#local-1628264132"><span class="hs-identifier hs-var">qtvs</span></a><span> </span><a href="#local-1628264133"><span class="hs-identifier hs-var">theta</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkFunTys"><span class="hs-identifier hs-var">mkFunTys</span></a><span> </span><a href="#local-1628264129"><span class="hs-identifier hs-var">arg_tys</span></a><span> </span><a href="#local-1628264130"><span class="hs-identifier hs-var">pat_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-591"></a><span>             </span><a name="local-1628264137"><a href="#local-1628264137"><span class="hs-identifier">builder_id</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#mkExportedVanillaId"><span class="hs-identifier hs-var">mkExportedVanillaId</span></a><span> </span><a href="#local-1628264131"><span class="hs-identifier hs-var">builder_name</span></a><span> </span><a href="#local-1628264136"><span class="hs-identifier hs-var">builder_sigma</span></a><span>
</span><a name="line-592"></a><span>              </span><span class="hs-comment">-- See Note [Exported LocalIds] in Id</span><span>
</span><a name="line-593"></a><span>
</span><a name="line-594"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-1628264137"><span class="hs-identifier hs-var">builder_id</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264135"><span class="hs-identifier hs-var">need_dummy_arg</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-595"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-596"></a><span>
</span><a name="line-597"></a><span class="hs-identifier">add_void</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-598"></a><a name="add_void"><a href="TcPatSyn.html#add_void"><span class="hs-identifier">add_void</span></a></a><span> </span><a name="local-1628264138"><a href="#local-1628264138"><span class="hs-identifier">need_dummy_arg</span></a></a><span> </span><a name="local-1628264139"><a href="#local-1628264139"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-599"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628264138"><span class="hs-identifier hs-var">need_dummy_arg</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a><span> </span><a href="TysPrim.html#voidPrimTy"><span class="hs-identifier hs-var">voidPrimTy</span></a><span> </span><a href="#local-1628264139"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-600"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264139"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-601"></a><span>
</span><a name="line-602"></a><span class="hs-identifier">tcPatSynBuilderBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcSigFun"><span class="hs-identifier hs-type">TcSigFun</span></a><span>
</span><a name="line-603"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsBinds.html#PatSynBind"><span class="hs-identifier hs-type">PatSynBind</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-604"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsBinds.html#LHsBinds"><span class="hs-identifier hs-type">LHsBinds</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span>
</span><a name="line-605"></a><span class="hs-comment">-- See Note [Matchers and builders for pattern synonyms] in PatSyn</span><span>
</span><a name="line-606"></a><a name="tcPatSynBuilderBind"><a href="TcPatSyn.html#tcPatSynBuilderBind"><span class="hs-identifier">tcPatSynBuilderBind</span></a></a><span> </span><a name="local-1628264140"><a href="#local-1628264140"><span class="hs-identifier">sig_fun</span></a></a><span> </span><a href="HsBinds.html#PSB"><span class="hs-identifier hs-var">PSB</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">psb_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628264141"><a href="#local-1628264141"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628264142"><a href="#local-1628264142"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_def</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628264143"><a href="#local-1628264143"><span class="hs-identifier">lpat</span></a></a><span>
</span><a name="line-607"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_dir</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628264144"><a href="#local-1628264144"><span class="hs-identifier">dir</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">psb_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628264145"><a href="#local-1628264145"><span class="hs-identifier">details</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-608"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcPatSyn.html#isUnidirectional"><span class="hs-identifier hs-var">isUnidirectional</span></a><span> </span><a href="#local-1628264144"><span class="hs-identifier hs-var">dir</span></a><span>
</span><a name="line-609"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span>
</span><a name="line-610"></a><span>
</span><a name="line-611"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isNothing"><span class="hs-identifier hs-var">isNothing</span></a><span> </span><a href="#local-1628264147"><span class="hs-identifier hs-var">mb_match_group</span></a><span>       </span><span class="hs-comment">-- Can't invert the pattern</span><span>
</span><a name="line-612"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-1628264143"><span class="hs-identifier hs-var">lpat</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcRnMonad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-613"></a><span>    </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Right-hand side of bidirectional pattern synonym cannot be used as an expression&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-614"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264143"><span class="hs-identifier hs-var">lpat</span></a><span class="hs-special">)</span><span>
</span><a name="line-615"></a><span>
</span><a name="line-616"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>  </span><span class="hs-comment">-- Bidirectional</span><span>
</span><a name="line-617"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628264167"><a href="#local-1628264167"><span class="hs-identifier">patsyn</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcEnv.html#tcLookupPatSyn"><span class="hs-identifier hs-var">tcLookupPatSyn</span></a><span> </span><a href="#local-1628264142"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-618"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;tcPatSynBuilderBind {&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264167"><span class="hs-identifier hs-var">patsyn</span></a><span>
</span><a name="line-619"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628264168"><a href="#local-1628264168"><span class="hs-identifier">builder_id</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264169"><a href="#local-1628264169"><span class="hs-identifier">need_dummy_arg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="PatSyn.html#patSynBuilder"><span class="hs-identifier hs-var">patSynBuilder</span></a><span> </span><a href="#local-1628264167"><span class="hs-identifier hs-var">patsyn</span></a><span>
</span><a name="line-620"></a><span>                   </span><span class="hs-comment">-- Bidirectional, so patSynBuilder returns Just</span><span>
</span><a name="line-621"></a><span>
</span><a name="line-622"></a><span>             </span><a name="local-1628264170"><a href="#local-1628264170"><span class="hs-identifier">match_group'</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628264169"><span class="hs-identifier hs-var">need_dummy_arg</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264150"><span class="hs-identifier hs-var">add_dummy_arg</span></a><span> </span><a href="#local-1628264146"><span class="hs-identifier hs-var">match_group</span></a><span>
</span><a name="line-623"></a><span>                          </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264146"><span class="hs-identifier hs-var">match_group</span></a><span>
</span><a name="line-624"></a><span>
</span><a name="line-625"></a><span>             </span><a name="local-1628264171"><a href="#local-1628264171"><span class="hs-identifier">bind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsBinds.html#FunBind"><span class="hs-identifier hs-var">FunBind</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fun_id</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628264141"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idName"><span class="hs-identifier hs-var">idName</span></a><span> </span><a href="#local-1628264168"><span class="hs-identifier hs-var">builder_id</span></a><span class="hs-special">)</span><span>
</span><a name="line-626"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_matches</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264170"><span class="hs-identifier hs-var">match_group'</span></a><span>
</span><a name="line-627"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_co_fn</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcEvidence.html#idHsWrapper"><span class="hs-identifier hs-var">idHsWrapper</span></a><span>
</span><a name="line-628"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">bind_fvs</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="PlaceHolder.html#placeHolderNamesTc"><span class="hs-identifier hs-var">placeHolderNamesTc</span></a><span>
</span><a name="line-629"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fun_tick</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-630"></a><span>
</span><a name="line-631"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-1628264172"><a href="#local-1628264172"><span class="hs-identifier">sig</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcPatSyn.html#get_builder_sig"><span class="hs-identifier hs-var">get_builder_sig</span></a><span> </span><a href="#local-1628264140"><span class="hs-identifier hs-var">sig_fun</span></a><span> </span><a href="#local-1628264142"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-1628264168"><span class="hs-identifier hs-var">builder_id</span></a><span> </span><a href="#local-1628264169"><span class="hs-identifier hs-var">need_dummy_arg</span></a><span>
</span><a name="line-632"></a><span>
</span><a name="line-633"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-1628264173"><a href="#local-1628264173"><span class="hs-identifier">builder_binds</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcBinds.html#tcPolyCheck"><span class="hs-identifier hs-var">tcPolyCheck</span></a><span> </span><a href="BasicTypes.html#NonRecursive"><span class="hs-identifier hs-var">NonRecursive</span></a><span> </span><a href="TcPat.html#emptyPragEnv"><span class="hs-identifier hs-var">emptyPragEnv</span></a><span> </span><a href="#local-1628264172"><span class="hs-identifier hs-var">sig</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-1628264171"><span class="hs-identifier hs-var">bind</span></a><span class="hs-special">)</span><span>
</span><a name="line-634"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceTc"><span class="hs-identifier hs-var">traceTc</span></a><span> </span><span class="hs-string">&quot;tcPatSynBuilderBind }&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264173"><span class="hs-identifier hs-var">builder_binds</span></a><span>
</span><a name="line-635"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-1628264173"><span class="hs-identifier hs-var">builder_binds</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-636"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-637"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628264146"><a href="#local-1628264146"><span class="hs-identifier">match_group</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264147"><span class="hs-identifier hs-var">mb_match_group</span></a><span>
</span><a name="line-638"></a><span>    </span><a name="local-1628264147"><a href="#local-1628264147"><span class="hs-identifier">mb_match_group</span></a></a><span>
</span><a name="line-639"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628264144"><span class="hs-identifier hs-var">dir</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-640"></a><span>           </span><a href="HsBinds.html#Unidirectional"><span class="hs-identifier hs-var">Unidirectional</span></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-641"></a><span>           </span><a href="HsBinds.html#ExplicitBidirectional"><span class="hs-identifier hs-var">ExplicitBidirectional</span></a><span> </span><a name="local-1628264151"><a href="#local-1628264151"><span class="hs-identifier">explicit_mg</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-1628264151"><span class="hs-identifier hs-var">explicit_mg</span></a><span>
</span><a name="line-642"></a><span>           </span><a href="HsBinds.html#ImplicitBidirectional"><span class="hs-identifier hs-var">ImplicitBidirectional</span></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="#local-1628264148"><span class="hs-identifier hs-var">mk_mg</span></a><span> </span><span class="hs-special">(</span><a href="TcPatSyn.html#tcPatToExpr"><span class="hs-identifier hs-var">tcPatToExpr</span></a><span> </span><a href="#local-1628264149"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-1628264143"><span class="hs-identifier hs-var">lpat</span></a><span class="hs-special">)</span><span>
</span><a name="line-643"></a><span>
</span><a name="line-644"></a><span>    </span><span class="hs-identifier">mk_mg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#MatchGroup"><span class="hs-identifier hs-type">MatchGroup</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-645"></a><span>    </span><a name="local-1628264148"><a href="#local-1628264148"><span class="hs-identifier">mk_mg</span></a></a><span> </span><a name="local-1628264152"><a href="#local-1628264152"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkMatchGroupName"><span class="hs-identifier hs-var">mkMatchGroupName</span></a><span> </span><a href="BasicTypes.html#Generated"><span class="hs-identifier hs-var">Generated</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628264154"><span class="hs-identifier hs-var">builder_match</span></a><span class="hs-special">]</span><span>
</span><a name="line-646"></a><span>             </span><span class="hs-keyword">where</span><span>
</span><a name="line-647"></a><span>               </span><a name="local-1628264153"><a href="#local-1628264153"><span class="hs-identifier">builder_args</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628264155"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#VarPat"><span class="hs-identifier hs-var">VarPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628264155"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-1628264156"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628264155"><a href="#local-1628264155"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628264156"><a href="#local-1628264156"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628264149"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">]</span><span>
</span><a name="line-648"></a><span>               </span><a name="local-1628264154"><a href="#local-1628264154"><span class="hs-identifier">builder_match</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsUtils.html#mkMatch"><span class="hs-identifier hs-var">mkMatch</span></a><span> </span><a href="#local-1628264153"><span class="hs-identifier hs-var">builder_args</span></a><span> </span><a href="#local-1628264152"><span class="hs-identifier hs-var">body</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="HsBinds.html#EmptyLocalBinds"><span class="hs-identifier hs-var">EmptyLocalBinds</span></a><span class="hs-special">)</span><span>
</span><a name="line-649"></a><span>
</span><a name="line-650"></a><span>    </span><a name="local-1628264149"><a href="#local-1628264149"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628264145"><span class="hs-identifier hs-var">details</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-651"></a><span>              </span><a href="HsBinds.html#PrefixPatSyn"><span class="hs-identifier hs-var">PrefixPatSyn</span></a><span> </span><a name="local-1628264157"><a href="#local-1628264157"><span class="hs-identifier">args</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628264157"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-652"></a><span>              </span><a href="HsBinds.html#InfixPatSyn"><span class="hs-identifier hs-var">InfixPatSyn</span></a><span> </span><a name="local-1628264158"><a href="#local-1628264158"><span class="hs-identifier">arg1</span></a></a><span> </span><a name="local-1628264159"><a href="#local-1628264159"><span class="hs-identifier">arg2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1628264158"><span class="hs-identifier hs-var">arg1</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264159"><span class="hs-identifier hs-var">arg2</span></a><span class="hs-special">]</span><span>
</span><a name="line-653"></a><span>              </span><a href="HsBinds.html#RecordPatSyn"><span class="hs-identifier hs-var">RecordPatSyn</span></a><span> </span><a name="local-1628264160"><a href="#local-1628264160"><span class="hs-identifier">args</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-identifier">recordPatSynPatVar</span><span> </span><a href="#local-1628264160"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-654"></a><span>
</span><a name="line-655"></a><span>    </span><span class="hs-identifier">add_dummy_arg</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#MatchGroup"><span class="hs-identifier hs-type">MatchGroup</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-656"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#MatchGroup"><span class="hs-identifier hs-type">MatchGroup</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-657"></a><span>    </span><a name="local-1628264150"><a href="#local-1628264150"><span class="hs-identifier">add_dummy_arg</span></a></a><span> </span><a name="local-1628264161"><a href="#local-1628264161"><span class="hs-identifier">mg</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsExpr.html#MG"><span class="hs-identifier hs-var">MG</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span>
</span><a name="line-658"></a><span>                            </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628264162"><a href="#local-1628264162"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628264163"><a href="#local-1628264163"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><a href="HsExpr.html#NonFunBindMatch"><span class="hs-identifier hs-var">NonFunBindMatch</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-1628264164"><a href="#local-1628264164"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-1628264165"><a href="#local-1628264165"><span class="hs-identifier">grhss</span></a></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-659"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264161"><span class="hs-identifier hs-var">mg</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span>
</span><a name="line-660"></a><span>                </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628264162"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628264163"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><a href="HsExpr.html#NonFunBindMatch"><span class="hs-identifier hs-var">NonFunBindMatch</span></a><span> </span><span class="hs-special">[</span><a href="HsUtils.html#nlWildPatName"><span class="hs-identifier hs-var">nlWildPatName</span></a><span class="hs-special">]</span><span> </span><a href="#local-1628264164"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-1628264165"><span class="hs-identifier hs-var">grhss</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-661"></a><span>    </span><span class="hs-identifier">add_dummy_arg</span><span> </span><a name="local-1628264166"><a href="#local-1628264166"><span class="hs-identifier">other_mg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;add_dummy_arg&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-662"></a><span>                             </span><a href="HsExpr.html#pprMatches"><span class="hs-identifier hs-var">pprMatches</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#PatSyn"><span class="hs-identifier hs-var">PatSyn</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsMatchContext"><span class="hs-identifier hs-type">HsMatchContext</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628264166"><span class="hs-identifier hs-var">other_mg</span></a><span>
</span><a name="line-663"></a><span>
</span><a name="line-664"></a><span class="hs-identifier">get_builder_sig</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TcSigFun"><span class="hs-identifier hs-type">TcSigFun</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="TcRnTypes.html#TcIdSigInfo"><span class="hs-identifier hs-type">TcIdSigInfo</span></a><span>
</span><a name="line-665"></a><a name="get_builder_sig"><a href="TcPatSyn.html#get_builder_sig"><span class="hs-identifier">get_builder_sig</span></a></a><span> </span><a name="local-1628264174"><a href="#local-1628264174"><span class="hs-identifier">sig_fun</span></a></a><span> </span><a name="local-1628264175"><a href="#local-1628264175"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-1628264176"><a href="#local-1628264176"><span class="hs-identifier">builder_id</span></a></a><span> </span><a name="local-1628264177"><a href="#local-1628264177"><span class="hs-identifier">need_dummy_arg</span></a></a><span>
</span><a name="line-666"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TcPatSynSig"><span class="hs-identifier hs-var">TcPatSynSig</span></a><span> </span><a name="local-1628264178"><a href="#local-1628264178"><span class="hs-identifier">sig</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628264174"><span class="hs-identifier hs-var">sig_fun</span></a><span> </span><a href="#local-1628264175"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-667"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="TcRnTypes.html#TPSI"><span class="hs-identifier hs-var">TPSI</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">patsig_univ_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628264179"><a href="#local-1628264179"><span class="hs-identifier">univ_tvs</span></a></a><span>
</span><a name="line-668"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">patsig_req</span><span>      </span><span class="hs-glyph">=</span><span> </span><a name="local-1628264180"><a href="#local-1628264180"><span class="hs-identifier">req</span></a></a><span>
</span><a name="line-669"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">patsig_ex_tvs</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-1628264181"><a href="#local-1628264181"><span class="hs-identifier">ex_tvs</span></a></a><span>
</span><a name="line-670"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">patsig_prov</span><span>     </span><span class="hs-glyph">=</span><span> </span><a name="local-1628264182"><a href="#local-1628264182"><span class="hs-identifier">prov</span></a></a><span>
</span><a name="line-671"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">patsig_arg_tys</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-1628264183"><a href="#local-1628264183"><span class="hs-identifier">arg_tys</span></a></a><span>
</span><a name="line-672"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">patsig_body_ty</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-1628264184"><a href="#local-1628264184"><span class="hs-identifier">body_ty</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628264178"><span class="hs-identifier hs-var">sig</span></a><span>
</span><a name="line-673"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- Constuct a TcIdSigInfo from a TcPatSynInfo</span><span>
</span><a name="line-674"></a><span>    </span><span class="hs-comment">-- This does unfortunately mean that we have to know how to</span><span>
</span><a name="line-675"></a><span>    </span><span class="hs-comment">-- make the builder Id's type from the TcPatSynInfo, which</span><span>
</span><a name="line-676"></a><span>    </span><span class="hs-comment">-- duplicates the construction in mkPatSynBuilderId</span><span>
</span><a name="line-677"></a><span>    </span><span class="hs-comment">-- But we really want to use the scoped type variables from</span><span>
</span><a name="line-678"></a><span>    </span><span class="hs-comment">-- the actual sigature, so this is really the Right Thing</span><span>
</span><a name="line-679"></a><span>    </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#TISI"><span class="hs-identifier hs-var">TISI</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">sig_bndr</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#CompleteSig"><span class="hs-identifier hs-var">CompleteSig</span></a><span> </span><a href="#local-1628264176"><span class="hs-identifier hs-var">builder_id</span></a><span>
</span><a name="line-680"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sig_skols</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Var.html#tyVarName"><span class="hs-identifier hs-var">tyVarName</span></a><span> </span><a href="#local-1628264185"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264185"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-1628264185"><a href="#local-1628264185"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628264179"><span class="hs-identifier hs-var">univ_tvs</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628264181"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">]</span><span>
</span><a name="line-681"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sig_theta</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264180"><span class="hs-identifier hs-var">req</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-1628264182"><span class="hs-identifier hs-var">prov</span></a><span>
</span><a name="line-682"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sig_tau</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TcPatSyn.html#add_void"><span class="hs-identifier hs-var">add_void</span></a><span> </span><a href="#local-1628264177"><span class="hs-identifier hs-var">need_dummy_arg</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-683"></a><span>                               </span><a href="TyCoRep.html#mkFunTys"><span class="hs-identifier hs-var">mkFunTys</span></a><span> </span><a href="#local-1628264183"><span class="hs-identifier hs-var">arg_tys</span></a><span> </span><a href="#local-1628264184"><span class="hs-identifier hs-var">body_ty</span></a><span>
</span><a name="line-684"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sig_ctxt</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcType.html#PatSynCtxt"><span class="hs-identifier hs-var">PatSynCtxt</span></a><span> </span><a href="#local-1628264175"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-685"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sig_loc</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#getSrcSpan"><span class="hs-identifier hs-var">getSrcSpan</span></a><span> </span><a href="#local-1628264175"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-686"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-687"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- No signature, so fake up a TcIdSigInfo from the builder Id</span><span>
</span><a name="line-688"></a><span>    </span><a href="TcBinds.html#instTcTySigFromId"><span class="hs-identifier hs-var">instTcTySigFromId</span></a><span> </span><a href="#local-1628264176"><span class="hs-identifier hs-var">builder_id</span></a><span>
</span><a name="line-689"></a><span>    </span><span class="hs-comment">-- See Note [Redundant constraints for builder]</span><span>
</span><a name="line-690"></a><span>
</span><a name="line-691"></a><span class="hs-identifier">tcPatSynBuilderOcc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="PatSyn.html#PatSyn"><span class="hs-identifier hs-type">PatSyn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="TcRnTypes.html#TcId"><span class="hs-identifier hs-type">TcId</span></a><span class="hs-special">,</span><span> </span><a href="TcType.html#TcSigmaType"><span class="hs-identifier hs-type">TcSigmaType</span></a><span class="hs-special">)</span><span>
</span><a name="line-692"></a><span class="hs-comment">-- monadic only for failure</span><span>
</span><a name="line-693"></a><a name="tcPatSynBuilderOcc"><a href="TcPatSyn.html#tcPatSynBuilderOcc"><span class="hs-identifier">tcPatSynBuilderOcc</span></a></a><span> </span><a name="local-1628264186"><a href="#local-1628264186"><span class="hs-identifier">ps</span></a></a><span>
</span><a name="line-694"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-1628264189"><a href="#local-1628264189"><span class="hs-identifier">builder_id</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1628264190"><a href="#local-1628264190"><span class="hs-identifier">add_void_arg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1628264188"><span class="hs-identifier hs-var">builder</span></a><span>
</span><a name="line-695"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-1628264191"><a href="#local-1628264191"><span class="hs-identifier">builder_expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-1628264189"><span class="hs-identifier hs-var">builder_id</span></a><span class="hs-special">)</span><span>
</span><a name="line-696"></a><span>        </span><a name="local-1628264192"><a href="#local-1628264192"><span class="hs-identifier">builder_ty</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-1628264189"><span class="hs-identifier hs-var">builder_id</span></a><span>
</span><a name="line-697"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-698"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-1628264190"><span class="hs-identifier hs-var">add_void_arg</span></a><span>
</span><a name="line-699"></a><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span> </span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628264191"><span class="hs-identifier hs-var">builder_expr</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsUtils.html#nlHsVar"><span class="hs-identifier hs-var">nlHsVar</span></a><span> </span><a href="MkId.html#voidPrimId"><span class="hs-identifier hs-var">voidPrimId</span></a><span class="hs-special">)</span><span>
</span><a name="line-700"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="TcType.html#tcFunResultTy"><span class="hs-identifier hs-var">tcFunResultTy</span></a><span> </span><a href="#local-1628264192"><span class="hs-identifier hs-var">builder_ty</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-701"></a><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-1628264191"><span class="hs-identifier hs-var">builder_expr</span></a><span class="hs-special">,</span><span> </span><a href="#local-1628264192"><span class="hs-identifier hs-var">builder_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-702"></a><span>
</span><a name="line-703"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>  </span><span class="hs-comment">-- Unidirectional</span><span>
</span><a name="line-704"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcPatSyn.html#nonBidirectionalErr"><span class="hs-identifier hs-var">nonBidirectionalErr</span></a><span> </span><a href="#local-1628264187"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-705"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-706"></a><span>    </span><a name="local-1628264187"><a href="#local-1628264187"><span class="hs-identifier">name</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="PatSyn.html#patSynName"><span class="hs-identifier hs-var">patSynName</span></a><span> </span><a href="#local-1628264186"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-707"></a><span>    </span><a name="local-1628264188"><a href="#local-1628264188"><span class="hs-identifier">builder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="PatSyn.html#patSynBuilder"><span class="hs-identifier hs-var">patSynBuilder</span></a><span> </span><a href="#local-1628264186"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-708"></a><span>
</span><a name="line-709"></a><span class="hs-comment">{-
Note [Redundant constraints for builder]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The builder can have redundant constraints, which are awkard to eliminate.
Consider
   pattern P = Just 34
To match against this pattern we need (Eq a, Num a).  But to build
(Just 34) we need only (Num a).  Fortunately instTcSigFromId sets
sig_warn_redundant to False.

************************************************************************
*                                                                      *
         Helper functions
*                                                                      *
************************************************************************

Note [As-patterns in pattern synonym definitions]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The rationale for rejecting as-patterns in pattern synonym definitions
is that an as-pattern would introduce nonindependent pattern synonym
arguments, e.g. given a pattern synonym like:

        pattern K x y = x@(Just y)

one could write a nonsensical function like

        f (K Nothing x) = ...

or
        g (K (Just True) False) = ...

Note [Type signatures and the builder expression]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider
   pattern L x = Left x :: Either [a] [b]

In tc{Infer/Check}PatSynDecl we will check that the pattern has the
specified type.  We check the pattern *as a pattern*, so the type
signature is a pattern signature, and so brings 'a' and 'b' into
scope.  But we don't have a way to bind 'a, b' in the LHS, as we do
'x', say.  Nevertheless, the sigature may be useful to constrain
the type.

When making the binding for the *builder*, though, we don't want
  $buildL x = Left x :: Either [a] [b]
because that wil either mean (forall a b. Either [a] [b]), or we'll
get a complaint that 'a' and 'b' are out of scope. (Actually the
latter; Trac #9867.)  No, the job of the signature is done, so when
converting the pattern to an expression (for the builder RHS) we
simply discard the signature.

Note [Record PatSyn Desugaring]
-------------------------------
It is important that prov_theta comes before req_theta as this ordering is used
when desugaring record pattern synonym updates.

Any change to this ordering should make sure to change deSugar/DsExpr.hs if you
want to avoid difficult to decipher core lint errors!
 -}</span><span>
</span><a name="line-768"></a><span>
</span><a name="line-769"></a><span class="hs-identifier">tcCheckPatSynPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-770"></a><a name="tcCheckPatSynPat"><a href="TcPatSyn.html#tcCheckPatSynPat"><span class="hs-identifier">tcCheckPatSynPat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264193"><span class="hs-identifier hs-var">go</span></a><span>
</span><a name="line-771"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-772"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-773"></a><span>    </span><a name="local-1628264193"><a href="#local-1628264193"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#addLocM"><span class="hs-identifier hs-var">addLocM</span></a><span> </span><a href="#local-1628264194"><span class="hs-identifier hs-var">go1</span></a><span>
</span><a name="line-774"></a><span>
</span><a name="line-775"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-776"></a><span>    </span><a name="local-1628264194"><a href="#local-1628264194"><span class="hs-identifier">go1</span></a></a><span>   </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628264195"><a href="#local-1628264195"><span class="hs-identifier">info</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><a href="#local-1628264193"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#hsConPatArgs"><span class="hs-identifier hs-var">hsConPatArgs</span></a><span> </span><a href="#local-1628264195"><span class="hs-identifier hs-var">info</span></a><span class="hs-special">)</span><span>
</span><a name="line-777"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><a href="HsPat.html#VarPat"><span class="hs-identifier hs-var">VarPat</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-778"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><a href="HsPat.html#WildPat"><span class="hs-identifier hs-var">WildPat</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-779"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><a name="local-1628264196"><a href="#local-1628264196"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsPat.html#AsPat"><span class="hs-identifier hs-var">AsPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="TcPatSyn.html#asPatInPatSynErr"><span class="hs-identifier hs-var">asPatInPatSynErr</span></a><span> </span><a href="#local-1628264196"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-780"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#LazyPat"><span class="hs-identifier hs-var">LazyPat</span></a><span> </span><a name="local-1628264197"><a href="#local-1628264197"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264193"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264197"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-781"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><a name="local-1628264198"><a href="#local-1628264198"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264193"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264198"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-782"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#BangPat"><span class="hs-identifier hs-var">BangPat</span></a><span> </span><a name="local-1628264199"><a href="#local-1628264199"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264193"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264199"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-783"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#PArrPat"><span class="hs-identifier hs-var">PArrPat</span></a><span> </span><a name="local-1628264200"><a href="#local-1628264200"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><a href="#local-1628264193"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264200"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-784"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><a name="local-1628264201"><a href="#local-1628264201"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><a href="#local-1628264193"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264201"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-785"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><a name="local-1628264202"><a href="#local-1628264202"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><a href="#local-1628264193"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264202"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-786"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><a href="HsPat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-787"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><a href="HsPat.html#NPat"><span class="hs-identifier hs-var">NPat</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-788"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#SigPatIn"><span class="hs-identifier hs-var">SigPatIn</span></a><span> </span><a name="local-1628264203"><a href="#local-1628264203"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264193"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264203"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-789"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#ViewPat"><span class="hs-identifier hs-var">ViewPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628264204"><a href="#local-1628264204"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264193"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264204"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-790"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><a name="local-1628264205"><a href="#local-1628264205"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><a href="HsPat.html#SplicePat"><span class="hs-identifier hs-var">SplicePat</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="TcPatSyn.html#thInPatSynErr"><span class="hs-identifier hs-var">thInPatSynErr</span></a><span> </span><a href="#local-1628264205"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-791"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><a name="local-1628264206"><a href="#local-1628264206"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><a href="HsPat.html#NPlusKPat"><span class="hs-identifier hs-var">NPlusKPat</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="TcPatSyn.html#nPlusKPatInPatSynErr"><span class="hs-identifier hs-var">nPlusKPatInPatSynErr</span></a><span> </span><a href="#local-1628264206"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-792"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><a href="HsPat.html#ConPatOut"><span class="hs-identifier hs-var">ConPatOut</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;ConPatOut in output of renamer&quot;</span><span>
</span><a name="line-793"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><a href="HsPat.html#SigPatOut"><span class="hs-identifier hs-var">SigPatOut</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;SigPatOut in output of renamer&quot;</span><span>
</span><a name="line-794"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><a href="HsPat.html#CoPat"><span class="hs-identifier hs-var">CoPat</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;CoPat in output of renamer&quot;</span><span>
</span><a name="line-795"></a><span>
</span><a name="line-796"></a><span class="hs-identifier">asPatInPatSynErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#OutputableBndr"><span class="hs-identifier hs-type">OutputableBndr</span></a><span> </span><a href="#local-1628263904"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="#local-1628263904"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="#local-1628263905"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-797"></a><a name="asPatInPatSynErr"><a href="TcPatSyn.html#asPatInPatSynErr"><span class="hs-identifier">asPatInPatSynErr</span></a></a><span> </span><a name="local-1628264207"><a href="#local-1628264207"><span class="hs-identifier">pat</span></a></a><span>
</span><a name="line-798"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-799"></a><span>    </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Pattern synonym definition cannot contain as-patterns (@):&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-800"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264207"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span>
</span><a name="line-801"></a><span>
</span><a name="line-802"></a><span class="hs-identifier">thInPatSynErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#OutputableBndr"><span class="hs-identifier hs-type">OutputableBndr</span></a><span> </span><a href="#local-1628263902"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="#local-1628263902"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="#local-1628263903"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-803"></a><a name="thInPatSynErr"><a href="TcPatSyn.html#thInPatSynErr"><span class="hs-identifier">thInPatSynErr</span></a></a><span> </span><a name="local-1628264208"><a href="#local-1628264208"><span class="hs-identifier">pat</span></a></a><span>
</span><a name="line-804"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-805"></a><span>    </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Pattern synonym definition cannot contain Template Haskell:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-806"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264208"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span>
</span><a name="line-807"></a><span>
</span><a name="line-808"></a><span class="hs-identifier">nPlusKPatInPatSynErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#OutputableBndr"><span class="hs-identifier hs-type">OutputableBndr</span></a><span> </span><a href="#local-1628263900"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="#local-1628263900"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="#local-1628263901"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-809"></a><a name="nPlusKPatInPatSynErr"><a href="TcPatSyn.html#nPlusKPatInPatSynErr"><span class="hs-identifier">nPlusKPatInPatSynErr</span></a></a><span> </span><a name="local-1628264209"><a href="#local-1628264209"><span class="hs-identifier">pat</span></a></a><span>
</span><a name="line-810"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-811"></a><span>    </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Pattern synonym definition cannot contain n+k-pattern:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-812"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264209"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">)</span><span>
</span><a name="line-813"></a><span>
</span><a name="line-814"></a><span class="hs-identifier">nonBidirectionalErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-1628263898"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1628263898"><span class="hs-identifier hs-type">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><a href="#local-1628263899"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-815"></a><a name="nonBidirectionalErr"><a href="TcPatSyn.html#nonBidirectionalErr"><span class="hs-identifier">nonBidirectionalErr</span></a></a><span> </span><a name="local-1628264210"><a href="#local-1628264210"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#failWithTc"><span class="hs-identifier hs-var">failWithTc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-816"></a><span>    </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;non-bidirectional pattern synonym&quot;</span><span>
</span><a name="line-817"></a><span>    </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264210"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;used in an expression&quot;</span><span>
</span><a name="line-818"></a><span>
</span><a name="line-819"></a><span class="hs-identifier">tcPatToExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-820"></a><a name="tcPatToExpr"><a href="TcPatSyn.html#tcPatToExpr"><span class="hs-identifier">tcPatToExpr</span></a></a><span> </span><a name="local-1628264211"><a href="#local-1628264211"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264213"><span class="hs-identifier hs-var">go</span></a><span>
</span><a name="line-821"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-822"></a><span>    </span><a name="local-1628264212"><a href="#local-1628264212"><span class="hs-identifier">lhsVars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-1628264211"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-823"></a><span>
</span><a name="line-824"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-825"></a><span>    </span><a name="local-1628264213"><a href="#local-1628264213"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628264217"><a href="#local-1628264217"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><a name="local-1628264218"><a href="#local-1628264218"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-1628264219"><a href="#local-1628264219"><span class="hs-identifier">info</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-826"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-1628264219"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-827"></a><span>          </span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><a name="local-1628264220"><a href="#local-1628264220"><span class="hs-identifier">ps</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628264214"><span class="hs-identifier hs-var">mkPrefixConExpr</span></a><span> </span><a href="#local-1628264218"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-1628264220"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-828"></a><span>          </span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a name="local-1628264221"><a href="#local-1628264221"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628264222"><a href="#local-1628264222"><span class="hs-identifier">r</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1628264214"><span class="hs-identifier hs-var">mkPrefixConExpr</span></a><span> </span><a href="#local-1628264218"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-special">[</span><a href="#local-1628264221"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><a href="#local-1628264222"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-829"></a><span>          </span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span> </span><a name="local-1628264223"><a href="#local-1628264223"><span class="hs-identifier">fields</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628264217"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1628264215"><span class="hs-identifier hs-var">mkRecordConExpr</span></a><span> </span><a href="#local-1628264218"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-1628264223"><span class="hs-identifier hs-var">fields</span></a><span>
</span><a name="line-830"></a><span>
</span><a name="line-831"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SigPatIn"><span class="hs-identifier hs-var">SigPatIn</span></a><span> </span><a name="local-1628264224"><a href="#local-1628264224"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264213"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264224"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-832"></a><span>        </span><span class="hs-comment">-- See Note [Type signatures and the builder expression]</span><span>
</span><a name="line-833"></a><span>
</span><a name="line-834"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628264225"><a href="#local-1628264225"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-1628264226"><a href="#local-1628264226"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628264225"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-1628264216"><span class="hs-identifier hs-var">go1</span></a><span> </span><a href="#local-1628264226"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-835"></a><span>
</span><a name="line-836"></a><span>    </span><span class="hs-comment">-- Make a prefix con for prefix and infix patterns for simplicity</span><span>
</span><a name="line-837"></a><span>    </span><span class="hs-identifier">mkPrefixConExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-838"></a><span>    </span><a name="local-1628264214"><a href="#local-1628264214"><span class="hs-identifier">mkPrefixConExpr</span></a></a><span> </span><a name="local-1628264227"><a href="#local-1628264227"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-1628264228"><a href="#local-1628264228"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-839"></a><span>      </span><a name="local-1628264229"><a href="#local-1628264229"><span class="hs-identifier">exprs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#traverse"><span class="hs-identifier hs-var">traverse</span></a><span> </span><a href="#local-1628264213"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264228"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-840"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1628264230"><a href="#local-1628264230"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1628264231"><a href="#local-1628264231"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#combineLocs"><span class="hs-identifier hs-var">combineLocs</span></a><span> </span><a href="#local-1628264230"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1628264231"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><a href="#local-1628264230"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1628264231"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-841"></a><span>                     </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-1628264227"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><a href="#local-1628264227"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-842"></a><span>                     </span><a href="#local-1628264229"><span class="hs-identifier hs-var">exprs</span></a><span>
</span><a name="line-843"></a><span>
</span><a name="line-844"></a><span>
</span><a name="line-845"></a><span>    </span><span class="hs-identifier">mkRecordConExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-type">HsRecFields</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-846"></a><span>    </span><a name="local-1628264215"><a href="#local-1628264215"><span class="hs-identifier">mkRecordConExpr</span></a></a><span> </span><a name="local-1628264232"><a href="#local-1628264232"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-1628264233"><a href="#local-1628264233"><span class="hs-identifier">fields</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-847"></a><span>      </span><a name="local-1628264234"><a href="#local-1628264234"><span class="hs-identifier">exprFields</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#traverse"><span class="hs-identifier hs-var">traverse</span></a><span> </span><a href="#local-1628264213"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264233"><span class="hs-identifier hs-var">fields</span></a><span>
</span><a name="line-848"></a><span>      </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsExpr.html#RecordCon"><span class="hs-identifier hs-var">RecordCon</span></a><span> </span><a href="#local-1628264232"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="PlaceHolder.html#PlaceHolder"><span class="hs-identifier hs-var">PlaceHolder</span></a><span> </span><a href="HsExpr.html#noPostTcExpr"><span class="hs-identifier hs-var">noPostTcExpr</span></a><span> </span><a href="#local-1628264234"><span class="hs-identifier hs-var">exprFields</span></a><span>
</span><a name="line-849"></a><span>
</span><a name="line-850"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-851"></a><span>    </span><a name="local-1628264216"><a href="#local-1628264216"><span class="hs-identifier">go1</span></a></a><span>   </span><span class="hs-special">(</span><a href="HsPat.html#VarPat"><span class="hs-identifier hs-var">VarPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1628264235"><a href="#local-1628264235"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-1628264236"><a href="#local-1628264236"><span class="hs-identifier">var</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-852"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-1628264236"><span class="hs-identifier hs-var">var</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#elemNameSet"><span class="hs-identifier hs-var">elemNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628264212"><span class="hs-identifier hs-var">lhsVars</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-1628264235"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-1628264236"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span>
</span><a name="line-853"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-854"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#LazyPat"><span class="hs-identifier hs-var">LazyPat</span></a><span> </span><a name="local-1628264237"><a href="#local-1628264237"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="HsExpr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628264213"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264237"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-855"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><a name="local-1628264238"><a href="#local-1628264238"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="HsExpr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628264213"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264238"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-856"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#BangPat"><span class="hs-identifier hs-var">BangPat</span></a><span> </span><a name="local-1628264239"><a href="#local-1628264239"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="HsExpr.html#HsPar"><span class="hs-identifier hs-var">HsPar</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628264213"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264239"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-857"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#PArrPat"><span class="hs-identifier hs-var">PArrPat</span></a><span> </span><a name="local-1628264240"><a href="#local-1628264240"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-1628264241"><a href="#local-1628264241"><span class="hs-identifier">ptt</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628264242"><a href="#local-1628264242"><span class="hs-identifier">exprs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-1628264213"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264240"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-858"></a><span>                                           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsExpr.html#ExplicitPArr"><span class="hs-identifier hs-var">ExplicitPArr</span></a><span> </span><a href="#local-1628264241"><span class="hs-identifier hs-var">ptt</span></a><span> </span><a href="#local-1628264242"><span class="hs-identifier hs-var">exprs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-859"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><a name="local-1628264243"><a href="#local-1628264243"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-1628264244"><a href="#local-1628264244"><span class="hs-identifier">ptt</span></a></a><span> </span><a name="local-1628264245"><a href="#local-1628264245"><span class="hs-identifier">reb</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628264246"><a href="#local-1628264246"><span class="hs-identifier">exprs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-1628264213"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264243"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-860"></a><span>                                           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsExpr.html#ExplicitList"><span class="hs-identifier hs-var">ExplicitList</span></a><span> </span><a href="#local-1628264244"><span class="hs-identifier hs-var">ptt</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><a href="#local-1628264245"><span class="hs-identifier hs-var">reb</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628264246"><span class="hs-identifier hs-var">exprs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-861"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><a name="local-1628264247"><a href="#local-1628264247"><span class="hs-identifier">pats</span></a></a><span> </span><a name="local-1628264248"><a href="#local-1628264248"><span class="hs-identifier">box</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-1628264249"><a href="#local-1628264249"><span class="hs-identifier">exprs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-1628264213"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264247"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-862"></a><span>                                           </span><span class="hs-special">;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsExpr.html#ExplicitTuple"><span class="hs-identifier hs-var">ExplicitTuple</span></a><span>
</span><a name="line-863"></a><span>                                                </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="HsExpr.html#Present"><span class="hs-identifier hs-var">Present</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628264249"><span class="hs-identifier hs-var">exprs</span></a><span class="hs-special">)</span><span> </span><a href="#local-1628264248"><span class="hs-identifier hs-var">box</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-864"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><a name="local-1628264250"><a href="#local-1628264250"><span class="hs-identifier">lit</span></a></a><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsExpr.html#HsLit"><span class="hs-identifier hs-var">HsLit</span></a><span> </span><a href="#local-1628264250"><span class="hs-identifier hs-var">lit</span></a><span>
</span><a name="line-865"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#NPat"><span class="hs-identifier hs-var">NPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628264251"><a href="#local-1628264251"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsExpr.html#HsOverLit"><span class="hs-identifier hs-var">HsOverLit</span></a><span> </span><a href="#local-1628264251"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-866"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#NPat"><span class="hs-identifier hs-var">NPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628264252"><a href="#local-1628264252"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-1628264253"><a href="#local-1628264253"><span class="hs-identifier">neg</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsUtils.html#nlHsSyntaxApps"><span class="hs-identifier hs-var">nlHsSyntaxApps</span></a><span> </span><a href="#local-1628264253"><span class="hs-identifier hs-var">neg</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsOverLit"><span class="hs-identifier hs-var">HsOverLit</span></a><span> </span><a href="#local-1628264252"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-867"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#ConPatOut"><span class="hs-identifier hs-var">ConPatOut</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;ConPatOut in output of renamer&quot;</span><span>
</span><a name="line-868"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#SigPatOut"><span class="hs-identifier hs-var">SigPatOut</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;SigPatOut in output of renamer&quot;</span><span>
</span><a name="line-869"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-special">(</span><a href="HsPat.html#CoPat"><span class="hs-identifier hs-var">CoPat</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;CoPat in output of renamer&quot;</span><span>
</span><a name="line-870"></a><span>    </span><span class="hs-identifier">go1</span><span>   </span><span class="hs-identifier">_</span><span>                           </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-871"></a><span>
</span><a name="line-872"></a><span class="hs-comment">-- Walk the whole pattern and for all ConPatOuts, collect the</span><span>
</span><a name="line-873"></a><span class="hs-comment">-- existentially-bound type variables and evidence binding variables.</span><span>
</span><a name="line-874"></a><span class="hs-comment">--</span><span>
</span><a name="line-875"></a><span class="hs-comment">-- These are used in computing the type of a pattern synonym and also</span><span>
</span><a name="line-876"></a><span class="hs-comment">-- in generating matcher functions, since success continuations need</span><span>
</span><a name="line-877"></a><span class="hs-comment">-- to be passed these pattern-bound evidences.</span><span>
</span><a name="line-878"></a><span class="hs-identifier">tcCollectEx</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="VarSet.html#TyVarSet"><span class="hs-identifier hs-type">TyVarSet</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-879"></a><a name="tcCollectEx"><a href="TcPatSyn.html#tcCollectEx"><span class="hs-identifier">tcCollectEx</span></a></a><span> </span><a name="local-1628264254"><a href="#local-1628264254"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264255"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264254"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-880"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-881"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="VarSet.html#TyVarSet"><span class="hs-identifier hs-type">TyVarSet</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-882"></a><span>    </span><a name="local-1628264255"><a href="#local-1628264255"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264256"><span class="hs-identifier hs-var">go1</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span>
</span><a name="line-883"></a><span>
</span><a name="line-884"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="VarSet.html#TyVarSet"><span class="hs-identifier hs-type">TyVarSet</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-885"></a><span>    </span><a name="local-1628264256"><a href="#local-1628264256"><span class="hs-identifier">go1</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LazyPat"><span class="hs-identifier hs-var">LazyPat</span></a><span> </span><a name="local-1628264259"><a href="#local-1628264259"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264255"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264259"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-886"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#AsPat"><span class="hs-identifier hs-var">AsPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628264260"><a href="#local-1628264260"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264255"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264260"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-887"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><a name="local-1628264261"><a href="#local-1628264261"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264255"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264261"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-888"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#BangPat"><span class="hs-identifier hs-var">BangPat</span></a><span> </span><a name="local-1628264262"><a href="#local-1628264262"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264255"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264262"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-889"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><a name="local-1628264263"><a href="#local-1628264263"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628264255"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628264263"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-890"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><a name="local-1628264264"><a href="#local-1628264264"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628264255"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628264264"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-891"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#PArrPat"><span class="hs-identifier hs-var">PArrPat</span></a><span> </span><a name="local-1628264265"><a href="#local-1628264265"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628264255"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628264265"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-892"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#ViewPat"><span class="hs-identifier hs-var">ViewPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628264266"><a href="#local-1628264266"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264255"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264266"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-893"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><a name="local-1628264267"><a href="#local-1628264267"><span class="hs-identifier">con</span></a></a><span class="hs-glyph">@</span><a href="HsPat.html#ConPatOut"><span class="hs-identifier hs-var">ConPatOut</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span> </span><span class="hs-special">(</span><a href="VarSet.html#mkVarSet"><span class="hs-identifier hs-var">mkVarSet</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">pat_tvs</span><span> </span><a href="#local-1628264267"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_dicts</span><span> </span><a href="#local-1628264267"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-894"></a><span>                                 </span><a href="#local-1628264257"><span class="hs-identifier hs-var">goConDetails</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">pat_args</span><span> </span><a href="#local-1628264267"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-895"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#SigPatOut"><span class="hs-identifier hs-var">SigPatOut</span></a><span> </span><a name="local-1628264268"><a href="#local-1628264268"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264255"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264268"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-896"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#CoPat"><span class="hs-identifier hs-var">CoPat</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628264269"><a href="#local-1628264269"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264256"><span class="hs-identifier hs-var">go1</span></a><span> </span><a href="#local-1628264269"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-897"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><span class="hs-special">(</span><a href="HsPat.html#NPlusKPat"><span class="hs-identifier hs-var">NPlusKPat</span></a><span> </span><a name="local-1628264270"><a href="#local-1628264270"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-1628264271"><a href="#local-1628264271"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-1628264272"><a href="#local-1628264272"><span class="hs-identifier">geq</span></a></a><span> </span><a name="local-1628264273"><a href="#local-1628264273"><span class="hs-identifier">subtract</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-898"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;TODO: NPlusKPat&quot;</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264270"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264271"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264272"><span class="hs-identifier hs-var">geq</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-1628264273"><span class="hs-identifier hs-var">subtract</span></a><span>
</span><a name="line-899"></a><span>    </span><span class="hs-identifier">go1</span><span> </span><span class="hs-identifier">_</span><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span>
</span><a name="line-900"></a><span>
</span><a name="line-901"></a><span>    </span><span class="hs-identifier">goConDetails</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#HsConPatDetails"><span class="hs-identifier hs-type">HsConPatDetails</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="VarSet.html#TyVarSet"><span class="hs-identifier hs-type">TyVarSet</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-902"></a><span>    </span><a name="local-1628264257"><a href="#local-1628264257"><span class="hs-identifier">goConDetails</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><a name="local-1628264274"><a href="#local-1628264274"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628264255"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628264274"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-903"></a><span>    </span><span class="hs-identifier">goConDetails</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a name="local-1628264275"><a href="#local-1628264275"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-1628264276"><a href="#local-1628264276"><span class="hs-identifier">p2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264255"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264275"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-1628264255"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264276"><span class="hs-identifier hs-var">p2</span></a><span>
</span><a name="line-904"></a><span>    </span><span class="hs-identifier">goConDetails</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span> </span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-var">HsRecFields</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">rec_flds</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628264277"><a href="#local-1628264277"><span class="hs-identifier">flds</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-905"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-1628264258"><span class="hs-identifier hs-var">goRecFd</span></a><span> </span><a href="../base-4.9.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-1628264277"><span class="hs-identifier hs-var">flds</span></a><span>
</span><a name="line-906"></a><span>
</span><a name="line-907"></a><span>    </span><span class="hs-identifier">goRecFd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#LHsRecField"><span class="hs-identifier hs-type">LHsRecField</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="VarSet.html#TyVarSet"><span class="hs-identifier hs-type">TyVarSet</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-908"></a><span>    </span><a name="local-1628264258"><a href="#local-1628264258"><span class="hs-identifier">goRecFd</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="HsPat.html#HsRecField"><span class="hs-identifier hs-var">HsRecField</span></a><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsRecFieldArg</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-1628264278"><a href="#local-1628264278"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1628264255"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-1628264278"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-909"></a></pre></body></html>